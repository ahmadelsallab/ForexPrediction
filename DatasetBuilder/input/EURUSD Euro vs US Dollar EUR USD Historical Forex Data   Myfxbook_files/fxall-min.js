var Prototype={Version:"1.7",Browser:(function(){var b=navigator.userAgent;var a=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!a,Opera:a,WebKit:b.indexOf("AppleWebKit/")>-1,Gecko:b.indexOf("Gecko")>-1&&b.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(b)}})(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:(function(){var a=window.Element||window.HTMLElement;return !!(a&&a.prototype)})(),SpecificElementExtensions:(function(){if(typeof window.HTMLDivElement!=="undefined"){return true}var c=document.createElement("div"),b=document.createElement("form"),a=false;if(c.__proto__&&(c.__proto__!==b.__proto__)){a=true}c=b=null;return a})()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(a){return a}};if(Prototype.Browser.MobileSafari){Prototype.BrowserFeatures.SpecificElementExtensions=false}var Abstract={};var Try={these:function(){var c;for(var b=0,d=arguments.length;b<d;b++){var a=arguments[b];try{c=a();break}catch(f){}}return c}};var Class=(function(){var d=(function(){for(var f in {toString:1}){if(f==="toString"){return false}}return true})();function a(){}function b(){var k=null,h=$A(arguments);if(Object.isFunction(h[0])){k=h.shift()}function f(){this.initialize.apply(this,arguments)}Object.extend(f,Class.Methods);f.superclass=k;f.subclasses=[];if(k){a.prototype=k.prototype;f.prototype=new a;k.subclasses.push(f)}for(var g=0,l=h.length;g<l;g++){f.addMethods(h[g])}if(!f.prototype.initialize){f.prototype.initialize=Prototype.emptyFunction}f.prototype.constructor=f;return f}function c(o){var h=this.superclass&&this.superclass.prototype,g=Object.keys(o);if(d){if(o.toString!=Object.prototype.toString){g.push("toString")}if(o.valueOf!=Object.prototype.valueOf){g.push("valueOf")}}for(var f=0,k=g.length;f<k;f++){var m=g[f],l=o[m];if(h&&Object.isFunction(l)&&l.argumentNames()[0]=="$super"){var q=l;l=(function(r){return function(){return h[r].apply(this,arguments)}})(m).wrap(q);l.valueOf=q.valueOf.bind(q);l.toString=q.toString.bind(q)}this.prototype[m]=l}return this}return{create:b,Methods:{addMethods:c}}})();(function(){var H=Object.prototype.toString,G="Null",t="Undefined",A="Boolean",g="Number",x="String",M="Object",y="[object Function]",D="[object Boolean]",h="[object Number]",q="[object String]",k="[object Array]",C="[object Date]",l=window.JSON&&typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&typeof JSON.stringify(Prototype.K)==="undefined";function o(O){switch(O){case null:return G;case (void 0):return t}var N=typeof O;switch(N){case"boolean":return A;case"number":return g;case"string":return x}return M}function E(N,P){for(var O in P){N[O]=P[O]}return N}function L(N){try{if(c(N)){return"undefined"}if(N===null){return"null"}return N.inspect?N.inspect():String(N)}catch(O){if(O instanceof RangeError){return"..."}throw O}}function I(N){return K("",{"":N},[])}function K(W,T,U){var V=T[W],S=typeof V;if(o(V)===M&&typeof V.toJSON==="function"){V=V.toJSON(W)}var P=H.call(V);switch(P){case h:case D:case q:V=V.valueOf()}switch(V){case null:return"null";case true:return"true";case false:return"false"}S=typeof V;switch(S){case"string":return V.inspect(true);case"number":return isFinite(V)?String(V):"null";case"object":for(var O=0,N=U.length;O<N;O++){if(U[O]===V){throw new TypeError()}}U.push(V);var R=[];if(P===k){for(var O=0,N=V.length;O<N;O++){var Q=K(O,V,U);R.push(typeof Q==="undefined"?"null":Q)}R="["+R.join(",")+"]"}else{var X=Object.keys(V);for(var O=0,N=X.length;O<N;O++){var W=X[O],Q=K(W,V,U);if(typeof Q!=="undefined"){R.push(W.inspect(true)+":"+Q)}}R="{"+R.join(",")+"}"}U.pop();return R}}function B(N){return JSON.stringify(N)}function m(N){return $H(N).toQueryString()}function u(N){return N&&N.toHTML?N.toHTML():String.interpret(N)}function w(N){if(o(N)!==M){throw new TypeError()}var O=[];for(var P in N){if(N.hasOwnProperty(P)){O.push(P)}}return O}function d(N){var O=[];for(var P in N){O.push(N[P])}return O}function F(N){return E({},N)}function z(N){return !!(N&&N.nodeType==1)}function r(N){return H.call(N)===k}var b=(typeof Array.isArray=="function")&&Array.isArray([])&&!Array.isArray({});if(b){r=Array.isArray}function f(N){return N instanceof Hash}function a(N){return H.call(N)===y}function s(N){return H.call(N)===q}function v(N){return H.call(N)===h}function J(N){return H.call(N)===C}function c(N){return typeof N==="undefined"}E(Object,{extend:E,inspect:L,toJSON:l?B:I,toQueryString:m,toHTML:u,keys:Object.keys||w,values:d,clone:F,isElement:z,isArray:r,isHash:f,isFunction:a,isString:s,isNumber:v,isDate:J,isUndefined:c})})();Object.extend(Function.prototype,(function(){var o=Array.prototype.slice;function d(t,q){var s=t.length,r=q.length;while(r--){t[s+r]=q[r]}return t}function l(r,q){r=o.call(r,0);return d(r,q)}function h(){var q=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return q.length==1&&!q[0]?[]:q}function k(s){if(arguments.length<2&&Object.isUndefined(arguments[0])){return this}var q=this,r=o.call(arguments,1);return function(){var t=l(r,arguments);return q.apply(s,t)}}function g(s){var q=this,r=o.call(arguments,1);return function(u){var t=d([u||window.event],r);return q.apply(s,t)}}function m(){if(!arguments.length){return this}var q=this,r=o.call(arguments,0);return function(){var s=l(r,arguments);return q.apply(this,s)}}function f(s){var q=this,r=o.call(arguments,1);s=s*1000;return window.setTimeout(function(){return q.apply(q,r)},s)}function a(){var q=d([0.01],arguments);return this.delay.apply(this,q)}function c(r){var q=this;return function(){var s=d([q.bind(this)],arguments);return r.apply(this,s)}}function b(){if(this._methodized){return this._methodized}var q=this;return this._methodized=function(){var r=d([this],arguments);return q.apply(null,r)}}return{argumentNames:h,bind:k,bindAsEventListener:g,curry:m,delay:f,defer:a,wrap:c,methodize:b}})());(function(c){function b(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function a(){return this.toISOString()}if(!c.toISOString){c.toISOString=b}if(!c.toJSON){c.toJSON=a}})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(a){return String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")};var PeriodicalExecuter=Class.create({initialize:function(b,a){this.callback=b;this.frequency=a;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000)},execute:function(){this.callback(this)},stop:function(){if(!this.timer){return}clearInterval(this.timer);this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(a){this.currentlyExecuting=false;throw a}}}});Object.extend(String,{interpret:function(a){return a==null?"":String(a)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object.extend(String.prototype,(function(){var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&typeof JSON.parse==="function"&&JSON.parse('{"test": true}').test;function prepareReplacement(replacement){if(Object.isFunction(replacement)){return replacement}var template=new Template(replacement);return function(match){return template.evaluate(match)}}function gsub(pattern,replacement){var result="",source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern)){pattern=RegExp.escape(pattern)}if(!(pattern.length||pattern.source)){replacement=replacement("");return replacement+source.split("").join(replacement)+replacement}while(source.length>0){if(match=source.match(pattern)){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length)}else{result+=source,source=""}}return result}function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0){return match[0]}return replacement(match)})}function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this)}function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?"...":truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,"img"),matchOne=new RegExp(Prototype.ScriptFragment,"im");return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match){return{}}return match[1].split(separator||"&").inject({},function(hash,pair){if((pair=pair.split("="))[0]){var key=decodeURIComponent(pair.shift()),value=pair.length>1?pair.join("="):pair[0];if(value!=undefined){value=decodeURIComponent(value)}if(key in hash){if(!Object.isArray(hash[key])){hash[key]=[hash[key]]}hash[key].push(value)}else{hash[key]=value}}return hash})}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(count){return count<1?"":new Array(count+1).join(this)}function camelize(){return this.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(useDoubleQuotes){var escapedString=this.replace(/[\x00-\x1f\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character]}return"\\u00"+character.charCodeAt().toPaddedString(2,16)});if(useDoubleQuotes){return'"'+escapedString.replace(/"/g,'\\"')+'"'}return"'"+escapedString.replace(/'/g,"\\'")+"'"}function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,"$1")}function isJSON(){var str=this;if(str.blank()){return false}str=str.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");str=str.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");str=str.replace(/(?:^|:|,)(?:\s*\[)+/g,"");return(/^[\],:{}\s]*$/).test(str)}function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(cx.test(json)){json=json.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}try{if(!sanitize||json.isJSON()){return eval("("+json+")")}}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function parseJSON(){var json=this.unfilterJSON();return JSON.parse(json)}function include(pattern){return this.indexOf(pattern)>-1}function startsWith(pattern){return this.lastIndexOf(pattern,0)===0}function endsWith(pattern){var d=this.length-pattern.length;return d>=0&&this.indexOf(pattern,d)===d}function empty(){return this==""}function blank(){return/^\s*$/.test(this)}function interpolate(object,pattern){return new Template(this,pattern).evaluate(object)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:startsWith,endsWith:endsWith,empty:empty,blank:blank,interpolate:interpolate}})());var Template=Class.create({initialize:function(a,b){this.template=a.toString();this.pattern=b||Template.Pattern},evaluate:function(a){if(a&&Object.isFunction(a.toTemplateReplacements)){a=a.toTemplateReplacements()}return this.template.gsub(this.pattern,function(d){if(a==null){return(d[1]+"")}var g=d[1]||"";if(g=="\\"){return d[2]}var b=a,h=d[3],f=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;d=f.exec(h);if(d==null){return g}while(d!=null){var c=d[1].startsWith("[")?d[2].replace(/\\\\]/g,"]"):d[1];b=b[c];if(null==b||""==d[3]){break}h=h.substring("["==d[3]?d[1].length:d[0].length);d=f.exec(h)}return g+String.interpret(b)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable=(function(){function c(D,C){var B=0;try{this._each(function(F){D.call(C,F,B++)})}catch(E){if(E!=$break){throw E}}return this}function w(E,D,C){var B=-E,F=[],G=this.toArray();if(E<1){return G}while((B+=E)<G.length){F.push(G.slice(B,B+E))}return F.collect(D,C)}function b(D,C){D=D||Prototype.K;var B=true;this.each(function(F,E){B=B&&!!D.call(C,F,E);if(!B){throw $break}});return B}function l(D,C){try{D=D||Prototype.K;var B=false;this.each(function(G,F){if(B=!!D.call(C,G,F)){throw $break}})}catch(E){}return B}function m(D,C){D=D||Prototype.K;var B=[];this.each(function(F,E){B.push(D.call(C,F,E))});return B}function y(D,C){var B;this.each(function(F,E){if(D.call(C,F,E)){B=F;throw $break}});return B}function k(D,C){var B=[];this.each(function(F,E){if(D.call(C,F,E)){B.push(F)}});return B}function h(E,D,C){D=D||Prototype.K;var B=[];if(Object.isString(E)){E=new RegExp(RegExp.escape(E))}this.each(function(G,F){if(E.match(G)){B.push(D.call(C,G,F))}});return B}function a(B){if(Object.isFunction(this.indexOf)){if(this.indexOf(B)!=-1){return true}}var C=false;this.each(function(D){if(D==B){C=true;throw $break}});return C}function v(C,B){B=Object.isUndefined(B)?null:B;return this.eachSlice(C,function(D){while(D.length<C){D.push(B)}return D})}function q(B,D,C){this.each(function(F,E){B=D.call(C,B,F,E)});return B}function A(C){var B=$A(arguments).slice(1);return this.map(function(D){return D[C].apply(D,B)})}function u(D,C){D=D||Prototype.K;var B;this.each(function(F,E){F=D.call(C,F,E);if(B==null||F>=B){B=F}});return B}function s(D,C){D=D||Prototype.K;var B;this.each(function(F,E){F=D.call(C,F,E);if(B==null||F<B){B=F}});return B}function f(E,C){E=E||Prototype.K;var D=[],B=[];this.each(function(G,F){(E.call(C,G,F)?D:B).push(G)});return[D,B]}function g(C){var B=[];this.each(function(D){B.push(D[C])});return B}function d(D,C){var B=[];this.each(function(F,E){if(!D.call(C,F,E)){B.push(F)}});return B}function r(C,B){return this.map(function(E,D){return{value:E,criteria:C.call(B,E,D)}}).sort(function(G,F){var E=G.criteria,D=F.criteria;return E<D?-1:E>D?1:0}).pluck("value")}function t(){return this.map()}function x(){var C=Prototype.K,B=$A(arguments);if(Object.isFunction(B.last())){C=B.pop()}var D=[this].concat(B).map($A);return this.map(function(F,E){return C(D.pluck(E))})}function o(){return this.toArray().length}function z(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:c,eachSlice:w,all:b,every:b,any:l,some:l,collect:m,map:m,detect:y,findAll:k,select:k,filter:k,grep:h,include:a,member:a,inGroupsOf:v,inject:q,invoke:A,max:u,min:s,partition:f,pluck:g,reject:d,sortBy:r,toArray:t,entries:t,zip:x,size:o,inspect:z,find:y}})();function $A(c){if(!c){return[]}if("toArray" in Object(c)){return c.toArray()}var b=c.length||0,a=new Array(b);while(b--){a[b]=c[b]}return a}function $w(a){if(!Object.isString(a)){return[]}a=a.strip();return a?a.split(/\s+/):[]}Array.from=$A;(function(){var w=Array.prototype,r=w.slice,t=w.forEach;function b(B,A){for(var z=0,C=this.length>>>0;z<C;z++){if(z in this){B.call(A,this[z],z,this)}}}if(!t){t=b}function q(){this.length=0;return this}function d(){return this[0]}function h(){return this[this.length-1]}function l(){return this.select(function(z){return z!=null})}function y(){return this.inject([],function(A,z){if(Object.isArray(z)){return A.concat(z.flatten())}A.push(z);return A})}function k(){var z=r.call(arguments,0);return this.select(function(A){return !z.include(A)})}function g(z){return(z===false?this.toArray():this)._reverse()}function o(z){return this.inject([],function(C,B,A){if(0==A||(z?C.last()!=B:!C.include(B))){C.push(B)}return C})}function u(z){return this.uniq().findAll(function(A){return z.detect(function(B){return A===B})})}function v(){return r.call(this,0)}function m(){return this.length}function x(){return"["+this.map(Object.inspect).join(", ")+"]"}function a(B,z){z||(z=0);var A=this.length;if(z<0){z=A+z}for(;z<A;z++){if(this[z]===B){return z}}return -1}function s(A,z){z=isNaN(z)?this.length:(z<0?this.length+z:z)+1;var B=this.slice(0,z).reverse().indexOf(A);return(B<0)?B:z-B-1}function c(){var E=r.call(this,0),C;for(var A=0,B=arguments.length;A<B;A++){C=arguments[A];if(Object.isArray(C)&&!("callee" in C)){for(var z=0,D=C.length;z<D;z++){E.push(C[z])}}else{E.push(C)}}return E}Object.extend(w,Enumerable);if(!w._reverse){w._reverse=w.reverse}Object.extend(w,{_each:t,clear:q,first:d,last:h,compact:l,flatten:y,without:k,reverse:g,uniq:o,intersect:u,clone:v,toArray:v,size:m,inspect:x});var f=(function(){return[].concat(arguments)[0][0]!==1})(1,2);if(f){w.concat=c}if(!w.indexOf){w.indexOf=a}if(!w.lastIndexOf){w.lastIndexOf=s}})();function $H(a){return new Hash(a)}var Hash=Class.create(Enumerable,(function(){function f(u){this._object=Object.isHash(u)?u.toObject():Object.clone(u)}function g(v){for(var u in this._object){var w=this._object[u],x=[u,w];x.key=u;x.value=w;v(x)}}function m(u,v){return this._object[u]=v}function c(u){if(this._object[u]!==Object.prototype[u]){return this._object[u]}}function r(u){var v=this._object[u];delete this._object[u];return v}function t(){return Object.clone(this._object)}function s(){return this.pluck("key")}function q(){return this.pluck("value")}function h(v){var u=this.detect(function(w){return w.value===v});return u&&u.key}function l(u){return this.clone().update(u)}function d(u){return new Hash(u).inject(this,function(v,w){v.set(w.key,w.value);return v})}function b(u,v){if(Object.isUndefined(v)){return u}return u+"="+encodeURIComponent(String.interpret(v))}function a(){return this.inject([],function(y,B){var x=encodeURIComponent(B.key),v=B.value;if(v&&typeof v=="object"){if(Object.isArray(v)){var A=[];for(var w=0,u=v.length,z;w<u;w++){z=v[w];A.push(b(x,z))}return y.concat(A)}}else{y.push(b(x,v))}return y}).join("&")}function o(){return"#<Hash:{"+this.map(function(u){return u.map(Object.inspect).join(": ")}).join(", ")+"}>"}function k(){return new Hash(this)}return{initialize:f,_each:g,set:m,get:c,unset:r,toObject:t,toTemplateReplacements:t,keys:s,values:q,index:h,merge:l,update:d,toQueryString:a,inspect:o,toJSON:t,clone:k}})());Hash.from=$H;Object.extend(Number.prototype,(function(){function d(){return this.toPaddedString(2,16)}function b(){return this+1}function k(m,l){$R(0,this,true).each(m,l);return this}function h(o,m){var l=this.toString(m||10);return"0".times(o-l.length)+l}function a(){return Math.abs(this)}function c(){return Math.round(this)}function f(){return Math.ceil(this)}function g(){return Math.floor(this)}return{toColorPart:d,succ:b,times:k,toPaddedString:h,abs:a,round:c,ceil:f,floor:g}})());function $R(c,a,b){return new ObjectRange(c,a,b)}var ObjectRange=Class.create(Enumerable,(function(){function b(g,d,f){this.start=g;this.end=d;this.exclusive=f}function c(d){var f=this.start;while(this.include(f)){d(f);f=f.succ()}}function a(d){if(d<this.start){return false}if(this.exclusive){return d<this.end}return d<=this.end}return{initialize:b,_each:c,include:a}})());var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(a){this.responders._each(a)},register:function(a){if(!this.include(a)){this.responders.push(a)}},unregister:function(a){this.responders=this.responders.without(a)},dispatch:function(d,b,c,a){this.each(function(f){if(Object.isFunction(f[d])){try{f[d].apply(f,[b,c,a])}catch(g){}}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(a){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,a||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters)){this.options.parameters=this.options.parameters.toObject()}}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,b,a){$super(a);this.transport=Ajax.getTransport();this.request(b)},request:function(b){this.url=b;this.method=this.options.method;var d=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!["get","post"].include(this.method)){d+=(d?"&":"")+"_method="+this.method;this.method="post"}if(d&&this.method==="get"){this.url+=(this.url.include("?")?"&":"?")+d}this.parameters=d.toQueryParams();try{var a=new Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(a)}Ajax.Responders.dispatch("onCreate",this,a);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){this.respondToReadyState.bind(this).defer(1)}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?(this.options.postBody||d):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange()}}catch(c){this.dispatchException(c)}},onStateChange:function(){var a=this.transport.readyState;if(a>1&&!((a==4)&&this._complete)){this.respondToReadyState(this.transport.readyState)}},setRequestHeaders:function(){var f={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){f["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){f.Connection="close"}}if(typeof this.options.requestHeaders=="object"){var c=this.options.requestHeaders;if(Object.isFunction(c.push)){for(var b=0,d=c.length;b<d;b+=2){f[c[b]]=c[b+1]}}else{$H(c).each(function(g){f[g.key]=g.value})}}for(var a in f){this.transport.setRequestHeader(a,f[a])}},success:function(){var a=this.getStatus();return !a||(a>=200&&a<300)||a==304},getStatus:function(){try{if(this.transport.status===1223){return 204}return this.transport.status||0}catch(a){return 0}},respondToReadyState:function(a){var c=Ajax.Request.Events[a],b=new Ajax.Response(this);if(c=="Complete"){try{this._complete=true;(this.options["on"+b.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(b,b.headerJSON)}catch(d){this.dispatchException(d)}var f=b.getHeader("Content-type");if(this.options.evalJS=="force"||(this.options.evalJS&&this.isSameOrigin()&&f&&f.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))){this.evalResponse()}}try{(this.options["on"+c]||Prototype.emptyFunction)(b,b.headerJSON);Ajax.Responders.dispatch("on"+c,this,b,b.headerJSON)}catch(d){this.dispatchException(d)}if(c=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction}},isSameOrigin:function(){var a=this.url.match(/^\s*https?:\/\/[^\/]*/);return !a||(a[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""}))},getHeader:function(a){try{return this.transport.getResponseHeader(a)||null}catch(b){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(a){(this.options.onException||Prototype.emptyFunction)(this,a);Ajax.Responders.dispatch("onException",this,a)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Response=Class.create({initialize:function(c){this.request=c;var d=this.transport=c.transport,a=this.readyState=d.readyState;if((a>2&&!Prototype.Browser.IE)||a==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(d.responseText);this.headerJSON=this._getHeaderJSON()}if(a==4){var b=d.responseXML;this.responseXML=Object.isUndefined(b)?null:b;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(a){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(a){return null}},getResponseHeader:function(a){return this.transport.getResponseHeader(a)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var a=this.getHeader("X-JSON");if(!a){return null}a=decodeURIComponent(escape(a));try{return a.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}},_getResponseJSON:function(){var a=this.request.options;if(!a.evalJSON||(a.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json"))||this.responseText.blank()){return null}try{return this.responseText.evalJSON(a.sanitizeJSON||!this.request.isSameOrigin())}catch(b){this.request.dispatchException(b)}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,a,c,b){this.container={success:(a.success||a),failure:(a.failure||(a.success?null:a))};b=Object.clone(b);var d=b.onComplete;b.onComplete=(function(f,g){this.updateContent(f.responseText);if(Object.isFunction(d)){d(f,g)}}).bind(this);$super(c,b)},updateContent:function(d){var c=this.container[this.success()?"success":"failure"],a=this.options;if(!a.evalScripts){d=d.stripScripts()}if(c=$(c)){if(a.insertion){if(Object.isString(a.insertion)){var b={};b[a.insertion]=d;c.insert(b)}else{a.insertion(c,d)}}else{c.update(d)}}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,a,c,b){$super(b);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=a;this.url=c;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(a){if(this.options.decay){this.decay=(a.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=a.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});function $(b){if(arguments.length>1){for(var a=0,d=[],c=arguments.length;a<c;a++){d.push($(arguments[a]))}return d}if(Object.isString(b)){b=document.getElementById(b)}return Element.extend(b)}if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(g,a){var c=[];var f=document.evaluate(g,$(a)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var b=0,d=f.snapshotLength;b<d;b++){c.push(Element.extend(f.snapshotItem(b)))}return c}}if(!Node){var Node={}}if(!Node.ELEMENT_NODE){Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12})}(function(c){function d(g,f){if(g==="select"){return false}if("type" in f){return false}return true}var b=(function(){try{var f=document.createElement('<input name="x">');return f.tagName.toLowerCase()==="input"&&f.name==="x"}catch(g){return false}})();var a=c.Element;c.Element=function(h,g){g=g||{};h=h.toLowerCase();var f=Element.cache;if(b&&g.name){h="<"+h+' name="'+g.name+'">';delete g.name;return Element.writeAttribute(document.createElement(h),g)}if(!f[h]){f[h]=Element.extend(document.createElement(h))}var k=d(h,g)?f[h].cloneNode(false):document.createElement(h);return Element.writeAttribute(k,g)};Object.extend(c.Element,a||{});if(a){c.Element.prototype=a.prototype}})(this);Element.idCounter=1;Element.cache={};Element._purgeElement=function(b){var a=b._prototypeUID;if(a){Element.stopObserving(b);b._prototypeUID=void 0;delete Element.Storage[a]}};Element.Methods={visible:function(a){return $(a).style.display!="none"},toggle:function(a){a=$(a);Element[Element.visible(a)?"hide":"show"](a);return a},hide:function(a){a=$(a);a.style.display="none";return a},show:function(a){a=$(a);a.style.display="";return a},remove:function(a){a=$(a);a.parentNode.removeChild(a);return a},update:(function(){var d=(function(){var h=document.createElement("select"),k=true;h.innerHTML='<option value="test">test</option>';if(h.options&&h.options[0]){k=h.options[0].nodeName.toUpperCase()!=="OPTION"}h=null;return k})();var b=(function(){try{var h=document.createElement("table");if(h&&h.tBodies){h.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var l=typeof h.tBodies[0]=="undefined";h=null;return l}}catch(k){return true}})();var a=(function(){try{var h=document.createElement("div");h.innerHTML="<link>";var l=(h.childNodes.length===0);h=null;return l}catch(k){return true}})();var c=d||b||a;var g=(function(){var h=document.createElement("script"),l=false;try{h.appendChild(document.createTextNode(""));l=!h.firstChild||h.firstChild&&h.firstChild.nodeType!==3}catch(k){l=true}h=null;return l})();function f(o,q){o=$(o);var h=Element._purgeElement;var r=o.getElementsByTagName("*"),m=r.length;while(m--){h(r[m])}if(q&&q.toElement){q=q.toElement()}if(Object.isElement(q)){return o.update().insert(q)}q=Object.toHTML(q);var l=o.tagName.toUpperCase();if(l==="SCRIPT"&&g){o.text=q;return o}if(c){if(l in Element._insertionTranslations.tags){while(o.firstChild){o.removeChild(o.firstChild)}Element._getContentFromAnonymousElement(l,q.stripScripts()).each(function(s){o.appendChild(s)})}else{if(a&&Object.isString(q)&&q.indexOf("<link")>-1){while(o.firstChild){o.removeChild(o.firstChild)}var k=Element._getContentFromAnonymousElement(l,q.stripScripts(),true);k.each(function(s){o.appendChild(s)})}else{o.innerHTML=q.stripScripts()}}}else{o.innerHTML=q.stripScripts()}q.evalScripts.bind(q).defer();return o}return f})(),replace:function(b,c){b=$(b);if(c&&c.toElement){c=c.toElement()}else{if(!Object.isElement(c)){c=Object.toHTML(c);var a=b.ownerDocument.createRange();a.selectNode(b);c.evalScripts.bind(c).defer();c=a.createContextualFragment(c.stripScripts())}}b.parentNode.replaceChild(c,b);return b},insert:function(c,f){c=$(c);if(Object.isString(f)||Object.isNumber(f)||Object.isElement(f)||(f&&(f.toElement||f.toHTML))){f={bottom:f}}var d,g,b,h;for(var a in f){d=f[a];a=a.toLowerCase();g=Element._insertionTranslations[a];if(d&&d.toElement){d=d.toElement()}if(Object.isElement(d)){g(c,d);continue}d=Object.toHTML(d);b=((a=="before"||a=="after")?c.parentNode:c).tagName.toUpperCase();h=Element._getContentFromAnonymousElement(b,d.stripScripts());if(a=="top"||a=="after"){h.reverse()}h.each(g.curry(c));d.evalScripts.bind(d).defer()}return c},wrap:function(b,c,a){b=$(b);if(Object.isElement(c)){$(c).writeAttribute(a||{})}else{if(Object.isString(c)){c=new Element(c,a)}else{c=new Element("div",c)}}if(b.parentNode){b.parentNode.replaceChild(c,b)}c.appendChild(b);return c},inspect:function(b){b=$(b);var a="<"+b.tagName.toLowerCase();$H({id:"id",className:"class"}).each(function(g){var f=g.first(),c=g.last(),d=(b[f]||"").toString();if(d){a+=" "+c+"="+d.inspect(true)}});return a+">"},recursivelyCollect:function(a,c,d){a=$(a);d=d||-1;var b=[];while(a=a[c]){if(a.nodeType==1){b.push(Element.extend(a))}if(b.length==d){break}}return b},ancestors:function(a){return Element.recursivelyCollect(a,"parentNode")},descendants:function(a){return Element.select(a,"*")},firstDescendant:function(a){a=$(a).firstChild;while(a&&a.nodeType!=1){a=a.nextSibling}return $(a)},immediateDescendants:function(b){var a=[],c=$(b).firstChild;while(c){if(c.nodeType===1){a.push(Element.extend(c))}c=c.nextSibling}return a},previousSiblings:function(a,b){return Element.recursivelyCollect(a,"previousSibling")},nextSiblings:function(a){return Element.recursivelyCollect(a,"nextSibling")},siblings:function(a){a=$(a);return Element.previousSiblings(a).reverse().concat(Element.nextSiblings(a))},match:function(b,a){b=$(b);if(Object.isString(a)){return Prototype.Selector.match(b,a)}return a.match(b)},up:function(b,d,a){b=$(b);if(arguments.length==1){return $(b.parentNode)}var c=Element.ancestors(b);return Object.isNumber(d)?c[d]:Prototype.Selector.find(c,d,a)},down:function(b,c,a){b=$(b);if(arguments.length==1){return Element.firstDescendant(b)}return Object.isNumber(c)?Element.descendants(b)[c]:Element.select(b,c)[a||0]},previous:function(b,c,a){b=$(b);if(Object.isNumber(c)){a=c,c=false}if(!Object.isNumber(a)){a=0}if(c){return Prototype.Selector.find(b.previousSiblings(),c,a)}else{return b.recursivelyCollect("previousSibling",a+1)[a]}},next:function(b,d,a){b=$(b);if(Object.isNumber(d)){a=d,d=false}if(!Object.isNumber(a)){a=0}if(d){return Prototype.Selector.find(b.nextSiblings(),d,a)}else{var c=Object.isNumber(a)?a+1:1;return b.recursivelyCollect("nextSibling",a+1)[a]}},select:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a)},adjacent:function(a){a=$(a);var b=Array.prototype.slice.call(arguments,1).join(", ");return Prototype.Selector.select(b,a.parentNode).without(a)},identify:function(a){a=$(a);var b=Element.readAttribute(a,"id");if(b){return b}do{b="anonymous_element_"+Element.idCounter++}while($(b));Element.writeAttribute(a,"id",b);return b},readAttribute:function(c,a){c=$(c);if(Prototype.Browser.IE){var b=Element._attributeTranslations.read;if(b.values[a]){return b.values[a](c,a)}if(b.names[a]){a=b.names[a]}if(a.include(":")){return(!c.attributes||!c.attributes[a])?null:c.attributes[a].value}}return c.getAttribute(a)},writeAttribute:function(f,c,g){f=$(f);var b={},d=Element._attributeTranslations.write;if(typeof c=="object"){b=c}else{b[c]=Object.isUndefined(g)?true:g}for(var a in b){c=d.names[a]||a;g=b[a];if(d.values[a]){c=d.values[a](f,g)}if(g===false||g===null){f.removeAttribute(c)}else{if(g===true){f.setAttribute(c,c)}else{f.setAttribute(c,g)}}}return f},getHeight:function(a){return Element.getDimensions(a).height},getWidth:function(a){return Element.getDimensions(a).width},classNames:function(a){return new Element.ClassNames(a)},hasClassName:function(a,b){if(!(a=$(a))){return}var c=a.className;return(c.length>0&&(c==b||new RegExp("(^|\\s)"+b+"(\\s|$)").test(c)))},addClassName:function(a,b){if(!(a=$(a))){return}if(!Element.hasClassName(a,b)){a.className+=(a.className?" ":"")+b}return a},removeClassName:function(a,b){if(!(a=$(a))){return}a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").strip();return a},toggleClassName:function(a,b){if(!(a=$(a))){return}return Element[Element.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)},cleanWhitespace:function(b){b=$(b);var c=b.firstChild;while(c){var a=c.nextSibling;if(c.nodeType==3&&!/\S/.test(c.nodeValue)){b.removeChild(c)}c=a}return b},empty:function(a){return $(a).innerHTML.blank()},descendantOf:function(b,a){b=$(b),a=$(a);if(b.compareDocumentPosition){return(b.compareDocumentPosition(a)&8)===8}if(a.contains){return a.contains(b)&&a!==b}while(b=b.parentNode){if(b==a){return true}}return false},scrollTo:function(a){a=$(a);var b=Element.cumulativeOffset(a);window.scrollTo(b[0],b[1]);return a},getStyle:function(b,c){b=$(b);c=c=="float"?"cssFloat":c.camelize();var d=b.style[c];if(!d||d=="auto"){var a=document.defaultView.getComputedStyle(b,null);d=a?a[c]:null}if(c=="opacity"){return d?parseFloat(d):1}return d=="auto"?null:d},getOpacity:function(a){return $(a).getStyle("opacity")},setStyle:function(b,c){b=$(b);var f=b.style,a;if(Object.isString(c)){b.style.cssText+=";"+c;return c.include("opacity")?b.setOpacity(c.match(/opacity:\s*(\d?\.?\d*)/)[1]):b}for(var d in c){if(d=="opacity"){b.setOpacity(c[d])}else{f[(d=="float"||d=="cssFloat")?(Object.isUndefined(f.styleFloat)?"cssFloat":"styleFloat"):d]=c[d]}}return b},setOpacity:function(a,b){a=$(a);a.style.opacity=(b==1||b==="")?"":(b<0.00001)?0:b;return a},makePositioned:function(a){a=$(a);var b=Element.getStyle(a,"position");if(b=="static"||!b){a._madePositioned=true;a.style.position="relative";if(Prototype.Browser.Opera){a.style.top=0;a.style.left=0}}return a},undoPositioned:function(a){a=$(a);if(a._madePositioned){a._madePositioned=undefined;a.style.position=a.style.top=a.style.left=a.style.bottom=a.style.right=""}return a},makeClipping:function(a){a=$(a);if(a._overflow){return a}a._overflow=Element.getStyle(a,"overflow")||"auto";if(a._overflow!=="hidden"){a.style.overflow="hidden"}return a},undoClipping:function(a){a=$(a);if(!a._overflow){return a}a.style.overflow=a._overflow=="auto"?"":a._overflow;a._overflow=null;return a},clonePosition:function(b,d){var a=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});d=$(d);var f=Element.viewportOffset(d),g=[0,0],c=null;b=$(b);if(Element.getStyle(b,"position")=="absolute"){c=Element.getOffsetParent(b);g=Element.viewportOffset(c)}if(c==document.body){g[0]-=document.body.offsetLeft;g[1]-=document.body.offsetTop}if(a.setLeft){b.style.left=(f[0]-g[0]+a.offsetLeft)+"px"}if(a.setTop){b.style.top=(f[1]-g[1]+a.offsetTop)+"px"}if(a.setWidth){b.style.width=d.offsetWidth+"px"}if(a.setHeight){b.style.height=d.offsetHeight+"px"}return b}};Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(d,b,c){switch(c){case"height":case"width":if(!Element.visible(b)){return null}var f=parseInt(d(b,c),10);if(f!==b["offset"+c.capitalize()]){return f+"px"}var a;if(c==="height"){a=["border-top-width","padding-top","padding-bottom","border-bottom-width"]}else{a=["border-left-width","padding-left","padding-right","border-right-width"]}return a.inject(f,function(g,h){var k=d(b,h);return k===null?g:g-parseInt(k,10)})+"px";default:return d(b,c)}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(c,a,b){if(b==="title"){return a.title}return c(a,b)})}else{if(Prototype.Browser.IE){Element.Methods.getStyle=function(a,b){a=$(a);b=(b=="float"||b=="cssFloat")?"styleFloat":b.camelize();var c=a.style[b];if(!c&&a.currentStyle){c=a.currentStyle[b]}if(b=="opacity"){if(c=(a.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/)){if(c[1]){return parseFloat(c[1])/100}}return 1}if(c=="auto"){if((b=="width"||b=="height")&&(a.getStyle("display")!="none")){return a["offset"+b.capitalize()]+"px"}return null}return c};Element.Methods.setOpacity=function(b,f){function g(h){return h.replace(/alpha\([^\)]*\)/gi,"")}b=$(b);var a=b.currentStyle;if((a&&!a.hasLayout)||(!a&&b.style.zoom=="normal")){b.style.zoom=1}var d=b.getStyle("filter"),c=b.style;if(f==1||f===""){(d=g(d))?c.filter=d:c.removeAttribute("filter");return b}else{if(f<0.00001){f=0}}c.filter=g(d)+"alpha(opacity="+(f*100)+")";return b};Element._attributeTranslations=(function(){var b="className",a="for",c=document.createElement("div");c.setAttribute(b,"x");if(c.className!=="x"){c.setAttribute("class","x");if(c.className==="x"){b="class"}}c=null;c=document.createElement("label");c.setAttribute(a,"x");if(c.htmlFor!=="x"){c.setAttribute("htmlFor","x");if(c.htmlFor==="x"){a="htmlFor"}}c=null;return{read:{names:{"class":b,className:b,"for":a,htmlFor:a},values:{_getAttr:function(d,f){return d.getAttribute(f)},_getAttr2:function(d,f){return d.getAttribute(f,2)},_getAttrNode:function(d,g){var f=d.getAttributeNode(g);return f?f.value:""},_getEv:(function(){var d=document.createElement("div"),h;d.onclick=Prototype.emptyFunction;var g=d.getAttribute("onclick");if(String(g).indexOf("{")>-1){h=function(f,k){k=f.getAttribute(k);if(!k){return null}k=k.toString();k=k.split("{")[1];k=k.split("}")[0];return k.strip()}}else{if(g===""){h=function(f,k){k=f.getAttribute(k);if(!k){return null}return k.strip()}}}d=null;return h})(),_flag:function(d,f){return $(d).hasAttribute(f)?f:null},style:function(d){return d.style.cssText.toLowerCase()},title:function(d){return d.title}}}}})();Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(a,b){a.checked=!!b},style:function(a,b){a.style.cssText=b?b:""}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex encType maxLength readOnly longDesc frameBorder").each(function(a){Element._attributeTranslations.write.names[a.toLowerCase()]=a;Element._attributeTranslations.has[a.toLowerCase()]=a});(function(a){Object.extend(a,{href:a._getAttr2,src:a._getAttr2,type:a._getAttr,action:a._getAttrNode,disabled:a._flag,checked:a._flag,readonly:a._flag,multiple:a._flag,onload:a._getEv,onunload:a._getEv,onclick:a._getEv,ondblclick:a._getEv,onmousedown:a._getEv,onmouseup:a._getEv,onmouseover:a._getEv,onmousemove:a._getEv,onmouseout:a._getEv,onfocus:a._getEv,onblur:a._getEv,onkeypress:a._getEv,onkeydown:a._getEv,onkeyup:a._getEv,onsubmit:a._getEv,onreset:a._getEv,onselect:a._getEv,onchange:a._getEv})})(Element._attributeTranslations.read.values);if(Prototype.BrowserFeatures.ElementExtensions){(function(){function a(f){var b=f.getElementsByTagName("*"),d=[];for(var c=0,g;g=b[c];c++){if(g.tagName!=="!"){d.push(g)}}return d}Element.Methods.down=function(c,d,b){c=$(c);if(arguments.length==1){return c.firstDescendant()}return Object.isNumber(d)?a(c)[d]:Element.select(c,d)[b||0]}})()}}else{if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)){Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=(b==1)?0.999999:(b==="")?"":(b<0.00001)?0:b;return a}}else{if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(a,b){a=$(a);a.style.opacity=(b==1||b==="")?"":(b<0.00001)?0:b;if(b==1){if(a.tagName.toUpperCase()=="IMG"&&a.width){a.width++;a.width--}else{try{var d=document.createTextNode(" ");a.appendChild(d);a.removeChild(d)}catch(c){}}}return a}}}}}if("outerHTML" in document.documentElement){Element.Methods.replace=function(c,f){c=$(c);if(f&&f.toElement){f=f.toElement()}if(Object.isElement(f)){c.parentNode.replaceChild(f,c);return c}f=Object.toHTML(f);var d=c.parentNode,b=d.tagName.toUpperCase();if(Element._insertionTranslations.tags[b]){var g=c.next(),a=Element._getContentFromAnonymousElement(b,f.stripScripts());d.removeChild(c);if(g){a.each(function(h){d.insertBefore(h,g)})}else{a.each(function(h){d.appendChild(h)})}}else{c.outerHTML=f.stripScripts()}f.evalScripts.bind(f).defer();return c}}Element._returnOffset=function(b,c){var a=[b,c];a.left=b;a.top=c;return a};Element._getContentFromAnonymousElement=function(f,d,g){var h=new Element("div"),c=Element._insertionTranslations.tags[f];var a=false;if(c){a=true}else{if(g){a=true;c=["","",0]}}if(a){h.innerHTML="&nbsp;"+c[0]+d+c[1];h.removeChild(h.firstChild);for(var b=c[2];b--;){h=h.firstChild}}else{h.innerHTML=d}return $A(h.childNodes)};Element._insertionTranslations={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};(function(){var a=Element._insertionTranslations.tags;Object.extend(a,{THEAD:a.TBODY,TFOOT:a.TBODY,TH:a.TD})})();Element.Methods.Simulated={hasAttribute:function(a,c){c=Element._attributeTranslations.has[c]||c;var b=$(a).getAttributeNode(c);return !!(b&&b.specified)}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);(function(a){if(!Prototype.BrowserFeatures.ElementExtensions&&a.__proto__){window.HTMLElement={};window.HTMLElement.prototype=a.__proto__;Prototype.BrowserFeatures.ElementExtensions=true}a=null})(document.createElement("div"));Element.extend=(function(){function c(h){if(typeof window.Element!="undefined"){var l=window.Element.prototype;if(l){var o="_"+(Math.random()+"").slice(2),k=document.createElement(h);l[o]="x";var m=(k[o]!=="x");delete l[o];k=null;return m}}return false}function b(k,h){for(var m in h){var l=h[m];if(Object.isFunction(l)&&!(m in k)){k[m]=l.methodize()}}}var d=c("object");if(Prototype.BrowserFeatures.SpecificElementExtensions){if(d){return function(k){if(k&&typeof k._extendedByPrototype=="undefined"){var h=k.tagName;if(h&&(/^(?:object|applet|embed)$/i.test(h))){b(k,Element.Methods);b(k,Element.Methods.Simulated);b(k,Element.Methods.ByTag[h.toUpperCase()])}}return k}}return Prototype.K}var a={},f=Element.Methods.ByTag;var g=Object.extend(function(l){if(!l||typeof l._extendedByPrototype!="undefined"||l.nodeType!=1||l==window){return l}var h=Object.clone(a),k=l.tagName.toUpperCase();if(f[k]){Object.extend(h,f[k])}b(l,h);l._extendedByPrototype=Prototype.emptyFunction;return l},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(a,Element.Methods);Object.extend(a,Element.Methods.Simulated)}}});g.refresh();return g})();if(document.documentElement.hasAttribute){Element.hasAttribute=function(a,b){return a.hasAttribute(b)}}else{Element.hasAttribute=Element.Methods.Simulated.hasAttribute}Element.addMethods=function(c){var l=Prototype.BrowserFeatures,d=Element.Methods.ByTag;if(!c){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods),BUTTON:Object.clone(Form.Element.Methods)})}if(arguments.length==2){var b=c;c=arguments[1]}if(!b){Object.extend(Element.Methods,c||{})}else{if(Object.isArray(b)){b.each(h)}else{h(b)}}function h(o){o=o.toUpperCase();if(!Element.Methods.ByTag[o]){Element.Methods.ByTag[o]={}}Object.extend(Element.Methods.ByTag[o],c)}function a(r,q,o){o=o||false;for(var t in r){var s=r[t];if(!Object.isFunction(s)){continue}if(!o||!(t in q)){q[t]=s.methodize()}}}function f(s){var o;var r={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(r[s]){o="HTML"+r[s]+"Element"}if(window[o]){return window[o]}o="HTML"+s+"Element";if(window[o]){return window[o]}o="HTML"+s.capitalize()+"Element";if(window[o]){return window[o]}var q=document.createElement(s),t=q.__proto__||q.constructor.prototype;q=null;return t}var k=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(l.ElementExtensions){a(Element.Methods,k);a(Element.Methods.Simulated,k,true)}if(l.SpecificElementExtensions){for(var m in Element.Methods.ByTag){var g=f(m);if(Object.isUndefined(g)){continue}a(d[m],g.prototype)}}Object.extend(Element,Element.Methods);delete Element.ByTag;if(Element.extend.refresh){Element.extend.refresh()}Element.cache={}};document.viewport={getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)}};(function(b){var h=Prototype.Browser,f=document,c,d={};function a(){if(h.WebKit&&!f.evaluate){return document}if(h.Opera&&window.parseFloat(window.opera.version())<9.5){return document.body}return document.documentElement}function g(k){if(!c){c=a()}d[k]="client"+k;b["get"+k]=function(){return c[d[k]]};return b["get"+k]()}b.getWidth=g.curry("Width");b.getHeight=g.curry("Height")})(document.viewport);Element.Storage={UID:1};Element.addMethods({getStorage:function(b){if(!(b=$(b))){return}var a;if(b===window){a=0}else{if(typeof b._prototypeUID==="undefined"){b._prototypeUID=Element.Storage.UID++}a=b._prototypeUID}if(!Element.Storage[a]){Element.Storage[a]=$H()}return Element.Storage[a]},store:function(b,a,c){if(!(b=$(b))){return}if(arguments.length===2){Element.getStorage(b).update(a)}else{Element.getStorage(b).set(a,c)}return b},retrieve:function(c,b,a){if(!(c=$(c))){return}var f=Element.getStorage(c),d=f.get(b);if(Object.isUndefined(d)){f.set(b,a);d=a}return d},clone:function(c,a){if(!(c=$(c))){return}var f=c.cloneNode(a);f._prototypeUID=void 0;if(a){var d=Element.select(f,"*"),b=d.length;while(b--){d[b]._prototypeUID=void 0}}return Element.extend(f)},purge:function(c){if(!(c=$(c))){return}var a=Element._purgeElement;a(c);var d=c.getElementsByTagName("*"),b=d.length;while(b--){a(d[b])}return null}});(function(){function k(A){var z=A.match(/^(\d+)%?$/i);if(!z){return null}return(Number(z[1])/100)}function t(K,L,A){var D=null;if(Object.isElement(K)){D=K;K=D.getStyle(L)}if(K===null){return null}if((/^(?:-)?\d+(\.\d+)?(px)?$/i).test(K)){return window.parseFloat(K)}var F=K.include("%"),B=(A===document.viewport);if(/\d/.test(K)&&D&&D.runtimeStyle&&!(F&&B)){var z=D.style.left,J=D.runtimeStyle.left;D.runtimeStyle.left=D.currentStyle.left;D.style.left=K||0;K=D.style.pixelLeft;D.style.left=z;D.runtimeStyle.left=J;return K}if(D&&F){A=A||D.parentNode;var C=k(K);var G=null;var E=D.getStyle("position");var I=L.include("left")||L.include("right")||L.include("width");var H=L.include("top")||L.include("bottom")||L.include("height");if(A===document.viewport){if(I){G=document.viewport.getWidth()}else{if(H){G=document.viewport.getHeight()}}}else{if(I){G=$(A).measure("width")}else{if(H){G=$(A).measure("height")}}}return(G===null)?0:G*C}return 0}function h(z){if(Object.isString(z)&&z.endsWith("px")){return z}return z+"px"}function m(A){var z=A;while(A&&A.parentNode){var B=A.getStyle("display");if(B==="none"){return false}A=$(A.parentNode)}return true}var d=Prototype.K;if("currentStyle" in document.documentElement){d=function(z){if(!z.currentStyle.hasLayout){z.style.zoom=1}return z}}function g(z){if(z.include("border")){z=z+"-width"}return z.camelize()}Element.Layout=Class.create(Hash,{initialize:function($super,A,z){$super();this.element=$(A);Element.Layout.PROPERTIES.each(function(B){this._set(B,null)},this);if(z){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(A,z){return Hash.prototype.set.call(this,A,z)},set:function(A,z){throw"Properties of Element.Layout are read-only."},get:function($super,A){var z=$super(A);return z===null?this._compute(A):z},_begin:function(){if(this._prepared){return}var D=this.element;if(m(D)){this._prepared=true;return}var F={position:D.style.position||"",width:D.style.width||"",visibility:D.style.visibility||"",display:D.style.display||""};D.store("prototype_original_styles",F);var G=D.getStyle("position"),z=D.getStyle("width");if(z==="0px"||z===null){D.style.display="block";z=D.getStyle("width")}var A=(G==="fixed")?document.viewport:D.parentNode;D.setStyle({position:"absolute",visibility:"hidden",display:"block"});var B=D.getStyle("width");var C;if(z&&(B===z)){C=t(D,"width",A)}else{if(G==="absolute"||G==="fixed"){C=t(D,"width",A)}else{var H=D.parentNode,E=$(H).getLayout();C=E.get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right")}}D.setStyle({width:C+"px"});this._prepared=true},_end:function(){var A=this.element;var z=A.retrieve("prototype_original_styles");A.store("prototype_original_styles",null);A.setStyle(z);this._prepared=false},_compute:function(A){var z=Element.Layout.COMPUTATIONS;if(!(A in z)){throw"Property not found."}return this._set(A,z[A].call(this,this.element))},toObject:function(){var z=$A(arguments);var A=(z.length===0)?Element.Layout.PROPERTIES:z.join(" ").split(" ");var B={};A.each(function(C){if(!Element.Layout.PROPERTIES.include(C)){return}var D=this.get(C);if(D!=null){B[C]=D}},this);return B},toHash:function(){var z=this.toObject.apply(this,arguments);return new Hash(z)},toCSS:function(){var z=$A(arguments);var B=(z.length===0)?Element.Layout.PROPERTIES:z.join(" ").split(" ");var A={};B.each(function(C){if(!Element.Layout.PROPERTIES.include(C)){return}if(Element.Layout.COMPOSITE_PROPERTIES.include(C)){return}var D=this.get(C);if(D!=null){A[g(C)]=D+"px"}},this);return A},inspect:function(){return"#<Element.Layout>"}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(B){if(!this._preComputing){this._begin()}var z=this.get("border-box-height");if(z<=0){if(!this._preComputing){this._end()}return 0}var C=this.get("border-top"),A=this.get("border-bottom");var E=this.get("padding-top"),D=this.get("padding-bottom");if(!this._preComputing){this._end()}return z-C-A-E-D},width:function(B){if(!this._preComputing){this._begin()}var A=this.get("border-box-width");if(A<=0){if(!this._preComputing){this._end()}return 0}var E=this.get("border-left"),z=this.get("border-right");var C=this.get("padding-left"),D=this.get("padding-right");if(!this._preComputing){this._end()}return A-E-z-C-D},"padding-box-height":function(A){var z=this.get("height"),C=this.get("padding-top"),B=this.get("padding-bottom");return z+C+B},"padding-box-width":function(z){var A=this.get("width"),B=this.get("padding-left"),C=this.get("padding-right");return A+B+C},"border-box-height":function(A){if(!this._preComputing){this._begin()}var z=A.offsetHeight;if(!this._preComputing){this._end()}return z},"border-box-width":function(z){if(!this._preComputing){this._begin()}var A=z.offsetWidth;if(!this._preComputing){this._end()}return A},"margin-box-height":function(A){var z=this.get("border-box-height"),B=this.get("margin-top"),C=this.get("margin-bottom");if(z<=0){return 0}return z+B+C},"margin-box-width":function(B){var A=this.get("border-box-width"),C=this.get("margin-left"),z=this.get("margin-right");if(A<=0){return 0}return A+C+z},top:function(z){var A=z.positionedOffset();return A.top},bottom:function(z){var C=z.positionedOffset(),A=z.getOffsetParent(),B=A.measure("height");var D=this.get("border-box-height");return B-D-C.top},left:function(z){var A=z.positionedOffset();return A.left},right:function(B){var D=B.positionedOffset(),C=B.getOffsetParent(),z=C.measure("width");var A=this.get("border-box-width");return z-A-D.left},"padding-top":function(z){return t(z,"paddingTop")},"padding-bottom":function(z){return t(z,"paddingBottom")},"padding-left":function(z){return t(z,"paddingLeft")},"padding-right":function(z){return t(z,"paddingRight")},"border-top":function(z){return t(z,"borderTopWidth")},"border-bottom":function(z){return t(z,"borderBottomWidth")},"border-left":function(z){return t(z,"borderLeftWidth")},"border-right":function(z){return t(z,"borderRightWidth")},"margin-top":function(z){return t(z,"marginTop")},"margin-bottom":function(z){return t(z,"marginBottom")},"margin-left":function(z){return t(z,"marginLeft")},"margin-right":function(z){return t(z,"marginRight")}}});if("getBoundingClientRect" in document.documentElement){Object.extend(Element.Layout.COMPUTATIONS,{right:function(A){var B=d(A.getOffsetParent());var C=A.getBoundingClientRect(),z=B.getBoundingClientRect();return(z.right-C.right).round()},bottom:function(A){var B=d(A.getOffsetParent());var C=A.getBoundingClientRect(),z=B.getBoundingClientRect();return(z.bottom-C.bottom).round()}})}Element.Offset=Class.create({initialize:function(A,z){this.left=A.round();this.top=z.round();this[0]=this.left;this[1]=this.top},relativeTo:function(z){return new Element.Offset(this.left-z.left,this.top-z.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}});function w(A,z){return new Element.Layout(A,z)}function b(z,A){return $(z).getLayout().get(A)}function s(A){A=$(A);var E=Element.getStyle(A,"display");if(E&&E!=="none"){return{width:A.offsetWidth,height:A.offsetHeight}}var B=A.style;var z={visibility:B.visibility,position:B.position,display:B.display};var D={visibility:"hidden",display:"block"};if(z.position!=="fixed"){D.position="absolute"}Element.setStyle(A,D);var C={width:A.offsetWidth,height:A.offsetHeight};Element.setStyle(A,z);return C}function q(z){z=$(z);if(f(z)||c(z)||r(z)||o(z)){return $(document.body)}var A=(Element.getStyle(z,"display")==="inline");if(!A&&z.offsetParent){return $(z.offsetParent)}while((z=z.parentNode)&&z!==document.body){if(Element.getStyle(z,"position")!=="static"){return o(z)?$(document.body):$(z)}}return $(document.body)}function y(A){A=$(A);var z=0,B=0;if(A.parentNode){do{z+=A.offsetTop||0;B+=A.offsetLeft||0;A=A.offsetParent}while(A)}return new Element.Offset(B,z)}function u(A){A=$(A);var B=A.getLayout();var z=0,D=0;do{z+=A.offsetTop||0;D+=A.offsetLeft||0;A=A.offsetParent;if(A){if(r(A)){break}var C=Element.getStyle(A,"position");if(C!=="static"){break}}}while(A);D-=B.get("margin-top");z-=B.get("margin-left");return new Element.Offset(D,z)}function a(A){var z=0,B=0;do{z+=A.scrollTop||0;B+=A.scrollLeft||0;A=A.parentNode}while(A);return new Element.Offset(B,z)}function x(D){A=$(A);var z=0,C=0,B=document.body;var A=D;do{z+=A.offsetTop||0;C+=A.offsetLeft||0;if(A.offsetParent==B&&Element.getStyle(A,"position")=="absolute"){break}}while(A=A.offsetParent);A=D;do{if(A!=B){z-=A.scrollTop||0;C-=A.scrollLeft||0}}while(A=A.parentNode);return new Element.Offset(C,z)}function v(z){z=$(z);if(Element.getStyle(z,"position")==="absolute"){return z}var D=q(z);var C=z.viewportOffset(),A=D.viewportOffset();var E=C.relativeTo(A);var B=z.getLayout();z.store("prototype_absolutize_original_styles",{left:z.getStyle("left"),top:z.getStyle("top"),width:z.getStyle("width"),height:z.getStyle("height")});z.setStyle({position:"absolute",top:E.top+"px",left:E.left+"px",width:B.get("width")+"px",height:B.get("height")+"px"});return z}function l(A){A=$(A);if(Element.getStyle(A,"position")==="relative"){return A}var z=A.retrieve("prototype_absolutize_original_styles");if(z){A.setStyle(z)}return A}if(Prototype.Browser.IE){q=q.wrap(function(B,A){A=$(A);if(f(A)||c(A)||r(A)||o(A)){return $(document.body)}var z=A.getStyle("position");if(z!=="static"){return B(A)}A.setStyle({position:"relative"});var C=B(A);A.setStyle({position:z});return C});u=u.wrap(function(C,A){A=$(A);if(!A.parentNode){return new Element.Offset(0,0)}var z=A.getStyle("position");if(z!=="static"){return C(A)}var B=A.getOffsetParent();if(B&&B.getStyle("position")==="fixed"){d(B)}A.setStyle({position:"relative"});var D=C(A);A.setStyle({position:z});return D})}else{if(Prototype.Browser.Webkit){y=function(A){A=$(A);var z=0,B=0;do{z+=A.offsetTop||0;B+=A.offsetLeft||0;if(A.offsetParent==document.body){if(Element.getStyle(A,"position")=="absolute"){break}}A=A.offsetParent}while(A);return new Element.Offset(B,z)}}}Element.addMethods({getLayout:w,measure:b,getDimensions:s,getOffsetParent:q,cumulativeOffset:y,positionedOffset:u,cumulativeScrollOffset:a,viewportOffset:x,absolutize:v,relativize:l});function r(z){return z.nodeName.toUpperCase()==="BODY"}function o(z){return z.nodeName.toUpperCase()==="HTML"}function f(z){return z.nodeType===Node.DOCUMENT_NODE}function c(z){return z!==document.body&&!Element.descendantOf(z,document.body)}if("getBoundingClientRect" in document.documentElement){Element.addMethods({viewportOffset:function(z){z=$(z);if(c(z)){return new Element.Offset(0,0)}var A=z.getBoundingClientRect(),B=document.documentElement;return new Element.Offset(A.left-B.clientLeft,A.top-B.clientTop)}})}})();window.$$=function(){var a=$A(arguments).join(", ");return Prototype.Selector.select(a,document)};Prototype.Selector=(function(){function a(){throw new Error('Method "Prototype.Selector.select" must be defined.')}function c(){throw new Error('Method "Prototype.Selector.match" must be defined.')}function d(o,q,k){k=k||0;var h=Prototype.Selector.match,m=o.length,g=0,l;for(l=0;l<m;l++){if(h(o[l],q)&&k==g++){return Element.extend(o[l])}}}function f(k){for(var g=0,h=k.length;g<h;g++){Element.extend(k[g])}return k}var b=Prototype.K;return{select:a,match:c,find:d,extendElements:(Element.extend===b)?b:f,extendElement:Element.extend}})();Prototype._original_property=window.Sizzle;
/*
 * Sizzle CSS Selector Engine - v1.0
 *  Copyright 2009, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var u=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^[\]]*\]|['"][^'"]*['"]|[^[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,l=0,d=Object.prototype.toString,s=false,k=true;[0,0].sort(function(){k=false;return 0});var b=function(J,z,G,B){G=G||[];var w=z=z||document;if(z.nodeType!==1&&z.nodeType!==9){return[]}if(!J||typeof J!=="string"){return G}var H=[],I,E,N,M,F,y,x=true,C=t(z),L=J;while((u.exec(""),I=u.exec(L))!==null){L=I[3];H.push(I[1]);if(I[2]){y=I[3];break}}if(H.length>1&&m.exec(J)){if(H.length===2&&f.relative[H[0]]){E=g(H[0]+H[1],z)}else{E=f.relative[H[0]]?[z]:b(H.shift(),z);while(H.length){J=H.shift();if(f.relative[J]){J+=H.shift()}E=g(J,E)}}}else{if(!B&&H.length>1&&z.nodeType===9&&!C&&f.match.ID.test(H[0])&&!f.match.ID.test(H[H.length-1])){var O=b.find(H.shift(),z,C);z=O.expr?b.filter(O.expr,O.set)[0]:O.set[0]}if(z){var O=B?{expr:H.pop(),set:a(B)}:b.find(H.pop(),H.length===1&&(H[0]==="~"||H[0]==="+")&&z.parentNode?z.parentNode:z,C);E=O.expr?b.filter(O.expr,O.set):O.set;if(H.length>0){N=a(E)}else{x=false}while(H.length){var A=H.pop(),D=A;if(!f.relative[A]){A=""}else{D=H.pop()}if(D==null){D=z}f.relative[A](N,D,C)}}else{N=H=[]}}if(!N){N=E}if(!N){throw"Syntax error, unrecognized expression: "+(A||J)}if(d.call(N)==="[object Array]"){if(!x){G.push.apply(G,N)}else{if(z&&z.nodeType===1){for(var K=0;N[K]!=null;K++){if(N[K]&&(N[K]===true||N[K].nodeType===1&&h(z,N[K]))){G.push(E[K])}}}else{for(var K=0;N[K]!=null;K++){if(N[K]&&N[K].nodeType===1){G.push(E[K])}}}}}else{a(N,G)}if(y){b(y,w,G,B);b.uniqueSort(G)}return G};b.uniqueSort=function(x){if(c){s=k;x.sort(c);if(s){for(var w=1;w<x.length;w++){if(x[w]===x[w-1]){x.splice(w--,1)}}}}return x};b.matches=function(w,x){return b(w,null,null,x)};b.find=function(D,w,E){var C,A;if(!D){return[]}for(var z=0,y=f.order.length;z<y;z++){var B=f.order[z],A;if((A=f.leftMatch[B].exec(D))){var x=A[1];A.splice(1,1);if(x.substr(x.length-1)!=="\\"){A[1]=(A[1]||"").replace(/\\/g,"");C=f.find[B](A,w,E);if(C!=null){D=D.replace(f.match[B],"");break}}}}if(!C){C=w.getElementsByTagName("*")}return{set:C,expr:D}};b.filter=function(G,F,J,z){var y=G,L=[],D=F,B,w,C=F&&F[0]&&t(F[0]);while(G&&F.length){for(var E in f.filter){if((B=f.match[E].exec(G))!=null){var x=f.filter[E],K,I;w=false;if(D==L){L=[]}if(f.preFilter[E]){B=f.preFilter[E](B,D,J,L,z,C);if(!B){w=K=true}else{if(B===true){continue}}}if(B){for(var A=0;(I=D[A])!=null;A++){if(I){K=x(I,B,A,D);var H=z^!!K;if(J&&K!=null){if(H){w=true}else{D[A]=false}}else{if(H){L.push(I);w=true}}}}}if(K!==undefined){if(!J){D=L}G=G.replace(f.match[E],"");if(!w){return[]}break}}}if(G==y){if(w==null){throw"Syntax error, unrecognized expression: "+G}else{break}}y=G}return D};var f=b.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF-]|\\.)+)(?:\((['"]*)((?:\([^\)]+\)|[^\2\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(w){return w.getAttribute("href")}},relative:{"+":function(D,w,C){var A=typeof w==="string",E=A&&!/\W/.test(w),B=A&&!E;if(E&&!C){w=w.toUpperCase()}for(var z=0,y=D.length,x;z<y;z++){if((x=D[z])){while((x=x.previousSibling)&&x.nodeType!==1){}D[z]=B||x&&x.nodeName===w?x||false:x===w}}if(B){b.filter(w,D,true)}},">":function(C,x,D){var A=typeof x==="string";if(A&&!/\W/.test(x)){x=D?x:x.toUpperCase();for(var y=0,w=C.length;y<w;y++){var B=C[y];if(B){var z=B.parentNode;C[y]=z.nodeName===x?z:false}}}else{for(var y=0,w=C.length;y<w;y++){var B=C[y];if(B){C[y]=A?B.parentNode:B.parentNode===x}}if(A){b.filter(x,C,true)}}},"":function(z,x,B){var y=l++,w=v;if(!/\W/.test(x)){var A=x=B?x:x.toUpperCase();w=r}w("parentNode",x,y,z,A,B)},"~":function(z,x,B){var y=l++,w=v;if(typeof x==="string"&&!/\W/.test(x)){var A=x=B?x:x.toUpperCase();w=r}w("previousSibling",x,y,z,A,B)}},find:{ID:function(x,y,z){if(typeof y.getElementById!=="undefined"&&!z){var w=y.getElementById(x[1]);return w?[w]:[]}},NAME:function(y,B,C){if(typeof B.getElementsByName!=="undefined"){var x=[],A=B.getElementsByName(y[1]);for(var z=0,w=A.length;z<w;z++){if(A[z].getAttribute("name")===y[1]){x.push(A[z])}}return x.length===0?null:x}},TAG:function(w,x){return x.getElementsByTagName(w[1])}},preFilter:{CLASS:function(z,x,y,w,C,D){z=" "+z[1].replace(/\\/g,"")+" ";if(D){return z}for(var A=0,B;(B=x[A])!=null;A++){if(B){if(C^(B.className&&(" "+B.className+" ").indexOf(z)>=0)){if(!y){w.push(B)}}else{if(y){x[A]=false}}}}return false},ID:function(w){return w[1].replace(/\\/g,"")},TAG:function(x,w){for(var y=0;w[y]===false;y++){}return w[y]&&t(w[y])?x[1]:x[1].toUpperCase()},CHILD:function(w){if(w[1]=="nth"){var x=/(-?)(\d*)n((?:\+|-)?\d*)/.exec(w[2]=="even"&&"2n"||w[2]=="odd"&&"2n+1"||!/\D/.test(w[2])&&"0n+"+w[2]||w[2]);w[2]=(x[1]+(x[2]||1))-0;w[3]=x[3]-0}w[0]=l++;return w},ATTR:function(A,x,y,w,B,C){var z=A[1].replace(/\\/g,"");if(!C&&f.attrMap[z]){A[1]=f.attrMap[z]}if(A[2]==="~="){A[4]=" "+A[4]+" "}return A},PSEUDO:function(A,x,y,w,B){if(A[1]==="not"){if((u.exec(A[3])||"").length>1||/^\w/.test(A[3])){A[3]=b(A[3],null,null,x)}else{var z=b.filter(A[3],x,y,true^B);if(!y){w.push.apply(w,z)}return false}}else{if(f.match.POS.test(A[0])||f.match.CHILD.test(A[0])){return true}}return A},POS:function(w){w.unshift(true);return w}},filters:{enabled:function(w){return w.disabled===false&&w.type!=="hidden"},disabled:function(w){return w.disabled===true},checked:function(w){return w.checked===true},selected:function(w){w.parentNode.selectedIndex;return w.selected===true},parent:function(w){return !!w.firstChild},empty:function(w){return !w.firstChild},has:function(y,x,w){return !!b(w[3],y).length},header:function(w){return/h\d/i.test(w.nodeName)},text:function(w){return"text"===w.type},radio:function(w){return"radio"===w.type},checkbox:function(w){return"checkbox"===w.type},file:function(w){return"file"===w.type},password:function(w){return"password"===w.type},submit:function(w){return"submit"===w.type},image:function(w){return"image"===w.type},reset:function(w){return"reset"===w.type},button:function(w){return"button"===w.type||w.nodeName.toUpperCase()==="BUTTON"},input:function(w){return/input|select|textarea|button/i.test(w.nodeName)}},setFilters:{first:function(x,w){return w===0},last:function(y,x,w,z){return x===z.length-1},even:function(x,w){return w%2===0},odd:function(x,w){return w%2===1},lt:function(y,x,w){return x<w[3]-0},gt:function(y,x,w){return x>w[3]-0},nth:function(y,x,w){return w[3]-0==x},eq:function(y,x,w){return w[3]-0==x}},filter:{PSEUDO:function(C,y,z,D){var x=y[1],A=f.filters[x];if(A){return A(C,z,y,D)}else{if(x==="contains"){return(C.textContent||C.innerText||"").indexOf(y[3])>=0}else{if(x==="not"){var B=y[3];for(var z=0,w=B.length;z<w;z++){if(B[z]===C){return false}}return true}}}},CHILD:function(w,z){var C=z[1],x=w;switch(C){case"only":case"first":while((x=x.previousSibling)){if(x.nodeType===1){return false}}if(C=="first"){return true}x=w;case"last":while((x=x.nextSibling)){if(x.nodeType===1){return false}}return true;case"nth":var y=z[2],F=z[3];if(y==1&&F==0){return true}var B=z[0],E=w.parentNode;if(E&&(E.sizcache!==B||!w.nodeIndex)){var A=0;for(x=E.firstChild;x;x=x.nextSibling){if(x.nodeType===1){x.nodeIndex=++A}}E.sizcache=B}var D=w.nodeIndex-F;if(y==0){return D==0}else{return(D%y==0&&D/y>=0)}}},ID:function(x,w){return x.nodeType===1&&x.getAttribute("id")===w},TAG:function(x,w){return(w==="*"&&x.nodeType===1)||x.nodeName===w},CLASS:function(x,w){return(" "+(x.className||x.getAttribute("class"))+" ").indexOf(w)>-1},ATTR:function(B,z){var y=z[1],w=f.attrHandle[y]?f.attrHandle[y](B):B[y]!=null?B[y]:B.getAttribute(y),C=w+"",A=z[2],x=z[4];return w==null?A==="!=":A==="="?C===x:A==="*="?C.indexOf(x)>=0:A==="~="?(" "+C+" ").indexOf(x)>=0:!x?C&&w!==false:A==="!="?C!=x:A==="^="?C.indexOf(x)===0:A==="$="?C.substr(C.length-x.length)===x:A==="|="?C===x||C.substr(0,x.length+1)===x+"-":false},POS:function(A,x,y,B){var w=x[2],z=f.setFilters[w];if(z){return z(A,y,x,B)}}}};var m=f.match.POS;for(var q in f.match){f.match[q]=new RegExp(f.match[q].source+/(?![^\[]*\])(?![^\(]*\))/.source);f.leftMatch[q]=new RegExp(/(^(?:.|\r|\n)*?)/.source+f.match[q].source)}var a=function(x,w){x=Array.prototype.slice.call(x,0);if(w){w.push.apply(w,x);return w}return x};try{Array.prototype.slice.call(document.documentElement.childNodes,0)}catch(o){a=function(A,z){var x=z||[];if(d.call(A)==="[object Array]"){Array.prototype.push.apply(x,A)}else{if(typeof A.length==="number"){for(var y=0,w=A.length;y<w;y++){x.push(A[y])}}else{for(var y=0;A[y];y++){x.push(A[y])}}}return x}}var c;if(document.documentElement.compareDocumentPosition){c=function(x,w){if(!x.compareDocumentPosition||!w.compareDocumentPosition){if(x==w){s=true}return 0}var y=x.compareDocumentPosition(w)&4?-1:x===w?0:1;if(y===0){s=true}return y}}else{if("sourceIndex" in document.documentElement){c=function(x,w){if(!x.sourceIndex||!w.sourceIndex){if(x==w){s=true}return 0}var y=x.sourceIndex-w.sourceIndex;if(y===0){s=true}return y}}else{if(document.createRange){c=function(z,x){if(!z.ownerDocument||!x.ownerDocument){if(z==x){s=true}return 0}var y=z.ownerDocument.createRange(),w=x.ownerDocument.createRange();y.setStart(z,0);y.setEnd(z,0);w.setStart(x,0);w.setEnd(x,0);var A=y.compareBoundaryPoints(Range.START_TO_END,w);if(A===0){s=true}return A}}}}(function(){var x=document.createElement("div"),y="script"+(new Date).getTime();x.innerHTML="<a name='"+y+"'/>";var w=document.documentElement;w.insertBefore(x,w.firstChild);if(!!document.getElementById(y)){f.find.ID=function(A,B,C){if(typeof B.getElementById!=="undefined"&&!C){var z=B.getElementById(A[1]);return z?z.id===A[1]||typeof z.getAttributeNode!=="undefined"&&z.getAttributeNode("id").nodeValue===A[1]?[z]:undefined:[]}};f.filter.ID=function(B,z){var A=typeof B.getAttributeNode!=="undefined"&&B.getAttributeNode("id");return B.nodeType===1&&A&&A.nodeValue===z}}w.removeChild(x);w=x=null})();(function(){var w=document.createElement("div");w.appendChild(document.createComment(""));if(w.getElementsByTagName("*").length>0){f.find.TAG=function(x,B){var A=B.getElementsByTagName(x[1]);if(x[1]==="*"){var z=[];for(var y=0;A[y];y++){if(A[y].nodeType===1){z.push(A[y])}}A=z}return A}}w.innerHTML="<a href='#'></a>";if(w.firstChild&&typeof w.firstChild.getAttribute!=="undefined"&&w.firstChild.getAttribute("href")!=="#"){f.attrHandle.href=function(x){return x.getAttribute("href",2)}}w=null})();if(document.querySelectorAll){(function(){var w=b,y=document.createElement("div");y.innerHTML="<p class='TEST'></p>";if(y.querySelectorAll&&y.querySelectorAll(".TEST").length===0){return}b=function(C,B,z,A){B=B||document;if(!A&&B.nodeType===9&&!t(B)){try{return a(B.querySelectorAll(C),z)}catch(D){}}return w(C,B,z,A)};for(var x in w){b[x]=w[x]}y=null})()}if(document.getElementsByClassName&&document.documentElement.getElementsByClassName){(function(){var w=document.createElement("div");w.innerHTML="<div class='test e'></div><div class='test'></div>";if(w.getElementsByClassName("e").length===0){return}w.lastChild.className="e";if(w.getElementsByClassName("e").length===1){return}f.order.splice(1,0,"CLASS");f.find.CLASS=function(x,y,z){if(typeof y.getElementsByClassName!=="undefined"&&!z){return y.getElementsByClassName(x[1])}};w=null})()}function r(x,C,B,G,D,F){var E=x=="previousSibling"&&!F;for(var z=0,y=G.length;z<y;z++){var w=G[z];if(w){if(E&&w.nodeType===1){w.sizcache=B;w.sizset=z}w=w[x];var A=false;while(w){if(w.sizcache===B){A=G[w.sizset];break}if(w.nodeType===1&&!F){w.sizcache=B;w.sizset=z}if(w.nodeName===C){A=w;break}w=w[x]}G[z]=A}}}function v(x,C,B,G,D,F){var E=x=="previousSibling"&&!F;for(var z=0,y=G.length;z<y;z++){var w=G[z];if(w){if(E&&w.nodeType===1){w.sizcache=B;w.sizset=z}w=w[x];var A=false;while(w){if(w.sizcache===B){A=G[w.sizset];break}if(w.nodeType===1){if(!F){w.sizcache=B;w.sizset=z}if(typeof C!=="string"){if(w===C){A=true;break}}else{if(b.filter(C,[w]).length>0){A=w;break}}}w=w[x]}G[z]=A}}}var h=document.compareDocumentPosition?function(x,w){return x.compareDocumentPosition(w)&16}:function(x,w){return x!==w&&(x.contains?x.contains(w):true)};var t=function(w){return w.nodeType===9&&w.documentElement.nodeName!=="HTML"||!!w.ownerDocument&&w.ownerDocument.documentElement.nodeName!=="HTML"};var g=function(w,D){var z=[],A="",B,y=D.nodeType?[D]:D;while((B=f.match.PSEUDO.exec(w))){A+=B[0];w=w.replace(f.match.PSEUDO,"")}w=f.relative[w]?w+"*":w;for(var C=0,x=y.length;C<x;C++){b(w,y[C],z)}return b.filter(A,z)};window.Sizzle=b})();(function(c){var d=Prototype.Selector.extendElements;function a(f,g){return d(c(f,g||document))}function b(g,f){return c.matches(f,[g]).length==1}Prototype.Selector.engine=c;Prototype.Selector.select=a;Prototype.Selector.match=b})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;var Form={reset:function(a){a=$(a);a.reset();return a},serializeElements:function(k,d){if(typeof d!="object"){d={hash:!!d}}else{if(Object.isUndefined(d.hash)){d.hash=true}}var f,h,a=false,g=d.submit,b,c;if(d.hash){c={};b=function(l,m,o){if(m in l){if(!Object.isArray(l[m])){l[m]=[l[m]]}l[m].push(o)}else{l[m]=o}return l}}else{c="";b=function(l,m,o){return l+(l?"&":"")+encodeURIComponent(m)+"="+encodeURIComponent(o)}}return k.inject(c,function(l,m){if(!m.disabled&&m.name){f=m.name;h=$(m).getValue();if(h!=null&&m.type!="file"&&(m.type!="submit"||(!a&&g!==false&&(!g||f==g)&&(a=true)))){l=b(l,f,h)}}return l})}};Form.Methods={serialize:function(b,a){return Form.serializeElements(Form.getElements(b),a)},getElements:function(f){var g=$(f).getElementsByTagName("*"),d,a=[],c=Form.Element.Serializers;for(var b=0;d=g[b];b++){a.push(d)}return a.inject([],function(h,k){if(c[k.tagName.toLowerCase()]){h.push(Element.extend(k))}return h})},getInputs:function(h,c,d){h=$(h);var a=h.getElementsByTagName("input");if(!c&&!d){return $A(a).map(Element.extend)}for(var f=0,k=[],g=a.length;f<g;f++){var b=a[f];if((c&&b.type!=c)||(d&&b.name!=d)){continue}k.push(Element.extend(b))}return k},disable:function(a){a=$(a);Form.getElements(a).invoke("disable");return a},enable:function(a){a=$(a);Form.getElements(a).invoke("enable");return a},findFirstElement:function(b){var c=$(b).getElements().findAll(function(d){return"hidden"!=d.type&&!d.disabled});var a=c.findAll(function(d){return d.hasAttribute("tabIndex")&&d.tabIndex>=0}).sortBy(function(d){return d.tabIndex}).first();return a?a:c.find(function(d){return/^(?:input|select|textarea)$/i.test(d.tagName)})},focusFirstElement:function(b){b=$(b);var a=b.findFirstElement();if(a){a.activate()}return b},request:function(b,a){b=$(b),a=Object.clone(a||{});var d=a.parameters,c=b.readAttribute("action")||"";if(c.blank()){c=window.location.href}a.parameters=b.serialize(true);if(d){if(Object.isString(d)){d=d.toQueryParams()}Object.extend(a.parameters,d)}if(b.hasAttribute("method")&&!a.method){a.method=b.method}return new Ajax.Request(c,a)}};Form.Element={focus:function(a){$(a).focus();return a},select:function(a){$(a).select();return a}};Form.Element.Methods={serialize:function(a){a=$(a);if(!a.disabled&&a.name){var b=a.getValue();if(b!=undefined){var c={};c[a.name]=b;return Object.toQueryString(c)}}return""},getValue:function(a){a=$(a);var b=a.tagName.toLowerCase();return Form.Element.Serializers[b](a)},setValue:function(a,b){a=$(a);var c=a.tagName.toLowerCase();Form.Element.Serializers[c](a,b);return a},clear:function(a){$(a).value="";return a},present:function(a){return $(a).value!=""},activate:function(a){a=$(a);try{a.focus();if(a.select&&(a.tagName.toLowerCase()!="input"||!(/^(?:button|reset|submit)$/i.test(a.type)))){a.select()}}catch(b){}return a},disable:function(a){a=$(a);a.disabled=true;return a},enable:function(a){a=$(a);a.disabled=false;return a}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers=(function(){function b(k,l){switch(k.type.toLowerCase()){case"checkbox":case"radio":return g(k,l);default:return f(k,l)}}function g(k,l){if(Object.isUndefined(l)){return k.checked?k.value:null}else{k.checked=!!l}}function f(k,l){if(Object.isUndefined(l)){return k.value}else{k.value=l}}function a(m,r){if(Object.isUndefined(r)){return(m.type==="select-one"?c:d)(m)}var l,o,s=!Object.isArray(r);for(var k=0,q=m.length;k<q;k++){l=m.options[k];o=this.optionValue(l);if(s){if(o==r){l.selected=true;return}}else{l.selected=r.include(o)}}}function c(l){var k=l.selectedIndex;return k>=0?h(l.options[k]):null}function d(o){var k,q=o.length;if(!q){return null}for(var m=0,k=[];m<q;m++){var l=o.options[m];if(l.selected){k.push(h(l))}}return k}function h(k){return Element.hasAttribute(k,"value")?k.value:k.text}return{input:b,inputSelector:g,textarea:f,select:a,selectOne:c,selectMany:d,optionValue:h,button:f}})();Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,a,b,c){$super(c,b);this.element=$(a);this.lastValue=this.getValue()},execute:function(){var a=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(a)?this.lastValue!=a:String(this.lastValue)!=String(a)){this.callback(this.element,a);this.lastValue=a}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});Abstract.EventObserver=Class.create({initialize:function(a,b){this.element=$(a);this.callback=b;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks()}else{this.registerCallback(this.element)}},onElementEvent:function(){var a=this.getValue();if(this.lastValue!=a){this.callback(this.element,a);this.lastValue=a}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(a){if(a.type){switch(a.type.toLowerCase()){case"checkbox":case"radio":Event.observe(a,"click",this.onElementEvent.bind(this));break;default:Event.observe(a,"change",this.onElementEvent.bind(this));break}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});(function(){var H={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{}};var g=document.documentElement;var I="onmouseenter" in g&&"onmouseleave" in g;var a=function(J){return false};if(window.attachEvent){if(window.addEventListener){a=function(J){return !(J instanceof window.Event)}}else{a=function(J){return true}}}var w;function F(K,J){return K.which?(K.which===J+1):(K.button===J)}var t={0:1,1:4,2:2};function D(K,J){return K.button===t[J]}function G(K,J){switch(J){case 0:return K.which==1&&!K.metaKey;case 1:return K.which==2||(K.which==1&&K.metaKey);case 2:return K.which==3;default:return false}}if(window.attachEvent){if(!window.addEventListener){w=D}else{w=function(K,J){return a(K)?D(K,J):F(K,J)}}}else{if(Prototype.Browser.WebKit){w=G}else{w=F}}function A(J){return w(J,0)}function y(J){return w(J,1)}function s(J){return w(J,2)}function d(L){L=H.extend(L);var K=L.target,J=L.type,M=L.currentTarget;if(M&&M.tagName){if(J==="load"||J==="error"||(J==="click"&&M.tagName.toLowerCase()==="input"&&M.type==="radio")){K=M}}if(K.nodeType==Node.TEXT_NODE){K=K.parentNode}return Element.extend(K)}function u(K,L){var J=H.element(K);if(!L){return J}while(J){if(Object.isElement(J)&&Prototype.Selector.match(J,L)){return Element.extend(J)}J=J.parentNode}}function x(J){return{x:c(J),y:b(J)}}function c(L){var K=document.documentElement,J=document.body||{scrollLeft:0};return L.pageX||(L.clientX+(K.scrollLeft||J.scrollLeft)-(K.clientLeft||0))}function b(L){var K=document.documentElement,J=document.body||{scrollTop:0};return L.pageY||(L.clientY+(K.scrollTop||J.scrollTop)-(K.clientTop||0))}function v(J){H.extend(J);J.preventDefault();J.stopPropagation();J.stopped=true}H.Methods={isLeftClick:A,isMiddleClick:y,isRightClick:s,element:d,findElement:u,pointer:x,pointerX:c,pointerY:b,stop:v};var C=Object.keys(H.Methods).inject({},function(J,K){J[K]=H.Methods[K].methodize();return J});if(window.attachEvent){function l(K){var J;switch(K.type){case"mouseover":case"mouseenter":J=K.fromElement;break;case"mouseout":case"mouseleave":J=K.toElement;break;default:return null}return Element.extend(J)}var z={stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}};H.extend=function(K,J){if(!K){return false}if(!a(K)){return K}if(K._extendedByPrototype){return K}K._extendedByPrototype=Prototype.emptyFunction;var L=H.pointer(K);Object.extend(K,{target:K.srcElement||J,relatedTarget:l(K),pageX:L.x,pageY:L.y});Object.extend(K,C);Object.extend(K,z);return K}}else{H.extend=Prototype.K}if(window.addEventListener){H.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(H.prototype,C)}function r(N,M,O){var L=Element.retrieve(N,"prototype_event_registry");if(Object.isUndefined(L)){f.push(N);L=Element.retrieve(N,"prototype_event_registry",$H())}var J=L.get(M);if(Object.isUndefined(J)){J=[];L.set(M,J)}if(J.pluck("handler").include(O)){return false}var K;if(M.include(":")){K=function(P){if(Object.isUndefined(P.eventName)){return false}if(P.eventName!==M){return false}H.extend(P,N);O.call(N,P)}}else{if(!I&&(M==="mouseenter"||M==="mouseleave")){if(M==="mouseenter"||M==="mouseleave"){K=function(Q){H.extend(Q,N);var P=Q.relatedTarget;while(P&&P!==N){try{P=P.parentNode}catch(R){P=N}}if(P===N){return}O.call(N,Q)}}}else{K=function(P){H.extend(P,N);O.call(N,P)}}}K.handler=O;J.push(K);return K}function k(){for(var J=0,K=f.length;J<K;J++){H.stopObserving(f[J]);f[J]=null}}var f=[];if(Prototype.Browser.IE){window.attachEvent("onunload",k)}if(Prototype.Browser.WebKit){window.addEventListener("unload",Prototype.emptyFunction,false)}var q=Prototype.K,h={mouseenter:"mouseover",mouseleave:"mouseout"};if(!I){q=function(J){return(h[J]||J)}}function B(M,L,N){M=$(M);var K=r(M,L,N);if(!K){return M}if(L.include(":")){if(M.addEventListener){M.addEventListener("dataavailable",K,false)}else{M.attachEvent("ondataavailable",K);M.attachEvent("onlosecapture",K)}}else{var J=q(L);if(M.addEventListener){M.addEventListener(J,K,false)}else{M.attachEvent("on"+J,K)}}return M}function o(P,M,Q){P=$(P);var L=Element.retrieve(P,"prototype_event_registry");if(!L){return P}if(!M){L.each(function(S){var R=S.key;o(P,R)});return P}var N=L.get(M);if(!N){return P}if(!Q){N.each(function(R){o(P,M,R.handler)});return P}var O=N.length,K;while(O--){if(N[O].handler===Q){K=N[O];break}}if(!K){return P}if(M.include(":")){if(P.removeEventListener){P.removeEventListener("dataavailable",K,false)}else{P.detachEvent("ondataavailable",K);P.detachEvent("onlosecapture",K)}}else{var J=q(M);if(P.removeEventListener){P.removeEventListener(J,K,false)}else{P.detachEvent("on"+J,K)}}L.set(M,N.without(K));return P}function E(M,L,K,J){M=$(M);if(Object.isUndefined(J)){J=true}if(M==document&&document.createEvent&&!M.dispatchEvent){M=document.documentElement}var N;if(document.createEvent){N=document.createEvent("HTMLEvents");N.initEvent("dataavailable",J,true)}else{N=document.createEventObject();N.eventType=J?"ondataavailable":"onlosecapture"}N.eventName=L;N.memo=K||{};if(document.createEvent){M.dispatchEvent(N)}else{M.fireEvent(N.eventType,N)}return H.extend(N)}H.Handler=Class.create({initialize:function(L,K,J,M){this.element=$(L);this.eventName=K;this.selector=J;this.callback=M;this.handler=this.handleEvent.bind(this)},start:function(){H.observe(this.element,this.eventName,this.handler);return this},stop:function(){H.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(K){var J=H.findElement(K,this.selector);if(J){this.callback.call(this.element,K,J)}}});function m(L,K,J,M){L=$(L);if(Object.isFunction(J)&&Object.isUndefined(M)){M=J,J=null}return new H.Handler(L,K,J,M).start()}Object.extend(H,H.Methods);Object.extend(H,{fire:E,observe:B,stopObserving:o,on:m});Element.addMethods({fire:E,observe:B,stopObserving:o,on:m});Object.extend(document,{fire:E.methodize(),observe:B.methodize(),stopObserving:o.methodize(),on:m.methodize(),loaded:false});if(window.Event){Object.extend(window.Event,H)}else{window.Event=H}})();(function(){var d;function a(){if(document.loaded){return}if(d){window.clearTimeout(d)}document.loaded=true;document.fire("dom:loaded")}function c(){if(document.readyState==="complete"){document.stopObserving("readystatechange",c);a()}}function b(){try{document.documentElement.doScroll("left")}catch(f){d=b.defer();return}a()}if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false)}else{document.observe("readystatechange",c);if(window==top){d=b.defer()}}Event.observe(window,"load",a)})();Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(a,b){return Element.insert(a,{before:b})},Top:function(a,b){return Element.insert(a,{top:b})},Bottom:function(a,b){return Element.insert(a,{bottom:b})},After:function(a,b){return Element.insert(a,{after:b})}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(b,a,c){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(b,a,c)}this.xcomp=a;this.ycomp=c;this.offset=Element.cumulativeOffset(b);return(c>=this.offset[1]&&c<this.offset[1]+b.offsetHeight&&a>=this.offset[0]&&a<this.offset[0]+b.offsetWidth)},withinIncludingScrolloffsets:function(b,a,d){var c=Element.cumulativeScrollOffset(b);this.xcomp=a+c[0]-this.deltaX;this.ycomp=d+c[1]-this.deltaY;this.offset=Element.cumulativeOffset(b);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+b.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+b.offsetWidth)},overlap:function(b,a){if(!b){return 0}if(b=="vertical"){return((this.offset[1]+a.offsetHeight)-this.ycomp)/a.offsetHeight}if(b=="horizontal"){return((this.offset[0]+a.offsetWidth)-this.xcomp)/a.offsetWidth}},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(a){Position.prepare();return Element.absolutize(a)},relativize:function(a){Position.prepare();return Element.relativize(a)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(b,c,a){a=a||{};return Element.clonePosition(c,b,a)}};if(!document.getElementsByClassName){document.getElementsByClassName=function(b){function a(c){return c.blank()?null:"[contains(concat(' ', @class, ' '), ' "+c+" ')]"}b.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(c,f){f=f.toString().strip();var d=/\s/.test(f)?$w(f).map(a).join(""):a(f);return d?document._getElementsByXPath(".//*"+d,c):[]}:function(f,g){g=g.toString().strip();var h=[],k=(/\s/.test(g)?$w(g):null);if(!k&&!g){return h}var c=$(f).getElementsByTagName("*");g=" "+g+" ";for(var d=0,m,l;m=c[d];d++){if(m.className&&(l=" "+m.className+" ")&&(l.include(g)||(k&&k.all(function(o){return !o.toString().blank()&&l.include(" "+o+" ")})))){h.push(Element.extend(m))}}return h};return function(d,c){return $(c||document.body).getElementsByClassName(d)}}(Element.Methods)}Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(a){this.element=$(a)},_each:function(a){this.element.className.split(/\s+/).select(function(b){return b.length>0})._each(a)},set:function(a){this.element.className=a},add:function(a){if(this.include(a)){return}this.set($A(this).concat(a).join(" "))},remove:function(a){if(!this.include(a)){return}this.set($A(this).without(a).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);(function(){window.Selector=Class.create({initialize:function(a){this.expression=a.strip()},findElements:function(a){return Prototype.Selector.select(this.expression,a)},match:function(a){return Prototype.Selector.match(a,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(g,h){var a=Prototype.Selector.match,d=[];for(var c=0,f=g.length;c<f;c++){var b=g[c];if(a(b,h)){d.push(Element.extend(b))}}return d},findElement:function(g,h,b){b=b||0;var a=0,d;for(var c=0,f=g.length;c<f;c++){d=g[c];if(Prototype.Selector.match(d,h)&&b===a++){return Element.extend(d)}}},findChildElements:function(b,c){var a=c.toArray().join(", ");return Prototype.Selector.select(a,b||document)}})})();var Scriptaculous={Version:"1.8.1",require:function(a){document.write('<script type="text/javascript" src="'+a+'"><\/script>')},REQUIRED_PROTOTYPE:"1.6.0",load:function(){function a(b){var c=b.split(".");return parseInt(c[0])*100000+parseInt(c[1])*1000+parseInt(c[2])}if((typeof Prototype=="undefined")||(typeof Element=="undefined")||(typeof Element.Methods=="undefined")||(a(Prototype.Version)<a(Scriptaculous.REQUIRED_PROTOTYPE))){throw ("script.aculo.us requires the Prototype JavaScript framework >= "+Scriptaculous.REQUIRED_PROTOTYPE)}$A(document.getElementsByTagName("script")).findAll(function(b){return(b.src&&b.src.match(/scriptaculous\.js(\?.*)?$/))}).each(function(c){var d=c.src.replace(/scriptaculous\.js(\?.*)?$/,"");var b=c.src.match(/\?.*load=([a-z,]*)/);(b?b[1]:"builder,effects,dragdrop,controls,slider,sound").split(",").each(function(f){Scriptaculous.require(d+f+".js")})})}};String.prototype.parseColor=function(){var a="#";if(this.slice(0,4)=="rgb("){var c=this.slice(4,this.length-1).split(",");var b=0;do{a+=parseInt(c[b]).toColorPart()}while(++b<3)}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var b=1;b<4;b++){a+=(this.charAt(b)+this.charAt(b)).toLowerCase()}}if(this.length==7){a=this.toLowerCase()}}}return(a.length==7?a:(arguments[0]||this))};Element.collectTextNodes=function(a){return $A($(a).childNodes).collect(function(b){return(b.nodeType==3?b.nodeValue:(b.hasChildNodes()?Element.collectTextNodes(b):""))}).flatten().join("")};Element.collectTextNodesIgnoreClass=function(a,b){return $A($(a).childNodes).collect(function(c){return(c.nodeType==3?c.nodeValue:((c.hasChildNodes()&&!Element.hasClassName(c,b))?Element.collectTextNodesIgnoreClass(c,b):""))}).flatten().join("")};Element.setContentZoom=function(a,b){a=$(a);a.setStyle({fontSize:(b/100)+"em"});if(Prototype.Browser.WebKit){window.scrollBy(0,0)}return a};Element.getInlineOpacity=function(a){return $(a).style.opacity||""};Element.forceRerendering=function(a){try{a=$(a);var c=document.createTextNode(" ");a.appendChild(c);a.removeChild(c)}catch(b){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(a){return(-Math.cos(a*Math.PI)/2)+0.5},reverse:function(a){return 1-a},flicker:function(a){var a=((-Math.cos(a*Math.PI)/4)+0.75)+Math.random()/4;return a>1?1:a},wobble:function(a){return(-Math.cos(a*Math.PI*(9*a))/2)+0.5},pulse:function(b,a){a=a||5;return(((b%(1/a))*a).round()==0?((b*a*2)-(b*a*2).floor()):1-((b*a*2)-(b*a*2).floor()))},spring:function(a){return 1-(Math.cos(a*4.5*Math.PI)*Math.exp(-a*6))},none:function(a){return 0},full:function(a){return 1}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(a){var b="position:relative";if(Prototype.Browser.IE){b+=";zoom:1"}a=$(a);$A(a.childNodes).each(function(c){if(c.nodeType==3){c.nodeValue.toArray().each(function(d){a.insertBefore(new Element("span",{style:b}).update(d==" "?String.fromCharCode(160):d),c)});Element.remove(c)}})},multiple:function(b,c){var f;if(((typeof b=="object")||Object.isFunction(b))&&(b.length)){f=b}else{f=$(b).childNodes}var a=Object.extend({speed:0.1,delay:0},arguments[2]||{});var d=a.delay;$A(f).each(function(h,g){new c(h,Object.extend(a,{delay:g*a.speed+d}))})},PAIRS:{slide:["SlideDown","SlideUp"],blind:["BlindDown","BlindUp"],appear:["Appear","Fade"]},toggle:function(b,c){b=$(b);c=(c||"appear").toLowerCase();var a=Object.extend({queue:{position:"end",scope:(b.id||"global"),limit:1}},arguments[2]||{});Effect[b.visible()?Effect.PAIRS[c][1]:Effect.PAIRS[c][0]](b,a)}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null},_each:function(a){this.effects._each(a)},add:function(b){var c=new Date().getTime();var a=Object.isString(b.options.queue)?b.options.queue:b.options.queue.position;switch(a){case"front":this.effects.findAll(function(d){return d.state=="idle"}).each(function(d){d.startOn+=b.finishOn;d.finishOn+=b.finishOn});break;case"with-last":c=this.effects.pluck("startOn").max()||c;break;case"end":c=this.effects.pluck("finishOn").max()||c;break}b.startOn+=c;b.finishOn+=c;if(!b.options.queue.limit||(this.effects.length<b.options.queue.limit)){this.effects.push(b)}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15)}},remove:function(a){this.effects=this.effects.reject(function(b){return b==a});if(this.effects.length==0){clearInterval(this.interval);this.interval=null}},loop:function(){var c=new Date().getTime();for(var b=0,a=this.effects.length;b<a;b++){this.effects[b]&&this.effects[b].loop(c)}}});Effect.Queues={instances:$H(),get:function(a){if(!Object.isString(a)){return a}return this.instances.get(a)||this.instances.set(a,new Effect.ScopedQueue())}};Effect.Queue=Effect.Queues.get("global");Effect.Base=Class.create({position:null,start:function(options){function codeForEvent(options,eventName){return((options[eventName+"Internal"]?"this.options."+eventName+"Internal(this);":"")+(options[eventName]?"this.options."+eventName+"(this);":""))}if(options&&options.transition===false){options.transition=Effect.Transitions.linear}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),options||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;eval('this.render = function(pos){ if (this.state=="idle"){this.state="running";'+codeForEvent(this.options,"beforeSetup")+(this.setup?"this.setup();":"")+codeForEvent(this.options,"afterSetup")+'};if (this.state=="running"){pos=this.options.transition(pos)*'+this.fromToDelta+"+"+this.options.from+";this.position=pos;"+codeForEvent(this.options,"beforeUpdate")+(this.update?"this.update(pos);":"")+codeForEvent(this.options,"afterUpdate")+"}}");this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this)}},loop:function(c){if(c>=this.startOn){if(c>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish()}this.event("afterFinish");return}var b=(c-this.startOn)/this.totalTime,a=(b*this.totalFrames).round();if(a>this.currentFrame){this.render(b);this.currentFrame=a}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this)}this.state="finished"},event:function(a){if(this.options[a+"Internal"]){this.options[a+"Internal"](this)}if(this.options[a]){this.options[a](this)}},inspect:function(){var a=$H();for(property in this){if(!Object.isFunction(this[property])){a.set(property,this[property])}}return"#<Effect:"+a.inspect()+",options:"+$H(this.options).inspect()+">"}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(a){this.effects=a||[];this.start(arguments[1])},update:function(a){this.effects.invoke("render",a)},finish:function(a){this.effects.each(function(b){b.render(1);b.cancel();b.event("beforeFinish");if(b.finish){b.finish(a)}b.event("afterFinish")})}});Effect.Tween=Class.create(Effect.Base,{initialize:function(c,g,f){c=Object.isString(c)?$(c):c;var b=$A(arguments),d=b.last(),a=b.length==5?b[3]:null;this.method=Object.isFunction(d)?d.bind(c):Object.isFunction(c[d])?c[d].bind(c):function(h){c[d]=h};this.start(Object.extend({from:g,to:f},a||{}))},update:function(a){this.method(a)}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}))},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(b){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}var a=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(a)},update:function(a){this.element.setOpacity(a)}});Effect.Move=Class.create(Effect.Base,{initialize:function(b){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(a)},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop}},update:function(a){this.element.setStyle({left:(this.options.x*a+this.originalLeft).round()+"px",top:(this.options.y*a+this.originalTop).round()+"px"})}});Effect.MoveBy=function(b,a,c){return new Effect.Move(b,Object.extend({x:c,y:a},arguments[3]||{}))};Effect.Scale=Class.create(Effect.Base,{initialize:function(b,c){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:c},arguments[2]||{});this.start(a)},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(b){this.originalStyle[b]=this.element.style[b]}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var a=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(b){if(a.indexOf(b)>0){this.fontSize=parseFloat(a);this.fontSizeType=b}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth]}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth]}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth]}},update:function(a){var b=(this.options.scaleFrom/100)+(this.factor*a);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*b+this.fontSizeType})}this.setDimensions(this.dims[0]*b,this.dims[1]*b)},finish:function(a){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle)}},setDimensions:function(a,f){var g={};if(this.options.scaleX){g.width=f.round()+"px"}if(this.options.scaleY){g.height=a.round()+"px"}if(this.options.scaleFromCenter){var c=(a-this.dims[0])/2;var b=(f-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){g.top=this.originalTop-c+"px"}if(this.options.scaleX){g.left=this.originalLeft-b+"px"}}else{if(this.options.scaleY){g.top=-c+"px"}if(this.options.scaleX){g.left=-b+"px"}}}this.element.setStyle(g)}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(b){this.element=$(b);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(a)},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return}this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"})}if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff")}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color")}this._base=$R(0,2).map(function(a){return parseInt(this.options.startcolor.slice(a*2+1,a*2+3),16)}.bind(this));this._delta=$R(0,2).map(function(a){return parseInt(this.options.endcolor.slice(a*2+1,a*2+3),16)-this._base[a]}.bind(this))},update:function(a){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(b,c,d){return b+((this._base[d]+(this._delta[d]*a)).round().toColorPart())}.bind(this))})},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}))}});Effect.ScrollTo=function(d){var c=arguments[1]||{},b=document.viewport.getScrollOffsets(),f=$(d).cumulativeOffset(),a=document.viewport.getScrollOffsets[0]-document.viewport.getHeight();if(c.offset){f[1]+=c.offset}return new Effect.Tween(null,b.top,f[1]>a?a:f[1],c,function(g){scrollTo(b.left,g.round())})};Effect.Fade=function(c){c=$(c);var a=c.getInlineOpacity();var b=Object.extend({from:c.getOpacity()||1,to:0,afterFinishInternal:function(d){if(d.options.to!=0){return}d.element.hide().setStyle({opacity:a})}},arguments[1]||{});return new Effect.Opacity(c,b)};Effect.Appear=function(b){b=$(b);var a=Object.extend({from:(b.getStyle("display")=="none"?0:b.getOpacity()||0),to:1,afterFinishInternal:function(c){c.element.forceRerendering()},beforeSetup:function(c){c.element.setOpacity(c.options.from).show()}},arguments[1]||{});return new Effect.Opacity(b,a)};Effect.Puff=function(b){b=$(b);var a={opacity:b.getInlineOpacity(),position:b.getStyle("position"),top:b.style.top,left:b.style.left,width:b.style.width,height:b.style.height};return new Effect.Parallel([new Effect.Scale(b,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(b,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(c){Position.absolutize(c.effects[0].element)},afterFinishInternal:function(c){c.effects[0].element.hide().setStyle(a)}},arguments[1]||{}))};Effect.BlindUp=function(a){a=$(a);a.makeClipping();return new Effect.Scale(a,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(b){b.element.hide().undoClipping()}},arguments[1]||{}))};Effect.BlindDown=function(b){b=$(b);var a=b.getDimensions();return new Effect.Scale(b,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:a.height,originalWidth:a.width},restoreAfterFinish:true,afterSetup:function(c){c.element.makeClipping().setStyle({height:"0px"}).show()},afterFinishInternal:function(c){c.element.undoClipping()}},arguments[1]||{}))};Effect.SwitchOff=function(b){b=$(b);var a=b.getInlineOpacity();return new Effect.Appear(b,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(c){new Effect.Scale(c.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(d){d.element.makePositioned().makeClipping()},afterFinishInternal:function(d){d.element.hide().undoClipping().undoPositioned().setStyle({opacity:a})}})}},arguments[1]||{}))};Effect.DropOut=function(b){b=$(b);var a={top:b.getStyle("top"),left:b.getStyle("left"),opacity:b.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(b,{x:0,y:100,sync:true}),new Effect.Opacity(b,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(c){c.effects[0].element.makePositioned()},afterFinishInternal:function(c){c.effects[0].element.hide().undoPositioned().setStyle(a)}},arguments[1]||{}))};Effect.Shake=function(d){d=$(d);var b=Object.extend({distance:20,duration:0.5},arguments[1]||{});var f=parseFloat(b.distance);var c=parseFloat(b.duration)/10;var a={top:d.getStyle("top"),left:d.getStyle("left")};return new Effect.Move(d,{x:f,y:0,duration:c,afterFinishInternal:function(g){new Effect.Move(g.element,{x:-f*2,y:0,duration:c*2,afterFinishInternal:function(h){new Effect.Move(h.element,{x:f*2,y:0,duration:c*2,afterFinishInternal:function(k){new Effect.Move(k.element,{x:-f*2,y:0,duration:c*2,afterFinishInternal:function(l){new Effect.Move(l.element,{x:f*2,y:0,duration:c*2,afterFinishInternal:function(m){new Effect.Move(m.element,{x:-f,y:0,duration:c,afterFinishInternal:function(o){o.element.undoPositioned().setStyle(a)}})}})}})}})}})}})};Effect.SlideDown=function(c){c=$(c).cleanWhitespace();var a=c.down().getStyle("bottom");var b=c.getDimensions();return new Effect.Scale(c,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:b.height,originalWidth:b.width},restoreAfterFinish:true,afterSetup:function(d){d.element.makePositioned();d.element.down().makePositioned();if(window.opera){d.element.setStyle({top:""})}d.element.makeClipping().setStyle({height:"0px"}).show()},afterUpdateInternal:function(d){d.element.down().setStyle({bottom:(d.dims[0]-d.element.clientHeight)+"px"})},afterFinishInternal:function(d){d.element.undoClipping().undoPositioned();d.element.down().undoPositioned().setStyle({bottom:a})}},arguments[1]||{}))};Effect.SlideUp=function(c){c=$(c).cleanWhitespace();var a=c.down().getStyle("bottom");var b=c.getDimensions();return new Effect.Scale(c,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:b.height,originalWidth:b.width},restoreAfterFinish:true,afterSetup:function(d){d.element.makePositioned();d.element.down().makePositioned();if(window.opera){d.element.setStyle({top:""})}d.element.makeClipping().show()},afterUpdateInternal:function(d){d.element.down().setStyle({bottom:(d.dims[0]-d.element.clientHeight)+"px"})},afterFinishInternal:function(d){d.element.hide().undoClipping().undoPositioned();d.element.down().undoPositioned().setStyle({bottom:a})}},arguments[1]||{}))};Effect.Squish=function(a){return new Effect.Scale(a,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(b){b.element.makeClipping()},afterFinishInternal:function(b){b.element.hide().undoClipping()}})};Effect.Grow=function(c){c=$(c);var b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var a={top:c.style.top,left:c.style.left,height:c.style.height,width:c.style.width,opacity:c.getInlineOpacity()};var h=c.getDimensions();var k,g;var f,d;switch(b.direction){case"top-left":k=g=f=d=0;break;case"top-right":k=h.width;g=d=0;f=-h.width;break;case"bottom-left":k=f=0;g=h.height;d=-h.height;break;case"bottom-right":k=h.width;g=h.height;f=-h.width;d=-h.height;break;case"center":k=h.width/2;g=h.height/2;f=-h.width/2;d=-h.height/2;break}return new Effect.Move(c,{x:k,y:g,duration:0.01,beforeSetup:function(l){l.element.hide().makeClipping().makePositioned()},afterFinishInternal:function(l){new Effect.Parallel([new Effect.Opacity(l.element,{sync:true,to:1,from:0,transition:b.opacityTransition}),new Effect.Move(l.element,{x:f,y:d,sync:true,transition:b.moveTransition}),new Effect.Scale(l.element,100,{scaleMode:{originalHeight:h.height,originalWidth:h.width},sync:true,scaleFrom:window.opera?1:0,transition:b.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(m){m.effects[0].element.setStyle({height:"0px"}).show()},afterFinishInternal:function(m){m.effects[0].element.undoClipping().undoPositioned().setStyle(a)}},b))}})};Effect.Shrink=function(c){c=$(c);var b=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var a={top:c.style.top,left:c.style.left,height:c.style.height,width:c.style.width,opacity:c.getInlineOpacity()};var g=c.getDimensions();var f,d;switch(b.direction){case"top-left":f=d=0;break;case"top-right":f=g.width;d=0;break;case"bottom-left":f=0;d=g.height;break;case"bottom-right":f=g.width;d=g.height;break;case"center":f=g.width/2;d=g.height/2;break}return new Effect.Parallel([new Effect.Opacity(c,{sync:true,to:0,from:1,transition:b.opacityTransition}),new Effect.Scale(c,window.opera?1:0,{sync:true,transition:b.scaleTransition,restoreAfterFinish:true}),new Effect.Move(c,{x:f,y:d,sync:true,transition:b.moveTransition})],Object.extend({beforeStartInternal:function(h){h.effects[0].element.makePositioned().makeClipping()},afterFinishInternal:function(h){h.effects[0].element.hide().undoClipping().undoPositioned().setStyle(a)}},b))};Effect.Pulsate=function(c){c=$(c);var b=arguments[1]||{};var a=c.getInlineOpacity();var f=b.transition||Effect.Transitions.sinoidal;var d=function(g){return f(1-Effect.Transitions.pulse(g,b.pulses))};d.bind(f);return new Effect.Opacity(c,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(g){g.element.setStyle({opacity:a})}},b),{transition:d}))};Effect.Fold=function(b){b=$(b);var a={top:b.style.top,left:b.style.left,width:b.style.width,height:b.style.height};b.makeClipping();return new Effect.Scale(b,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(c){new Effect.Scale(b,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(d){d.element.hide().undoClipping().setStyle(a)}})}},arguments[1]||{}))};Effect.Morph=Class.create(Effect.Base,{initialize:function(c){this.element=$(c);if(!this.element){throw (Effect._elementDoesNotExistError)}var a=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(a.style)){this.style=$H(a.style)}else{if(a.style.include(":")){this.style=a.style.parseStyle()}else{this.element.addClassName(a.style);this.style=$H(this.element.getStyles());this.element.removeClassName(a.style);var b=this.element.getStyles();this.style=this.style.reject(function(d){return d.value==b[d.key]});a.afterFinishInternal=function(d){d.element.addClassName(d.options.style);d.transforms.each(function(f){d.element.style[f.style]=""})}}}this.start(a)},setup:function(){function a(b){if(!b||["rgba(0, 0, 0, 0)","transparent"].include(b)){b="#ffffff"}b=b.parseColor();return $R(0,2).map(function(c){return parseInt(b.slice(c*2+1,c*2+3),16)})}this.transforms=this.style.map(function(h){var g=h[0],f=h[1],d=null;if(f.parseColor("#zzzzzz")!="#zzzzzz"){f=f.parseColor();d="color"}else{if(g=="opacity"){f=parseFloat(f);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1})}}else{if(Element.CSS_LENGTH.test(f)){var c=f.match(/^([\+\-]?[0-9\.]+)(.*)$/);f=parseFloat(c[1]);d=(c.length==3)?c[2]:null}}}var b=this.element.getStyle(g);return{style:g.camelize(),originalValue:d=="color"?a(b):parseFloat(b||0),targetValue:d=="color"?a(f):f,unit:d}}.bind(this)).reject(function(b){return((b.originalValue==b.targetValue)||(b.unit!="color"&&(isNaN(b.originalValue)||isNaN(b.targetValue))))})},update:function(a){var d={},b,c=this.transforms.length;while(c--){d[(b=this.transforms[c]).style]=b.unit=="color"?"#"+(Math.round(b.originalValue[0]+(b.targetValue[0]-b.originalValue[0])*a)).toColorPart()+(Math.round(b.originalValue[1]+(b.targetValue[1]-b.originalValue[1])*a)).toColorPart()+(Math.round(b.originalValue[2]+(b.targetValue[2]-b.originalValue[2])*a)).toColorPart():(b.originalValue+(b.targetValue-b.originalValue)*a).toFixed(3)+(b.unit===null?"":b.unit)}this.element.setStyle(d,true)}});Effect.Transform=Class.create({initialize:function(a){this.tracks=[];this.options=arguments[1]||{};this.addTracks(a)},addTracks:function(a){a.each(function(b){b=$H(b);var c=b.values().first();this.tracks.push($H({ids:b.keys().first(),effect:Effect.Morph,options:{style:c}}))}.bind(this));return this},play:function(){return new Effect.Parallel(this.tracks.map(function(a){var d=a.get("ids"),c=a.get("effect"),b=a.get("options");var f=[$(d)||$$(d)].flatten();return f.map(function(g){return new c(g,Object.extend({sync:true},b))})}).flatten(),this.options)}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderSpacing borderTopColor borderTopStyle borderTopWidth bottom clip color fontSize fontWeight height left letterSpacing lineHeight marginBottom marginLeft marginRight marginTop markerOffset maxHeight maxWidth minHeight minWidth opacity outlineColor outlineOffset outlineWidth paddingBottom paddingLeft paddingRight paddingTop right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");String.prototype.parseStyle=function(){var b,a=$H();if(Prototype.Browser.WebKit){b=new Element("div",{style:this}).style}else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';b=String.__parseStyleElement.childNodes[0].style}Element.CSS_PROPERTIES.each(function(c){if(b[c]){a.set(c,b[c])}});if(Prototype.Browser.IE&&this.include("opacity")){a.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1])}return a};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(b){var a=document.defaultView.getComputedStyle($(b),null);return Element.CSS_PROPERTIES.inject({},function(c,d){c[d]=a[d];return c})}}else{Element.getStyles=function(b){b=$(b);var a=b.currentStyle,c;c=Element.CSS_PROPERTIES.inject({},function(d,f){d[f]=a[f];return d});if(!c.opacity){c.opacity=b.getOpacity()}return c}}Effect.Methods={morph:function(a,b){a=$(a);new Effect.Morph(a,Object.extend({style:b},arguments[2]||{}));return a},visualEffect:function(c,f,b){c=$(c);var d=f.dasherize().camelize(),a=d.charAt(0).toUpperCase()+d.substring(1);new Effect[a](c,b);return c},highlight:function(b,a){b=$(b);new Effect.Highlight(b,a);return b}};$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown pulsate shake puff squish switchOff dropOut").each(function(a){Effect.Methods[a]=function(c,b){c=$(c);Effect[a.charAt(0).toUpperCase()+a.substring(1)](c,b);return c}});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(a){Effect.Methods[a]=Element[a]});Element.addMethods(Effect.Methods);if(typeof Effect=="undefined"){throw ("controls.js requires including script.aculo.us' effects.js library")}var Autocompleter={};Autocompleter.Base=Class.create({baseInitialize:function(b,c,a){b=$(b);this.element=b;this.update=$(c);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;if(this.setOptions){this.setOptions(a)}else{this.options=a||{}}this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(f,d,g){if(!g.style.position||g.style.position=="absolute"){g.style.position="absolute";Position.clone(d,g,{setHeight:false,setWidth:!f.options.width,offsetTop:d.offsetHeight});g.style.top=(parseInt(g.style.top,10)+(f.options.offsetTop||0))+"px";g.style.left=(parseInt(g.style.left,10)+(f.options.offsetLeft||0))+"px"}if(f.options.width){g.setStyle({width:f.options.width+"px"})}Element.show(g)};this.options.onHide=this.options.onHide||function(d,f){Element.hide(f)};if(typeof(this.options.tokens)=="string"){this.options.tokens=new Array(this.options.tokens)}if(!this.options.tokens.include("\n")){this.options.tokens.push("\n")}this.observer=null;this.element.setAttribute("autocomplete","off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keydown",this.onKeyPress.bindAsEventListener(this))},show:function(){if(Element.getStyle(this.update,"display")=="none"){this.options.onShow(this,this.element,this.update)}if(!this.iefix&&(Prototype.Browser.IE)&&(Element.getStyle(this.update,"position")=="absolute")){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.update.id+"_iefix")}if(this.iefix){setTimeout(this.fixIEOverlapping.bind(this),50)}},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});var a=this.update.getStyle("z-index")||0;this.iefix.style.zIndex=a+1;this.update.style.zIndex=a+2;Element.show(this.iefix)},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,"display")!="none"){this.options.onHide(this.element,this.update)}if(this.iefix){Element.hide(this.iefix)}},startIndicator:function(){if(this.options.indicator){Element.show(this.options.indicator)}},stopIndicator:function(){if(this.options.indicator){Element.hide(this.options.indicator)}},onKeyPress:function(a){if(this.active){switch(a.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(a);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(a);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(a);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(a);return}}else{if(a.keyCode==Event.KEY_TAB||a.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&a.keyCode==0)){return}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer)}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000)},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices()},onHover:function(b){var a=Event.findElement(b,"LI");if(this.index!=a.autocompleteIndex){this.index=a.autocompleteIndex;this.render()}Event.stop(b)},onClick:function(b){var a=Event.findElement(b,"LI");this.index=a.autocompleteIndex;this.selectEntry();this.hide()},onBlur:function(a){setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false},render:function(){if(this.entryCount>0){for(var a=0;a<this.entryCount;a++){this.index==a?Element.addClassName(this.getEntry(a),"selected"):Element.removeClassName(this.getEntry(a),"selected")}if(this.hasFocus){this.show();this.active=true}}else{this.active=false;this.hide()}},markPrevious:function(){if(this.index>0){this.index--}else{this.index=this.entryCount-1}if(this.getEntry(this.index).getAttribute("bind")=="transparent"){this.markPrevious()}},markNext:function(){if(this.index<this.entryCount-1){this.index++}else{this.index=0}if(this.getEntry(this.index).getAttribute("bind")=="transparent"){this.markNext()}},getEntry:function(a){return this.update.firstChild.childNodes[a]},getCurrentEntry:function(){return this.getEntry(this.index)},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry(),this.options.updateElementParam)},updateElement:function(g){if(this.options.updateElement){this.options.updateElement(g,this.options.updateElementParam);return}var d="";if(this.options.select){var a=$(g).select("."+this.options.select)||[];if(a.length>0){d=Element.collectTextNodes(a[0],this.options.select)}}else{d=Element.collectTextNodesIgnoreClass(g,"informal")}var c=this.getTokenBounds();if(c[0]!=-1){var f=this.element.value.substr(0,c[0]);var b=this.element.value.substr(c[0]).match(/^\s+/);if(b){f+=b[0]}this.element.value=f+d+this.element.value.substr(c[1])}else{this.element.value=d}this.oldElementValue=this.element.value;this.element.focus();if(this.options.afterUpdateElement){this.options.afterUpdateElement(this.element,g)}},updateChoices:function(c){if(!this.changed&&this.hasFocus){if(typeof c=="string"){this.update.innerHTML=c}else{this.update.innerHTML="";this.update.appendChild(c)}Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var a=0;a<this.entryCount;a++){var b=this.getEntry(a);b.autocompleteIndex=a;this.addObservers(b)}}else{this.entryCount=0}this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide()}else{this.render()}}},addObservers:function(a){Event.observe(a,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(a,"click",this.onClick.bindAsEventListener(this))},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices()}else{this.active=false;this.hide()}this.oldElementValue=this.element.value},getToken:function(){var a=this.getTokenBounds();return this.element.value.substring(a[0],a[1]).strip()},getTokenBounds:function(){if(null!=this.tokenBounds){return this.tokenBounds}var f=this.element.value;if(f.strip().empty()){return[-1,0]}var g=arguments.callee.getFirstDifferencePos(f,this.oldElementValue);var k=(g==this.oldElementValue.length?1:0);var d=-1,c=f.length;var h;for(var b=0,a=this.options.tokens.length;b<a;++b){h=f.lastIndexOf(this.options.tokens[b],g+k-1);if(h>d){d=h}h=f.indexOf(this.options.tokens[b],g+k);if(-1!=h&&h<c){c=h}}return(this.tokenBounds=[d+1,c])}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(c,a){var d=Math.min(c.length,a.length);for(var b=0;b<d;++b){if(c[b]!=a[b]){return b}}return d};Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(c,d,b,a){this.baseInitialize(c,d,a);this.options.asynchronous=true;if(this.options.onComplete){this.options.onComplete=this.options.onComplete.bind(this,this.options.onCompleteParams)}else{this.options.onComplete=this.onComplete.bind(this,this.options.onCompleteParams)}this.options.defaultParams=this.options.parameters||null;this.url=b},getUpdatedChoices:function(){if($("loaderAC")!=null){showElement("loaderAC")}this.startIndicator();var a=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,a):a;if(this.options.defaultParams){this.options.parameters+="&"+this.options.defaultParams}if(this.options.requester){this.options.requester(this.url,this.options)}else{new Ajax.Request(this.url,this.options)}},onComplete:function(a){this.updateChoices(a.responseText,this.options.onCompleteParams)}});Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(b,d,c,a){this.baseInitialize(b,d,a);this.options.array=c},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this))},setOptions:function(a){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(b){var d=[];var c=[];var k=b.getToken();var h=0;for(var f=0;f<b.options.array.length&&d.length<b.options.choices;f++){var g=b.options.array[f];var l=b.options.ignoreCase?g.toLowerCase().indexOf(k.toLowerCase()):g.indexOf(k);while(l!=-1){if(l==0&&g.length!=k.length){d.push("<li><strong>"+g.substr(0,k.length)+"</strong>"+g.substr(k.length)+"</li>");break}else{if(k.length>=b.options.partialChars&&b.options.partialSearch&&l!=-1){if(b.options.fullSearch||/\s/.test(g.substr(l-1,1))){c.push("<li>"+g.substr(0,l)+"<strong>"+g.substr(l,k.length)+"</strong>"+g.substr(l+k.length)+"</li>");break}}}l=b.options.ignoreCase?g.toLowerCase().indexOf(k.toLowerCase(),l+1):g.indexOf(k,l+1)}}if(c.length){d=d.concat(c.slice(0,b.options.choices-d.length))}return"<ul>"+d.join("")+"</ul>"}},a||{})}});Form.Element.DelayedObserver=Class.create({initialize:function(b,a,c){this.delay=a||0.5;this.element=$(b);this.callback=c;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this))},delayedListener:function(a){if(this.lastValue==$F(this.element)){return}if(this.timer){clearTimeout(this.timer)}this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element)},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element))}});if(typeof Effect=="undefined"){throw ("dragdrop.js requires including script.aculo.us' effects.js library")}var Droppables={drops:[],remove:function(a){this.drops=this.drops.reject(function(b){return b.element==$(a)})},add:function(b){b=$(b);var a=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(a.containment){a._containers=[];var c=a.containment;if((typeof c=="object")&&(c.constructor==Array)){c.each(function(d){a._containers.push($(d))})}else{a._containers.push($(c))}}if(a.accept){a.accept=[a.accept].flatten()}Element.makePositioned(b);a.element=b;this.drops.push(a)},findDeepestChild:function(a){deepest=a[0];for(i=1;i<a.length;++i){if(Element.isParent(a[i].element,deepest.element)){deepest=a[i]}}return deepest},isContained:function(b,a){var c;if(a.tree){c=b.treeNode}else{c=b.parentNode}return a._containers.detect(function(d){return c==d})},isAffected:function(a,c,b){return((b.element!=c)&&((!b._containers)||this.isContained(c,b))&&((!b.accept)||(Element.classNames(c).detect(function(d){return b.accept.include(d)})))&&Position.within(b.element,a[0],a[1]))},deactivate:function(a){if(a.hoverclass){Element.removeClassName(a.element,a.hoverclass)}this.last_active=null},activate:function(a){if(a.hoverclass){Element.addClassName(a.element,a.hoverclass)}this.last_active=a},show:function(a,b){if(!this.drops.length){return}var c=[];if(this.last_active){this.deactivate(this.last_active)}this.drops.each(function(d){if(Droppables.isAffected(a,b,d)){c.push(d)}});if(c.length>0){drop=Droppables.findDeepestChild(c);Position.within(drop.element,a[0],a[1]);if(drop.onHover){drop.onHover(b,drop.element,Position.overlap(drop.overlap,drop.element))}Droppables.activate(drop)}},fire:function(b,a){if(!this.last_active){return}Position.prepare();if(this.isAffected([Event.pointerX(b),Event.pointerY(b)],a,this.last_active)){if(this.last_active.onDrop){this.last_active.onDrop(a,this.last_active.element,b)}}},reset:function(){if(this.last_active){this.deactivate(this.last_active)}}};var Draggables={drags:[],observers:[],register:function(a){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress)}this.drags.push(a)},unregister:function(a){this.drags=this.drags.reject(function(b){return b==a});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress)}},activate:function(a){if(a.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=a}.bind(this),a.options.delay)}else{window.focus();this.activeDraggable=a}},deactivate:function(){this.activeDraggable=null},updateDrag:function(a){if(!this.activeDraggable){return}var b=[Event.pointerX(a),Event.pointerY(a)];if(this._lastPointer&&(this._lastPointer.inspect()==b.inspect())){return}this._lastPointer=b;this.activeDraggable.updateDrag(a,b)},endDrag:function(a){if(this._timeout){clearTimeout(this._timeout);this._timeout=null}if(!this.activeDraggable){return}this._lastPointer=null;this.activeDraggable.endDrag(a);this.activeDraggable=null},keyPress:function(a){if(this.activeDraggable){this.activeDraggable.keyPress(a)}},addObserver:function(a){this.observers.push(a);this._cacheObserverCallbacks()},removeObserver:function(a){this.observers=this.observers.reject(function(b){return b.element==a});this._cacheObserverCallbacks()},notify:function(b,a,c){if(this[b+"Count"]>0){this.observers.each(function(d){if(d[b]){d[b](b,a,c)}})}if(a.options[b]){a.options[b](a,c)}},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(a){Draggables[a+"Count"]=Draggables.observers.select(function(b){return b[a]}).length})}};var Draggable=Class.create();Draggable._dragging={};Draggable.prototype={initialize:function(b){var c={handle:false,reverteffect:function(g,f,d){var h=Math.sqrt(Math.abs(f^2)+Math.abs(d^2))*0.02;new Effect.Move(g,{x:-d,y:-f,duration:h,queue:{scope:"_draggable",position:"end"}})},endeffect:function(f){var d=typeof f._opacity=="number"?f._opacity:1;new Effect.Opacity(f,{duration:0.2,from:0.7,to:d,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[f]=false}})},zindex:1000,revert:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||typeof arguments[1].endeffect=="undefined"){Object.extend(c,{starteffect:function(d){d._opacity=Element.getOpacity(d);Draggable._dragging[d]=true;new Effect.Opacity(d,{duration:0.2,from:d._opacity,to:0.7})}})}var a=Object.extend(c,arguments[1]||{});this.element=$(b);if(a.handle&&(typeof a.handle=="string")){this.handle=this.element.down("."+a.handle,0)}if(!this.handle){this.handle=$(a.handle)}if(!this.handle){this.handle=this.element}if(a.scroll&&!a.scroll.scrollTo&&!a.scroll.outerHTML){a.scroll=$(a.scroll);this._isScrollChild=Element.childOf(this.element,a.scroll)}Element.makePositioned(this.element);this.delta=this.currentDelta();this.options=a;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this)},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this)},currentDelta:function(){return([parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")])},initDrag:function(a){if(typeof Draggable._dragging[this.element]!="undefined"&&Draggable._dragging[this.element]){return}if(Event.isLeftClick(a)){var c=Event.element(a);if((tag_name=c.tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA")){return}var b=[Event.pointerX(a),Event.pointerY(a)];var d=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(f){return(b[f]-d[f])});Draggables.activate(this);Event.stop(a)}},startDrag:function(b){this.dragging=true;if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0);this.element.style.zIndex=this.options.zindex}if(this.options.ghosting){this._clone=this.element.cloneNode(true);Position.absolutize(this.element);this.element.parentNode.insertBefore(this._clone,this.element)}if(this.options.scroll){if(this.options.scroll==window){var a=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=a.left;this.originalScrollTop=a.top}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop}}Draggables.notify("onStart",this,b);if(this.options.starteffect){this.options.starteffect(this.element)}},updateDrag:function(event,pointer){if(!this.dragging){this.startDrag(event)}Position.prepare();Droppables.show(pointer,this.element);Draggables.notify("onDrag",this,event);this.draw(pointer);if(this.options.change){this.options.change(this)}if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height]}}else{p=Position.page(this.options.scroll);p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight)}var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity)}if(pointer[1]<(p[1]+this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity)}if(pointer[0]>(p[2]-this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity)}if(pointer[1]>(p[3]-this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity)}this.startScrolling(speed)}if(navigator.appVersion.indexOf("AppleWebKit")>0){window.scrollBy(0,0)}Event.stop(event)},finishDrag:function(b,f){this.dragging=false;if(this.options.ghosting){Position.relativize(this.element);Element.remove(this._clone);this._clone=null}if(f){Droppables.fire(b,this.element)}Draggables.notify("onEnd",this,b);var a=this.options.revert;if(a&&typeof a=="function"){a=a(this.element)}var c=this.currentDelta();if(a&&this.options.reverteffect){this.options.reverteffect(this.element,c[1]-this.delta[1],c[0]-this.delta[0])}else{this.delta=c}if(this.options.zindex){this.element.style.zIndex=this.originalZ}if(this.options.endeffect){this.options.endeffect(this.element)}Draggables.deactivate(this);Droppables.reset()},keyPress:function(a){if(a.keyCode!=Event.KEY_ESC){return}this.finishDrag(a,false);Event.stop(a)},endDrag:function(a){if(!this.dragging){return}this.stopScrolling();this.finishDrag(a,true);Event.stop(a)},draw:function(a){var h=Position.cumulativeOffset(this.element);if(this.options.ghosting){var c=Position.realOffset(this.element);h[0]+=c[0]-Position.deltaX;h[1]+=c[1]-Position.deltaY}var g=this.currentDelta();h[0]-=g[0];h[1]-=g[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){h[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;h[1]-=this.options.scroll.scrollTop-this.originalScrollTop}var f=[0,1].map(function(d){return(a[d]-h[d]-this.offset[d])}.bind(this));if(this.options.snap){if(typeof this.options.snap=="function"){f=this.options.snap(f[0],f[1],this)}else{if(this.options.snap instanceof Array){f=f.map(function(d,k){return Math.round(d/this.options.snap[k])*this.options.snap[k]}.bind(this))}else{f=f.map(function(d){return Math.round(d/this.options.snap)*this.options.snap}.bind(this))}}}var b=this.element.style;if((!this.options.constraint)||(this.options.constraint=="horizontal")){b.left=f[0]+"px"}if((!this.options.constraint)||(this.options.constraint=="vertical")){b.top=f[1]+"px"}if(b.visibility=="hidden"){b.visibility=""}},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null}},startScrolling:function(a){if(!(a[0]||a[1])){return}this.scrollSpeed=[a[0]*this.options.scrollSpeed,a[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10)},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1])}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000}Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify("onDrag",this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0){Draggables._lastScrollPointer[0]=0}if(Draggables._lastScrollPointer[1]<0){Draggables._lastScrollPointer[1]=0}this.draw(Draggables._lastScrollPointer)}if(this.options.change){this.options.change(this)}},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight}else{W=body.offsetWidth;H=body.offsetHeight}}}return{top:T,left:L,width:W,height:H}}};var SortableObserver=Class.create();SortableObserver.prototype={initialize:function(b,a){this.element=$(b);this.observer=a;this.lastValue=Sortable.serialize(this.element)},onStart:function(){this.lastValue=Sortable.serialize(this.element)},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element)){this.observer(this.element)}}};var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(a){while(a.tagName.toUpperCase()!="BODY"){if(a.id&&Sortable.sortables[a.id]){return a}a=a.parentNode}},options:function(a){a=Sortable._findRootElement($(a));if(!a){return}return Sortable.sortables[a.id]},destroy:function(a){var b=Sortable.options(a);if(b){Draggables.removeObserver(b.element);b.droppables.each(function(c){Droppables.remove(c)});b.draggables.invoke("destroy");delete Sortable.sortables[b.element.id]}},create:function(c){c=$(c);var b=Object.extend({element:c,tag:"li",dropOnEmpty:false,tree:false,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:c,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(c);var a={revert:true,scroll:b.scroll,scrollSpeed:b.scrollSpeed,scrollSensitivity:b.scrollSensitivity,delay:b.delay,ghosting:b.ghosting,constraint:b.constraint,handle:b.handle};if(b.starteffect){a.starteffect=b.starteffect}if(b.reverteffect){a.reverteffect=b.reverteffect}else{if(b.ghosting){a.reverteffect=function(g){g.style.top=0;g.style.left=0}}}if(b.endeffect){a.endeffect=b.endeffect}if(b.zindex){a.zindex=b.zindex}var d={overlap:b.overlap,containment:b.containment,tree:b.tree,hoverclass:b.hoverclass,onHover:Sortable.onHover};var f={onHover:Sortable.onEmptyHover,overlap:b.overlap,containment:b.containment,hoverclass:b.hoverclass};Element.cleanWhitespace(c);b.draggables=[];b.droppables=[];if(b.dropOnEmpty||b.tree){Droppables.add(c,f);b.droppables.push(c)}(this.findElements(c,b)||[]).each(function(h){var g=b.handle?$(h).down("."+b.handle,0):h;b.draggables.push(new Draggable(h,Object.extend(a,{handle:g})));Droppables.add(h,d);if(b.tree){h.treeNode=c}b.droppables.push(h)});if(b.tree){(Sortable.findTreeElements(c,b)||[]).each(function(g){Droppables.add(g,f);g.treeNode=c;b.droppables.push(g)})}this.sortables[c.id]=b;Draggables.addObserver(new SortableObserver(c,b.onUpdate))},findElements:function(b,a){return Element.findChildren(b,a.only,a.tree?true:false,a.tag)},findTreeElements:function(b,a){return Element.findChildren(b,a.only,a.tree?true:false,a.treeTag)},onHover:function(f,d,a){if(Element.isParent(d,f)){return}if(a>0.33&&a<0.66&&Sortable.options(d).tree){return}else{if(a>0.5){Sortable.mark(d,"before");if(d.previousSibling!=f){var b=f.parentNode;f.style.visibility="hidden";d.parentNode.insertBefore(f,d);if(d.parentNode!=b){Sortable.options(b).onChange(f)}Sortable.options(d.parentNode).onChange(f)}}else{Sortable.mark(d,"after");var c=d.nextSibling||null;if(c!=f){var b=f.parentNode;f.style.visibility="hidden";d.parentNode.insertBefore(f,c);if(d.parentNode!=b){Sortable.options(b).onChange(f)}Sortable.options(d.parentNode).onChange(f)}}}},onEmptyHover:function(f,h,k){var l=f.parentNode;var a=Sortable.options(h);if(!Element.isParent(h,f)){var g;var c=Sortable.findElements(h,{tag:a.tag,only:a.only});var b=null;if(c){var d=Element.offsetSize(h,a.overlap)*(1-k);for(g=0;g<c.length;g+=1){if(d-Element.offsetSize(c[g],a.overlap)>=0){d-=Element.offsetSize(c[g],a.overlap)}else{if(d-(Element.offsetSize(c[g],a.overlap)/2)>=0){b=g+1<c.length?c[g+1]:null;break}else{b=c[g];break}}}}h.insertBefore(f,b);Sortable.options(l).onChange(f);a.onChange(f)}},unmark:function(){if(Sortable._marker){Sortable._marker.hide()}},mark:function(b,a){var d=Sortable.options(b.parentNode);if(d&&!d.ghosting){return}if(!Sortable._marker){Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker)}var c=Position.cumulativeOffset(b);Sortable._marker.setStyle({left:c[0]+"px",top:c[1]+"px"});if(a=="after"){if(d.overlap=="horizontal"){Sortable._marker.setStyle({left:(c[0]+b.clientWidth)+"px"})}else{Sortable._marker.setStyle({top:(c[1]+b.clientHeight)+"px"})}}Sortable._marker.show()},_tree:function(f,b,g){var d=Sortable.findElements(f,b)||[];for(var c=0;c<d.length;++c){var a=d[c].id.match(b.format);if(!a){continue}var h={id:encodeURIComponent(a?a[1]:null),element:f,parent:g,children:[],position:g.children.length,container:$(d[c]).down(b.treeTag)};if(h.container){this._tree(h.container,b,h)}g.children.push(h)}return g},tree:function(d){d=$(d);var c=this.options(d);var b=Object.extend({tag:c.tag,treeTag:c.treeTag,only:c.only,name:d.id,format:c.format},arguments[1]||{});var a={id:null,parent:null,children:[],container:d,position:0};return Sortable._tree(d,b,a)},_constructIndex:function(b){var a="";do{if(b.id){a="["+b.position+"]"+a}}while((b=b.parent)!=null);return a},sequence:function(b){b=$(b);var a=Object.extend(this.options(b),arguments[1]||{});return $(this.findElements(b,a)||[]).map(function(c){return c.id.match(a.format)?c.id.match(a.format)[1]:""})},setSequence:function(b,c){b=$(b);var a=Object.extend(this.options(b),arguments[2]||{});var d={};this.findElements(b,a).each(function(f){if(f.id.match(a.format)){d[f.id.match(a.format)[1]]=[f,f.parentNode]}f.parentNode.removeChild(f)});c.each(function(f){var g=d[f];if(g){g[1].appendChild(g[0]);delete d[f]}})},serialize:function(c){c=$(c);var b=Object.extend(Sortable.options(c),arguments[1]||{});var a=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:c.id);if(b.tree){return Sortable.tree(c,arguments[1]).children.map(function(d){return[a+Sortable._constructIndex(d)+"[id]="+encodeURIComponent(d.id)].concat(d.children.map(arguments.callee))}).flatten().join("&")}else{return Sortable.sequence(c,arguments[1]).map(function(d){return a+"[]="+encodeURIComponent(d)}).join("&")}}};Element.isParent=function(b,a){if(!b.parentNode||b==a){return false}if(b.parentNode==a){return true}return Element.isParent(b.parentNode,a)};Element.findChildren=function(d,b,a,c){if(!d.hasChildNodes()){return null}c=c.toUpperCase();if(b){b=[b].flatten()}var f=[];$A(d.childNodes).each(function(h){if(h.tagName&&h.tagName.toUpperCase()==c&&(!b||(Element.classNames(h).detect(function(k){return b.include(k)})))){f.push(h)}if(a){var g=Element.findChildren(h,b,a,c);if(g){f.push(g)}}});return(f.length>0?f.flatten():[])};Element.offsetSize=function(a,b){return a["offset"+((b=="vertical"||b=="height")?"Height":"Width")]};if(!Control){var Control={}}Control.Slider=Class.create();Control.Slider.prototype={initialize:function(d,a,b){var c=this;if(d instanceof Array){this.handles=d.collect(function(f){return $(f)})}else{this.handles=[$(d)]}this.track=$(a);this.options=b||{};this.axis=this.options.axis||"horizontal";this.increment=this.options.increment||1;this.step=parseInt(this.options.step||"1");this.range=this.options.range||$R(0,1);this.value=0;this.values=this.handles.map(function(){return 0});this.spans=this.options.spans?this.options.spans.map(function(f){return $(f)}):false;this.options.startSpan=$(this.options.startSpan||null);this.options.endSpan=$(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||"0");this.alignY=parseInt(this.options.alignY||"0");this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?(this.handles[0].offsetHeight!=0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,"")):(this.handles[0].offsetWidth!=0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""));this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled){this.setDisabled()}this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):false;if(this.allowedValues){this.minimum=this.allowedValues.min();this.maximum=this.allowedValues.max()}this.eventMouseDown=this.startDrag.bindAsEventListener(this);this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.update.bindAsEventListener(this);this.handles.each(function(g,f){f=c.handles.length-1-f;c.setValue(parseFloat((c.options.sliderValue instanceof Array?c.options.sliderValue[f]:c.options.sliderValue)||c.range.start),f);Element.makePositioned(g);Event.observe(g,"mousedown",c.eventMouseDown)});Event.observe(this.track,"mousedown",this.eventMouseDown);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);this.initialized=true},dispose:function(){var a=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown);Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);this.handles.each(function(b){Event.stopObserving(b,"mousedown",a.eventMouseDown)})},setDisabled:function(){this.disabled=true},setEnabled:function(){this.disabled=false},getNearestValue:function(a){if(this.allowedValues){if(a>=this.allowedValues.max()){return(this.allowedValues.max())}if(a<=this.allowedValues.min()){return(this.allowedValues.min())}var c=Math.abs(this.allowedValues[0]-a);var b=this.allowedValues[0];this.allowedValues.each(function(d){var f=Math.abs(d-a);if(f<=c){b=d;c=f}});return b}if(a>this.range.end){return this.range.end}if(a<this.range.start){return this.range.start}return a},setValue:function(b,a){if(!this.active){this.activeHandleIdx=a||0;this.activeHandle=this.handles[this.activeHandleIdx];this.updateStyles()}a=a||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((a>0)&&(b<this.values[a-1])){b=this.values[a-1]}if((a<(this.handles.length-1))&&(b>this.values[a+1])){b=this.values[a+1]}}b=this.getNearestValue(b);this.values[a]=b;this.value=this.values[0];this.handles[a].style[this.isVertical()?"top":"left"]=this.translateToPx(b);this.drawSpans();if(!this.dragging||!this.event){this.updateFinished()}},setValueBy:function(b,a){this.setValue(this.values[a||this.activeHandleIdx||0]+b,a||this.activeHandleIdx||0)},translateToPx:function(a){return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(a-this.range.start))+"px"},translateToValue:function(a){return((a/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start)},getRange:function(b){var a=this.values.sortBy(Prototype.K);b=b||0;return $R(a[b],a[b+1])},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX)},maximumOffset:function(){return(this.isVertical()?(this.track.offsetHeight!=0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!=0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignY)},isVertical:function(){return(this.axis=="vertical")},drawSpans:function(){var a=this;if(this.spans){$R(0,this.spans.length-1).each(function(b){a.setSpan(a.spans[b],a.getRange(b))})}if(this.options.startSpan){this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value))}if(this.options.endSpan){this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum))}},setSpan:function(b,a){if(this.isVertical()){b.style.top=this.translateToPx(a.start);b.style.height=this.translateToPx(a.end-a.start+this.range.start)}else{b.style.left=this.translateToPx(a.start);b.style.width=this.translateToPx(a.end-a.start+this.range.start)}},updateStyles:function(){this.handles.each(function(a){Element.removeClassName(a,"selected")});Element.addClassName(this.activeHandle,"selected")},startDrag:function(c){if(Event.isLeftClick(c)){if(!this.disabled){this.active=true;var d=Event.element(c);var f=[Event.pointerX(c),Event.pointerY(c)];var a=d;if(a==this.track){var b=Position.cumulativeOffset(this.track);this.event=c;this.setValue(this.translateToValue((this.isVertical()?f[1]-b[1]:f[0]-b[0])-(this.handleLength/2)));var b=Position.cumulativeOffset(this.activeHandle);this.offsetX=(f[0]-b[0]);this.offsetY=(f[1]-b[1])}else{while((this.handles.indexOf(d)==-1)&&d.parentNode){d=d.parentNode}this.activeHandle=d;this.activeHandleIdx=this.handles.indexOf(this.activeHandle);this.updateStyles();var b=Position.cumulativeOffset(this.activeHandle);this.offsetX=(f[0]-b[0]);this.offsetY=(f[1]-b[1])}}Event.stop(c)}},update:function(a){if(this.active){if(!this.dragging){this.dragging=true}this.draw(a);if(navigator.appVersion.indexOf("AppleWebKit")>0){window.scrollBy(0,0)}Event.stop(a)}},draw:function(b){var c=[Event.pointerX(b),Event.pointerY(b)];var a=Position.cumulativeOffset(this.track);c[0]-=this.offsetX+a[0];c[1]-=this.offsetY+a[1];this.event=b;this.setValue(this.translateToValue(this.isVertical()?c[1]:c[0]));if(this.initialized&&this.options.onSlide){this.options.onSlide(this.values.length>1?this.values:this.value,this)}},endDrag:function(a){if(this.active&&this.dragging){this.finishDrag(a,true);Event.stop(a)}this.active=false;this.dragging=false},finishDrag:function(a,b){this.active=false;this.dragging=false;this.updateFinished()},updateFinished:function(){if(this.initialized&&this.options.onChange){this.options.onChange(this.values.length>1?this.values:this.value,this)}this.event=null}};var SUNDAY=1;var MONDAY=2;var TUESDAY=3;var WEDNESDAY=4;var THURSDAY=5;var FRIDAY=6;var SATURDAY=7;var DST=0;var newYork=new Array();newYork[2014]={start:"March 9",end:"November 2"};newYork[2015]={start:"March 8",end:"November 1"};newYork[2016]={start:"March 13",end:"November 6"};newYork[2017]={start:"March 12",end:"November 5"};var london=new Array();london[2014]={start:"March 30",end:"October 26"};london[2015]={start:"March 29",end:"October 25"};london[2016]={start:"March 27",end:"October 30"};london[2017]={start:"March 26",end:"October 29"};var sydney=new Array();sydney[2014]={start:"April 6",end:"October 5"};sydney[2015]={start:"April 5",end:"October 4"};sydney[2016]={start:"April 3",end:"October 2"};sydney[2017]={start:"April 2",end:"October 1"};var markets=[{name:"newYork",open:12,close:21,startDay:MONDAY,dst:newYork},{name:"london",open:7,close:16,startDay:MONDAY,dst:london},{name:"tokyo",open:0,close:9,startDay:MONDAY,dst:""},{name:"sydney",open:21,close:6,startDay:SUNDAY,dst:sydney}];function marketTime(){for(var c=0;c<markets.length;c++){var f=markets[c];var a=checkStatus(f);var d=(f.name=="newYork");if(a.open){$(f.name).innerHTML=timeLeft(a,$F("mcil"),d);$(markets[c].name+"M").className="on";$(markets[c].name+"B").className="marketBon"}else{$(f.name).innerHTML=timeLeft(a,$F("moil"),d);$(markets[c].name+"M").className="market";$(markets[c].name+"B").className="marketBoff"}var b=(f.open+3)/24*230;if(markets[c].name!="sydney"){$(markets[c].name+"M").style.right=b+"px"}}setTimeout(function(){marketTime()},1000)}var second=1000,minute=60*second,hour=60*minute,day=24*hour;function checkStatus(f){var a=new Object();var b=checkDst(f);var d=new Date(dt.getFullYear(),dt.getMonth(),dt.getDate(),f.open,0,0);while(d.getDay()+1!=f.startDay){d.setDate(d.getDate()-1)}var c=new Date(d.getFullYear(),d.getMonth(),d.getDate(),f.close,0,0);while(c<d){c.setDate(c.getDate()+1)}if(b){d.setHours(d.getHours()+1);c.setHours(c.getHours()+1)}a.dstMode=b;while(dt>c||(d.getDay()+1)>FRIDAY||d.getDay()+1<f.startDay||((d.getDay()+1)==FRIDAY)&&d.getHours()>=f.close){d.setDate(d.getDate()+1);c.setDate(c.getDate()+1)}if(dt>=d&&dt<c){a.open=true;a.left=c.getTime()-dt.getTime()}else{a.open=false;a.left=d.getTime()-dt.getTime()}return a}function checkDst(d){try{if(d.dst[dt.getFullYear()]!=null){var a=new Date(d.dst[dt.getFullYear()].start+","+dt.getFullYear());var c=new Date(d.dst[dt.getFullYear()].end+","+dt.getFullYear());return(dt<a||dt>c)}else{return false}}catch(b){return false}}function timeLeft(d,h,a){var g=d.left;var m=Math.floor(g/day);g-=m*day;var k=Math.floor(g/hour);g-=k*hour;var c=Math.floor(g/minute);g-=c*minute;var l=Math.floor(g/second);var b=((dt.getHours()*3600+dt.getMinutes()*60+dt.getSeconds()+10800-(d.dstMode?3600:0)));if(b>86400){b=(b-86400)/86400}else{b=b/86400}var f=b*230;$("timeWidget").style.display="none";return[(a?"<div id='timeline' style='right:"+f+"px'></div><div>":"")+h+" ",k+(m!=0?m*24:0)+$F("mhp")+", "+c+$F("mmp")+", "+l+$F("msp")+"</div>"].join("")}var marketCurrenciesChecked=0;function changeMarketsCurrencies(b){var a=$J(b.options[b.selectedIndex]).attr("val");if(marketCurrenciesChecked!=a){setCookie("marketTimescale",a,YEAR,false);marketCurrenciesChecked=a;document.location.href="/forex-market/currencies/"+a}}function calendarEventUpdateToSymbolChartAnalysis(g){var o=g.eventData;var l=g.oid;var c=g.date;if(hasText(o)){var b="event"+l;jQuery("#"+b).remove();jQuery("#"+b+"url").remove();jQuery("#chartTooltipEvents").append(o);var f=g.volatility;var k="events"+f;var d=marketObject.getEventMarkerById(k,b);var r=marketObject.getEventMarkersGroupById(k).events;if(r!=null){if(d!=null){var m=r.indexOf(d);if(m>-1){r.splice(m,1);marketObject.removeEventMarker(k,b)}}var q=Number($F("userTimezoneOffset"))*1000*60;var h=new Date(c+(q));var a={date:h,id:b,attributes:{id:b}};r.push(a);marketObject.addEventMarker(k,a);marketObject.commitEventMarkersChanges()}}}var Help={};Help.Methods={getTranslation:function(b,c){b=jsTranslationMap[b];if(typeof c!="undefined"){for(var a=0;a<c.length;a++){b=b.replace(/{.}/,c[a])}}return b},getAttribute:function(b,a){return b.getAttribute(a)},setInnerHTML:function(b,a){$(b).innerHTML=a},hideElementFunction:function(b){try{$(b).style.display="none"}catch(a){}},showElementFunction:function(b){try{$(b).style.display=""}catch(a){}}};try{var $J=jQuery.noConflict();$J.fn.isExist=function(){return jQuery(this).length>0}}catch(e){}var $T=Help.Methods.getTranslation;var $AT=Help.Methods.getAttribute;var $S=Help.Methods.setInnerHTML;var $SE=Help.Methods.setInnerHTMLElement;var $HDE=Help.Methods.hideElementFunction;var $SHE=Help.Methods.showElementFunction;var busy=false;var cellTypes=["url","yield","absYield","daily","monthly","drawdown","balance","equity","profit","swap","deposits","withdrawals","totalTrades","profitability","pips","bestTradeCurrency","worstTradeCurrency","avgWinPips","avgLossPips","avgWinCurrency","avgLossCurrency","sizing","commissions","longsWon","shortsWon","pipsHighest","pipsLowest","totalTradeTime","profitFactor","deviation","sharpeRatio","zScore","expectancy","ahpr","ghpr","systemType","tradingType","lastUpdateDate"];var commentsName=["comment2","comment3","comment4","comment5"];var fxVars={tags:{},addUpdateAccount:"/secure/addUpdateAccount.xml?",checkMtLogin:"/secure/check-mt-login.xml?id=",tryMtLogin:"/secure/try-mt-login.xml?",switchPublish:"/secure/switchPublish.xml?old=",deleteAccount:"/secure/delete-account.xml?oid=",deleteStrategy:"/secure/delete-strategy.xml?oid=",addPost:"/secure/addPost.html?",editPost:"/secure/editPost.html?",deletePost:"/secure/deletePost.html?oid=",deleteTopic:"/secure/deleteTopic.html?oid=",moveTopic:"/moveTopic.html?",addAccountWatchUrl:"/secure/watch.json?type=1&oid=",autoCompleters:{},changeEmailUrl:"/secure/sendChangeEmail.xml?",changePasswordUrl:"/secure/changePassword.xml?",getUserId:"/getUserId.xml?username=",deleteMessageUrl:"/secure/deleteMessage.html?",findUserUrl:"/finduser.xml",flashStyle:{},forgotPasswordUrl:"/forgot.xml?",inboxReply:"/secure/inboxReply.html?",loginUrl:"/login.html?",pagingUrl:"/paging.html",generateOwnerKey:"/secure/generate-owner-key.xml?",removeAccountWatchUrl:"/secure/watch.json?type=0&oid=",regUrl:"/regform.xml?",resendActivationUrl:"/reactivate.xml?",resetPasswordUrl:"/resetpass.html?",userInfo:"/userInfo.xml?",rateEA:"/secure/rateEA.json?",rateSignal:"/secure/rateSignal.json?",rateBroker:"/secure/rateBroker.json?",searchSystems:"/searchSystems.html?",getPostById:"/getPost.html?postId=",reportAbuse:"/secure/abuse.html?postId=",getAccountForm:"/secure/getAccountForm.html?accountId=",topicSubscribe:"/secure/topicSubscribe.html?",topicUnsubscribe:"/secure/topicUnsubscribe.html?",deleteNotification:"/secure/deleteNotification.xml?id=",vote:"/secure/voteSuggestion.json?",reportBug:"/reportBug.xml?",contact:"/contactSend.html?",saveEmailSettings:"/secure/saveEmailSettings.html?",twitterUpdate:"/secure/twitter-update.html?",twitterUrl:"/secure/twitter-url.xml?accountId=",twitterReset:"/secure/twitter-reset.xml?id=",subscriptionDelete:"/secure/subscriptionDelete.html?",updateAdvanced:"/getAdvancedStatistics.json?",updateAdvancedStrategy:"/getStrategyAdvancedStatistics.xml?",accountInvitation:"/secure/account-invitation.xml?",generateInvitation:"/secure/generate-invitation.xml?",commentTrade:"/secure/commentTrade.xml?",commentStrategy:"/secure/comment-strategy.xml?",refreshDashboard:"/secure/refresh-dashboard.xml?newsLastTime=",customStartDate:"/secure/customStart.xml?",customMagics:"/secure/customMagics.xml?",addPortfolio:"/secure/add-portfolio.xml?name=",deletePortfolio:"/secure/delete-portfolio.xml?id=",setAccountPortfolio:"/secure/set-account-portfolio.json?",updatePortfolioName:"/secure/update-portfolio.xml?",saveTranslation:"/secure/save-translation.xml?",editTranslation:"/secure/edit-translation.xml?",getAccountTwitter:"/secure/get-account-twitter.xml?id=",setDefaultTwitter:"/secure/set-default-twitter.xml?id=",voteTranslation:"/secure/vote-translation.xml?id=",contestRegister:"/secure/contest-register.xml?",contestStatus:"/secure/contest-status.xml?id=",contestSubscribe:"/secure/contest-subscribe.xml?",contestActivity:"/contest-activity.xml?",calendarNotification:"/secure/calendarNotification.xml?oid=",saveEmailMinAlert:"/calendarEmailMinAlert.xml?min=",changeLanguage:"/secure/change-language.json?locale=",addStrategy:"/secure/add-strategy.xml?",addStrategyGroup:"/secure/add-strategy-group.xml?",getGroupStrategies:"/secure/get-group-strategies.xml?",removeStrategyGroup:"/secure/remove-strategy-group.xml?",updateStrategy:"/secure/update-strategy.xml?",rateUser:"/secure/rate-user.json?",boardAdd:"/secure/board-add.xml?",groupAdd:"/secure/add-group.xml?",groupRemove:"/secure/remove-group.xml?id",groupRequest:"/secure/group-request.xml?id=",groupRemoveUser:"/secure/remove-group-user.xml?id=",groupUpdateRequest:"/secure/update-group-request.xml?id=",bumpBoard:"/secure/bump-board.xml?id=",groupPost:"/secure/group-post.xml?id=",deleteBoardAd:"/secure/delete-board-ad.xml?id=",closeAccount:"/secure/close-account.xml?",calendarClick:"/calendar-click.html?",blockUser:"/secure/block-user.html?",removeUserBlock:"/secure/remove-block-user.html?oid=",forexNews:"/streaming-forex-news.html?lTime=",getCompareAccount:"/getCompareAccount.xml?id=",saveCompare:"/secure/save-comparison.xml?ids=",loadComparison:"/load-comparison.xml?id=",removeComparison:"/secure/remove-comparison.xml?id=",addRemoveWatch:"/secure/update-watch.json?type=1&oid=",tradeDiary:"/secure/tradeDiary.xml?",rateTopics:"/secure/rateTopics.xml?",createOrderTag:"/secure/createOrderTag.xml?",addOrderTagMap:"/secure/addOrderTagMap.xml?",deleteOrderTag:"/secure/deleteOrderTag.xml?&oid=",updateOrderTag:"/secure/updateOrderTag.xml?",rateVps:"/secure/rateVps.json?",rateTradingPlatform:"/secure/rateTradingPlatform.json?",rateEap:"/secure/rateEap.json?",updateQuotes:"/secure/updateQuotes.xml?quotes=",searchProfile:"/secure/addSearchProfile.xml?",quotes:"/quotes.xml?symbolId=",spreadsData:"/spreadsData.json?serverId=",updateSpreadMenu:"/updateSpreadMenu.json?",removeProfile:"/secure/removeProfile.xml?profileId=",commentWatch:"/secure/commentWatch.json?",updatePortfolioOverallFilter:"/secure/updatePortfolioOverallFilter.json?filters=",deleteAllNotifications:"/secure/deleteAllNotifications.json?",getGeneralData:"/getToolbarData.json?showSymbolsTop=",showToolbar:"/showToolbar.json?showToolbar=",getWallPosts:"/secure/getWallPosts.json?user=",addWallPost:"/secure/addWallPost.json?",searchTranslate:"/secure/searchTranslate.json?",searchTranslateVote:"/secure/vote-translations.json?",removeWallPosts:"/secure/removeWallPosts.json?id=",editWallPosts:"/secure/editWallPosts.json?",showMoreWallPosts:"/showMoreWallPosts.json?",addOandaAccount:"/secure/add-oanda-account.json?",checkOandaLogin:"/secure/check-oanda-login.json?id=",getSpreadRange:"/getSpreadRange.json?serverId=",getQuotes:"/getQuotes.json?timeScale=",editRemoveGoal:"/secure/editRemoveGoal.json?",addGoal:"/secure/addGoal.json?",getTradeBrowserInfo:"/getTradeBrowserInfo.json?",getTradeConfigInfo:"/getTradeConfigInfo.json?",updatePortfolioSettings:"/secure/updatePortfolioSettings.json?",contestResendMail:"/secure/contest-resend-mail.json?id=",getTradePaging:"/tradePaging.json?",saveChartProfile:"/saveChartProfile.json?",loadChartProfile:"/loadChartProfile.json?oid=",changeTopicLockStatus:"/admin/lock-topic.html?oid=",saveChart:"/saveChart.json?",loadChart:"/loadChart.json?",changeTopicLockStatus:"/admin/lock-topic.html?oid=",saveCharts:"/secure/saveCharts.json?",removeChart:"/secure/removeChart.json?chartId=",updatePublishChart:"/secure/updatePublishChart.json?oid=",rateRebateProgram:"/secure/rateRebateProgram.json?",ratePamm:"/secure/ratePamm.json?",saveChart:"/saveChart.json?",removeChartProfile:"/removeChartProfile.json?profileId=",updatePublicProfile:"/updatePublicProfile.json?oid=",newChart:"/newChart.json?",getPublishCharts:"/getPublishCharts.json?",voteForChart:"/secure/voteForChart.json?chartId=",addTemplate:"/secure/addTemplate.json?",removeTemplate:"/secure/removeTemplate.json?templateId=",getAccountTracking:"/getAccountTracking.json?oid=",updateChartSubscribers:"/secure/updateChartSubscribers.json?subscribe=",updateNotifications:"/secure/updateNotifications.json?",getChartsMenu:"/secure/getChartsMenu.json?",addAccountNotification:"/secure/addAccountNotification.json?",getAccountNotification:"/secure/getAccountNotification.json?",editRemoveAccountNotification:"/secure/editRemoveAccountNotification.json?",getPostComments:"/getPostComments.json?postId=",getWallPosts:"/secure/getWallPosts.json?",getWallPostsBetweenOids:"/secure/getWallPostsBetweenOids.json?",saveChartScreenshot:"/saveChartScreenshot.json?",feedSubscribe:"/secure/feedSubscribe.json?toUid=",feedUnsubscribe:"/secure/feedUnsubscribe.json?toUid=",feedSubscriptionDelete:"/secure/feedSubscriptionDelete.json?oid=",getChartsActivity:"/getChartsActivity.json?lastActivity=",settingsAddAccountSwitch:"/secure/settingsAddAccountSwitch.json?type=",getRecentCharts:"/getRecentCharts.json?date=",getRecentActivity:"/getRecentActivity.json?oid=",getChartQuotes:"/getChartQuotes.json?oid=",getChartVotesOrFollowing:"/getChartVotesOrFollowing.json?chartOid=",getSymbolAnalysisConfig:"/getSymbolAnalysisConfig.json?symbol=",getSymbolAnalysis:"/getSymbolAnalysis.json?timeScale=",getSymbolOutlookConfig:"/symbolOutlookConfig.json?",updateMarketSymbolMenu:"/updateMarketSymbolMenu.json?",getHistoricalDataByDate:"/getHistoricalDataByDate.json?",updateUserCalendarBubble:"/secure/updateUserCalendarBubble.json?show=",volatilityCharts:"/volatilityCharts.json?",changeInboxSubscribe:"/secure/change-inbox-subscribe.json?",updateCorrelationSymbolMenu:"/updateCorrelationSymbolMenu.json?",getCorrelationConfig:"/getCorrelationConfig.json?rowSymbol=",getSymbolCorrelationByTime:"/getSymbolCorrelationByTime.json?timeScale=",getTopCorrelationByTimeScale:"/getTopCorrelationByTimeScale.json?",getTopCorrelationCharts:"/getTopCorrelationCharts.json?",getSwapChartBySymbolInfo:"/get-swap-chart-by-symbol.json?",changeBrokerSwapsSymbols:"/change-broker-swaps-symbols.json?",addOrDeleteMasterToSlave:"/secure/addOrDeleteMasterToSlave.json?",updateMultiplier:"/secure/updateMultiplier.json?oid=",saveUserDashboardOrder:"/secure/saveDashboardOrder.json?orderList=",getActivity:"/get-activity.json?lastOid=",updateInboxNotifications:"/secure/updateInboxNotifications.json?",getAutoTradeConfirmData:"/secure/getAutoTradeConfirmData.json?",addPendingAutoTradeProvider:"/secure/addPendingAutoTradeProvider.json?accountOid=",getUserVouchers:"/getUserVouchers.json?uid=",removeSlaveAccount:"/secure/removeSlaveAccount.json?slaveAccountOid=",saveUserPortfolioMenuOrder:"/secure/saveUserPortfolioMenuOrder.json?orderList=",openLiveAccount:"/secure/openLiveAccount.json?accountId=",getAccountRisk:"/secure/getAccountRisk.json?accountOid=",loadOpenTrades:"/loadAccount.json?chartId=",setOpenTrades:"/secure/setAccountToChart.json?accountOid=",closePosition:"/secure/closePosition.json?accountOid=",getCOTConfig:"/get-cot-config.json?symbolOid=",addPaymentSettingsConfirmation:"/secure/addPaymentSettingsConfirmation.json?",addPayment:"/secure/addPayment.json?",getMoreCalendarEvents:"/get-more-calendar-events.json?pageNumber=",saveAutoTradeQuestionnaire:"/saveAutoTradeQuestionnaire.json?accountOid=",getCalendarNextDayEvents:"/get-calendar-next-day-events.json?",updateSignalTraderSettings:"/secure/updateSignalTraderSettings.json?",pauseMasterForSlave:"/secure/pauseMasterForSlave.json?",updateLiveAccountPassword:"/secure/updateLiveAccountPassword.json?accountOid=",checkMtLoginUpdatePass:"/secure/check-mt-login-update-pass.json?accountOid=",signalTraderSettingsExist:"/secure/signalTraderSettingsExist.json?",updateInvestorPassword:"/secure/updateInvestorPassword.json?accountOid=",openDemo:"/secure/openDemo.json?",getContestAnalysisCharts:"/getContestAnalysisCharts.json?contestOid=",tryDukascopyLogin:"/secure/try-dukascopy-login.json?",checkDukascopyLogin:"/secure/check-dukascopy-login.json?login=",getSimulatorChart:"/getSimulatorChart.json?",addCtraderAccount:"/secure/add-ctrader-account.json?",checkCtraderLogin:"/secure/check-ctrader-login.json?id=",saveSimulatorUserSettings:"/secure/saveSimulatorUserSettings.json?",deleteSimulatorUserSettings:"/secure/deleteSimulatorUserSettings.json?",setSimulationAsAutoTradePortfolio:"/secure/setSimulationAsAutoTradePortfolio.json?",addContact:"/secure/addContact.json?",approveOrDisapproveContact:"/secure/approveOrDisapproveContact.json?",getChatHistory:"/secure/getChatHistory.json?",updateLastChatVisibleDate:"/secure/updateLastChatVisibleDate.json?",brokerManageSave:"/brokerManageSave.json?",brokerManageSearch:"/brokerManageSearch.json?",updateOutlookSymbolsFilter:"/secure/updateOutlookSymbolsFilter.json?filters=",autoCompleteSearch:"/autoCompleteSearch.json",getUserPositionsSlippage:"/secure/getUserPositionsSlippage.json?",addTradesBlogComment:"/secure/addTradesBlogComment.json?",getAccountMagics:"/secure/get-account-magics.json?oid=",saveSlaveSettings:"/secure/saveSlaveSettings.json?",getOutlookNotification:"/secure/getOutlookNotification.json?",addUpdateOutlookNotification:"/secure/addUpdateOutlookNotification.json?",removeOutlookNotification:"/secure/removeOutlookNotification.json?",refreshDashSystemsTable:"/secure/refreshDashSystemsTable.json?",getStrategiesPerPage:"/secure/getStrategiesPerPage.json?",changeOutlookSymbols:"/changeOutlookSymbols.json?",updateIndicatorsTable:"/updateIndicatorsTable.json?",refreshIndicatorsTable:"/refreshIndicatorsTable.json?",refreshIndicatorSingleTable:"/refreshIndicatorSingleTable.json?",updateSingleIndicatorTable:"/updateSingleIndicatorTable.json?",brokerBackendLogin:"/brokerBackendLogin.html?",updateDashboardWatchedFilter:"/secure/updateDashboardWatchedFilter.json?filters=",declineProvider:"/secure/declineProvider.json?",getMarketNotification:"/secure/getMarketNotification.json?",addUpdateMarketNotification:"/secure/addUpdateMarketNotification.json?",removeMarketNotification:"/secure/removeMarketNotification.json?",newsRedirect:"/news-redirect.json?",calendarMultiNotification:"/calendarMultiNotification.json?",resendOrCancelPaymentSettings:"/secure/resendOrCancelPaymentSettings.json?",addUpdateTechnicalNotification:"/secure/addUpdateTechnicalNotification.json?",getTechnicalNotification:"/secure/getTechnicalNotification.json?",deleteTechnicalNotifications:"/secure/deleteTechnicalNotifications.json?",getTechnicalNotificationSymbolSavedTimeFrames:"/secure/getTechnicalNotificationSymbolSavedTimeFrames.json?",deletePostAttachment:"/secure/deletePostAttachment.json?",rateBinaryBroker:"/secure/rateBinaryBroker.json?",sendTrySignalStart:"/secure/sendTrySignalStart.json?",getSpreadsByType:"/getSpreadsByType.json?"};Array.prototype.______array="______array";window.dhtmlHistory={isIE:false,isOpera:false,isSafari:false,isKonquerer:false,isGecko:false,isSupported:false,create:function(d){var h=this;var g=navigator.userAgent.toLowerCase();var a=navigator.platform.toLowerCase();var k=navigator.vendor||"";if(k==="KDE"){this.isKonqueror=true;this.isSupported=false}else{if(typeof window.opera!=="undefined"){this.isOpera=true;this.isSupported=true}else{if(typeof document.all!=="undefined"){this.isIE=true;this.isSupported=true}else{if(k.indexOf("Apple Computer, Inc.")>-1){this.isSafari=true;this.isSupported=(a.indexOf("mac")>-1)}else{if(g.indexOf("gecko")!=-1){this.isGecko=true;this.isSupported=true}}}}}window.historyStorage.setup(d);if(this.isSafari){this.createSafari()}else{if(this.isOpera){this.createOpera()}}var b=this.getCurrentLocation();this.currentLocation=b;if(this.isIE){this.createIE(b)}var f=function(){h.firstLoad=null};this.addEventListener(window,"unload",f);if(this.isIE){this.ignoreLocationChange=true}else{if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.ignoreLocationChange=true;this.firstLoad=true;historyStorage.put(this.PAGELOADEDSTRING,true)}else{this.ignoreLocationChange=false;this.fireOnNewListener=true}}var c=function(){h.checkLocation()};setInterval(c,100)},initialize:function(){if(this.isIE){if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.fireOnNewListener=false;this.firstLoad=true;historyStorage.put(this.PAGELOADEDSTRING,true)}else{this.fireOnNewListener=true;this.firstLoad=false}}},addListener:function(a){this.listener=a;if(this.fireOnNewListener){this.fireHistoryEvent(this.currentLocation);this.fireOnNewListener=false}},addEventListener:function(c,b,a){if(c.addEventListener){c.addEventListener(b,a,false)}else{if(c.attachEvent){c.attachEvent("on"+b,function(){a(window.event)})}}},add:function(c,d){if(this.isSafari){c=this.removeHash(c);historyStorage.put(c,d);this.currentLocation=c;window.location.hash=c;this.putSafariState(c)}else{var b=this;var a=function(){if(b.currentWaitTime>0){b.currentWaitTime=b.currentWaitTime-b.waitTime}c=b.removeHash(c);if(document.getElementById(c)&&b.debugMode){var f="Exception: History locations can not have the same value as _any_ IDs that might be in the document, due to a bug in IE; please ask the developer to choose a history location that does not match any HTML IDs in this document. The following ID is already taken and cannot be a location: "+c;throw new Error(f)}historyStorage.put(c,d);b.ignoreLocationChange=true;b.ieAtomicLocationChange=true;b.currentLocation=c;window.location.hash=c;if(b.isIE){b.iframe.src="/pages/blank.html?"+c}b.ieAtomicLocationChange=false};window.setTimeout(a,this.currentWaitTime);this.currentWaitTime=this.currentWaitTime+this.waitTime}},isFirstLoad:function(){return this.firstLoad},getVersion:function(){return"0.6"},getCurrentLocation:function(){var a=(this.isSafari?this.getSafariHash():this.getCurrentHash());return a},getCurrentHash:function(){var b=window.location.href;var a=b.indexOf("#");return(a>=0?b.substr(a+1):"")},PAGELOADEDSTRING:"DhtmlHistory_pageLoaded",listener:null,waitTime:200,currentWaitTime:0,currentLocation:null,iframe:null,safariHistoryStartPoint:null,safariStack:null,safariLength:null,ignoreLocationChange:null,fireOnNewListener:null,firstLoad:null,ieAtomicLocationChange:null,createIE:function(a){this.waitTime=400;var b=(historyStorage.debugMode?"width: 800px;height:80px;border:1px solid black;":historyStorage.hideStyles);var d="rshHistoryFrame";var c='<iframe frameborder="0" id="'+d+'" style="'+b+'" src="/blank.html?'+a+'"></iframe>';document.write(c);this.iframe=document.getElementById(d)},createOpera:function(){this.waitTime=400;var a='<img src="javascript:location.href=\'javascript:dhtmlHistory.checkLocation();\';" style="'+historyStorage.hideStyles+'" />';document.write(a)},createSafari:function(){var f="rshSafariForm";var d="rshSafariStack";var c="rshSafariLength";var b=historyStorage.debugMode?historyStorage.showStyles:historyStorage.hideStyles;var a=(historyStorage.debugMode?"width:800px;height:20px;border:1px solid black;margin:0;padding:0;":historyStorage.hideStyles);var g='<form id="'+f+'" style="'+b+'"><input type="text" style="'+a+'" id="'+d+'" value="[]"/><input type="text" style="'+a+'" id="'+c+'" value=""/></form>';document.write(g);this.safariStack=document.getElementById(d);this.safariLength=document.getElementById(c);if(!historyStorage.hasKey(this.PAGELOADEDSTRING)){this.safariHistoryStartPoint=history.length;this.safariLength.value=this.safariHistoryStartPoint}else{this.safariHistoryStartPoint=this.safariLength.value}},getSafariStack:function(){var a=this.safariStack.value;return historyStorage.fromJSON(a)},getSafariState:function(){var a=this.getSafariStack();var b=a[history.length-this.safariHistoryStartPoint-1];return b},getSafariHash:function(){var a=window.location.hash;return a.substring(a.indexOf("#")+1,a.length)},putSafariState:function(b){var a=this.getSafariStack();a[history.length-this.safariHistoryStartPoint]=b;this.safariStack.value=historyStorage.toJSON(a)},fireHistoryEvent:function(a){var b=historyStorage.get(a);this.listener.call(null,a,b)},checkLocation:function(){if(!this.isIE&&this.ignoreLocationChange){this.ignoreLocationChange=false;return}if(!this.isIE&&this.ieAtomicLocationChange){return}var a=this.getCurrentLocation();if(a==this.currentLocation){return}this.ieAtomicLocationChange=true;if(this.isIE&&this.getIframeHash()!=a){this.iframe.src="/pages/blank.html?"+a}else{if(this.isIE){return}}this.currentLocation=a;this.ieAtomicLocationChange=false;this.fireHistoryEvent(a)},getIframeHash:function(){var b=this.iframe.contentWindow.document;var a=String(b.location.search);if(a.length==1&&a.charAt(0)=="?"){a=""}else{if(a.length>=2&&a.charAt(0)=="?"){a=a.substring(1)}}return a},removeHash:function(b){var a;if(b===null||b===undefined){a=null}else{if(b===""){a=""}else{if(b.length==1&&b.charAt(0)=="#"){a=""}else{if(b.length>1&&b.charAt(0)=="#"){a=b.substring(1)}else{a=b}}}}return a},iframeLoaded:function(a){if(this.ignoreLocationChange){this.ignoreLocationChange=false;return}var b=String(a.search);if(b.length==1&&b.charAt(0)=="?"){b=""}else{if(b.length>=2&&b.charAt(0)=="?"){b=b.substring(1)}}window.location.hash=b;this.fireHistoryEvent(b)}};var p=dhtmlHistory.getCurrentLocation();if(p.length!=0&&window.location.pathname.indexOf("/settings")==-1&&window.location.pathname.indexOf("/faq")==-1&&window.location.pathname.indexOf("/help")==-1&&window.location.pathname.indexOf("/widgets")==-1){if(window.location.pathname.indexOf("/translations/")!=-1||window.location.pathname.indexOf("/board/")!=-1){window.location=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")+1)+gup("p")}else{if(window.location.pathname.indexOf("/forex-charts")!=-1){window.location="/forex-charts/"+p}else{if(window.location.pathname.indexOf("/systems")!=-1){window.location=window.location.pathname+p}else{if(window.location.pathname.indexOf("/forex-brokers")!=-1){window.location=window.location.pathname+p}else{window.location=window.location.pathname.substring(0,window.location.pathname.lastIndexOf(",")+1)+gup("p")}}}}}window.historyStorage={setup:function(b){if(typeof b!=="undefined"){if(b.debugMode){this.debugMode=b.debugMode}if(b.toJSON){this.toJSON=b.toJSON}if(b.fromJSON){this.fromJSON=b.fromJSON}}var d="rshStorageForm";var g="rshStorageField";var a=this.debugMode?historyStorage.showStyles:historyStorage.hideStyles;var f=(historyStorage.debugMode?"width: 800px;height:80px;border:1px solid black;":historyStorage.hideStyles);var c='<form id="'+d+'"><textarea id="'+g+'" style="'+f+'"></textarea></form>';document.write(c);this.storageField=document.getElementById(g);if(typeof window.opera!=="undefined"){this.storageField.focus()}},put:function(a,b){this.assertValidKey(a);if(this.hasKey(a)){this.remove(a)}this.storageHash[a]=b;this.saveHashTable()},get:function(a){this.assertValidKey(a);this.loadHashTable();var b=this.storageHash[a];if(b===undefined){b=null}return b},remove:function(a){this.assertValidKey(a);this.loadHashTable();delete this.storageHash[a];this.saveHashTable()},reset:function(){this.storageField.value="";this.storageHash={}},hasKey:function(a){this.assertValidKey(a);this.loadHashTable();return(typeof this.storageHash[a]!=="undefined")},isValidKey:function(a){return(typeof a==="string")},showStyles:"border:0;margin:0;padding:0;",hideStyles:"left:-1000px;top:-2000px;padding:0;position:absolute;display:block;",debugMode:false,storageHash:{},hashLoaded:false,storageField:null,assertValidKey:function(a){var b=this.isValidKey(a);if(!b&&this.debugMode){throw new Error("Please provide a valid key for window.historyStorage. Invalid key = "+a+".")}},loadHashTable:function(){if(!this.hashLoaded){var a=this.storageField.value;if(a!==""&&a!==null){this.storageHash=this.fromJSON(a);this.hashLoaded=true}}},saveHashTable:function(){this.loadHashTable();var a=this.toJSON(this.storageHash);this.storageField.value=a},toJSON:function(a){return a.toJSONString()},fromJSON:function(a){return a.parseJSON()}};function getCookie(b){if(document.cookie.length>0){var c=document.cookie.indexOf(b+"=");if(c!=-1){c=c+b.length+1;var a=document.cookie.indexOf(";",c);if(a==-1){a=document.cookie.length}return unescape(document.cookie.substring(c,a))}}return""}function getSessionUserName(){var a=getCookie("username");if(a==null||a.length==0){a=""}return a}function $is(a){return typeof a!="undefined"}function $I(b,c,a){b=$(b);if(!b){return null}var d=(["input","textarea","option"].include(b.tagName.toLowerCase()))?"value":"innerHTML";return $is(c)?(a)?b[d]+=c:b[d]=c:b[d]}function initTags(b,a){if(fxVars.tags[b]){return}var d=$(a.tagsField);if(!d){return}fxVars.tags[b]=Object.extend({tags:{},autoTags:{},tagsOrder:[],deletedTags:{}},a);d.observe("keydown",removeTagOnBackspace.bindAsEventListener(this,b),false);if(a.autoCompleter){a.autoCompleter(b,a.tagsField,a.tagsAutoCompleterDropDown,{type:a.tagsType,updateElement:addTagFromAutoComplete,updateElementParam:a.autoCompleteParams,indicator:false,offsetTop:a.offsetTop,offsetLeft:a.offsetLeft})}if(a.allowEmails){d.observe("keyup",addEmailTag.bindAsEventListener(this,b),false)}if(a.autoTagger){fxVars.tags[b].timer=null;fxVars.tags[b].storedTexts={};for(var c=0;c<a.textFields.length;c++){fxVars.tags[b].storedTexts[a.textFields[c]]="";$(a.textFields[c]).observe("keyup",autoTaggerKeyStroke.bindAsEventListener(this,b),true)}}if(!a.fieldAutoGrow){fxVars.tags[b].fieldAutoGrow=0}}function addTagFromAutoComplete(b,d){var a,c;if(d.object){a=b.innerHTML.stripScripts().stripTags();c=d.object[a]}else{a=b.getAttribute(d.key);c=b.getAttribute(d.value)}$I(fxVars.tags[d.name].tagsField,"");addTag(d.name,a,c,false)}function addTag(c,f,h,g){if(fxVars.tags[c].deniedTags&&fxVars.tags[c].deniedTags.include(f)){return}if(fxVars.tags[c].tags[f]){flashStyle("tag"+sterilizeTagValue(f),3,350,"border","1px solid #6d6d6d","1px solid #e2e1e1");return}if(fxVars.tags[c].maxTags&&fxVars.tags[c].tagsOrder.length>=fxVars.tags[c].maxTags){var b=fxVars.tags[c].tagsOrder[0];removeTag(c,b,g,true)}fxVars.tags[c].tags[f]=h;if(g){fxVars.tags[c].autoTags[f]=h}fxVars.tags[c].tagsOrder.push(f);var a=new Element("li",{id:"tag"+sterilizeTagValue(f),className:"tagItem"});a.innerHTML="<span><em>"+f+'</em><a href="javascript:void(0)" class="closer floatLeft" onclick="removeTag(\''+c+"', '"+f+"', false, false)\"></a></span>";var d=$(fxVars.tags[c].tagsList);d.insertBefore(a,d.down(fxVars.tags[c].insertTagBefore||"li.floatLeft"));if(fxVars.tags[c].callback){fxVars.tags[c].callback(c,f,h,true)}if(fxVars.tags[c].fieldbaseWidth){$(fxVars.tags[c].tagsField).setStyle({width:fxVars.tags[c].fieldbaseWidth+"px"})}}function addEmailTag(a,b){if(a.keyCode!=32){return}var c=Event.element(a).value.replace(/[\s,;]/g,"");if(!cfv.cond.is_email(c)){return}addTag(b,c,c,true);$I(fxVars.tags[b].tagsField,"")}function removeTag(c,f,b,d){var a=$("tag"+sterilizeTagValue(f));if(!a){return}a.remove();var g=fxVars.tags[c].tags[f];if(!b){fxVars.tags[c].deletedTags[f]=fxVars.tags[c].tags[f]}delete fxVars.tags[c].tags[f];delete fxVars.tags[c].autoTags[f];fxVars.tags[c].tagsOrder=fxVars.tags[c].tagsOrder.without(f);if(!d&&fxVars.tags[c].callback){fxVars.tags[c].callback(c,f,g,false)}}function removeTagOnBackspace(b,c){var d=Event.element(b);if(fxVars.tags[c].fieldAutoGrow&&d.value.length>fxVars.tags[c].fieldAutoGrow){d.setStyle({width:(8*d.value.length)+"px"})}if(b.keyCode!=Event.KEY_BACKSPACE||d.value!=""){return}var a=fxVars.tags[c].tagsOrder.length;if(a>0){removeTag(c,fxVars.tags[c].tagsOrder[a-1],false,false)}}function clearTags(a,d,c){while(fxVars.tags[a].tagsOrder.length>0){var b=fxVars.tags[a].tagsOrder[0];if(!d||(d&&fxVars.tags[a].autoTags[b])){removeTag(a,b,d,c)}}fxVars.tags[a].deletedTags={}}function sterilizeTagValue(a){return a.replace(/[\s\/@\(\)]/g,"_")}function focusRecipientsCont(a){$("composeTo").focus();$(a).removeClassName("fieldX")}function setQueryBold(str,query){return str.replace(eval("/"+query.replace(/[.]/g,"\\.")+"/i"),"<span class='orange'><b>$&</b></span>")}function getSetParam(c,g){var f=location.search.toString();if(!f){return null}f=f.substring(1).split("&");var a,d=false;for(var b=0;b<f.length;b++){a=f[b].split("=");if(c==a[0]){if(typeof g=="undefined"){return a[1]}f[b]=c+"="+g;d=true;break}}if(!d){f.push(c+"="+g)}f="?"+f.join("&");return(typeof g=="undefined")?f:""}function initComposeField(){initTags("compose",{tagsField:"composeTo",tagsList:"toUL",callback:setIds,autoCompleter:createAutoCompleter,offsetTop:2,offsetLeft:-4,tagsAutoCompleterDropDown:"composeToList",insertTagBefore:"li.floatL",autoCompleteParams:{name:"compose",value:"id",key:"membername"}});var a=getSetParam("to");if(!a){return}fxAjax.sendRequest(fxVars.getUserId+a,{contentType:"text/xml",params:{username:a},loader:true,callback:"initComposeFieldResponse"})}function initComposeFieldResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){var c=getContent(a);addTag("compose",f.username,c,false)}}function createAutoCompleter(b,c,d,a){if(!$(c)){return}Object.extend(a,{onCompleteParams:b,minChars:1,cachable:true,isAutoComplete:true,mimeType:"application/xml",method:"GET",paramName:"q",width:286,frequency:0.1,autoSelect:false,onComplete:createULForAutoComplete});fxVars.autoCompleters[b]=new Ajax.Autocompleter(c,d,fxVars.findUserUrl,a)}function createULForAutoComplete(a,d){var f=d.responseXML.getElementsByTagName("users")[0];var g=fxVars.autoCompleters[a].element.value.toLowerCase();var b=f.childNodes;var l=[];for(var c=0,h,k=b.length;c<k;c++){if(b[c].nodeType!=1){continue}l.push(['<li id="',b[c].getAttribute("id"),'" membername="',b[c].firstChild.nodeValue,'"><p class="height20">',setQueryBold(b[c].firstChild.nodeValue,g),"</p></li>"].join(""))}fxVars.autoCompleters[a].updateChoices("<ul>"+l.join("")+"</ul>");hideElement("loaderAC")}function setIds(b,c,f,a){var d=$I("ids").split(",");if(a){d.push(f)}else{d=d.without(f)}d=d.uniq().without("");$I("ids",d.join(","))}function flashStyle(){var a=$A(arguments);var c=a[0];if(a.length>1){if(fxVars.flashStyle[c]){return}fxVars.flashStyle[c]={el:$(c),times:a[1]*2,interval:a[2],prop:a[3],valueOn:a[4],valueOff:a[5]}}var b=fxVars.flashStyle[c];if(b.times%2==0){b.el.style[b.prop]=b.valueOn}else{b.el.style[b.prop]=b.valueOff}b.times--;if(b.times==0){delete fxVars.flashStyle[c]}else{setTimeout("flashStyle('"+c+"')",b.interval)}}function reloadAds(){try{_gaq.push(["_trackPageview",window.location.pathname]);googletag.pubads().refresh([slot1,slot2])}catch(a){}}function setShortcutIcon(){var a=document.createElement("link");a.type="image/x-icon";a.rel="shortcut icon";a.href="http://myfxbook.local/images/favicon.ico";document.getElementsByTagName("head")[0].appendChild(a)}function ajaxPaging(a,c,h,g,f,k,b,l){if(g){dhtmlHistory.add(a,"")}if(typeof(l)=="undefined"){l=true}var d=getComboValue("formatSlTpHistory");fxAjax.sendRequest(fxVars.pagingUrl+a,{contentType:"text/xhtml",params:{container:c,runAjaxScripts:f,reloadAds:k,scrollToTop:b,slTpOption:d},loader:l,callback:"ajaxPagingResponse"});return false}function ajaxPagingResponse(a,b){if(b.container=="postsCont"){cleanAutocompleteAll()}$(b.container).innerHTML=a;if(b.runAjaxScripts){runAjaxScripts(a)}if(quotePostId!=-1){getPost(quotePostId)}if(b.scrollToTop){Effect.ScrollTo("wrapper")}if(b.reloadAds){reloadAds()}if(b.slTpOption!=undefined){showHideSlTpOptions(b.slTpOption,"")}setShortcutIcon()}function runAjaxScripts(html){try{var temp=html;while(true){var sindex=temp.indexOf("<script");if(sindex<0){break}var eindex=temp.indexOf("<\/script>",sindex);var js=temp.substring(sindex+31,eindex);try{eval(js)}catch(e){}temp=temp.substring(eindex+9)}}catch(e){}}function showLoading(){if($("loadingTop")!=null){$("loadingTop").style.display=""}}function hideLoading(){if($("loadingTop")!=null){$("loadingTop").style.display="none"}}var fxAjax={sendRequest:function(b,a){if(!a.method){a.method="get"}if(!a.contentType){a.contentType="text/xml"}if(!a.returnJson){a.returnJson=false}b+=["&rand=",Math.random()].join("");a.onSuccess=fxAjax.handleResponse.bindAsEventListener(this,a);a.onFailure=fxAjax.handleFailure.bindAsEventListener(this,a);if(a.loader){showLoading()}new Ajax.Request(b,a)},handleResponse:function(response,options){var responseData;var contentType=response.getHeader("Content-Type");if(options.returnJson){responseData=new Object();responseData.response=response.responseXML.getElementsByTagName("response")[0];responseData.error=eval(responseData.response.getAttribute("error"));responseData.message=responseData.response.getAttribute("message");responseData.content=getContent(responseData.response)}else{if(contentType.indexOf("text/xml")!=-1){responseData=response.responseXML}else{if(contentType.indexOf("json")!=-1){responseData=hasText(response.responseText)?eval("("+response.responseText+")"):""}else{responseData=response.responseText}}}var callback=(options.callback)?eval(options.callback):null;if(typeof callback=="function"){callback(responseData,options.params)}if(options.loader){hideLoading()()}},handleFailure:function(a,b){if(b.loader){hideLoading()}}};function addPost(c,b,a){if(validate("text",VALID_TEXT)){$(a).disabled="disabled";var d=["&typeId=",c,"&topicId=",b,"&text=",encodeParameter($("text").value),"&files=",encodeParameter(filesUploaded.join(","))].join("");fxAjax.sendRequest(fxVars.addPost,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:d,method:"post",loader:true,callback:"addPostResponse"})}}function addPostResponse(b){reloadAds();$("postsCont").innerHTML=b;cleanAutocompleteAll();runAjaxScripts(b);filesUploaded=new Array();var a=$("currentPageUrl").value;if(getPageNumber()!=gup("p",a)){dhtmlHistory.add(a,null)}}function getPageNumber(){var b=dhtmlHistory.currentLocation;if(b.length!=0){return parseInt(gup("p"))}else{b=window.location.href;var c=b.substring(b.lastIndexOf("/")+1);var a=c.split(",");if(a.size()==1){return 1}return parseInt(a[1])}}function addTopic(a,b){window.location.href="/community/"+a+"/"+b+"/add"}function moveTopic(b,a){var c=$F("forumType"+a);if(c!=0){if(confirm("Move topic ?")){var d=["&typeId=",b,"&topicId=",a,"&newTypeId=",c];fxAjax.sendRequest(fxVars.moveTopic+d.join(""),{contentType:"text/xml",params:{topicId:a,newTypeId:c},loader:true,callback:"moveTopicResponse"})}else{selectOptionByValue($("forumType"+a),b)}}}function moveTopicResponse(c,d){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){alert("Topic was moved successfully ");$("forumType"+d.topicId).onchange=function(){moveTopic(d.newTypeId,d.topicId)};$("topicRow"+d.topicId).remove()}else{alert("Error, moving topic failed")}}function reloadCaptcha(){$("captchaImg").src="/Captcha.jpg?rand="+Math.random()}function addAccountWatch(a,b){fxAjax.sendRequest(fxVars.addAccountWatchUrl+[a,"&invitation=",b].join(""),{params:{oid:a,invitation:b},loader:true,callback:"addAccountWatchResponse"})}function addAccountWatchResponse(a,h){var b=a.error;var c=a.content.data;var g=a.content.menu;if(!b){$("accountsNav").innerHTML=g;runAjaxScripts(g);var f=parseInt($("totalTracking").innerHTML);$("totalTracking").innerHTML=f+1;$("buttAccountWatch").innerHTML="<span class='minus'>"+$F("rfwl")+"</span>";$("buttAccountWatch").onclick=function(){removeAccountWatchMessageSystemPage(c,false,h.invitation)};showElement("displayAccountWatchComment");$("displayComment").innerHTML=$T("tYourCommentIsEmpty");$("addComment").onclick=function(){addCommentWatch(c,"s")};showElement("commentDiv");hideElement("files");if(hasText($("tracking").innerHTML)){$("tracking").innerHTML=""}}else{var d=a.getAttribute("message");inlineMsg("buttAccountWatch","<b>Error</b><br>"+d,3)}}function removeAccountWatchMessage(b,a,c){inlineAlert($("watchRemoveButt"+b),$T("tConfirmWatchDelete"),"removeAccountWatch("+b+","+a+",'"+c+"')")}function removeAccountWatch(b,a,c){if($("totalTracking")){var d=parseInt($("totalTracking").innerHTML);$("totalTracking").innerHTML=d-1;if(hasText($("tracking").innerHTML)){$("tracking").innerHTML=""}}fxAjax.sendRequest(fxVars.removeAccountWatchUrl+b,{params:{oid:b,personal:a,invitation:c},loader:true,callback:"removeAccountWatchResponse"})}function removeAccountWatchResponse(d,c){var g=d.error;var f=d.content.data;var a=d.content.menu;if(!g){if(c.personal==undefined){hideElement("buttAccountWatch")}else{if(c.personal){var b=$("watchRemoveButt"+c.oid);var l=b.parentNode.parentNode.parentNode;var m=b.parentNode.parentNode;var k=$$("#watchTable tr[name=watchedCommentTR"+c.oid+"]")[0];l.deleteRow(m.rowIndex);l.deleteRow(k.rowIndex);m.hide();var h=parseInt($("watchedTotalSpan").innerHTML);$("watchedTotalSpan").innerHTML=h-1;if(l.rows.length==1){$("watched").innerHTML='<div class="padd10 center"><span class="information">'+$F("nwasl")+"</span></div>"}SortableTable.find()}else{$("buttAccountWatch").innerHTML="<span class='plus'>"+$F("atwl")+"</span>";$("buttAccountWatch").onclick=function(){addAccountWatch(f,c.invitation)};$("files").innerHTML="";$("sfiles").innerHTML="";$("displayAccountWatchComment").style.display="none";$("textAccountWatchComment").style.display="none";$("textComment").value="";hideElement("commentDiv")}}$("accountsNav").innerHTML=a;runAjaxScripts(a)}}function searchSystemsSort(d,c,k,b){var h=d.parentNode.parentNode.id;var a=d.getAttribute("order");var g=$(h).getElementsByTagName("td");if(a=="1"){for(i=0;i<g.length;i++){g[i].className=""}}else{for(i=0;i<g.length;i++){g[i].className=""}}var f=collectSearchParamters();dhtmlHistory.add("#?pt=6&p=1&st="+a+"&sb="+k+"&"+f.join(""),"");fxAjax.sendRequest(fxVars.pagingUrl+"?"+f.join("")+"&pt="+c+"&st="+a+"&sb="+k,{contentType:"text/html",params:b,loader:true,callback:"searchSystemsSortResponse"})}function searchSystemsSortResponse(b,a){$(a).innerHTML=b;runAjaxScripts(b)}function sortTableResponse(b,a){replaceTbodyContent(b,a)}function replaceTbodyContent(a,h){var g=$(h).innerHTML;var c=g.toLowerCase().indexOf("<tbody>")+8;var b=g.toLowerCase().indexOf("</tbody>");var f=g.substring(0,c);var d=g.substring(b,g.length);$(h).innerHTML=f+a+d}function validateContact(){if(validate("name",VALID_NAME)&&validate("email",VALID_EMAIL)&&validate("msgContact",VALID_MESSAGE)){var a=["name=",$("name").value,"&email=",$("email").value,"&subject=",$("subject").value,"&msgContact=",encodeParameter($("msgContact").value)];fxAjax.sendRequest(fxVars.contact,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:a,method:"post",params:{},loader:false,callback:"validateContactResponse"});$("contact").style.display="none";$("spinnerLoader").style.display=""}}function validateContactResponse(){$("spinnerLoader").style.display="none";$("contactRes").style.display=""}function validateAddTopic(){$("title").value=$("titleHold").value;$("text").value=$("textHold").value;$("files").value=filesUploaded.join(",");var a=validate("titleHold",VALID_TITLE)&&validate("textHold",VALID_TEXT);if(a){$("addTopicButton").disabled="disabled"}return a}function validateComposeMail(a){if(suspendedPass(a)&&validate("recipientsCont",VALID_COMPOSE_TO)&&validate("subject",VALID_TITLE)&&validate("text",VALID_TEXT)){$("idsHold").value=$F("ids");$("textHold").value=$F("text");$("subjectHold").value=$F("subject");$("files").value=getLinksTitleByName("orderFiles");$("inboxComposeForm").submit()}}function validateRegister(){if(validate("username",VALID_USER_NAME)&&validate("email",VALID_EMAIL)&&validate("password",VALID_PASSWORD)&&validate("passwordConfirm",VALID_PASSWORD_CONFIRM2)&&validate("captcha",VALID_CAPTHCA)&&validate("agree",VALID_AGREE)){register()}}function register(){$("openAccount").disabled="disabled";var a=["username=",$("username").value,"&email=",$("email").value,"&password=",encodeParameter($("password").value),"&captcha=",$("captcha").value];fxAjax.sendRequest(fxVars.regUrl+a.join(""),{contentType:"text/xml",params:{},loader:true,callback:"registerResponse"})}function registerResponse(f){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("code");var c=a.getAttribute("message");if(b=="false"){$("register").innerHTML="<div class='font12 lh18 center' style='margin-top:120px; padding: 0 20px;'>"+c+"</div>"}else{if(d==30){inlineMsg("username","<b>"+$T("tError")+"</b><br>"+c,3)}if(d==7){inlineMsg("captcha","<b>"+$T("tError")+"</b><br>"+c,3);reloadCaptcha();clearField("captcha")}if(d==13){inlineMsg("openAccount","<b>"+$T("tError")+"</b><br>"+c,3)}if(d==8||d==101){inlineMsg("email","<b>"+$T("tError")+"</b><br>"+c,3)}$("openAccount").disabled=""}}function disable(b){try{$(b).disabled="disabled"}catch(a){}}function enable(b){try{$(b).disabled=""}catch(a){}}function login(){if(validate("loginEmail",VALID_EMAIL)&&validate("loginPassword",VALID_PASSWORD)){disable("loginButton");var a=["loginEmail=",$("loginEmail").value,"&loginPassword=",encodeParameter($("loginPassword").value),"&remember=",$("remember").checked];fxAjax.sendRequest(fxVars.loginUrl+a.join(""),{contentType:"text/xml",params:{loginRedirect:gup("lr")},loader:true,callback:"loginResponse"})}}function loginResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if(hasText(f.loginRedirect)){window.location=f.loginRedirect}else{window.location=serverPath+"/dashboard"}}else{$("response").innerHTML=c;enable("loginButton")}}function resendActivation(){if(validate("emailActivation",VALID_EMAIL)){var a=["email=",$("emailActivation").value];fxAjax.sendRequest(fxVars.resendActivationUrl+a.join(""),{contentType:"text/xml",params:{},loader:false,callback:"resendActivationResponse"});$("activationCont").style.display="none";$("spinner").style.display=""}}function resendActivationResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$("spinner").style.display="none";$("activationResponse").style.display="";if(b=="false"){$("activationResponse").innerHTML=$T("tActivationEmailResent")}else{$("activationResponse").innerHTML=c}}function forgotPassword(){if(validate("emailForgot",VALID_EMAIL)){var a=["email=",$("emailForgot").value];$("forgotCont").style.display="none";$("spinner").style.display="";fxAjax.sendRequest(fxVars.forgotPasswordUrl+a.join(""),{contentType:"text/xml",params:{},loader:false,callback:"forgotPasswordResponse"})}}function forgotPasswordResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$("spinner").style.display="none";$("forgotResponse").style.display="";$("forgotResponse").innerHTML=c;$("forgotClose").style.display=""}function resetPassword(){if(validate("password",VALID_PASSWORD)&&validate("passwordConfirm",VALID_PASSWORD_CONFIRM2)){var a=["code=",$("forgotCode").value,"&id=",$("forgotId").value,"&password1=",encodeParameter($("password").value),"&password2=",encodeParameter($("passwordConfirm").value)];fxAjax.sendRequest(fxVars.resetPasswordUrl+a.join(""),{contentType:"text/xml",params:{},loader:true,callback:"resetPasswordResponse"})}}function resetPasswordResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$("resetResponse").innerHTML=c;$("resetResponse").style.display=""}function changePassword(){if(validate("oldPassword",VALID_PASSWORD)&&validate("password1",VALID_PASSWORD)&&validate("password2",VALID_PASSWORD)&&validate("password1",VALID_PASSWORD_CONFIRM)){var a=["oldPassword=",encodeParameter($("oldPassword").value),"&password1=",encodeParameter($("password1").value),"&password2=",encodeParameter($("password2").value)];fxAjax.sendRequest(fxVars.changePasswordUrl+a.join(""),{contentType:"text/xml",params:{},loader:true,callback:"changePasswordResponse"})}}function changePasswordResponse(data){var response=data.getElementsByTagName("response")[0];var error=eval(response.getAttribute("error"));$("responsePass").innerHTML=response.getAttribute("message");$("responsePass").style.display="";if(!error){$("oldPassword").value="";$("password1").value="";$("password2").value=""}}function changeEmail(){if(validate("password",VALID_PASSWORD)&&validate("email",VALID_EMAIL)){var a=["password=",encodeParameter($("password").value),"&email=",$("email").value];fxAjax.sendRequest(fxVars.changeEmailUrl+a.join(""),{contentType:"text/xml",params:{},loader:true,callback:"changeEmailResponse"})}}function changeEmailResponse(c){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");$("responseEmail").innerHTML=a.getAttribute("message");$("responseEmail").style.display="";if(!b){$("paswword").value="";$("email").value=""}}var INBOX=1;var SENT=2;var READ_INBOX=3;var READ_SENT=4;function deleteSelected(f,d){var c=new Array();var a;if(d==INBOX){a=document.getElementsByName("messagesInbox")}else{a=document.getElementsByName("messagesSent")}for(var b=0;b<a.length;b++){if(a[b].checked){c.push(a[b].value)}}if(c.length!=0){var g=["deleteMessage(","'",c.join("-"),"'",",",d,")"];inlineAlert(f,$T("tConfirmMessageDelete"),g.join(""))}}function deleteMessageVerify(b,d,a){var c=["deleteMessage(","'",d,"'",",",a,")"];inlineAlert(b.id,$T("tConfirmMessageDelete"),c.join(""))}var SELECT_NONE=0;var SELECT_READ=1;var SELECT_UNREAD=2;var SELECT_ALL=3;function selectMessages(el,from){var cb=document.getElementsByName("messages"+from);for(var i=0;i<cb.length;i++){switch(eval(el.value)){case SELECT_NONE:cb[i].checked=false;break;case SELECT_READ:cb[i].checked=cb[i].parentNode.parentNode.className.indexOf("old")!=-1;break;case SELECT_UNREAD:cb[i].checked=cb[i].parentNode.parentNode.className.indexOf("new")!=-1;break;case SELECT_ALL:cb[i].checked=true;break}}}function deleteMessage(c,a){var b=["&type=",a,"&id=",c].join("");switch(a){case INBOX:fxAjax.sendRequest(fxVars.deleteMessageUrl+b,{contentType:"text/xhtml",params:{cont:"inboxCont",id:c},loader:true,callback:"deleteResponse"});break;case SENT:fxAjax.sendRequest(fxVars.deleteMessageUrl+b,{contentType:"text/xhtml",params:{cont:"sentCont"},loader:true,callback:"deleteResponse"});break;case READ_INBOX:case READ_SENT:fxAjax.sendRequest(fxVars.deleteMessageUrl+b,{contentType:"text/xhtml",loader:true,callback:"returnToInbox"});break}}function deleteResponse(g,k){var a=g.getElementsByTagName("response")[0];var b=a.getAttribute("error");var f=a.getAttribute("message");var d=getContent(g.getElementsByTagName("data")[0]);var c=parseInt(getContent(g.getElementsByTagName("inboxCount")[0]));if(b=="false"){$(k.cont).innerHTML=d;if(c==0){$("newInboxNotification").innerHTML=0;$("newInboxNotification").className="countRed grayBG"}else{$("newInboxNotification").innerHTML=c}var h=$("aConOid"+k.id);if(h!=undefined){h.remove()}runAjaxScripts(d)}}function returnToInbox(){window.location="/inbox"}function encodeParameter(a){return(encodeURI(a).replace(/&/g,"%26").replace(/=/g,"%3D").replace(/\+/g,"%2B").replace(/#/g,"%23").replace(/\?/g,"%3F").replace(/\:/g,"%3A"))}function reply(c){if(validate("message",VALID_TEXT)){$("replyButton").disabled="disabled";var b=["&id=",c,"&message=",encodeParameter($("message").value)];var a=getLinksTitleByName("orderFiles"+c);if(hasText(a)){b.push("&files=");b.push(a)}fxAjax.sendRequest(fxVars.inboxReply,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),loader:true,callback:"replyResponse"})}}function getContent(a){try{return typeof a.textContent!="undefined"?a.textContent:a.childNodes[0].nodeValue}catch(b){return""}}function replyResponse(d){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");var d=getContent(a);if(b=="false"){$("messageCont").innerHTML=d;runAjaxScripts(d)}else{inlineMsg("message",c,3)}$("replyButton").disabled="";Tipped.hideAll()}function editAccount(a){$("oldAccountId").value=a;$("oldPassword").value=$("password"+a).innerHTML;$("oldServerId").value=$("server"+a).getAttribute("serverId");$("accountId").value=a;$("password").value=$("password"+a).innerHTML;$("serverId").selectedIndex=$("server"+a).getAttribute("serverId");if($("public"+a).getAttribute("value")=="true"){$("public").checked="checked"}else{$("public").checked=""}if($("historyPublic"+a).getAttribute("value")=="true"){$("historyPublic").checked="checked"}else{$("historyPublic").checked=""}}function borderChange(a){$(a).style.border="1px solid #FFA962"}function borderReturn(a){$(a).style.border="1px solid #e2e1e1"}function rateBroker(a){if(isRated()){var b=["brokerId="+a,"&platform=",$("platform").value,"&spreads=",$("spreads").value,"&service=",$("service").value,"&features=",$("features").value].join("");fxAjax.sendRequest(fxVars.rateBroker+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateEA(a){if(isRated()){var b=["eaId="+a,"&profitability=",$("profitability").value,"&pricing=",$("pricing").value,"&service=",$("service").value,"&use=",$("use").value].join("");fxAjax.sendRequest(fxVars.rateEA+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateSignal(a){if(isRated()){var b=["signalId="+a,"&profit=",$("profit").value,"&pricing=",$("pricing").value,"&service=",$("service").value,"&platform=",$("platform").value].join("");fxAjax.sendRequest(fxVars.rateSignal+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function voteSuggestion(b,a){var c=["topicId="+b,"&vote=",a].join("");fxAjax.sendRequest(fxVars.vote+c,{contentType:"text/xml",params:"suggestCont",loader:true,callback:"voteSuggestionResponse"})}function voteSuggestionResponse(c,a){if(!c.error){$(a).innerHTML=c.content.data;runAjaxScripts(c.content.data);var b=FusionCharts("ChartId");b.setXMLData(c.content.chartData)}}function userInfo(){var d=$("dstOn").checked;var a=$("timezoneoffset").value;var c=$("timeAutoOn");if(c!=null&&c.checked){d=false;a=getTimezoneOffset()}var b=["&countryId=",$("countryId").value,"&bio=",encodeParameter($("bio").value),"&experience=",$("experience").value,"&tradingStyle=",encodeParameter($("tradingStyle").value),"&motto=",encodeParameter($("motto").value),"&name=",encodeParameter($("name").value),"&timezone=",a,"&dst=",d,"&timeFormat=",$F("timeFormat"),"&timeAuto=",$("timeAutoOn").checked].join("");fxAjax.sendRequest(fxVars.userInfo+b,{contentType:"text/xml",params:{dst:d,timeZone:a},loader:true,callback:"userInfoResponse"})}function userInfoResponse(c,f){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");$("profileMessage").innerHTML=a.getAttribute("message");$("profileMessage").style.display="";try{$("avatarChange").style.display="none";uploadPic()}catch(d){}setTimeZoneCookie(f.timeZone);setCookie("dst",f.dst?"1":"0",YEAR,false);cookieCache={}}function uploadPic(){if($("file").value.length>4){$("profilePic").submit()}}function updateProfilePic(b,c,a){$("profileImg").src=a;try{$J("#profilePic #profileImg").attr("src",a)}catch(d){}}function validateAddAccount(){var b=$("serverId").value;var a=$("platformId").value;var c=true;if(a==0&&!$("platformId").disabled){inlineMsg("platformId",$T("tChoosePlatform"),3);c=false}else{if(b==0&&!$("serverId").disabled){inlineMsg("serverId",$T("tChooseBroker"),3);c=false}else{if(!validate("systemName",VALID_SYSTEM_NAME)){c=false}else{if(a==PLATFORM_OANDA&&!validate("url",VALID_ACCOUNT_HISTORY_URL)){c=false}else{if(c){addUpdateAccount()}}}}}}function addUpdateAccount(){$("save").disabled="disabled";var b=$("accountOid").value;var a=$("systemName").value;var d=($("accountId"))?$F("accountId"):"";var c=["&accountId=",d,"&accountOid=",b,"&serverId=",$("serverId").value,"&platformId=",$("platformId").value,"&url=",encodeParameter($("url").value),"&systemName=",encodeParameter(a),"&systemDescription=",encodeParameter($("systemDescription").value),"&systemType=",$("systemType").value,"&tradingType=",$("tradingType").value,"&type=",$("type").value,"&leverage=",$("leverage").value];if($$("[name=accountPublic]").size()>0){c.push("&accountPublic="+getRadioGroupValue("accountPublic"))}c.push("&accountNumberPublic="+getRadioGroupValue("accountNumberPublic"));c.push("&balancePublic="+getRadioGroupValue("balancePublic"));c.push("&historyPublic="+getRadioGroupValue("historyPublic"));c.push("&ordersPublic="+getRadioGroupValue("ordersPublic"));c.push("&tradesPublic="+getRadioGroupValue("tradesPublic"));c.push("&commentsPublic="+getRadioGroupValue("commentsPublic"));c.push("&sizingPublic="+getRadioGroupValue("sizingPublic"));c.push("&magicNumberPublic="+getRadioGroupValue("magicNumberPublic"));c.push("&communityPublic="+$("communityPublic").checked);c.push("&accountTagPublic="+getRadioGroupValue("accountTagPublic"));c.push("&goalsPublic="+getRadioGroupValue("goalsPublic"));c.push("&slTpPublic="+getRadioGroupValue("slTpPublic"));if($("mt4ServerId")!=null){c.push("&mt4ServerId="+$("mt4ServerId").value)}if($("investorPassword")!=null){c.push("&investorPassword="+encodeParameter($("investorPassword").value))}if($("updateIntervalBox")!=null){c.push("&updateInterval=",$F("updateIntervalBox"))}c.push(collectMagicNames());fxAjax.sendRequest(fxVars.addUpdateAccount,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:c.join(""),params:{cont:"myAccounts",name:a,oid:b},loader:true,callback:"addUpdateAccountResponse"})}function addUpdateAccountResponse(g,d){try{$("save").disabled="";var f=g.getElementsByTagName("response")[0];var c=g.getElementsByTagName("accounts")[0];var b=g.getElementsByTagName("menu")[0];var k=g.getElementsByTagName("twitterAccountsCombo")[0];var l=f.getAttribute("error");var m=f.getAttribute("message");var a=f.getAttribute("code");if(l=="false"){$("accountsDiv").innerHTML=getContent(c);$("accountsNav").innerHTML=getContent(b);$("twitterAccountComboCont").innerHTML=getContent(k);runAjaxScripts(getContent(c));runAjaxScripts(getContent(b))}else{if(a!=43){$("accountResponse").innerHTML=m}else{inlineMsg("url",m)}}reloadAds()}catch(h){}}function collectMagicNames(){var elements=document.getElementsByName("magicNumbers");var colorElements=document.getElementsByName("magicColors");var originalElements=document.getElementsByName("originalMagicNumbers");var originalColorElements=document.getElementsByName("originalMagicColors");var magicHideElement=document.getElementsByName("magicShowBox");var str=new Array();for(var i=0;i<elements.length;i++){var name=$(elements[i].id).value;var originalShowBox=$(magicHideElement[i]).value;var originalName=$(originalElements[i].id).value;var color=colorElements[i].getAttribute("hex");var originalColor=originalColorElements[i].value;var showMagic=magicHideElement[i].checked;if(name!=originalName||color!=originalColor||eval(originalShowBox)!=showMagic){str.push("&magicOids=");str.push(elements[i].id.substr(5));str.push("&magicNames=");str.push(encodeParameter(name));str.push("&magicColors=");str.push(color);str.push("&magicShow=");str.push(showMagic)}}return str.join("")}function deleteAccountVerify(g,c,f){var b=$J("#settingsAccount"+g).attr("portfolioOid");var a=$J("#settingsAccount"+g).attr("portfolioAccountOid");var h="";if(f){h=$T("tDeleteAutoTradeParticipates")+"<br/><br/>"}var d=["deleteAccount('",g,"','",b,"','",a,"')"];inlineAlert(c,h+$T("tConfirmAccountDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>",d.join(""))}function deleteAccount(c,b,a){fxAjax.sendRequest(fxVars.deleteAccount+c+"&portfolioAccountOid="+a+"&portfolioOid="+b,{contentType:"text/xml",params:{oid:c,portfolioOid:b},loader:true,callback:"deleteAccountResponse"})}function deleteAccountResponse(h,f){var g=h.getElementsByTagName("response")[0];var k=g.getAttribute("error");var l=g.getAttribute("message");var b=g.getAttribute("code");var d=h.getElementsByTagName("accounts")[0];var c=h.getElementsByTagName("menu")[0];var a=getContent(h.getElementsByTagName("slaveDeleted")[0]);if(k=="false"){$("accountsDiv").innerHTML=getContent(d);$("accountsNav").innerHTML=getContent(c);runAjaxScripts(getContent(d));runAjaxScripts(getContent(c));if(a=="true"){removeElement("autoTradeMenu"+f.oid)}}}function getRadioGroupValue(c){var a=false;var b=document.getElementsByName(c);if(b.length!=0){if(b[1].checked){a=true}}return a}function getRadioValue(c){var b=document.getElementsByName(c);for(var a=0;a<b.length;a++){if(b[a].checked){return b[a].value}}}function setSettingsActiveTab(){var a=window.location.hash;if(a.length!=0){var d=a.substring(1,a.length);var f=getSettingsActiveTab(d+"Div");var c=$("settingsTab").getElementsByTagName("li");for(var b=1;b<c.length;b++){if(f==b){c[b].className="on"}else{c[b].className="off"}}for(var b=0;b<tabs6.length;b++){if(tabs6[b]==(d+"Div")){$(tabs6[b]).style.display=""}else{$(tabs6[b]).style.display="none"}}}else{window.location.hash="accounts"}}function getSettingsActiveTab(a){if(a=="accountsDiv"){return 1}else{if(a=="privacyDiv"){return 2}else{if(a=="profileDiv"){return 3}else{if(a=="loginDetailsDiv"){return 4}else{if(a=="subscriptionsDiv"){return 5}else{if(a=="twitterDiv"){return 6}else{if(a=="invitationsDiv"){return 7}else{if(a=="blockDiv"){return 8}}}}}}}}}function switchButton(a){var c=a.parentNode;var b=c.getElementsByTagName("li");for(i=0;i<b.length;i++){if(a==b[i]){b[i].className="active"}else{b[i].className=""}}}function switchMode(b){var a=document.getElementsByClassName("control");for(i=0;i<a.length;i++){if(b==0){a[i].disabled=true}else{if(b==1){a[i].disabled=false}}}}var VALID_USER_NAME=1;var VALID_EMAIL=2;var VALID_PASSWORD=3;var VALID_NAME=4;var VALID_MESSAGE=5;var VALID_TITLE=6;var VALID_TEXT=7;var VALID_URL=8;var VALID_ACCOUNT_PASSWORD=9;var VALID_SYSTEM_NAME=10;var VALID_SERVER=11;var VALID_PASSWORD_CONFIRM=12;var VALID_AGREE=13;var VALID_COMPOSE_TO=14;var VALID_PLATFORM=15;var VALID_PASSWORD_CONFIRM2=16;var VALID_CAPTHCA=17;var VALID_SEARCH=18;var VALID_PORTFOLIO_NAME=19;var VALID_INTEGER=20;var VALID_COUNTRY=21;var VALID_AGREE_CONTEST=22;var VALID_PHONE_CONTEST=23;var VALID_NAME_1_CHAR=24;var VALID_ACCOUNT=25;var VALID_DOUBLE=26;var VALID_INTEGER_OR_EMPTY=27;var VALID_DOUBLE_POSITIVE=28;var VALID_PROFILE=29;var VALID_NUMBER=30;var VALID_ABSOLUTE_NUMBER=31;var VALID_EN_NAME=32;var VALID_MASTER_PASSWORD=33;var VALID_MASTER_IDENCTICAL_INVESTOR_PASSWORD_CONFIRM=34;var VALID_PERCENT=35;var VALID_DOUBLE_POSITIVE_WITHOUT_ZERO=36;var VALID_INTEGER_POSITIVE_WITHOUT_ZERO=37;var VALID_PERCENT_WITHOUT_ZERO=38;var VALID_ACCOUNT_TYPE=39;var VALID_YEAR=40;var VALID_INTER_PHONE=41;var VALID_CHECKBOXES=42;var VALID_DROPDOWN=43;var VALID_ADDRESS=44;var VALID_ACCOUNT_HISTORY_URL=45;var VALID_INTERNATIONAL_OFFICES=46;var VALID_PASSWORD_CONFIRM3=47;var VALID_PERCENT_NON_SIGN=48;var VALID_NUMBER_NON_SIGN=49;var VALID_DOUBLE_POSITIVE_MORE_THAN=50;var VALID_PERCENT_WITH_SIGN=51;var VALID_DOUBLE_POSITIVE_LESS_THAN=52;var DEFAULT_LEVERAGE=100;function validate(a,l,d){var f=true;var c,m;try{c=$(a).value}catch(h){}switch(l){case VALID_USER_NAME:m=/^[a-zA-Z0-9_]{4,16}$/;if(c==""){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br />"+$T("tChooseUserName"),3);f=false}else{if(!c.match(m)){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br />"+$T("tInvalidUserName")+"<br/>"+$T("tUseOnlyDigits"),4);f=false}}break;case VALID_EMAIL:m=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,5}$/;if(c==""){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br />"+$T("tMustEnterEmail"),3);f=false}else{if(!c.match(m)){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br />"+$T("tInvalidEmail"),3);f=false}}break;case VALID_PASSWORD:m=/^.{4,20}$/;if(c==""){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br />"+$T("tMustEnterPassword"),3);f=false}else{if(!c.match(m)){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br />"+$T("tInvalidPassword"),3);f=false}}break;case VALID_NAME:if(c==""){inlineMsg(a,$T("tEnterName"),3);f=false}break;case VALID_EN_NAME:m=/^[a-zA-Z ]+$/;try{c=c.trim()}catch(h){}if(c==""){inlineMsg(a,$T("tEnterName"),3);f=false}else{if(!c.match(m)){inlineMsg(a,$T("tEnterEnglishOnly"),3);f=false}}break;case VALID_MESSAGE:if(c==""){inlineMsg(a,$T("tEnterMessage"),3);f=false}break;case VALID_TITLE:m=/^.{3,}$/;if(!(c.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(m)){inlineMsg(a,$T("tEnterTitleName"),3);f=false}break;case VALID_TEXT:if(c.trim()==""){inlineMsg(a,$T("tOops")+"<br>"+$T("tNoTextEntered"),3);f=false}break;case VALID_ACCOUNT_HISTORY_URL:if(c==""){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br />"+$T("tMustEnterAccountHistory"),3);f=false}break;case VALID_ACCOUNT_PASSWORD:if(c==""){inlineMsg(a,$T("tEnterReadOnlyPassword"),3);f=false}break;case VALID_SYSTEM_NAME:m=/^.{3,}$/;if(!(c.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(m)){inlineMsg(a,$T("tEnterNameForYourSystem"),3);f=false}break;case VALID_PORTFOLIO_NAME:m=/^.{3,}$/;if(!(c.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(m)){inlineMsg(a,$T("tEnterNameAtLeast3Char"),3);f=false}break;case VALID_SERVER:if(c==-1){inlineMsg(a,$T("tChooseBroker"),3);f=false}break;case VALID_PASSWORD_CONFIRM:var k=$("oldPassword").value;var g=$("password2").value;if(c==k){inlineMsg("password1","<strong>"+$T("tError")+"</strong><br/>"+$T("tCantUseCurrentPassword"),3);f=false}else{if(c!=g){inlineMsg("password2","<strong>"+$T("tError")+"</strong><br/>"+$T("tPasswordNoMatch"),3);f=false}}break;case VALID_PASSWORD_CONFIRM2:var k=$("password").value;if(c!=k){inlineMsg("passwordConfirm","<strong>"+$T("tError")+"</strong><br/>"+$T("tPasswordNoMatch"),3);f=false}break;case VALID_PASSWORD_CONFIRM3:var k=$("registrationDialogPassword").value;if(c!=k){inlineMsg("registrationDialogConfirmPassword","<strong>"+$T("tError")+"</strong><br/>"+$T("tPasswordNoMatch"),3);f=false}break;case VALID_AGREE:if(!$(a).checked){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustAgreeToTerms"),3);f=false}break;case VALID_COMPOSE_TO:var b=$(a).getElementsByTagName("li").length;if(b==1){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustChooseRecipient"),3);f=false}else{if(b>11){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tAllowedToChoose"),3);f=false}}break;case VALID_PLATFORM:if(c==0){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustSelectYourPlatform"),3);f=false}break;case VALID_CAPTHCA:if(c==""){inlineMsg(a,$T("tPleasEnterCode"),3);f=false}break;case VALID_SEARCH:if(!hasText(c)||c.length<3){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tSearchPhraseMustContain3Char"),3);f=false}break;case VALID_INTEGER:m=/^[0-9]+$/;if(!c.match(m)){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tPleaseUseNumberOnly"),3);f=false}break;case VALID_COUNTRY:if(c==0){inlineMsg(a,$T("tPleaseSelectYourCountry"),3);f=false}break;case VALID_AGREE_CONTEST:if(!$(a).checked){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustAgreeToContestRules"),3);f=false}break;case VALID_PHONE_CONTEST:try{f=$F(a).length>3;if(!f){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tMustEnterValidPhoneNumber"),3)}}catch(h){f=false}break;case VALID_NAME_1_CHAR:m=/^.{1,}$/;if(!(c.replace(/^\s\s*/,"").replace(/\s\s*$/,"")).match(m)){inlineMsg(a,$T("tPleaseEnterName"),3);f=false}break;case VALID_ACCOUNT:m=/^[0-9]+$/;if(!c.match(m)){inlineMsg(a,$T("tPleaseEnterYourAccountNumber"),3);f=false}break;case VALID_DOUBLE:m=/^[-+]?\d+(\.\d+)?$/;if(!c.match(m)&&c!=""){beforeRunFunc(d);inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_INTEGER_OR_EMPTY:m=/^[0-9]+$/;if(!c.match(m)&&c!=""){beforeRunFunc(d);inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_DOUBLE_POSITIVE:m=/^[+]?\d+(\.\d+)?$/;if(!c.match(m)&&c!=""){beforeRunFunc(d);inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_PROFILE:if(c==""){inlineMsg(a,$T("tPleaseEnterName"),3);f=false}break;case VALID_NUMBER:m=/^[+]?\d+(\.\d+)?$/;if(!c.match(m)||c==""){inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_NUMBER_NON_SIGN:m=/^\d+(\.\d+)?$/;if(!c.match(m)||c==""){inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_ABSOLUTE_NUMBER:m=/^[+-]?\d+(\.\d+)?$/;if(!c.match(m)||c==""){inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_MASTER_PASSWORD:if(c==""){inlineMsg(a,$T("tMustEnterMasterPassword"),3);f=false}break;case VALID_MASTER_IDENCTICAL_INVESTOR_PASSWORD_CONFIRM:var k=$("accountInvestorPassword").value;if(c==k){inlineMsg(a,$T("tPasswordsCannotBeIdentical"),3);f=false}break;case VALID_PERCENT:m=/^[+]?\d+(\.\d+)?$/;if(!c.match(m)||c==""||c<0||c>100){inlineMsg(a,$T("tPleaseEnterNumberBetween",[0,100]),3);f=false}break;case VALID_DOUBLE_POSITIVE_WITHOUT_ZERO:m=/^[+]?\d+(\.\d+)?$/;if(c==0||!c.match(m)&&c!=""){beforeRunFunc(d);inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_INTEGER_POSITIVE_WITHOUT_ZERO:m=/^[0-9]+$/;if(c==0||!c.match(m)){inlineMsg(a,"<strong>"+$T("tError")+"</strong><br/>"+$T("tPleaseUseNumberOnly"),3);f=false}break;case VALID_PERCENT_WITHOUT_ZERO:m=/^[+]?\d+(\.\d+)?$/;if(!c.match(m)||c==""||c<1||c>100){inlineMsg(a,$T("tPleaseEnterNumberBetween",[1,100]),3);f=false}break;case VALID_PERCENT_NON_SIGN:m=/^\d+(\.\d+)?$/;if(!c.match(m)||c==""||c<0||c>100){inlineMsg(a,$T("tPleaseEnterNumberBetween",[1,100]),3);f=false}break;case VALID_ACCOUNT_TYPE:if(c==0){inlineMsg(a,$T("tChooseAccountType"),2);f=false}break;case VALID_YEAR:m=/^(19[5-9]\d|20[0-4]\d|2050)$/;if(!hasText(c)||!c.match(m)){inlineMsg(a,$T("tPleaseEnterYearBetween",[1950,2050]),3);f=false}break;case VALID_INTER_PHONE:m=/^\+?([0-9]{2})\)?[-. ]?([0-9]{4})[-. ]?([0-9]{4})$/;if(!hasText(c)||!c.match(m)){inlineMsg(a,$T("tPleaseEnterValidPhone"),3);f=false}break;case VALID_CHECKBOXES:if($J("input[name='"+a+"']:checked").size()==0){inlineMsg($J("input[name='"+a+"']")[0].id,$T("tAtLeastOneOption"),3);f=false}break;case VALID_DROPDOWN:if(c==0){inlineMsg(a,$T("tPleaseSelect"),3);f=false}break;case VALID_ADDRESS:if(c.trim()==""){inlineMsg(a,$T("tEnterAddress"),3);f=false}break;case VALID_URL:if(c.trim()==""){inlineMsg(a,$T("tEnterUrl"),3);f=false}break;case VALID_INTERNATIONAL_OFFICES:if(c==0&&$J("input[name='officeCountry']").size()==0){inlineMsg(a,$T("tPleaseSelect"),3);f=false}else{if($J("input[name='officeCountry']:checked").size()==0){inlineMsg($J("input[name='officeCountry']")[0].id,$T("tAtLeastOneOption"),3);f=false}}break;case VALID_DOUBLE_POSITIVE_MORE_THAN:m=/^[+]?\d+(\.\d+)?$/;if(c<Number($(a).getAttribute("minValue"))||!c.match(m)&&c!=""){beforeRunFunc(d);inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break;case VALID_PERCENT_WITH_SIGN:m=/^[-+]?\d+(\.\d+)?$/;if(!c.match(m)||c==""||c<-100||c>100){inlineMsg(a,$T("tPleaseEnterNumberBetween",[-100,100]),3);f=false}break;case VALID_DOUBLE_POSITIVE_LESS_THAN:m=/^[+]?\d+(\.\d+)?$/;if(c>Number($(a).getAttribute("maxValue"))||!c.match(m)&&c!=""){beforeRunFunc(d);inlineMsg(a,$T("tYouMustEnterValidNumber"),3);f=false}break}return f}var MSGTIMER=0;var MSGSPEED=100;var MSGOFFSET=3;var MSGHIDE=3;function inlineMsg(l,k,g){var c;var m;if(!$("alert")){c=document.createElement("div");c.id="alert";m=document.createElement("div");m.id="alertcontent";document.body.appendChild(c);c.appendChild(m);c.style.filter="alpha(opacity=0)";c.style.opacity=0;c.alpha=0}else{c=$("alert");m=$("alertcontent")}m.innerHTML=k;c.style.display="block";var d=c.offsetHeight;var f=c.offsetWidth;var b=$(l);b.focus();var h=b.offsetHeight;var q=b.offsetWidth;var a=topPosition(b)-((d-h)/2);var o;if((leftPosition(b)-leftPosition($("content")))<(1000-(leftPosition(b)+q-leftPosition($("content"))))){$("alert").className="alertRight";o=leftPosition(b)+q+MSGOFFSET}else{$("alert").className="alertLeft";o=leftPosition(b)-MSGOFFSET-f}c.style.top=a+"px";c.style.left=o+"px";clearInterval(c.timer);c.timer=setInterval("fadeMsg(1)",MSGTIMER);if(!g){g=MSGHIDE}window.setTimeout("hideMsg()",(g*1000))}function inlineAlert(target,string,func){var msg;var msgcontent;if(!$("alert")){msg=document.createElement("div");msg.id="alert";msgcontent=document.createElement("div");msgcontent.id="alertcontent";document.body.appendChild(msg);msg.appendChild(msgcontent);msg.style.filter="alpha(opacity=0)";msg.style.opacity=0;msg.alpha=0}else{msg=$("alert");msgcontent=$("alertcontent")}msgcontent.innerHTML=string+"<br/><br/>";msg.style.display="block";var buttons;buttons=document.createElement("div");buttons.id="buttons";var cancelButt=document.createElement("input");cancelButt.type="button";cancelButt.className="popupButton";cancelButt.value="  No  ";cancelButt.onclick=function(){hideMsg(this)};var okButt=document.createElement("input");okButt.type="button";okButt.className="popupButton";okButt.value="  Yes  ";okButt.onclick=function(){hideMsg(this);eval(func)};buttons.appendChild(okButt);buttons.appendChild(cancelButt);msgcontent.appendChild(buttons);var msgheight=msg.offsetHeight;var msgWidth=msg.offsetWidth;var targetdiv=$(target);targetdiv.focus();var targetheight=targetdiv.offsetHeight;var targetwidth=targetdiv.offsetWidth;var topposition=topPosition(targetdiv)-((msgheight-targetheight)/2);if((leftPosition(targetdiv)-leftPosition($("content")))<(1000-(leftPosition(targetdiv)+targetwidth-leftPosition($("content"))))){$("alert").className="alertRight";leftposition=leftPosition(targetdiv)+targetwidth+MSGOFFSET}else{$("alert").className="alertLeft";leftposition=leftPosition(targetdiv)-MSGOFFSET-msgWidth}msg.style.top=topposition+"px";msg.style.left=leftposition+"px";clearInterval(msg.timer);msg.timer=setInterval("fadeMsg(1)",MSGTIMER)}function hideMsg(a){var a=$("alert");if(!a.timer){a.timer=setInterval("fadeMsg(0)",MSGTIMER)}}function fadeMsg(a){if(a==null){a=1}var c=$("alert");var b;if(a==1){b=c.alpha+MSGSPEED}else{b=c.alpha-MSGSPEED}c.alpha=b;c.style.opacity=(b/100);c.style.filter="alpha(opacity="+b+")";if(b>=99){clearInterval(c.timer);c.timer=null}else{if(b<=1){c.style.display="none";clearInterval(c.timer)}}}function leftPosition(b){var a=0;if(b.offsetParent){while(1){a+=b.offsetLeft;if(!b.offsetParent){break}b=b.offsetParent}}else{if(b.x){a+=b.x}}return a}function topPosition(b){var a=0;if(b.offsetParent){while(1){a+=b.offsetTop;if(!b.offsetParent){break}b=b.offsetParent}}else{if(b.y){a+=b.y}}return a}if(document.images){arrow=new Image(7,80);arrow.src=staticServerPath+"/images/msg_arrowRight.gif"}var ONE_DAY=0;var ONE_WEEK=1;var ONE_MONTH=2;var ONE_YEAR=3;var RESULTS_10=0;var RESULTS_20=1;var RESULTS_30=2;function collectSearchParamters(){var a=new Array();a.push("profitType=",$("profitSelect").options[$("profitSelect").selectedIndex].value,"&profitValue=",$F("profitVal"),"&ageType=",$("ageType").value,"&ageValue=",$("ageSelect").options[$("ageSelect").selectedIndex].value);a.push("&drawType=",$("drawdownSelect").selectedIndex,"&drawValue=",$F("drawdownVal"),"&systemType=",$("systemTypeSelect").value,"&tradingType=",$("tradingTypeSelect").value,"&accountType=",$("accountTypeSelect").selectedIndex,"&lastTraded=",$F("lastTradedSelect"));a.push("&profitabilityType=",$("profitabilitySelect").selectedIndex,"&profitabilityValue=",$F("profitabilityVal"));a.push("&size=",$("sizeVal").options[$("sizeVal").selectedIndex].value,"&tradesType=",$F("tradesType"));a.push("&serverOid=",$("serverOid").options[$("serverOid").selectedIndex].value,"&regulationType=",$("regulationTypeSelect").selectedIndex);if($("currSelect").options[$("currSelect").selectedIndex].index!=0){a.push("&symbols=",$("currSelect").options[$("currSelect").selectedIndex].value)}return a}function searchSystems(c){if(validate("profitVal",VALID_ABSOLUTE_NUMBER)&&validate("drawdownVal",VALID_ABSOLUTE_NUMBER)&&validate("profitabilityVal",VALID_ABSOLUTE_NUMBER)){var b=collectSearchParamters();var a=[];if($("systemsSearchSortBy")!=null&&$("systemsSearchSortType")!=null&&$("systemsSearchSortBy").value.length!=0&&$("systemsSearchSortType").value.length!=0){a.push("&sb=",$("systemsSearchSortBy").value,"&st=",$("systemsSearchSortType").value)}else{a.push("&sb=19&st=2")}if($("autoTradeSystemsSearchSortBy")!=null&&$("autoTradeSystemsSearchSortType")!=null&&$("autoTradeSystemsSearchSortBy").value.length!=0&&$(autoTradeSystemsSearchSortType).value.length!=0){a.push("&autoTradeSortBy=",$("autoTradeSystemsSearchSortBy").value,"&autoTradeSortType=",$("autoTradeSystemsSearchSortType").value)}else{a.push("&sb=19&st=2")}dhtmlHistory.add("#?pt=6&p=1&"+b.join("")+a.join(""));fxAjax.sendRequest(fxVars.searchSystems+b.join("")+a.join(""),{contentType:"text/xhtml",params:{cont:"allSystemsCont",session:c},loader:true,callback:"searchSystemsResponse"})}}function searchSystemsResponse(a,b){$(b.cont).innerHTML=a;runAjaxScripts(a);if(b.session!="true"){loadWatchCookie()}reloadAds()}function submitEnter(b){var a;if(window.event){a=window.event.keyCode}else{if(b){a=b.which}else{return true}}if(a==13){login()}}var quotePostId=-1;function quote(c,f,b,d,g){if($("suspended")==undefined){quotePostId=c;if(d){getPost(c);Effect.ScrollTo("text")}else{var h=f.indexOf("&p=")+3;var a=f.substring(0,h)+g+f.substring(f.indexOf("&o="));ajaxPaging(a,b,undefined,undefined,true)}}}function getPost(a){fxAjax.sendRequest(fxVars.getPostById+a,{contentType:"text/xhtml",params:"",loader:true,callback:"getPostResponse"})}function editPost(b,a){var c=$("post"+b+"Edit");if(a){c.style.display="";new TextAreaResize(c);$("post"+b).style.display="none";$("postOptions"+b).style.display="none";$("editButton"+b).style.display="none";refreshAutocompleteAndAdd("post"+b+"Edit")}else{c.style.display="none";$("post"+b).style.display="";$("postOptions"+b).style.display="";$("editButton"+b).style.display="";refreshAutocompleteAndDelete("post"+b+"Edit")}}function editPostSave(a){if(validate("post"+a+"Edit",VALID_TEXT)){var c=$("post"+a+"Edit").value;var b=["oid=",a,"&text=",encodeParameter(c)].join("");fxAjax.sendRequest(fxVars.editPost,{contentType:"application/x-www-form-urlencoded; charset=utf-8",params:{oid:a},postBody:b,method:"post",loader:true,callback:"editPostSaveResponse"})}}function deletePost(a){if(confirm("Are you sure?")){fxAjax.sendRequest(fxVars.deletePost+a,{contentType:"text/xhtml",params:{oid:a},loader:true,callback:"deletePostResponse"})}}function deletePostResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){$("postRow"+f.oid).remove()}}function deleteTopic(a){if(confirm("Are you sure?")){fxAjax.sendRequest(fxVars.deleteTopic+a,{contentType:"text/xhtml",params:{oid:a},loader:true,callback:"deleteTopicResponse"})}}function deleteTopicResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if($("topicRow"+f.oid)!=null){$("topicRow"+f.oid).remove();alert("Topic was deleted")}}else{alert("problem deleting topic")}}function editPostSaveResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");if(b=="false"){var c=getContent(a);$("edit"+g.oid).style.display="none";$("post"+g.oid+"Edit").style.display="none";$("post"+g.oid).style.display="";$("post"+g.oid).innerHTML=c;$("postOptions"+g.oid).style.display="";$("editButton"+g.oid).style.display="";Jlinker.createLinker(linkerList,"post"+g.oid)}else{inlineMsg("saveEditPostButt"+g.oid,d,3)}refreshAutocompleteAndDelete("post"+g.oid+"Edit")}function reportAbuseVerify(f,c,a,d){var b=["fadeMsg(0);reportAbuse('",f,"',",c,",",a,",",d,");"];inlineAlert($(f),"<div class='center'><b>"+$T("tReportAbuse")+"</b><br/><br/><span class='exclamation'>"+$T("tAbusiveContent")+"</span></div>",b.join(""))}function reportAbuse(d,b,a,c){fxAjax.sendRequest(fxVars.reportAbuse+b+"&conversationOid="+a+"&pageNum="+c,{contentType:"text/xhtml",loader:true});inlineMsg($(d),$T("tPostReported"),3)}function getPostResponse(a){$("text").value=a;Effect.ScrollTo("text");quotePostId=-1}var filesUploaded=new Array();function navigateTo(a){document.location.href=a}function searchSite(b){var a;if(window.event){a=window.event.keyCode}else{if(b){a=b.which}}if(a==13){searchSiteFunc()}return false}function searchSiteFunc(){if(validate("search",VALID_SEARCH)){var a=encodeParameter($("search").value);window.location="/search/"+a}}function getAccountForm(b,a){if(typeof(b)=="undefined"){b=0}if(typeof a=="undefined"){a=true}fxAjax.sendRequest(fxVars.getAccountForm+b+"&os="+a,{contentType:"text/xhtml",params:{newAccount:(b==0)},loader:true,callback:"getAccountFormResponse"})}function getAccountFormResponse(data,params){hideElement("portfolioManageDiv");hideElement("accountsListDiv");showElement("currentAccount");$("currentAccount").innerHTML=data;runAjaxScripts(data);var magicColors=document.getElementsByName("magicColors");for(var i=0;i<magicColors.length;i++){var colorObject=new jscolor.color(magicColors[i],{required:false});if(magicColors[i].value.length!=0){colorObject.fromString(magicColors[i].value)}}if(!params.newAccount){getMt4Servers($("selectedServerId").value,$("selectedMt4ServerId").value);var selectedServerId=$("selectedServerId").value;if(selectedServerId.length!=0&&selectedServerId!=1){$("levergeHolder").style.display=""}updateServersCombo(eval($("selectedPlatformOid").value))}reloadAds()}function closeCurrentAccount(){hideElement("currentAccount");showElement("accountsListDiv");reloadAds()}function getMetaContent(a){var c=document.getElementsByTagName("meta");for(var b=0;b<c.length;b++){if(c[b].name==a){return c[b].content}}}var SYSTEM_TIMESTAMP;var mmToMonth=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var dayStr=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");var dt=new Date(getMetaContent("server-time"));var cookieCache={};var initTimezone=null;function updateTime(){var a=new Date(dt);var h;var g;if(cookieCache.timezone!=undefined){h=cookieCache.timezone}else{h=getCookie("timezone");cookieCache.timezone=h}if(cookieCache.dst!=undefined){g=cookieCache.dst}else{g=getCookie("dst");cookieCache.dst=g}var c=" GMT";if(h!=null&&h.length!=0){a.setTime(a.getTime()+h*HOUR);c=""}if(hasText(g)&&g=="1"){a.setTime(a.getTime()+HOUR)}var f=mmToMonth[a.getMonth()];var b=dayStr[a.getDay()];$("time").innerHTML=b+", "+f+" "+a.getDate()+", "+format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())+":"+format2Digits(a.getSeconds())+c;a.setTime(a.getTime()+1000);if(initTimezone==null){initTimezone=dt.getTime()-getUTCTime().getTime();dt.setTime(dt.getTime()+1000)}else{var d=(getUTCTime()).getTime()+initTimezone;dt=new Date(d)}setTimeout("updateTime()",1000)}function getUTCTime(){var a=new Date();return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())}var SECOND=1000;var MINUTE=60*SECOND;var HOUR=60*MINUTE;var DAY=24*HOUR;var WEEK=7*DAY;var YEAR=360*DAY;var isTimeOut=0;function updateCalendarTime(page){var isDone=false;var currDate=dt.getTime();currDate+=MINUTE*dt.getTimezoneOffset()*-1;var elements=document.getElementsByName("calendarLeft");for(var i=0;i<elements.length;i++){var timestamp=eval(elements[i].getAttribute("time"));var delta=timestamp-currDate;var text;var color=elements[i].parentNode.parentNode.style.backgroundColor;var isPassed=parseInt(elements[i].getAttribute("isPassed"));var last=elements.length;if(i==(last-1)&&isPassed==0&&isTimeOut==1){isTimeOut=0}if(delta<0){if(isPassed==0){elements[i].parentNode.parentNode.style.backgroundColor=""}elements[i].value="Done";elements[i].setAttribute("isPassed","1");isDone=true;if(i<=elements.length-1&&i>0&&isPassed==0){$$("#"+elements[i].parentNode.parentNode.id+" td").each(function(element){element.style.borderTop=""});if(i<elements.length-1){$$("#"+elements[i+1].parentNode.parentNode.id+" td").each(function(element){element.style.borderTop="3px solid #e4e4e4"})}}if(i==(last-1)&&isPassed==1&&isTimeOut!=1){isTimeOut=1;setTimeout("movePage()",300000)}continue}var importance=parseInt(elements[i].getAttribute("importance"));var setColor;if(importance==0){setColor="#ededed"}else{if(importance==1){setColor="#e2fee3"}else{if(importance==2){setColor="#fdefd3"}else{if(importance==3){setColor="#fedbdb"}}}}if(delta<=MINUTE){text=$T("tTimeLeftSeconds",[Math.floor(delta/SECOND)]);elements[i].parentNode.parentNode.style.backgroundColor=(new RGBColor(color).toHex()==setColor?"white":setColor)}else{if(delta>=MINUTE&&delta<=HOUR){text=$T("tTimeLeftMin",[Math.floor(delta/MINUTE)])}else{if(delta>=HOUR&&delta<=DAY){text=$T("tTimeLeftHMin",[Math.floor(delta/HOUR),Math.floor((delta%HOUR)/MINUTE)])}else{if(delta>=DAY){var day=Math.floor(delta/DAY);text=day<=1?$T("tTimeLeftDay",[day]):$T("tTimeLeftDays",[day])}}}}elements[i].value=text}if(isDone&&page=="c"){var nextEventElements=$J('td [isPassed="0"]');if(nextEventElements!=undefined&&nextEventElements.length>0){var nextEventTime=nextEventElements[0].attributes.time.value;for(var j=0;j<nextEventElements.length;j++){var deltaNextEvent=nextEventTime-currDate;if(nextEventElements[j].attributes.time.value==nextEventTime&&deltaNextEvent>=MINUTE){var nextEventImportance=parseInt(nextEventElements[j].attributes.importance.value);var nextEventElColor=elements[j].parentNode.parentNode.style.backgroundColor;var nextEventColor;if(nextEventImportance==0){nextEventColor="#ededed"}else{if(nextEventImportance==1){nextEventColor="#e2fee3"}else{if(nextEventImportance==2){nextEventColor="#fdefd3"}else{if(nextEventImportance==3){nextEventColor="#fedbdb"}}}}nextEventElements[j].parentNode.parentNode.style.backgroundColor=nextEventColor}}}}setTimeout('updateCalendarTime("'+page+'")',1000)}var AUTO_CAL_PAGING="1";function movePage(){var c=parseInt($F("calLivePage"));if($F("autoCalPaging")==AUTO_CAL_PAGING){c+=1}var a=$F("calLastP");var b=$F("calP");if(isTimeOut==1&&b!=a){ajaxPaging("?pt=7&p="+c+"&calRefreshed=1&o=&t=","calendarCont",1,false,true,false,false,false);setTimeout("movePageFinish()",1000)}}function movePageFinish(){if($F("calRefreshed")=="0"){setTimeout("movePageFinish()",1000)}else{isTimeOut=0}}function RGBColor(h){this.ok=false;if(h.charAt(0)=="#"){h=h.substr(1,6)}h=h.replace(/ /g,"");h=h.toLowerCase();var a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var c in a){if(h==c){h=a[c]}}var k=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}];for(var b=0;b<k.length;b++){var f=k[b].re;var d=k[b].process;var g=f.exec(h);if(g){channels=d(g);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var o=this.r.toString(16);var m=this.g.toString(16);var l=this.b.toString(16);if(o.length==1){o="0"+o}if(m.length==1){m="0"+m}if(l.length==1){l="0"+l}return"#"+o+m+l};this.getHelpXML=function(){var o=new Array();for(var r=0;r<k.length;r++){var m=k[r].example;for(var q=0;q<m.length;q++){o[o.length]=m[q]}}for(var w in a){o[o.length]=w}var s=document.createElement("ul");s.setAttribute("id","rgbcolor-examples");for(var r=0;r<o.length;r++){try{var t=document.createElement("li");var v=new RGBColor(o[r]);var x=document.createElement("div");x.style.cssText="margin: 3px; border: 1px solid black; background:"+v.toHex()+"; color:"+v.toHex();x.appendChild(document.createTextNode("test"));var l=document.createTextNode(" "+o[r]+" -> "+v.toRGB()+" -> "+v.toHex());t.appendChild(x);t.appendChild(l);s.appendChild(t)}catch(u){}}return s}}function format2Digits(a){if(a<10){return"0"+a}else{return a}}function getToday(){var a=new Date();return format2Digits(a.getMonth()+1)+"/"+format2Digits(a.getDate())+"/"+a.getFullYear()+" "+format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())}var checkboxHeight="25";var radioHeight="25";var selectWidth="90";document.write('<style type="text/css">input.styled { display: none; } select.styled { position: relative; width: '+selectWidth+"px; opacity: 0; filter: alpha(opacity=0); z-index: 5; }</style>");if(typeof(SETTINGS)=="undefined"){window.dhtmlHistory.create({toJSON:function(a){return JSON.stringify(a)},fromJSON:function(a){return JSON.parse(a)}})}function initialize(){dhtmlHistory.initialize();dhtmlHistory.addListener(handleHistoryChange);var a=dhtmlHistory.getCurrentLocation();if(dhtmlHistory.isFirstLoad()&&typeof(initPage)!="undefined"){}}function handleHistoryChange(b,c){if(b.length==0){var a=historyStorage.get(window.location.pathname);if(a!=null&&a.length!=0&&container!=null&&$(container)!=null){$(container).innerHTML=a}return}updateUI(b,c)}function updateUI(a,b){if(typeof(container)!="undefined"){ajaxPaging(a,container,1,true,true)}}var PLATFORM_OANDA=1;var PLATFORM_MT4=2;var PLATFORM_FXCM=3;var PLATFORM_MT5=5;function setAccountForm(id){try{if(eval(id)==0){$("mt4MissingServerHelp").style.display="none"}if(eval(id)==PLATFORM_OANDA){$("serverId").style.display="";$("typeSelect").style.display="none";$("levergeHolder").style.display="none";$("sizingLabel").innerHTML="Units";$("verificationRow").style.display="none";$("type").style.display="none";$("mt4MissingServerHelp").style.display="none"}else{if(eval(id)==PLATFORM_MT4){showElement("typeSelect");showElement("levergeHolder");if($("sizingLabel")){$("sizingLabel").innerHTML="Lots"}showElement("verificationRow");showElement("type");showElement("mt4MissingServerHelp")}else{if(eval(id)==PLATFORM_MT5){$("f").style.display="none";$("brokerIs").style.display="none";$("mt5Text").style.display="";$("save").style.display="none";$("required").style.display="none";$("platformId").disabled="disabled";window.location.href="http://www.myfxbook.com/pages/EaInstallerMT5.exe"}}}}catch(e){}updateServersCombo(id)}function updateServersCombo(id){if(id!=null&&!$("serverId").disabled){clearCombo("serverId");var serverSecondary=$("serverId");var firstOption=new Option($T("tPleaseSelect"),0);serverSecondary.options.add(firstOption);var servers=eval($("serversJson").value);for(var index in servers){var server=servers[index];if(server.platformOid==id){var newOption=new Option(server.name,server.oid);serverSecondary.options.add(newOption);if($("selectedServerId")&&typeof($F("selectedServerId"))!="undefined"&&$F("selectedServerId")==server.oid){serverSecondary.options[serverSecondary.options.length-1].selected="selected"}}}}}function topicSubscribe(a){var b=["topicId=",a];fxAjax.sendRequest(fxVars.topicSubscribe+b.join(""),{contentType:"text/xhtml",params:{container:"subscribe",topicId:a},loader:true,callback:"topicSubscribeResponse"})}function topicSubscribeResponse(d,f){var b=d.getElementsByTagName("response")[0];$("response").innerHTML=b.getAttribute("message");$("response").style.display="";var a=$$("td[name=subscribe]");for(var c=0;c<a.length;c++){a[c].innerHTML="<a href='javascript:void(0);' onclick='topicUnsubscribe("+f.topicId+")' class='unsubscribe gray'>"+$T("tTopicUnsucscribe")+"</a>"}}function topicUnsubscribe(a){var b=["topicId=",a];fxAjax.sendRequest(fxVars.topicUnsubscribe+b.join(""),{contentType:"text/xhtml",params:{container:"subscribe",topicId:a},loader:true,callback:"topicUnsubscribeResponse"})}function topicUnsubscribeResponse(d,f){var b=d.getElementsByTagName("response")[0];$("response").innerHTML=b.getAttribute("message");$("response").style.display="";var a=$$("td[name=subscribe]");for(var c=0;c<a.length;c++){a[c].innerHTML="<a href='javascript:void(0);' onclick='topicSubscribe("+f.topicId+")' class='subscribe gray'>"+$T("tTopicSubscribe")+"</a>"}}function subscriptionDelete(b,a){var c=["oid=",a];fxAjax.sendRequest(fxVars.subscriptionDelete+c.join(""),{contentType:"text/xhtml",params:{container:"subscriptions"},loader:true,callback:"subscriptionDeleteResponse"})}function subscriptionDeleteResponse(a,b){$("subscriptionsCont").innerHTML=a}function deleteNotifications(a){fxAjax.sendRequest(fxVars.deleteNotification+a,{contentType:"text/xml",params:{id:a},loader:true,callback:"deleteNotificationsResponse"})}function deleteNotificationsResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");var c=$("notification"+g.id);if(b=="false"){if(c){c.remove()}}else{inlineMsg(c,d,3)}}function deleteAllNotifications(){fxAjax.sendRequest(fxVars.deleteAllNotifications,{loader:true,callback:"deleteAllNotificationsResponse"})}function deleteAllNotificationsResponse(a){if(a.error){inlineMsg($("notifyTb"),a.message,3)}else{$("notificationsTB").innerHTML=""}}function setAnchorTab(a){window.location.hash=a}function reportBug(){if(validate("bugDescription",VALID_MESSAGE)){var a=[];jQuery("#reportBugForm [name=reportFiles]").each(function(){a.push(this.title)});var b=["text=",encodeParameter($("bugDescription").value),"&browser=",encodeParameter($("browserType").value),"&url=",encodeParameter($("currentUrl").value),"&userIdentity=",$("userIdentity").value,"&files=",encodeParameter(a.join(","))];fxAjax.sendRequest(fxVars.reportBug,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:b,method:"post",params:{},loader:false,callback:"reportBugResponse"})}}function initBugForm(){$("currentUrl").value=window.location.href;$("browserType").value=navigator.userAgent}function reportBugResponse(c,d){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");$("bugFormContent").style.display="none";$("bugSent").style.display="block";$("bugDescription").value="";$("userIdentity").value="";jQuery("#reportBugForm [name=bugReportFileRemove]").each(function(){this.click()});setTimeout(function(){$JD.close("#reportBugForm")},1000)}var currentChartDate="";var changeCharts=["chartRatios","chartCurrency","chartHold"];function changeChartMonth(d){var a=d.split(",");var c=a[0];var l=a[1];var h=a.length>2?a[2]:"";if(currentChartDate.length==0||currentChartDate!=c){var k=(l*15)<250?250:l*15;if(isNaN(k)){k=250}var b=new Chart(342,k,"riskRatios",3);b.renderChart("/charts.json?chartType=4&accountOid="+accountOid+"&startDateForChart="+c+"&invitation="+h+buildAdvancedStatisticsUrl(false,false)+"&r="+Math.random());var f=new Chart(480,250,"currencies",4);f.renderChart("/charts.json?chartType=6&accountOid="+accountOid+"&startDateForChart="+c+"&invitation="+h+buildAdvancedStatisticsUrl(false,false)+"&r="+Math.random());var g=new Chart(342,k,"holdPeriod",1);g.renderChart("/charts.json?chartType=5&accountOid="+accountOid+"&startDateForChart="+c+"&invitation="+h+buildAdvancedStatisticsUrl(false,false)+"&r="+Math.random());currentChartDate=c}}var currentStrategyChartDate="";function changeStrategyChartMonth(f){var h=f.split(",");var b=h[0];var c=h[1];var g=h.length>2?h[2]:"";if(currentStrategyChartDate.length==0||currentStrategyChartDate!=b){var a=new Chart(342,120,"riskRatios",3);a.renderChart("/strategy-chart.json?chartType=4&id="+$F("stid")+"&startDate="+b+"&invitation="+g+"&r="+Math.random());var d=new Chart(342,120,"holdPeriod",1);d.renderChart("/strategy-chart.json?chartType=5&id="+$F("stid")+"&startDate="+b+"&invitation="+g+"&r="+Math.random());currentStrategyChartDate=b}}var monthlyCharts=["chartMonthly","chartRatios","chartCurrency","chartHold"];function changeChartYear(c,h,m,d){if(m==null){m=""}if(monthType==null){monthType=0}var f=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var o=new Date("01/01/"+c);if(o<f){c=getDbDateFormat(f)}else{c=c+"-01-01"}if(h!="on"){currentChartDate="";var a=new Chart(480,250,"monthlyCont",3);a.renderChart("/charts.json?chartType=3&monthType="+monthType+"&accountOid="+accountOid+"&startDate="+c+"&endDate="+getDbDateFormat(new Date((userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")))))+"&r="+Math.random()+"&l="+d+buildAdvancedStatisticsUrl(true,false)+"&startDateYear="+getDbDateFormat(f));var b=new Chart(342,250,"riskRatios",3,$F("psaml"));var g=new Chart(480,250,"currencies",4,$F("psaml"));var k=new Chart(342,250,"holdPeriod",1,$F("psaml"))}}function changeStrategyChartYear(c,d,k){if(k==null){k=""}var h=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var g=new Date("01/01/"+c);if(g<h){c=getDbDateFormat(h)}else{c=c+"-01-01"}if(d!="on"){disposeCharts(monthlyCharts);currentChartDate="";var b=new Chart(480,250,"monthlyCont",3);b.renderChart("/strategy-chart.json?chartType=3&id="+$F("stid")+"&startDate="+c+"&endDate="+getDbDateFormat(new Date($("endDate").value))+"&invitation="+k+"&r="+Math.random());var a=new Chart(342,120,"riskRatios",3,$F("psaml"));var f=new Chart(342,120,"holdPeriod",1,$F("psaml"))}}function suspendedPass(b){if(typeof(suspended)=="undefined"||!suspended){return true}else{var a=$("ids").value.split(",");if(a.length>1||!isContains(b,a[0])){inlineMsg("recipientsCont","<strong>"+$T("tError")+"</strong><br />"+$T("tInboxSuspended"),3);return false}else{return true}}}if(!window.SI){var SI={}}SI.Files={htmlClass:"SI-FILES-STYLIZED",fileClass:"file",wrapClass:"cabinet",fini:false,able:false,init:function(){this.fini=true;var b=0;if(window.opera||(b&&b<5.5)||!document.getElementsByTagName){return}this.able=true;var a=document.getElementsByTagName("html")[0];a.className+=(a.className!=""?" ":"")+this.htmlClass},stylize:function(a){if(!this.fini){this.init()}if(!this.able){return}a.parentNode.file=a;a.parentNode.onmousemove=function(k){if(typeof k=="undefined"){k=window.event}if(typeof k.pageY=="undefined"&&typeof k.clientX=="number"&&document.documentElement){k.pageX=k.clientX+document.documentElement.scrollLeft;k.pageY=k.clientY+document.documentElement.scrollTop}var d=oy=0;var g=this;if(g.offsetParent){d=g.offsetLeft;oy=g.offsetTop;while(g=g.offsetParent){d+=g.offsetLeft;oy+=g.offsetTop}}var b=k.pageX-d;var l=k.pageY-oy;var c=this.file.offsetWidth;var f=this.file.offsetHeight;this.file.style.top=l-(f/2)+"px";this.file.style.left=b-(c-30)+"px"}},stylizeById:function(a){this.stylize(document.getElementById(a))},stylizeAll:function(){if(!this.fini){this.init()}if(!this.able){return}var a=document.getElementsByTagName("input");for(var c=0;c<a.length;c++){var b=a[c];if(b.type=="file"&&b.className.indexOf(this.fileClass)!=-1&&b.parentNode.className.indexOf(this.wrapClass)!=-1){this.stylize(b)}}}};function insertAtCursor(d,c){if(document.selection){d.focus();sel=document.selection.createRange();sel.text=c}else{if(d.selectionStart||d.selectionStart=="0"){var b=d.selectionStart;var a=d.selectionEnd;d.value=d.value.substring(0,b)+c+d.value.substring(a,d.value.length)}else{d.value+=c}}}function showHide(a,b,c){if(c==1||$(b).style.display=="none"){$(b).style.display="";$(a).onclick=function(){showHide(a,b,2);return false}}else{if(c==2||$(b).style.display==""){$(b).style.display="none";$(a).onclick=function(){showHide(a,b,1);return false}}}}function showHideSwitch(button,elem,func){if($(elem).style.display=="none"){$(elem).style.display="";$(button).onclick=function(){showHideSwitch(button,elem,func);eval(func);return false}}else{$(elem).style.display="none";$(button).onclick=function(){showHideSwitch(button,elem,func);eval(func);return false}}}var carpemouseover=false;var carpeDefaultSliderLength=80;var carpeSliderDefaultOrientation="horizontal";var carpeSliderClassName="carpe_slider";var carpeSliderDisplayClassName="carpe_slider_display";var carpesliders=[];var carpedisplays=[];var carpeslider={};var carpedisplay={};function carpeAddLoadEvent(a){var b=window.onload;if(typeof window.onload!="function"){window.onload=a}else{window.onload=function(){b();a()}}}function carpeGetElementsByClass(f){var g=new Array();var d=document.getElementsByTagName("*");var a=d.length;var h=new RegExp("\\b"+f+"\\b");for(var c=0,b=0;c<a;c++){if(h.test(d[c].className)){g[b]=d[c];b++}}return g}function carpeLeft(a,b){if(!(a=document.getElementById(a))){return 0}if(a.style&&(typeof(a.style.left)=="string")){if(typeof(b)=="number"){a.style.left=b+"px"}else{b=parseInt(a.style.left);if(isNaN(b)){b=0}}}else{if(a.style&&a.style.pixelLeft){if(typeof(b)=="number"){a.style.pixelLeft=b}else{b=a.style.pixelLeft}}}return b}function carpeTop(a,b){if(!(a=document.getElementById(a))){return 0}if(a.style&&(typeof(a.style.top)=="string")){if(typeof(b)=="number"){a.style.top=b+"px"}else{b=parseInt(a.style.top);if(isNaN(b)){b=0}}}else{if(a.style&&a.style.pixelTop){if(typeof(b)=="number"){a.style.pixelTop=b}else{b=a.style.pixelTop}}}return b}function moveSlider(d){var d=(!d)?window.event:d;if(carpemouseover){carpeslider.x=carpeslider.startOffsetX+d.screenX;carpeslider.y=carpeslider.startOffsetY+d.screenY;if(carpeslider.x>carpeslider.xMax){carpeslider.x=carpeslider.xMax}if(carpeslider.x<0){carpeslider.x=0}if(carpeslider.y>carpeslider.yMax){carpeslider.y=carpeslider.yMax}if(carpeslider.y<0){carpeslider.y=0}carpeLeft(carpeslider.id,carpeslider.x);carpeTop(carpeslider.id,carpeslider.y);var b=carpeslider.x+carpeslider.y;var c=(carpeslider.distance/carpedisplay.valuecount)*Math.round(carpedisplay.valuecount*b/carpeslider.distance);var a=Math.round((c*carpeslider.scale+carpeslider.from)*Math.pow(10,carpedisplay.decimals))/Math.pow(10,carpedisplay.decimals);carpedisplay.value=a;return false}return}function slide(l){if(!l){l=window.event}carpeslider=(l.target)?l.target:l.srcElement;var f=parseInt(carpeslider.getAttribute("distance"));carpeslider.distance=f?f:carpeDefaultSliderLength;var k=carpeslider.getAttribute("orientation");var b=((k=="horizontal")||(k=="vertical"))?k:carpeSliderDefaultOrientation;var a=carpeslider.getAttribute("display");carpedisplay=document.getElementById(a);carpedisplay.sliderId=carpeslider.id;var d=parseInt(carpedisplay.getAttribute("decimals"));carpedisplay.decimals=d?d:0;var c=parseInt(carpedisplay.getAttribute("valuecount"));carpedisplay.valuecount=c?c:carpeslider.distance+1;var h=parseFloat(carpedisplay.getAttribute("from"));h=h?h:0;var g=parseFloat(carpedisplay.getAttribute("to"));g=g?g:carpeslider.distance;carpeslider.scale=(g-h)/carpeslider.distance;if(b=="vertical"){carpeslider.from=g;carpeslider.xMax=0;carpeslider.yMax=carpeslider.distance;carpeslider.scale=-carpeslider.scale}else{carpeslider.from=h;carpeslider.xMax=carpeslider.distance;carpeslider.yMax=0}carpeslider.startOffsetX=carpeLeft(carpeslider.id)-l.screenX;carpeslider.startOffsetY=carpeTop(carpeslider.id)-l.screenY;carpemouseover=true;document.onmousemove=moveSlider;document.onmouseup=sliderMouseUp;return false}function sliderMouseUp(){if(carpemouseover){var a=(carpedisplay.value)?carpedisplay.value:0;var b=(a-carpeslider.from)/(carpeslider.scale);if(carpeslider.yMax==0){b=(b>carpeslider.xMax)?carpeslider.xMax:b;b=(b<0)?0:b;carpeLeft(carpeslider.id,b)}if(carpeslider.xMax==0){b=(b>carpeslider.yMax)?carpeslider.yMax:b;b=(b<0)?0:b;carpeTop(carpeslider.id,b)}if(document.removeEventListener){document.removeEventListener("mousemove",moveSlider,false);document.removeEventListener("mouseup",sliderMouseUp,false)}else{if(document.detachEvent){document.detachEvent("onmousemove",moveSlider);document.detachEvent("onmouseup",sliderMouseUp);document.releaseCapture()}}}carpemouseover=false}function focusDisplay(c){if(!c){c=window.event}var a=(c.target)?c.target:c.srcElement;var b=a.getAttribute("typelock");if(b=="on"){a.blur()}return}function carpeInit(){carpesliders=carpeGetElementsByClass(carpeSliderClassName);for(var a=0;a<carpesliders.length;a++){carpesliders[a].onmousedown=slide}carpedisplays=carpeGetElementsByClass(carpeSliderDisplayClassName);for(var a=0;a<carpedisplays.length;a++){carpedisplays[a].value=carpedisplays[a].defaultValue;carpedisplays[a].onfocus=focusDisplay}}carpeAddLoadEvent(carpeInit);function addEvent(d,c,a){if(d.addEventListener){d.addEventListener(c,a,false);return true}else{if(d.attachEvent){var b=d.attachEvent("on"+c,a);return b}else{return false}}}function removeEvent(f,d,b,a){if(f.removeEventListener){f.removeEventListener(d,b,a);return true}else{if(f.detachEvent){var c=f.detachEvent("on"+d,b);return c}else{alert("Handler could not be removed")}}}function getViewportHeight(){if(window.innerHeight!=window.undefined){return window.innerHeight}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientHeight}if(document.body){return document.body.clientHeight}return window.undefined}function getViewportWidth(){var b=17;var a=null;if(window.innerWidth!=window.undefined){return window.innerWidth}if(document.compatMode=="CSS1Compat"){return document.documentElement.clientWidth}}function getScrollTop(){if(self.pageYOffset){return self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}}}}function getScrollLeft(){if(self.pageXOffset){return self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollLeft){return document.documentElement.scrollLeft}else{if(document.body){return document.body.scrollLeft}}}}function alertRow(c,d){var b=document.getElementsByClassName("publisherAlertOption"+d);for(var a=0;a<b.length;a++){b[a].disabled=!c}}function saveEmailSettings(){var a=[];var c=document.getElementsByName("accountDownAlert");try{for(var b=0;b<c.length;b++){var g=c[b].id;a.push(g+"="+c[b].value+"_"+$("publisherAlertActive"+g).checked+";"+$F("monitorDayStart"+g)+"_"+$F("monitorTimeStart"+g)+";"+$F("monitorDayEnd"+g)+"_"+$F("monitorTimeEnd"+g))}}catch(f){}var d=["privateMessage=",$("privateMessage").checked,"&newFeature=",$("newFeature").checked,"&topicAutoSubscribe=",$("topicAutoSubscribe").checked,"&accountAlerts=",encodeParameter(a.join(",")),"&emailFrequency=",$F("emailFrequency"),"&weeklyCalendar=",$("weeklyCalendar").checked,"&weeklyWatchAccounts=",$("weeklyWatchAccounts").checked,"&weeklyGoals=",$("weeklyGoals").checked,"&postWatchingEmailNotification=",$("postWatchingEmailNotification").checked,"&feedAutoSubscribe=",$("feedAutoSubscribe").checked,"&tradePositionOpenEmailNotification=","&sendAddToWatchAccountEmail=",$("sendAddToWatchAccountEmail").checked,"&someonePostsInMyFeed=",$("someonePostsInMyFeed").checked].join("");fxAjax.sendRequest(fxVars.saveEmailSettings,{contentType:"application/x-www-form-urlencoded; charset=utf-8",params:{},postBody:d,method:"post",loader:true,callback:"saveEmailSettingsResponse"})}function saveEmailSettingsResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$("messagesResponse").innerHTML=c;$("messagesResponse").style.display=""}function saveTwitter(b){$("twitterResponse").style.display="none";if(validate("twitterEvery",VALID_NUMBER)&&validate("twitterHourLimit",VALID_NUMBER)){var a=["&accountId="+b,"&lots=",$("lots").checked,"&twitterTradesOpen=",$("twitterTradesOpen").checked,"&twitterTradesClose=",$("twitterTradesClose").checked,"&twitterOrdersOpen=",$("twitterOrdersOpen").checked,"&twitterOrdersClose=",$("twitterOrdersClose").checked,"&twitterSL=",$("twitterSL").checked,"&twitterTP=",$("twitterTP").checked,"&twitterPrev=",encodeParameter($("twitterPrev").value),"&twitterPost=",encodeParameter($("twitterPost").value),"&twitterHourLimit=",$F("twitterHourLimit"),"&twitterEvery=",$F("twitterEvery")];fxAjax.sendRequest(fxVars.twitterUpdate+a.join(""),{contentType:"text/xhtml",params:{},loader:true,callback:"saveTwitterResponse"})}}function saveTwitterResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");$("twitterResponse").innerHTML=c;$("twitterResponse").style.display=""}function createTwitterUrl(){var a=$("twitterAccountSelect").item($("twitterAccountSelect").selectedIndex).id;if(a!=0){$("twitterStatus").style.display="none";fxAjax.sendRequest(fxVars.twitterUrl+a,{contentType:"text/xhtml",params:{},loader:true,callback:"createTwitterUrlResponse"})}}function createTwitterUrlResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){window.location=getContent(a)}else{$("twitterStatus").innerHTML=c;$("twitterStatus").style.display=""}}var noArray=[""];var tabs1=["watched","mysystems"];var tabs2=["inboxCont","sentCont"];var tabs3=["growth","balance","profit","drawdown"];var tabs4=["avgHolding","avgTpSl"];var tabs5=["openOrders","openTrades","history","exposures"];var tabs6=["accountsDiv","privacyDiv","profileDiv","loginDetailsDiv","subscriptionsDiv","twitterDiv","invitationsDiv","blockDiv"];var tabs7=["my","watched"];var tabs8=["users","accountsCont","communityCont","strategiesCont","reviewCont"];var tabs9=["stats","gen"];var tabs10=["tradesSummaryDiv","trades","hourly","daily","riskOfRuin","duration","maeMfe"];var tabs11=["style1","style2","style3"];var tabs12=["style1","style2","style3"];var tabs13=["json","xml","apiGeneral"];var tabs14=["cra","posts1"];var tabs15=["newAd","myAds"];var tabs16=["all","byCountry"];var tabs17=["searchSettings","watchCont"];var tabs18=["magicList","currenciesList","timingList","tradeList","analyzeTags","profileTab"];var tabs19=["periods","goals","tradeBrowser","autoTradeMastersStats"];var tabs20=["similarCharts"];var tabs21=["chartContainer","tempChart"];var tabs22=["available","subscribedSystems"];var tabs23=["openTradesDiv","openOrdersDiv"];var tabs24=["growth","balance"];var tabs25=["simulationSettingsTab","simulatorRecentTab"];var tabs26=["simulatorSubscribedSystemsTab","availableSystemsTab"];var tabs27=["generalTab","passwordTab"];var tabs28=["posts1","generalDiscussion"];function switchTab(tabArray,id,el){var contId=el.parentNode;var elements=contId.getElementsByTagName("li");var i;if(id!=el){for(i=0;i<elements.length;i++){if((elements[i].className=="on")||(elements[i].className=="off")){if(el==elements[i]){elements[i].className="on"}else{elements[i].className="off"}}}if(eval(tabArray)[0].length>0){for(i=0;i<eval(tabArray).length;i++){if($(eval(tabArray)[i])&&eval(tabArray)[i]==id){$(eval(tabArray)[i]).style.display=""}else{if($(eval(tabArray)[i])){$(eval(tabArray)[i]).style.display="none"}}}}}}function handleEnter(d,b){var c=b.keyCode?b.keyCode:b.which?b.which:b.charCode;if(c==13){var a;for(a=0;a<d.form.elements.length;a++){if(d==d.form.elements[a]){break}}a=(a+1)%d.form.elements.length;d.form.elements[a].focus();return false}else{return true}}try{var TextAreaResize=Class.create();TextAreaResize.prototype={initialize:function(b,a){b=$(b);this.element=b;this.options=Object.extend({},a||{});Event.observe(this.element,"keyup",this.onKeyUp.bindAsEventListener(this));this.onKeyUp()},onKeyUp:function(){var b=this.element.cols;var a=0;$A(this.element.value.split("\n")).each(function(c){a+=1+Math.floor(c.length/b)});this.element.rows=a}}}catch(e){}function setCookie(b,d,a,c){var f=new Date();f.setTime(f.getTime()+a);document.cookie=b+"="+(c!=null&&c?escape(d):d)+";path=/ ; domain="+document.domain.replace("www","")+((a==null)?"":";expires="+f.toGMTString())}function setTimeZoneCookie(a){var b=getCookie("timezone");if(b==null||b.length==0||b!=a){setCookie("timezone",a,YEAR)}}addDOMLoadEvent=(function(){var load_events=[],load_timer,script,done,exec,old_onload,init=function(){done=true;clearInterval(load_timer);while(exec=load_events.shift()){exec()}if(script){script.onreadystatechange=""}};return function(func){if(done){return func()}if(!load_events[0]){if(document.addEventListener){document.addEventListener("DOMContentLoaded",init,false);
/*@cc_on @*/
/*@if (@_win32)
             document.write("<script id=__ie_onload defer src=//0><\/scr"+"ipt>");
             script = document.getElementById("__ie_onload");
             script.onreadystatechange = function() {
             if (this.readyState == "complete")
             init(); // call the onload handler
             };
             /*@end @*/
}if(/WebKit/i.test(navigator.userAgent)){load_timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){init()}},10)}old_onload=window.onload;window.onload=function(){init();if(old_onload){old_onload()}}}load_events.push(func)}})();addDOMLoadEvent(function(){if(typeof(SETTINGS)=="undefined"){initialize()}});function timedRefresh(a){setTimeout("location.reload(true);",a)}function analyze(c,g,k,f){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),k))){$("startDate").value=$("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),k))){$("endDate").value=$("endDate").defaultValue}var h=userFormatToDefaultFormat($F("startDate"),k);var b=userFormatToDefaultFormat($F("endDate"),k);var a=new Date(h);var d=new Date(b);if(a>d){inlineMsg("startDate",$T("tStartBeforeEnd"),3)}else{updateAdvanced(h,b,c,g,f);reloadAds()}}function analyzeStrategy(f,b,c){var a=new Date(f);var d=new Date(b);if(a>d){inlineMsg("startDate",$T("tStartBeforeEnd"),3)}else{updateAdvancedStrategy(f,b,c);reloadAds()}}function getCheckBoxesValues(b){var a=document.getElementsByName(b);var d=[];for(var c=0;c<a.length;c++){if(a[c].checked){d.push(a[c].value)}}return d.join(",")}function getCheckBoxValue(a){return $(a)!=null&&$(a).checked}function getMagicsReal(b){var a=document.getElementsByName(b);var d=[];for(var c=0;c<a.length;c++){if(a[c].checked){d.push(a[c].value)}}return d.join(",")}function updateAdvanced(a,d,m,c,q){var g=["tabs18","tradeList",$("analyzeTradeTab"),"showActualGrowth"];var o=new SwitchToTradeTab(g);if(validate("yieldStart",VALID_DOUBLE,o)&&validate("yieldEnd",VALID_DOUBLE,o)&&validate("netProfitStart",VALID_DOUBLE,o)&&validate("netProfitEnd",VALID_DOUBLE,o)&&validate("durationStart",VALID_INTEGER_OR_EMPTY,o)&&validate("durationEnd",VALID_INTEGER_OR_EMPTY,o)&&validate("pipsStart",VALID_DOUBLE,o)&&validate("pipsEnd",VALID_DOUBLE,o)&&validate("takeProfitStart",VALID_DOUBLE_POSITIVE,o)&&validate("takeProfitEnd",VALID_DOUBLE_POSITIVE,o)&&validate("stopLoss",VALID_DOUBLE_POSITIVE,o)&&validate("stopLossEnd",VALID_DOUBLE_POSITIVE,o)&&validate("sizingStart",VALID_DOUBLE_POSITIVE,o)&&validate("sizingEnd",VALID_DOUBLE_POSITIVE,o)&&validate("customDeposit",VALID_DOUBLE_POSITIVE)){var k;var b;var r;mainStrategyChartStatus=1;mainChartStatus=1;if(hasText($F("durationStart"))){b=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){r=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}var f=getCommentsOptions("commentOption");var h=["start=",getDbTimeFormat(a),"&end=",getDbTimeFormat(d),"&accountOid=",m,"&l=",c,"&invitation=",q,"&magicNumbers=",getMagicsReal("accountMagic"),"&magicNumbersValues=",getCheckBoxesValues("accountMagic"),"&symbols=",getCheckBoxesValues("accountSymbol"),"&orderTags=",getCheckBoxesValues("accountTag"),"&days=",getCheckBoxesValues("days"),"&hours=",getCheckBoxesValues("hours"),getCommentBoxesValues(),"&buySell=",getCheckBoxesValues("buySell"),"&yieldStart=",$F("yieldStart"),"&yieldEnd=",$F("yieldEnd"),"&netProfitStart=",$F("netProfitStart"),"&netProfitEnd=",$F("netProfitEnd"),"&durationStart=",b,"&durationEnd=",r,"&takeProfitStart=",$F("takeProfitStart"),"&takeProfitEnd=",$F("takeProfitEnd"),"&stopLoss=",$F("stopLoss"),"&stopLossEnd=",$F("stopLossEnd"),"&sizingStart=",$F("sizingStart"),"&sizingEnd=",$F("sizingEnd"),"&selectedTime=",getCheckBoxesValues("selectedTime"),"&pipsStart=",$F("pipsStart"),"&pipsEnd=",$F("pipsEnd"),f,"&customDeposit=",$F("customDeposit")];fxAjax.sendRequest(fxVars.updateAdvanced+h.join(""),{params:{start:a,end:d,accountOid:m,invitation:q,l:c,magicNumbers:getMagicsReal("accountMagic"),symbols:getCheckBoxesValues("accountSymbol"),orderTags:getCheckBoxesValues("accountTag"),days:getCheckBoxesValues("days"),hours:getCheckBoxesValues("hours"),comment:getCommentBoxesValues(),buySell:getCheckBoxesValues("buySell"),yieldStart:$F("yieldStart"),yieldEnd:$F("yieldEnd"),netProfitStart:$F("netProfitStart"),netProfitEnd:$F("netProfitEnd"),durationStart:b,durationEnd:r,takeProfitStart:$F("takeProfitStart"),takeProfitEnd:$F("takeProfitEnd"),stopLoss:$F("stopLoss"),stopLossEnd:$F("stopLossEnd"),sizingStart:$F("sizingStart"),sizingEnd:$F("sizingEnd"),selectedTime:getCheckBoxesValues("selectedTime"),pipsStart:$F("pipsStart"),pipsEnd:$F("pipsEnd"),commentOption:f},loader:true,callback:"updateAdvancedResponse"})}}var charts=["chartGrowth","chartBalance","chartProfit","chartDrawdown","chartMonthly","chartRatios","chartCurrency","chartHold","chartHourly","chartDaily","chartDuration","chartSymbol","chartMaeMfe"];function updateAdvancedResponse(q,A){if(!q.error){currentChartDate="";selectTimeframeHide($("customAnalysisButt"));var x=$("tradingContDiv").innerHTML;$("analyzeCont").innerHTML=q.content.data;var f=$("periods").innerHTML;$("tradingContDiv").innerHTML=x;$("periods").innerHTML=f;runAjaxScripts(q.content.data);var v=q.content.slaveMastersStats;if(v!=undefined&&$("autoTradeMastersStats")!=undefined){$("autoTradeMastersStats").innerHTML=v}if($("chart1")!=null){var t=new Chart(630,314,"chart1",0);t.renderChart("/charts.json?chartType=1&period=6&accountOid="+A.accountOid+"&l="+A.l+buildAdvancedStatisticsUrl(false,false))}try{if($("chart2")!=null){var b=new Chart(630,314,"chart2",0);b.renderChart("/charts.json?chartType=2&period=6&accountOid="+A.accountOid+"&l="+A.l+buildAdvancedStatisticsUrl(false,false))}if($("chart3")!=null){var h=new Chart(630,314,"chart3",0);h.renderChart("/charts.json?chartType=13&period=6&accountOid="+A.accountOid+"&l="+A.l+buildAdvancedStatisticsUrl(false,false))}if($("chart4")!=null){var g=new Chart(630,314,"chart4",0);g.renderChart("/charts.json?chartType=15&type=1&period=6&l=p&accountOid="+A.accountOid+"&drawdownShowType="+getRadioIndex("drawdownOptions")+buildAdvancedStatisticsUrl(false,false))}tagsColors=document.getElementsByName("tagsColors");for(var w=0;w<tagsColors.length;w++){var B=new jscolor.color(tagsColors[w],{required:false});if(tagsColors[w].value.length!=0){B.fromString(tagsColors[w].value)}}}catch(y){}try{var z=new Chart(840,319,"hourlyChart",1);z.renderChart("/charts.json?chartType=11&l=p&type="+getAttributeByRadioChecked("hourlyOptions","hourlyType")+"&accountOid="+A.accountOid+buildAdvancedStatisticsUrl(false,false));var l=new Chart(840,319,"dailyChart",1);l.renderChart("/charts.json?chartType=12&l=p&type="+getAttributeByRadioChecked("hourlyOptions","hourlyType")+"&accountOid="+A.accountOid+buildAdvancedStatisticsUrl(false,false));var a=new Chart(856,319,"scatterChart",2);a.renderChart("/charts.json?chartType=14&l=p&type="+getAttributeByRadioChecked("durationOptions","durationType")+"&accountOid="+A.accountOid+buildAdvancedStatisticsUrl(false,true))}catch(y){}if(accountVerified){var c=[];c.push(getAttributeByRadioChecked("maeMfeOptions","maeMfeType"));c.push(getAttributeByRadioChecked("maeMfeSecondOptions","maeMfeSecondType"));var m=new Chart(856,319,"scatterChartMaeMfe",2);m.renderChart("/charts.json?chartType=16&l=p&type="+c+"&accountOid="+A.accountOid+buildAdvancedStatisticsUrl(false,true))}if($("monthlyCont")!=null){var C=new Chart(480,250,"monthlyCont",3);C.renderChart("/charts.json?chartType=3&accountOid="+A.accountOid+"&monthType="+monthType+"&l="+A.l+"&startDate="+getDbDateFormat(A.end).substring(0,4)+"-01-01&endDate="+getDbDateFormat(A.end)+"&startDateYear="+getDbDateFormat(A.start)+buildAdvancedStatisticsUrl(true,false))}if($("riskRatios")!=null){var s=new Chart(342,250,"riskRatios",3,$F("psaml"))}if($("currencies")!=null){var k=new Chart(480,250,"currencies",4,$F("psaml"))}if($("holdPeriod")!=null){var r=new Chart(342,250,"holdPeriod",1,$F("psaml"))}var u=["?start=",encodeParameter(getDbTimeFormat(A.start)),"&end=",encodeParameter(getDbTimeFormat(A.end)),"&magicNumbers=",A.magicNumbers,"&symbols=",A.symbols,"&orderTags=",A.orderTags,"&days=",A.days,"&hours=",A.hours,A.comment,"&buySell=",A.buySell,"&yieldStart=",A.yieldStart,"&yieldEnd=",A.yieldEnd,"&netProfitStart=",A.netProfitStart,"&netProfitEnd=",A.netProfitEnd,"&durationStart=",A.durationStart,"&durationEnd=",A.durationEnd,"&takeProfitStart=",A.takeProfitStart,"&takeProfitEnd=",A.takeProfitEnd,"&stopLoss=",A.stopLoss,"&stopLossEnd=",A.stopLossEnd,"&sizingStart=",A.sizingStart,"&sizingEnd=",A.sizingEnd,"&selectedTime=",A.selectedTime,"&pipsStart=",A.pipsStart,"&pipsEnd=",A.pipsEnd,A.commentOption].join("");var d;var o=["pdf","csv","html"];for(var w=0;w<o.length;w++){d=$(o[w]+"Statement").href;if($is(d)){$(o[w]+"Statement").href=d.substring(0,d.indexOf("?")!=-1?d.indexOf("?"):d.length)+u}}SortableTable.find();rowIndex={}}else{if(q.content.negativeBalance!=undefined&&q.content.negativeBalance){inlineMsg("customDeposit",$T("tNegativeBalanceReached"),3)}else{inlineMsg("analyzeButton",q.message,3)}}tradeChart.write("chartContainer");if($("tradeBrowserElement").className=="on"){getTradeConfig(A.accountOid,$F("tradeSymbols"),true,"","","",null,A.l)}new Draggable("tradeBrowserWindow",{ghosting:true})}function updateAdvancedStrategy(k,b,f){var d=["tabs18","tradeList",$("analyzeTradeTab")];var h=new SwitchToTradeTab(d);if(validate("yieldStart",VALID_DOUBLE,h)&&validate("yieldEnd",VALID_DOUBLE,h)&&validate("netProfitStart",VALID_DOUBLE,h)&&validate("netProfitEnd",VALID_DOUBLE,h)&&validate("durationStart",VALID_INTEGER_OR_EMPTY,h)&&validate("durationEnd",VALID_INTEGER_OR_EMPTY,h)&&validate("takeProfitStart",VALID_DOUBLE_POSITIVE,h)&&validate("takeProfitEnd",VALID_DOUBLE_POSITIVE,h)&&validate("stopLoss",VALID_DOUBLE_POSITIVE,h)&&validate("stopLossEnd",VALID_DOUBLE_POSITIVE,h)&&validate("sizingStart",VALID_DOUBLE_POSITIVE,h)&&validate("sizingEnd",VALID_DOUBLE_POSITIVE,h)&&validate("pipsStart",VALID_DOUBLE,h)&&validate("pipsEnd",VALID_DOUBLE,h)){var a="";var c="";mainStrategyChartStatus=1;if(hasText($F("durationStart"))){a=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){c=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}var g=["&start=",getDbTimeFormat(k),"&end=",getDbTimeFormat(b),"&oid=",f,"&magicNumbers=",getMagicsReal("accountMagic"),"&days=",getCheckBoxesValues("days"),"&hours=",getCheckBoxesValues("hours"),"&buySell=",getCheckBoxesValues("buySell"),"&yieldStart=",$F("yieldStart"),"&yieldEnd=",$F("yieldEnd"),"&netProfitStart=",$F("netProfitStart"),"&netProfitEnd=",$F("netProfitEnd"),"&durationStart=",a,"&durationEnd=",c,"&takeProfitStart=",$F("takeProfitStart"),"&takeProfitEnd=",$F("takeProfitEnd"),"&stopLoss=",$F("stopLoss"),"&stopLossEnd=",$F("stopLossEnd"),"&sizingStart=",$F("sizingStart"),"&sizingEnd=",$F("sizingEnd"),"&selectedTime=",getCheckBoxesValues("selectedTime"),"&pipsStart=",$F("pipsStart"),"&pipsEnd=",$F("pipsEnd")];fxAjax.sendRequest(fxVars.updateAdvancedStrategy+g.join(""),{returnJson:true,params:{start:k,end:b,oid:f},loader:true,callback:"updateAdvancedStrategyResponse"})}}function updateAdvancedStrategyResponse(v,k){if(!v.error){selectTimeframeHide($("customAnalysisButt"));$("analyzeCont").innerHTML=v.content;runAjaxScripts(v.content);disposeCharts(charts);if($("chart1")!=null){var t=new Chart(630,319,"chart1");t.renderChart("/strategy-chart.json?chartType=1&period=6&id="+k.oid+buildChartUrl())}try{if($("chart2")!=null){var g=new Chart(630,319,"chart2");g.renderChart("/strategy-chart.json?chartType=2&period=6&id="+k.oid+buildChartUrl())}if($("chart3")!=null){var b=new Chart(630,319,"chart3");b.renderChart("/strategy-chart.json?chartType=13&period=6&id="+k.oid+buildChartUrl())}}catch(m){}var d=$F("chartSymbol1");var q=new Chart(840,319,"symbolChart1");q.renderChart("/strategy-chart.json?chartType=10&id="+k.oid+buildSymbolChartUrl(d));var r=new Chart(840,319,"hourlyChart",1);r.renderChart("/strategy-chart.json?chartType=11&l=p&type=1&id="+k.oid+buildAdvancedStatisticsUrl(false,false));var u=new Chart(840,319,"dailyChart",1);u.renderChart("/strategy-chart.json?chartType=12&l=p&type=1&id="+k.oid+buildAdvancedStatisticsUrl(false,false));var h=new Chart(856,319,"scatterChart",2);h.renderChart("/strategy-chart.json?chartType=14&l=p&type=3&id="+k.oid+buildAdvancedStatisticsUrl(false,true));if($("monthlyCont")!=null){var c=new Chart(480,250,"monthlyCont",3);c.renderChart("/strategy-chart.json?chartType=3&id="+k.oid+"&startDate="+getDbDateFormat(k.end).substring(0,4)+"-01-01&endDate="+getDbDateFormat(k.end))}if($("riskRatios")!=null){var f=new Chart(342,120,"riskRatios",3,$F("psaml"))}if($("holdPeriod")!=null){var s=new Chart(342,120,"holdPeriod",1,$F("psaml"))}var o=["?start=",encodeParameter(getDbTimeFormat(k.start)),"&end=",encodeParameter(getDbTimeFormat(k.end)),"&days=",k.days,"&hours=",k.hours,"&buySell=",k.buySell,"&yieldStart=",k.yieldStart,"&yieldEnd=",k.yieldEnd,"&netProfitStart=",k.netProfitStart,"&netProfitEnd=",k.netProfitEnd,"&durationStart=",k.durationStart,"&durationEnd=",k.durationEnd,"&takeProfitStart=",k.takeProfitStart,"&takeProfitEnd=",k.takeProfitEnd,"&stopLoss=",k.stopLoss,"&stopLossEnd=",k.stopLossEnd,"&sizingStart=",k.sizingStart,"&sizingEnd=",k.sizingEnd,"&selectedTime=",k.selectedTime,"&pipsStart=",k.pipsStart,"&pipsEnd=",k.pipsEnd].join("");var a;var l="csv";a=$(l+"Statement").href;if($is(a)){$(l+"Statement").href=a.substring(0,a.indexOf("?")!=-1?a.indexOf("?"):a.length)+o}SortableTable.find()}else{inlineMsg("analyzeButton",v.message,3)}}function getDbDateFormat(a){var a=new Date(a);return a.getFullYear()+"-"+format2Digits(a.getMonth()+1)+"-"+format2Digits(a.getDate())}function getDbTimeFormat(a){var a=new Date(a);return a.getFullYear()+"-"+format2Digits(a.getMonth()+1)+"-"+format2Digits(a.getDate())+" "+format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())}function escapeFlash(a){return a.replace(":","_")}function getMonthlyStart(){var c=new Date(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")));var a=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var b=new Date("01/01/"+getContent($("chartYearsUl").children[$("chartYearsUl").children.length-1]));return b<a?getDbDateFormat(a):getDbDateFormat(b)}function updateTwitterCharacter(b,a){$(a+"1").innerHTML=b;$(a+"2").innerHTML=b}function accountInvitation(b){var c=document.getElementsByClassName("invitationSettings");for(var a=0;a<c.length;a++){c[a].style.display="none"}var d=(b.item(b.selectedIndex)).value;$("invitation"+d).style.display="";new Tip("#reTip"+d,$F("itt"))}function saveAccountInvitation(){var c=$("accountInvitationsCombo");var a=c[c.selectedIndex].value;var b=["oid=",a];b.push("&balancePublic="+getRadioGroupValue("balancePublic"+a));b.push("&accountNumberPublic="+getRadioGroupValue("accountNumberPublic"+a));b.push("&historyPublic="+getRadioGroupValue("historyPublic"+a));b.push("&sizingPublic="+getRadioGroupValue("sizingPublic"+a));b.push("&ordersPublic="+getRadioGroupValue("ordersPublic"+a));b.push("&tradesPublic="+getRadioGroupValue("tradesPublic"+a));b.push("&commentsPublic="+getRadioGroupValue("commentsPublic"+a));b.push("&magicNumberPublic="+getRadioGroupValue("magicNumberPublic"+a));b.push("&accountTagPublic="+getRadioGroupValue("accountTagPublic"+a));b.push("&goalsPublic="+getRadioGroupValue("goalsPublic"+a));b.push("&slTpPublic="+getRadioGroupValue("slTpPublic"+a));b.push("&active="+$("invitationActive"+a).checked);fxAjax.sendRequest(fxVars.accountInvitation+b.join(""),{contentType:"text/xml",params:{oid:a},loader:true,callback:"saveAccountInvitationResponse"})}function saveAccountInvitationResponse(f,g){var a=f.getElementsByTagName("response")[0];var c=a.getAttribute("error");var d=a.getAttribute("message");if(c=="false"){var b=getContent(a);if(b.length!=0){$("invitationUrl"+g.oid).value=b}}$("accountInvitationResponse"+g.oid).innerHTML=d;$("accountInvitationResponse"+g.oid).style.display=""}function generateAccountInvitation(a){var b=["oid=",a];fxAjax.sendRequest(fxVars.generateInvitation+b.join(""),{contentType:"text/xml",params:{oid:a},loader:true,callback:"generateAccountInvitationResponse"})}function generateAccountInvitationVerify(a){var c=$("accountInvitationsCombo");var b=c[c.selectedIndex].value;if($("invitationActive"+b).checked){inlineAlert(a,"<span class=''></span>"+$T("tRegenerateUrl")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tOldUrlBlocked")+"</span></div>","generateAccountInvitation("+b+")")}else{inlineMsg("invitationActive"+b,$T("tEnableUrl"),3)}}function generateAccountInvitationResponse(f,g){var a=f.getElementsByTagName("response")[0];var c=a.getAttribute("error");var d=a.getAttribute("message");if(c=="false"){var b=getContent(a);if(b.length!=0){$("invitationUrl"+g.oid).value=b}}else{$("accountInvitationResponse"+g.oid).innerHTML=d;$("accountInvitationResponse"+g.oid).style.display=""}}function setActiveInvitation(){var b=$("accountInvitationsCombo");var a=b[b.selectedIndex].value;if(a!=0){$("invitation"+a).style.display="";new Tip("#reTip"+a,$F("itt"))}}function generateCommentDeleteVerify(d,f,b,a,c){inlineAlert(d,"<span class=''></span>"+$T("tConfirmCommentDelete")+"<br/>","addTradeComment("+f+","+b+","+a+",'"+c+"')")}function addTradeComment(f,b,a,c){if(validate(c+"text"+f,VALID_TEXT)){var g=["oid=",f,"&comment=",encodeParameter($(c+"text"+f).value),"&accountOid=",b,"&delete=",a,"&type="+c];var d=getLinksTitleByName(c+"orderFiles"+f);if(hasText(d)){g.push("&files=");g.push(encodeParameter(d))}fxAjax.sendRequest(fxVars.commentTrade+g.join(""),{contentType:"text/xml",params:{oid:f,deleteComment:a,type:c},loader:true,callback:"addTradeCommentResponse"})}}function hasText(a){try{if(a!=null){a=String(a);a=a.trim();return a.length!=0}}catch(b){}return false}function isImage(b){var a=b.substring(b.lastIndexOf(".")+1).toLowerCase();return(a=="jpg"||a=="jpeg"||a=="png"||a=="gif"||a=="bmp")}function selectTimeframeShow(a){$("timeframe").style.display="";$(a).onclick=function(){selectTimeframeHide(a)}}function selectTimeframeHide(a){if(calendarObjForForm.isVisible()){calendarObjForForm.hide()}$("timeframe").style.display="none";$(a).onclick=function(){selectTimeframeShow(a)}}var TIME_FORMAT_CUSTOM=1;function userFormatToDefaultFormat(b,d){if(d==TIME_FORMAT_CUSTOM){var c=b.split("/");var a=c[1]+"/"+c[0]+"/"+c[2];return a}return b}function updatePeriods(h,f,b,g){if(h==0){$("startDate").value=f}else{var c=new Date(userFormatToDefaultFormat(b,g));c.setDate(c.getDate()-h);var a=b.indexOf(":")!=-1;if(g==TIME_FORMAT_CUSTOM){$("startDate").value=format2Digits(c.getDate())+"/"+format2Digits(c.getMonth()+1)+"/"+c.getFullYear()}else{$("startDate").value=format2Digits(c.getMonth()+1)+"/"+format2Digits(c.getDate())+"/"+c.getFullYear()}if(a){$("startDate").value+=" "+format2Digits(c.getHours())+":"+format2Digits(c.getMinutes())}}$("endDate").value=b}function addTradeCommentResponse(m,k){var l=m.getElementsByTagName("response")[0];var s=l.getAttribute("error");var t=l.getAttribute("message");var o=getContent(l);var r=k.type;var g=k.oid;if(s=="false"){if(k.deleteComment){var q=$(r+"ballon"+g);q.onmouseover="";q.onmouseout="";Tips.remove(q);q.onclick=function(){commentTrade(g,r)};q.className="pencilSmall pointer";q.id=r+"pencil"+g;$(r+"commentDeleteButt"+g).style.display="none";$(r+"text"+g).value="";$(r+"orderFiles"+g).innerHTML=""}else{var b=getLinksTitleByName(r+"orderFiles"+g);var h=hasText(b);attachFiles(g,b,r);var d=$(r+"pencil"+g);var f=h?o+"<br/><br/>"+$T("tAttachments")+":<br/><div>"+$(r+"files"+g).innerHTML:o+"</div>";if(d!=null){d.className="ballonSmall pointer";d.id=r+"ballon"+g;buildOrderTip(d.id,f,h);d.onclick=function(){commentTrade(g,r)}}else{var q=$(r+"ballon"+g);buildOrderTip(q.id,f,h);q.onclick=function(){commentTrade(g,r)}}$(r+"commentDeleteButt"+g).style.display="";var a=htmlDecode(o.replace(/<br\/>/g,"\n"));$(r+"originalComment"+g).value=a}$(r+"history"+g).style.display="none";var c=$(r+"pencil"+g);if(c==null){c=$(r+"ballon"+g)}boldTD(c)}}function removeOrderFile(b,a){$(a+"orderFileLink"+b).remove();$(a+"orderFileRemove"+b).remove();$(a+"orderFileBr"+b).remove();if($(a+"insert"+b)){$(a+"insert"+b).remove()}}function buildOrderTip(c,b,a){if(a){new Tip("#"+c,b,{hideOthers:true,maxWidth:500,hook:{target:"rightmiddle",tooltip:"leftmiddle"}})}else{new Tip("#"+c,b,{hideOthers:true,maxWidth:500,hook:{target:"rightmiddle",tooltip:"leftmiddle"}})}}function getLinksTitleByName(d){var a=[];var c=document.getElementsByName(d);for(var b=0;b<c.length;b++){a.push(c[b].title)}return a.join(",")}function attachFiles(b,g,k){var d=$F("sessionUsername");$(k+"files"+b).innerHTML="";try{var a=g.split(",");a=orderFiles(a);for(var f=0;f<a.length;f++){var c=removeSpace(a[f]);var l=encodeParameter(c);if(isImage(c)){var m="img"+getRandomInt();$(k+"files"+b).innerHTML+="<a id="+m+' target="_blank" href="/files/'+d+"/"+l+'" style="color:white;text-align:center"></a>&nbsp;';$(m).insert(new Element("img",{src:"/files/"+d+"/"+l,style:"margin-bottom:2px; border:2px solid #5F5F5F;max-width:220px; max-height:220px"}))}else{$(k+"files"+b).innerHTML+='<a style="color:white" target="_blank" href="/files/'+d+"/"+l+'">'+c+"</a><br/>"}}}catch(h){}}function orderFiles(c){var d=[];for(var b=0;b<c.length;b++){var g=c[b];var a=g.substring(g.lastIndexOf(".")+1).toLowerCase();var f=(a=="jpg"||a=="jpeg"||a=="png"||a=="gif"||a=="bmp");if(f){d.push(g)}else{d.reverse();d.push(g);d.reverse()}}return d}function removeSpace(a){return a.replace(/\n/g,"").trim()}function closeAddTradeComment(d,c){$(c+"history"+d).style.display="none";var a=$(c+"originalComment"+d);if(a!=null){$(c+"text"+d).value=$(c+"originalComment"+d).value}var b=$(c+"pencil"+d);if(b==null){b=$(c+"ballon"+d)}b.onclick=function(){commentTrade(d,c)};boldTD(b)}function boldTD(b){var d=$(b).parentNode;if(d.tagName.toLocaleLowerCase()=="td"){d=d.parentNode}var c=d.getElementsByTagName("td");for(var a=0;a<c.length;a++){if($(c[a]).style.fontWeight!="bold"){$(c[a]).style.fontWeight="bold"}else{$(c[a]).style.fontWeight="normal"}}}function commentTrade(c,b){if(isShown("tagMenu"+b+c)){showHideTags(b+"history"+c)}if(isShown("tagMenu"+b+lastRowId)){showHideTags(b+"history"+lastRowId)}if(!isShown(b+"history"+c)){Tipped.hideAll()}var a=($(b+"pencil"+c)==null?$(b+"ballon"+c):$(b+"pencil"+c));if(!isShown(b+"history"+c)){$(b+"history"+c).style.display="";boldTD(a);a.onclick=function(){commentTrade(c,b)}}else{$(b+"history"+c).style.display="none";boldTD(a);a.onclick=function(){commentTrade(c,b)}}}var refresh=1;var lastKnownNewsTime=0;function refreshDashboardData(a){var b=getRecentTopicFromPage();if(hasText(a)){lastKnownNewsTime=a}fxAjax.sendRequest(fxVars.refreshDashboard+lastKnownNewsTime,{contentType:"text/xml",params:{oldItems:b},loader:false,callback:"refreshDashboardDataResponse"})}function refreshDashboardDataResponse(m,f){var g=m.getElementsByTagName("response")[0];var s=g.getAttribute("error");var v=g.getAttribute("message");var t=m.getElementsByTagName("news")[0];var h=m.getElementsByTagName("systems")[0];var l=m.getElementsByTagName("calendar")[0];var c=m.getElementsByTagName("topics")[0];var o=t.getAttribute("newsLastTime");if(o==""){o=lastKnownNewsTime}if(s=="false"){try{if(hasText(getContent(t))){$("scrollbar_content").innerHTML="<div id='newCont"+(refresh)+"' style='display:none'>"+getContent(t)+"</div>"+$("scrollbar_content").innerHTML;Effect.SlideDown($("newCont"+refresh),{duration:0.5});refresh++}$("recentTopicsCont").innerHTML=getContent(c);var u=getRecentTopicFromPage();setLastPostsEffect(f.oldItems,u);if(!isShown("watched")&&$J("#accountNotification").dialog("isOpen")!=true){$("systemsCont").innerHTML=getContent(h);runAjaxScripts(getContent(h))}}catch(q){}}var a=document.getElementsByName("timeNews");for(var k=0;k<a.length;k++){var r=a[k].attributes.time.value;var b=dateToString(r);if(b!="false"){a[k].innerHTML="&nbsp; "+b}}setTimeout("refreshDashboardData("+o+")",60000)}function tableSort(f,o,t,b,l,m,c,g,s,q){var d=f.getAttribute("order");var a=f.parentNode.getElementsByTagName("th");if(d=="1"){for(i=0;i<a.length;i++){a[i].className=""}}else{for(i=0;i<a.length;i++){a[i].className=""}}if(m.length>0){m="&l="+m}var k=["?pt=",o,"&st=",d,"&sb=",t,"&id=",l,m,"&ts=",q,"&p=1"];if(c.length!=0&&g.length!=0){k.push("&start=",c,"&end=",g)}if(s!=null){k.push("&invitation=",s)}var h=getComboValue("formatSlTpHistory");var r=getComboValue("timeSwitcher");fxAjax.sendRequest(fxVars.pagingUrl+k.join(""),{contentType:"text/html",params:{cont:b,slTpOption:h,showInBrokerTime:r},loader:true,callback:"tableSortResponse"})}function tableSortResponse(a,b){$(b.cont).innerHTML=a;runAjaxScripts(a);if(b.slTpOption!=undefined){showHideSlTpOptions(b.slTpOption,"")}if(b.showInBrokerTime!=undefined){tradingActivityTimeSwitcher(b.showInBrokerTime,"")}}function gup(c,b){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+c+"=([^&#]*)";var f=new RegExp(a);var d;if(b==null){d=f.exec(window.location.href)}else{d=f.exec(b)}if(d==null){return""}else{return d[1]}}function initSearchForm(){try{$("profitSelect").value=setComboValue("profitSelect",parseInt(gup("profitType")));$("profitVal").value=setComboValue("profitVal",parseInt(gup("profitValue")));$("drawdownSelect").value=setComboValue("drawdownSelect",parseInt(gup("drawType")));$("drawdownVal").value=setComboValue("drawdownVal",parseInt(gup("drawValue")));$("ageType").value=setComboValue("ageType",parseInt(gup("ageType")));$("ageSelect").value=setComboValue("ageSelect",parseInt(gup("ageValue")));$("tradingTypeSelect").value=setComboValue("tradingTypeSelect",parseInt(gup("tradingType")));$("systemTypeSelect").value=setComboValue("systemTypeSelect",parseInt(gup("systemType")));$("currSelect").value=setComboValue("currSelect",parseInt(gup("symbols")));$("accountTypeSelect").value=setComboValue("accountTypeSelect",parseInt(gup("accountType")));$("regulationTypeSelect").value=setComboValue("regulationTypeSelect",parseInt(gup("regulationType")))}catch(a){}}function setComboValue(f,d){var c=$(f);var a=c.options.length;for(var b=0;b<a;b++){if(c.options[b].value==d){c.options[b].selected="selected"}else{c.options[b].selected=""}}}var mainChartStatus=1;function updateMainChart(c,h){if(h==null){h=""}var a;var b=document.getElementsByName("growthOptions");for(var d=0;d<b.length;d++){if(b[d].checked){a=d;break}}if(mainChartStatus!=a){disposeCharts(["chartGrowth","chartBalance"]);mainChartStatus=a;var g=new Chart(630,314,"chart1",0);g.renderChart("/charts.json?chartType=1&period=6&accountOid="+c+"&size=0"+buildAdvancedStatisticsUrl(false,false));var f=new Chart(630,314,"chart2",0);f.renderChart("/charts.json?chartType=2&period=6&accountOid="+c+"&size=0"+buildAdvancedStatisticsUrl(false,false))}}var mainStrategyChartStatus=1;function updateMainStrategyChart(g){var a;var b=document.getElementsByName("growthOptions");for(var c=0;c<b.length;c++){if(b[c].checked){a=c;break}}if(mainStrategyChartStatus!=a){mainStrategyChartStatus=a;var f=new Chart(630,319,"chart1");f.renderChart("/strategy-chart.json?chartType=1&period=6&id="+g+"&size=0"+buildChartUrl());var d=new Chart(630,319,"chart2");d.renderChart("/strategy-chart.json?chartType=2&period=6&id="+g+"&size=0"+buildChartUrl())}}function buildSymbolChartUrl(b){var a=[];a.push("&symbol=");a.push(encodeParameter(encodeParameter(b)));a.push(buildAdvancedStatisticsUrl(false,false));return a.join("")}function buildAdvancedStatisticsUrl(c,m){var b=new Array();var d="";var l="";var a=$("showMain");if(hasText($F("durationStart"))){d=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){l=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}if(!c){b.push("&startDate=");b.push(escapeFlash(getDbTimeFormat((userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat"))))));b.push("&endDate=");b.push(escapeFlash(getDbTimeFormat((userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat"))))))}b.push("&magicNumbers=");if(m){b.push(getMagicsReal("accountMagic"))}else{b.push(getCheckBoxesValues("accountMagic"))}b.push("&symbols=");b.push(getCheckBoxesValues("accountSymbol"));b.push("&tags=");b.push(getCheckBoxesValues("accountTag"));b.push("&days=");b.push(getCheckBoxesValues("days"));b.push("&hours=");b.push(getCheckBoxesValues("hours"));b.push(getCommentBoxesValues());b.push("&buySell=");b.push(getCheckBoxesValues("buySell"));b.push("&yieldStart=");b.push($F("yieldStart"));b.push("&yieldEnd=");b.push($F("yieldEnd"));b.push("&netProfitStart=");b.push($F("netProfitStart"));b.push("&netProfitEnd=");b.push($F("netProfitEnd"));b.push("&durationStart=");b.push(d);b.push("&durationEnd=");b.push(l);b.push("&takeProfitStart=");b.push($F("takeProfitStart"));b.push("&takeProfitEnd=");b.push($F("takeProfitEnd"));b.push("&stopLoss=");b.push($F("stopLoss"));b.push("&stopLossEnd=");b.push($F("stopLossEnd"));b.push("&sizingStart=");b.push($F("sizingStart"));b.push("&sizingEnd=");b.push($F("sizingEnd"));b.push("&selectedTime=");b.push(getCheckBoxesValues("selectedTime"));b.push("&pipsStart=");b.push($F("pipsStart"));b.push("&pipsEnd=");b.push($F("pipsEnd"));var k=$("invitation");var g=$("showSizingCheck").checked;if(g!=null){b.push("&showLots=");b.push(g)}var f=$("showPipsCheck").checked;if(f!=null){b.push("&showPips=");b.push(f)}if($("showSymbolPipsCheck")!=undefined){var h=$("showSymbolPipsCheck").checked;if(h!=null){b.push("&showSymbolPips=");b.push(h)}}if(k!=null){b.push("&invitation=");b.push(k.value)}if(a!=null){b.push("&showMain=");b.push(a.checked)}else{b.push("&showMain=true")}b.push(getCommentsOptions("commentOption"));if($("customDeposit")!=undefined&&$F("customDeposit")!=0){b.push("&customDeposit=");b.push($F("customDeposit"))}return b.join("")}function buildChartUrl(){var b=new Array();var g=$("invitation");var a=(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var f=(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")));var h=$("showSizingCheck").checked;var d=$("showPipsCheck").checked;var k=$("showSimulated");var c=$("showMain");if(g!=null){b.push("&invitation=");b.push(g.value)}b.push("&startDate=");b.push(getDbDateFormat(a));b.push("&endDate=");b.push(getDbDateFormat(f));b.push("&showLots=");b.push(h);b.push("&showPips=");b.push(d);b.push("&magicNumbers=");b.push(getCheckBoxesValues("accountMagic"));b.push("&symbols=");b.push(getCheckBoxesValues("accountSymbol"));b.push("&tags=");b.push(getCheckBoxesValues("accountTag"));if(c!=null){b.push("&showMain=");b.push(c.checked)}else{b.push("&showMain=true")}if(k!=null){b.push("&showSimulated=");b.push(k.checked)}return b.join("")}function getMt4Servers(b,f){clearCombo("mt4ServerId");var d=$("mt4ServerId");var o=document.getElementsByName("mt4serverOption");var c=o.length;for(var g=0;g<c;g++){var m=o[g];var h=m.id.substr(8,m.id.length);var a=m.className;var l=m.value;if(l==b){var k=new Option(a,h);d.options.add(k);if(typeof(f)!="undefined"&&f==h){d.options[d.options.length-1].selected="selected"}}}if(d.options.length==0){var k=new Option("No servers",0);d.options.add(k)}}function clearCombo(b){var a=$(b);while(a.options.length!=0){a.remove(0)}}function generatOwnerKey(a){var b=["accountOid=",a];fxAjax.sendRequest(fxVars.generateOwnerKey+b.join(""),{contentType:"text/xml",params:{cont:"ownerValidationKey"},loader:true,callback:"generatOwnerKeyResponse"})}function generatOwnerKeyResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){$(f.cont).value=getContent(a)}}function resetTwitter(a){inlineAlert(a,$T("tConfirmTwitterRemove"),"executeDeleteTwitter()")}function setDefaultTwitterAlert(a,b){inlineAlert(a,$T("tUseTwitterForAll")+"<br/>"+$T("tTwitterOverwritten"),"setDefaultTwitter("+b+")")}function getComboValue(b){try{return $(b).item($(b).selectedIndex).id}catch(a){return undefined}}function executeDeleteTwitter(){var a=getComboValue("twitterAccountSelect");fxAjax.sendRequest(fxVars.twitterReset+a,{contentType:"text/xml",params:{cont:"twitterStatusOk"},loader:true,callback:"executeDeleteTwitterResponse"})}function executeDeleteTwitterResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");if(b=="false"){var c=$(g.cont);c.innerHTML=$T("tNoTwitterActive");c.className="responseRed marginT5";c.style.width="400px";$("createTwitterUrlRow").style.display="";$("resetTwitter").style.display="none"}}var savingCustomStart=false;function saveCustomStart(b,d){if(!savingCustomStart){savingCustomStart=true;var a=getDbTimeFormat((userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat"))));var c=["accountOid=",b,"&start=",a,"&custom=",d];fxAjax.sendRequest(fxVars.customStartDate+c.join(""),{contentType:"text/xml",params:{custom:d,accountOid:b,start:a},loader:true,callback:"saveCustomStartResponse"})}}function saveCustomStartResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){setDefaultDateButton(f.accountOid,f.custom);if(f.custom){$("customStartDate").innerHTML=$T("tCustomStartSet",[$("startDate").value])}else{$("customStartDate").innerHTML=""}defaultDate=f.start}else{inlineMsg("pinBg",c,3)}savingCustomStart=false}function setDefaultDateButton(a,b){if(b){$("pinBg").className="active";$("pinButt").className="pin"}else{$("pinBg").className="";$("pinButt").className="pinOff"}$("pinBg").onclick=function(){saveCustomStart(a,!b)}}function setFontWeight(b,a){if(b!=null){b.style.fontWeight=a}}function saveCustomMagics(a,h){var g=document.getElementsByName("accountMagic");var c="";for(var b=0;b<g.length;b++){var d=g[b];if(d.checked){if(h){c=c+d.value+","}}}if($("showMain")!=null&&$("showMain").checked){c=c+"a,"}if($("magic")!=null&&$("magic").checked){c=c+"m,"}c=c.substring(0,c.length-1);var f=["accountOid=",a,"&magics=",c,"&custom=",h];fxAjax.sendRequest(fxVars.customMagics+f.join(""),{contentType:"text/xml",params:{custom:h,accountOid:a},loader:true,callback:"saveCustomMagicsResponse"})}function saveCustomMagicsResponse(data,params){var response=data.getElementsByTagName("response")[0];var error=response.getAttribute("error");var message=response.getAttribute("message");if(error=="false"){setMagicButton(params.accountOid,!params.custom);var elements=document.getElementsByName("accountMagic");for(var i=0;i<elements.length;i++){var el=elements[i];if(el.checked){if(params.custom){setFontWeight($("label"+el.value),"bold");defaultMagics=eval("["+getContent(response)+"]")}else{setFontWeight($("label"+el.value),"")}}else{setFontWeight($("label"+el.value),"")}setFontWeight($("labelShowMain"),params.custom&&$("showMain").checked?"bold":"");if($("magic")!=null){setFontWeight($("labelShowManual"),params.custom&&$("magic").checked?"bold":"")}}}}function setMagicButton(a,b){if(b){$("magicsPinBg").className="";$("magicsPinButt").className="pinOff"}else{$("magicsPinBg").className="active";$("magicsPinButt").className="pin"}$("magicsPinBg").onclick=function(){saveCustomMagics(a,b)}}function inArray(d,c){var b=false;for(var a=0;a<d.length;a++){if(d[a]==c){b=true;break}}return b}function checkDefaultMagics(b){var a=false;var g=document.getElementsByName("accountMagic");var f=0;for(var c=0;c<g.length;c++){var d=g[c];if(d.checked){if(!inArray(defaultMagics,d.value)){a=true;break}f++}}if($("showMain")!=null&&$("showMain").checked){f++}if($("magic")!=null&&$("magic").checked){f++}if(f!=defaultMagics.length){a=true}setMagicButton(b,a)}function scroll(a){Effect.ScrollTo(a);return false}AIM={frame:function(g){var f="f"+getRandomInt();var b=document.createElement("DIV");b.innerHTML='<iframe style="display:none" src="about:blank" id="'+f+'" name="'+f+'" onload="AIM.loaded(\''+f+"')\"></iframe>";document.body.appendChild(b);var a=document.getElementById(f);if(g&&typeof(g.onComplete)=="function"){a.onComplete=g.onComplete}return f},form:function(b,a){b.setAttribute("target",a)},submit:function(a,d,b){if(typeof b!="undefined"){this.p=b}AIM.form(a,AIM.frame(d));if(d&&typeof(d.onStart)=="function"){return d.onStart()}else{return true}},loaded:function(c){var a=document.getElementById(c);if(a.contentDocument){var b=a.contentDocument}else{if(a.contentWindow){var b=a.contentWindow.document}else{var b=window.frames[c].document}}if(b.location.href=="about:blank"){return}if(typeof(a.onComplete)=="function"){a.onComplete(JSON.parse(b.body.innerHTML),this.p)}}};function getRandomInt(){return Math.floor(Math.random()*99999)}function hideElement(b){try{$(b).style.display="none"}catch(a){}}function showElement(b){try{$(b).style.display=""}catch(a){}}function clearElement(b){try{$(b).value=""}catch(a){}}function isVisible(b){try{return $(b).style.display==""}catch(a){return false}}function managePortfolios(){showElement("portfolioManageDiv");hideElement("accountsListDiv")}function addPortfolio(){if(validate("newPortfolioName",VALID_PORTFOLIO_NAME)){fxAjax.sendRequest(fxVars.addPortfolio+$("newPortfolioName").value,{contentType:"text/xml",params:{},loader:true,callback:"addPortfolioResponse"})}}function addPortfolioResponse(f,h){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");var c=f.getElementsByTagName("accounts")[0];var g=f.getElementsByTagName("menu")[0];if(b=="false"){$("accountsDiv").innerHTML=getContent(c);$("accountsNav").innerHTML=getContent(g);runAjaxScripts(getContent(c));runAjaxScripts(getContent(g))}}function deletePortfolio(a){fxAjax.sendRequest(fxVars.deletePortfolio+a,{contentType:"text/xml",params:{},loader:true,callback:"addPortfolioResponse"})}function setAccountPortfolio(b,a){var c=["accountOid=",b,"&portfolioOid=",a];fxAjax.sendRequest(fxVars.setAccountPortfolio+c.join(""),{params:{accountOid:b,portfolioOid:a},loader:true,callback:"setAccountPortfolioResponse"})}function setAccountPortfolioResponse(data,params){if(!data.error){$("accountsNav").innerHTML=data.content.data;runAjaxScripts(data.content.data);if($("portfoliosMessage").style.display=="none"){$("portfoliosMessage").innerHTML=data.message;showElement("portfoliosMessage");window.setTimeout(function(){Effect.toggle("portfoliosMessage","appear")},(1000))}var changedAccount=$J("#settingsAccount"+params.accountOid);var portfolio=$J("#portfolioTitle"+params.portfolioOid);var oldPortfolioOid=changedAccount.attr("portfolioOid");changedAccount.attr("class","");$J("#settingsAccountSelectField"+params.accountOid).attr("style","border: 1px solid rgb(226, 225, 225);");changedAccount.attr("portfolioOid",params.portfolioOid);changedAccount.attr("portfolioAccountOid",data.content.newPortfolioAccountOid);changedAccount.fadeOut(600,function(){portfolio.after(changedAccount);if(eval(portfolio.attr("isOpen"))){changedAccount.fadeIn(600)}});updateSettingsPortfolioAccountsSize(params.portfolioOid,oldPortfolioOid)}}function exitManagePortfolios(){hideElement("portfolioManageDiv");showElement("accountsListDiv")}function updatePortfolios(){var c=[];var b=document.getElementsByName("portfolios");if(b.length>0){for(var a=0;a<b.length;a++){c.push("&ids=");c.push(b[a].id.substring(9));c.push("&names=");c.push(encodeParameter(b[a].value))}fxAjax.sendRequest(fxVars.updatePortfolioName+c.join(""),{contentType:"text/xml",params:{},loader:true,callback:"updatePortfolioResponse"})}}function updatePortfolioResponse(f,h){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=a.getAttribute("message");var c=f.getElementsByTagName("accounts")[0];var g=f.getElementsByTagName("menu")[0];if(b=="false"){$("accountsDiv").innerHTML=getContent(c);$("accountsNav").innerHTML=getContent(g);runAjaxScripts(getContent(c));if($("portfoliosChangedMessage").style.display=="none"){$("portfoliosChangedMessage").innerHTML=d;showElement("portfoliosChangedMessage");window.setTimeout(function(){Effect.toggle("portfoliosChangedMessage","appear")},(1000))}}}function changeLanguageFooter(a){if(a!=0){if(hasText($F("sessionUsername"))){fxAjax.sendRequest(fxVars.changeLanguage+a,{contentType:"text/xml",params:{val:a},loader:false,callback:"changeLanguageResponse"})}else{setCookie("locale",a,YEAR);window.location.reload()}}return false}function changeLanguageResponse(a,b){if(!a.error){setCookie("locale",b.val,YEAR);window.location.reload()}}var translationCookie="translation";function getTextToTranslate(){var a=$F("languageSelect");if(a!=0){setCookie(translationCookie,a,YEAR);if(window.location.pathname.match("/translations")){window.location="/translations/translate/1"}else{window.location.reload()}}}function saveTranslation(b){if(tokensUsed(b)){$("saveButton"+b).disabled="disabled";var a=["id=",b,"&text=",encodeParameter($F("translation"+b))];fxAjax.sendRequest(fxVars.saveTranslation+a.join(""),{contentType:"text/xml",params:{id:b,text:$F("translation"+b)},loader:true,callback:"saveTranslationResponse"})}}function saveTranslationResponse(data,params){var response=data.getElementsByTagName("response")[0];var error=response.getAttribute("error");var message=response.getAttribute("message");var saveButton=$("saveButton"+params.id);if(error=="false"){translateArea(params.id);if(eval(getContent(response))){$("userTranslationCount").innerHTML=parseInt($("userTranslationCount").innerHTML)+1}$("translationPreview"+params.id).innerHTML=params.text}else{inlineMsg("saveButton"+params.id,message,3)}saveButton.disabled=""}function editTranslation(b){if(tokensUsed(b)){$("saveButton"+b).disabled="disabled";var a=["id=",b,"&text=",encodeParameter($F("translation"+b))];fxAjax.sendRequest(fxVars.editTranslation+a.join(""),{contentType:"text/xml",params:{id:b,text:$F("translation"+b)},loader:true,callback:"editTranslationResponse"})}}function editTranslationResponse(c,d){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){hideElement("translateArea"+d.id);$("myTranslation"+d.id).innerHTML=d.text;showElement("myTranslation"+d.id)}$("saveButton"+d.id).disabled=""}function translationDir(){if($("translation").dir=="ltr"){$("translation").dir="rtl"}else{$("translation").dir="ltr"}$("translation").focus()}function getAccountTwitter(){var a=getComboValue("twitterAccountSelect");if(a!=0){fxAjax.sendRequest(fxVars.getAccountTwitter+a,{contentType:"text/xml",params:{},loader:true,callback:"getAccountTwitterResponse"})}}function getAccountTwitterResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){$("twitterAccountDiv").innerHTML=getContent(a);prevTwitts();updateTwitterCharacter($("twitterPrev").value,"twitterPrev");updateTwitterCharacter($("twitterPost").value,"twitterPost")}}function setDefaultTwitter(a){fxAjax.sendRequest(fxVars.setDefaultTwitter+a,{contentType:"text/xml",params:{},loader:true,callback:"saveTwitterResponse"})}function translateArea(a){if($("translateArea"+a).style.display=="none"){showElement("translateArea"+a);$("translation"+a).focus();$("translation"+a).value=$("translationPreview"+a).innerHTML;setFontWeight($("textToTranslate"+a),"bold")}else{hideElement("translateArea"+a);setFontWeight($("textToTranslate"+a),"")}}function editTranslate(a){if($("translateArea"+a).style.display=="none"){showElement("translateArea"+a);$("translation"+a).focus()}else{hideElement("translateArea"+a)}}function insertToken(a,b){$("translation"+b).value+=getContent(a);hideElement(a)}function checkTokens(f){var c=$("tokensDiv"+f).children;var d=$F("translation"+f);var a=0;for(var b=0;b<c.length;b++){if(d.indexOf(getContent(c[b]),a)==-1){showElement(c[b])}else{hideElement(c[b]);a=d.indexOf(getContent(c[b]),a)+getContent(c[b]).length}}}function tokensUsed(d){var c=$("tokensDiv"+d).children;var b=0;for(var a=0;a<c.length;a++){if(c[a].style.display=="none"){b++}else{new Effect.Highlight(c[a],{duration:2,startcolor:"#FF7F84"})}}return b==c.length}function voteTranslation(b,a){fxAjax.sendRequest(fxVars.voteTranslation+b+"&vote="+a,{contentType:"text/xml",params:{id:b,vote:a},loader:true,callback:"voteTranslationResponse"})}function voteTranslationResponse(f,g){var a=f.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){var d=parseInt(getContent(a));$("userVotesCount").innerHTML=parseInt($("userVotesCount").innerHTML)+d;if(d!=0){$("voteCount"+g.id).innerHTML=parseInt($("voteCount"+g.id).innerHTML)+g.vote;if($("voteDownIco"+g.id).className=="thumbDownOn pointer"){$("voteDownIco"+g.id).className="thumbDown pointer"}else{if($("voteUpIco"+g.id).className=="thumbUpOn pointer"){$("voteUpIco"+g.id).className="thumbUp pointer";$("voteDownIco"+g.id).className="thumbDown pointer"}else{var c=g.vote<0?"Down":"Up";$("vote"+c+"Ico"+g.id).className="thumb"+c+"On pointer"}}}}}var symbolChartStatus=1;function updateSymbolsChart(c){var a;var f=document.getElementsByName("symbolOptions");for(var d=0;d<f.length;d++){if(f[d].checked){a=d;break}}if(symbolChartStatus!=a){symbolChartStatus=a;for(var d=1;d<=$F("tradesSummarySize");d++){if(rowIndex[d]){var h="chartSymbol"+d;var g=new Chart(840,319,"symbolChart"+d);var b=$("rowNum"+d).getAttribute("symbol");g.renderChart("/charts.json?chartType=10&l=p&accountOid="+c+buildSymbolChartUrl(b))}}}}function updateSymbolsChartStrategies(c){var a;var f=document.getElementsByName("symbolOptions");for(var d=0;d<f.length;d++){if(f[d].checked){a=d;break}}if(symbolChartStatus!=a){symbolChartStatus=a}for(var d=1;d<=$F("tradesSummarySize");d++){var g=new Chart(840,319,"symbolChart"+d);var b=$F("chartSymbol"+d);g.renderChart("/strategy-chart.json?chartType=10&id="+c+buildSymbolChartUrl(b))}}function updateDurationChart(a,c){var b=new Chart(856,319,"scatterChart",2);b.renderChart("/charts.json?chartType=14&l=p&type="+c+"&accountOid="+a+buildAdvancedStatisticsUrl(false,true))}function updateDurationChartStrategy(a,c){var b=new Chart(856,319,"scatterChart",2);b.renderChart("/strategy-chart.json?chartType=14&l=p&type="+c+"&id="+a+buildAdvancedStatisticsUrl(false,true))}function openAllSymbols(b){for(var a=1;a<=$F("tradesSummarySize");a++){showHide($("symbolChartMode"+a),"chartSymbolRow"+a,b)}$("allSymbolsButt").onclick=function(){openAllSymbols(b==1?2:1)}}function contestRegister(c){var a="countryId";if(!busy&&validate("firstName",VALID_EN_NAME)&&validate("lastName",VALID_EN_NAME)&&validate(a,VALID_COUNTRY)&&validate("phone",VALID_INTEGER)&&validate("phone",VALID_PHONE_CONTEST)&&validate("agree",VALID_AGREE_CONTEST)){$("contestReg").style.display="none";$("contestLoad").style.display="";busy=true;var b=["id=",c,"&firstName=",encodeParameter($F("firstName")),"&lastName=",encodeParameter($F("lastName")),"&countryId=",$F("countryId"),"&phone=",$F("phone")];fxAjax.sendRequest(fxVars.contestRegister+b.join(""),{contentType:"text/xml",params:{},loader:false,callback:"contestRegisterResponse"})}}function contestStatus(a){fxAjax.sendRequest(fxVars.contestStatus+a,{contentType:"text/xml",params:{},loader:false,callback:"contestRegisterResponse"})}function contestRegisterResponse(g,k){var b=g.getElementsByTagName("response")[0];var c=b.getAttribute("error");var f=b.getAttribute("message");var h=g.getElementsByTagName("menu")[0];var d=g.getElementsByTagName("contest")[0];hideElement("contestLoad");if(c=="false"){hideElement("contestReg");showElement("yhsm");$("yhsm").innerHTML=getContent(d);$("accountsNav").innerHTML=getContent(h);runAjaxScripts(getContent(h));var a=parseInt($("competitorsTotal").innerHTML);$("competitorsTotal").innerHTML=a+1}else{showElement("contestReg");inlineMsg("scbutt","<b>"+$T("tError")+"</b><br>"+f,3)}busy=false}var updateAccount=1;function contestActivity(c,b,d,a,f){fxAjax.sendRequest(fxVars.contestActivity+["lastTradeOid=",b,"&lastPostOid=",d,"&topicOid=",a,"&lastGeneralPostOid=",f,"&contestId=",c].join(""),{contentType:"text/xml",params:{contestId:c,topicOid:a},loader:false,callback:"contestActivityResponse"})}function contestActivityResponse(f,b){var c=f.getElementsByTagName("response")[0];var h=c.getAttribute("error");var l=f.getElementsByTagName("trades")[0];var a=f.getElementsByTagName("generalContestPosts")[0];var m=f.getElementsByTagName("posts")[0];var d=l.getAttribute("lastTradeOid");var k=m.getAttribute("lastPostOid");var g=a.getAttribute("lastGeneralPostOid");if(h=="false"){if(hasText(removeSpace(getContent(l)))){$("cra").innerHTML="<div id='newCont"+(updateAccount)+"' style='display:none'><div>"+getContent(l)+"</div></div>"+$("cra").innerHTML;Effect.SlideDown("newCont"+updateAccount,{duration:0.5});updateAccount++}if(hasText(removeSpace(getContent(m)))){hideElement("emptyPostList");$("posts1").innerHTML="<div id='newCont"+(updateAccount)+"' style='display:none'><div>"+getContent(m)+"</div></div>"+$("posts1").innerHTML;Effect.SlideDown("newCont"+updateAccount,{duration:0.5});updateAccount++}if(hasText(removeSpace(getContent(a)))){hideElement("emptyGenerealPostList");$("generalDiscussion").innerHTML="<div id='newCont"+(updateAccount)+"' style='display:none'><div>"+getContent(a)+"</div></div>"+$("generalDiscussion").innerHTML;Effect.SlideDown("newCont"+updateAccount,{duration:0.5});updateAccount++}}window.setTimeout(function(){contestActivity(b.contestId,d,k,b.topicOid,g)},10000)}var calRequests=new Object();function calendarEmailAlert(c,a,b){if(calRequests[a]!=true){calRequests[a]=true;fxAjax.sendRequest(fxVars.calendarNotification+[a,"&add=",b].join(""),{contentType:"text/xml",params:{oid:a,add:b,e:c},loader:true,callback:"calendarEmailAlertResponse"});c.cancelBubble=true;if(c.stopPropagation){c.stopPropagation()}}}function calendarEmailAlertResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if(f.add){$("calendarAlert"+f.oid).onclick=function(g){calendarEmailAlert(g?g:window.event,f.oid,false)};$("calendarAlert"+f.oid).className="notifyOn"}else{$("calendarAlert"+f.oid).onclick=function(g){calendarEmailAlert(g?g:window.event,f.oid,true)};$("calendarAlert"+f.oid).className="notifyOff"}}else{inlineMsg("calendarAlert"+f.oid,"<b>Error</b><br>"+c,3)}calRequests[f.oid]=false}function saveEmailMinAlert(l,o,d){var h="";var c=[];h=collectionCalendarFilter();var m=getCheckBoxValue("calendarBubble");var q=1;if(l=="cal"){var g=0;if(!isValidDate(userFormatToDefaultFormat($F("startDate"),o))){$("startDate").value=$("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),o))){$("endDate").value=$("endDate").defaultValue}q=$("calPeriod").value;var a=userFormatToDefaultFormat($F("startDate"),o);var f=userFormatToDefaultFormat($F("endDate"),o);var b=new Date(a);var k=new Date(f);c=["&start=",getDbTimeFormat(b),"&end=",getDbTimeFormat(k)]}if($("notifyTimeM").checked){if($("mCalendarTime").value<10){inlineMsg($("mCalendarTime"),"<strong>"+$T("tError")+"</strong><br/>"+$T("tMinimalAlert"),3);return false}if(validate("mCalendarTime",VALID_INTEGER)){g=$("mCalendarTime").value;fxAjax.sendRequest(fxVars.saveEmailMinAlert+g+"&filter="+h+"&type="+l+"&bubble="+m+"&token="+d+"&calPeriod="+q+c.join(""),{contentType:"text/xml",params:{},loader:true,callback:"saveEmailMinAlertResponse"})}}else{if($("notifyTimeH").checked){if(validate("hCalendarTime",VALID_INTEGER)){g=$("hCalendarTime").value*60;fxAjax.sendRequest(fxVars.saveEmailMinAlert+g+"&filter="+h+"&type="+l+"&bubble="+m+"&token="+d+"&calPeriod="+q+c.join(""),{contentType:"text/xml",params:{},loader:true,callback:"saveEmailMinAlertResponse"})}}}}function saveEmailMinAlertEvent(b,a){fxWebsocket.getTokenForsaveEmailMinAlert(b,a)}function saveEmailMinAlertResponse(c,f){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=getContent(a);if(b=="false"){$("chartOptions").style.display="none";if(hasText(d)){$("calendarCont").innerHTML=d;runAjaxScripts(d)}}}function collectionCalendarFilter(){var b=[];var d=document.getElementsByName("eventsSymbol");for(var c=0;c<d.length;c++){if(d[c].checked){b.push(d[c].id.toUpperCase())}}var a=[];var f=[];if(getCheckBoxValue("eventsNone")){a.push(0)}if(getCheckBoxValue("eventsLow")){a.push(1)}if(getCheckBoxValue("eventsMedium")){a.push(2)}if(getCheckBoxValue("eventsHigh")){a.push(3)}f.push(a.join("-"));f.push("_");if(b.length>0){f.push(b.join("-"))}return f.join("")}function sort(c,a,d,h,k,b,g){if(!hasText(g)){g=""}var f=["?pt=",c,"&p=1&ts=",d,"&ps=",h,"&sb=",k,"&st=",b,"&",g];fxAjax.sendRequest(fxVars.pagingUrl+f.join(""),{contentType:"text/xml",params:{container:a},loader:true,callback:"sortResponse"})}function sortResponse(a,b){$(b.container).innerHTML=a;runAjaxScripts(a)}function filterHistory(c,b){var d=[c,"&types=",getCheckBoxesValues("filterOption"),"&updateFilter=update"];if($("tabHistory")!=null&&$("tabHistory").className=="off"){d.push("&displayHistory=false")}var a=getComboValue("formatSlTpHistory");fxAjax.sendRequest(fxVars.pagingUrl+d.join(""),{contentType:"text/xhtml",params:{container:b,slTpOption:a},loader:true,callback:"filterHistoryResponse"})}function filterHistoryResponse(a,b){$(b.container).innerHTML=a;runAjaxScripts(a);$("historyTotalSpan").innerHTML="("+$F("historySize")+")";if(b.slTpOption!=undefined){showHideSlTpOptions(b.slTpOption,"")}}function addStrategy(a,f){var c;if($("fileLink"+a)==null){inlineMsg("fileHolder"+a,"</strong><br />"+$T("tChooseStrategy"),3)}else{if(validate("strategyName",VALID_NAME_1_CHAR)){if(!uploading){c=strategyFileName;var d=["strategyFile=",encodeParameter(c),"&name=",encodeParameter($F("strategyName")),"&accountOid=",$F("account"),"&privacy=",$F("SelectedStrategyPrivacy"),"&comment=",encodeParameter($F("strategyComment")),"&serverId=",$F("serverSelect")];var b=getLinksTitleByName("scriptfile"+f);if(hasText(b)){d.push("&files=");d.push(b)}fxAjax.sendRequest(fxVars.addStrategy+d.join(""),{returnJson:true,loader:true,callback:"addStrategyResponse"})}else{inlineMsg("addStrategyButton",$T("tWaitUpload"),3)}}}}function addStrategyResponse(a,b){if(!a.error){$("strategyGroupCont").innerHTML=a.content;runAjaxScripts(a.content);filesUploaded=new Array()}else{inlineMsg("addStrategyButton",a.message,4)}}function strategyCommentDelete(b,c,a,d){inlineAlert(b,"<span class=''></span>"+$T("tConfirmCommentDelete")+"<br/>","addStrategyComment("+c+","+a+","+d+")")}function addStrategyComment(b,a,d){var f="";if(!a&&validate("text"+b,VALID_TEXT)){f=encodeParameter($("text"+b).value)}var c=["oid=",b,"&comment=",f,"&delete=",a,"&page=",d];fxAjax.sendRequest(fxVars.commentStrategy+c.join(""),{returnJson:true,params:{oid:b,deleteComment:a},loader:true,callback:"addStrategyCommentResponse"})}function addStrategyCommentResponse(a,b){if(!a.error){$("myStrategies").innerHTML=a.content;runAjaxScripts(a.content)}}function addStrategyGroup(){var a=["name=",$F("groupName")];fxAjax.sendRequest(fxVars.addStrategyGroup+a.join(""),{returnJson:true,loader:true,callback:"addStrategyGroupResponse"})}function addStrategyGroupResponse(a,b){if(!a.error){$("strategyGroupCont").innerHTML=a.content;runAjaxScripts(a.content)}else{inlineMsg("addStrategyGroupButt",a.message,3)}}function getGroupStrategies(a){var b=["groupOid=",a];fxAjax.sendRequest(fxVars.getGroupStrategies+b.join(""),{returnJson:true,loader:true,callback:"getGroupStrategiesResponse"})}function getGroupStrategiesResponse(a,b){if(!a.error){$("myStrategiesTable").innerHTML=a.content;runAjaxScripts(a.content)}}function removeStrategyGroupVerify(c,a){var b=["removeStrategyGroup(","'",c,"'",")"];inlineAlert(a,$T("tConfirmStrategyDelete")+"<br/><br/><div class='center'><span class='information'>"+$T("tStrategyGroupNotDeleted")+"</span></div>",b.join(""))}function removeStrategyGroup(a){fxAjax.sendRequest(fxVars.removeStrategyGroup+"oid="+a,{returnJson:true,loader:true,callback:"removeStrategyGroupResponse"})}function removeStrategyGroupResponse(a,b){if(!a.error){$("strategyGroupCont").innerHTML=a.content;runAjaxScripts(a.content)}else{inlineMsg("account"+b.id,a.message,4)}}function updateStrategy(f,c){if(validate("strategyName"+f,VALID_NAME_1_CHAR)){var d="";if($("fileLink"+f)!=null){d=$("fileLink"+f).innerHTML}var b=["oid=",f,"&name=",encodeParameter($F("strategyName"+f)),"&groupOid=",$F("strategyGroupCombo"+f),"&privacy=",$F("strategyPrivacy"+f),"&accountOid=",$F("account"+f),"&serverId="+$F("serverSelect"+f),"&page=",c];var a=getLinksTitleByName("scriptfile"+f);if(hasText(a)){b.push("&files=");b.push(a)}fxAjax.sendRequest(fxVars.updateStrategy+b.join(""),{params:{id:f},returnJson:true,loader:true,callback:"removeStrategyGroupResponse"})}}function deleteStrategyVerify(c,a){var b=["deleteStrategy(","'",c,"'",")"];inlineAlert(a,$T("tConfirmStrategyGroupDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>",b.join(""))}function deleteStrategy(a){fxAjax.sendRequest(fxVars.deleteStrategy+a,{returnJson:true,loader:true,callback:"deleteStrategyResponse"})}function deleteStrategyResponse(a,b){if(!a.error){$("myStrategies").innerHTML=a.content;runAjaxScripts(a.content)}}function updateHourly(f,b,a){var c=new Chart(840,319,"hourlyChart",1);c.renderChart("/charts.json?chartType="+11+"&l="+a+"&accountOid="+f+"&type="+b+buildAdvancedStatisticsUrl(false,false));var d=new Chart(840,319,"dailyChart",1);d.renderChart("/charts.json?chartType="+12+"&l="+a+"&accountOid="+f+"&type="+b+buildAdvancedStatisticsUrl(false,false))}function updateStrategyHourly(b,c,a){var d=new Chart(856,319,"hourlyChart",1);d.renderChart("/strategy-chart.json?chartType="+11+"&l="+a+"&id="+b+"&type="+c+buildAdvancedStatisticsUrl(false,false));var f=new Chart(856,319,"dailyChart",1);f.renderChart("/strategy-chart.json?chartType="+12+"&l="+a+"&id="+b+"&type="+c+buildAdvancedStatisticsUrl(false,false))}function vouchUnVouchUser(f,d,b,a){var c=["to=",d,"&returnData=",b,"&vouch=",a];fxAjax.sendRequest(fxVars.rateUser+c.join(""),{params:{id:f,uid:d,returnData:b,vouch:a},loader:true,callback:"vouchUserResponse"})}function vouchUserResponse(o,b){if(!o.error){var a=parseInt(o.content.total);var g=a;var m=60;if(a>20){g=20}var c=document.getElementsByClassName("rateBar"+b.uid);var k="<div class='floatLeft' style='background:#00dd4e;width:"+Math.round(g/20*m)+"px;height:7px;'</div>";var l;for(var d=0;d<c.length;d++){c[d].innerHTML=k;l=c[d].title;try{var f=b.vouch?1:-1;c[d].title=parseInt(l.substring(0,l.indexOf(" ")))+f+l.substring(l.indexOf(" "),l.length)}catch(h){}}hideShowElementsByName("vouchSwitch"+b.uid,!b.vouch);hideShowElementsByName("unVouchSwitch"+b.uid,b.vouch);if(b.vouch){hideElement("vouchUser"+b.id)}if(b.returnData){$("vouchers").innerHTML=o.content.data;$("vouches").innerHTML=a;if(isShown("vouchers")){showElement("vouchers")}else{hideElement("vouchers")}}}}function boardAdd(){var a=["description=",encodeParameter($F("description")),"&price=",$F("price"),"&type=",$F("boardType"),"&phone=",$F("phone"),"&contact=",$F("contact"),"&site=",encodeParameter($F("site")),"&file=",encodeParameter(filesUploaded.join(",")),"&countryId=",$F("countryId")];fxAjax.sendRequest(fxVars.boardAdd+a.join(""),{params:{},returnJson:true,loader:true,callback:"boardAddResponse"})}function boardAddResponse(a,b){if(!a.error){alert("ok")}}function addGroup(){var a=["description=",$F("description"),"&name=",$F("name"),"&file=",encodeParameter(filesUploaded.join(","))];fxAjax.sendRequest(fxVars.groupAdd+a.join(""),{params:{},returnJson:true,loader:true,callback:"addGroupResponse"})}function addGroupResponse(a,b){if(!a.error){alert("ok")}}function removeGroup(a){fxAjax.sendRequest(fxVars.groupRemove+a,{params:{},returnJson:true,loader:true,callback:"removeGroupResponse"})}function removeGroupResponse(a,b){if(!a.error){alert("ok")}}function requestGroup(a){fxAjax.sendRequest(fxVars.groupRequest+a,{params:{},returnJson:true,loader:true,callback:"requestGroupResponse"})}function requestGroupResponse(a,b){if(!a.error){alert("ok")}}function removeGroupUser(b,a){fxAjax.sendRequest(fxVars.groupRemoveUser+b+"&uid="+a,{params:{},returnJson:true,loader:true,callback:"removeGroupUserResponse"})}function removeGroupUserResponse(a,b){if(!a.error){alert("ok")}}function updateGroupRequest(b,a){fxAjax.sendRequest(fxVars.groupUpdateRequest+b+"&approved="+a,{params:{},returnJson:true,loader:true,callback:"updateGroupRequestResponse"})}function updateGroupRequestResponse(a,b){if(!a.error){alert("ok")}}var BOARD_CLASSIFIEDS=1;var BOARD_PRODUCTS=2;var BOARD_SERVICES=3;function bumpBoard(b,a){fxAjax.sendRequest(fxVars.bumpBoard+b+"&type="+a,{params:{},returnJson:true,loader:true,callback:"bumpBoardResponse"})}function bumpBoardResponse(a,b){if(!a.error){alert("ok")}}function addGroupPost(a){fxAjax.sendRequest(fxVars.groupPost+a+"&text="+encodeParameter($F("post")),{params:{},returnJson:true,loader:true,callback:"addGroupPostResponse"})}function addGroupPostResponse(a,b){if(!a.error){$("groupPosts").innerHTML=a.content}}function deleteBoardAdVerify(c,a){var b=["deleteBoardAd(","'",c,"'",")"];inlineAlert(a,$F("dbaq")+"<br/><br/><div class='center'><span class='exclamation'>"+$F("ycuts")+"</span></div>",b.join(""))}function deleteBoardAd(a){fxAjax.sendRequest(fxVars.deleteBoardAd+a,{contentType:"text/xml",params:{oid:a},returnJson:true,loader:true,callback:"deleteBoardAdResponse"})}function deleteBoardAdResponse(a,b){if(!a.error){$("adRow"+b.oid).remove()}}function closeAccount(){var a=jQuery("#userPassword").val();var b=["password=",a];fxAjax.sendRequest(fxVars.closeAccount+b.join(""),{contentType:"text/xml",returnJson:true,params:{password:a},loader:true,callback:"closeAccountResponse"})}function closeAccountResponse(a,b){if(!a.error){jQuery("#deleteUserAccount").dialog("close");jQuery("#accountDeleted").html("Account successfully closed. Sorry to see you go!");jQuery("#accountDeleted").dialog({resizable:false,modal:true,width:310,buttons:[{text:"Ok",click:function(){window.location=serverPath}}]})}else{jQuery("#errorMessage").html(a.message);jQuery("#errorMessageRow").show()}}function isValidDate(a){return(isNaN(Date.parse(a))==false)}function filterCalendar(k,l){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),k))){$("startDate").value=$("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),k))){$("endDate").value=$("endDate").defaultValue}var b=collectionCalendarFilter();var a=userFormatToDefaultFormat($F("startDate"),k);var d=userFormatToDefaultFormat($F("endDate"),k);var c=new Date(a);var g=new Date(d);var h=getCheckBoxValue("calendarBubble");var f=["&start=",getDbTimeFormat(c),"&end=",getDbTimeFormat(g),"&filter=",b,"&show=show","&type=cal","&bubble=",h,"&calPeriod=",l];if(c>g){inlineMsg("startDate",$T("tStartBeforeEnd"),3)}else{fxAjax.sendRequest(fxVars.saveEmailMinAlert+f.join(""),{contentType:"text/html",loader:true,callback:"filterCalendarResponse"})}}function filterCalendarResponse(c){var a=c.getElementsByTagName("response")[0];var b=a.getAttribute("error");var d=getContent(a);if(b=="false"){$("calendarCont").innerHTML=d;runAjaxScripts(d)}}function logInAlert(b,a){inlineMsg(a,"<b>"+$T("tError")+"</b><br>"+$T("tPleaseLoginToUseFeature"),1);b.cancelBubble=true;if(b.stopPropagation){b.stopPropagation()}}function loadjscssfile(a){if(a.indexOf(".js")!=-1){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",a)}else{if(a.indexOf(".css")){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a)}}if(typeof b!="undefined"){document.getElementsByTagName("head")[0].appendChild(b)}}function outlookMap(a){var b=new SWFObject("/flash/ammap/ammap.swf","ammap","856","600","8","#fcfcfc");b.addVariable("path","/flash/ammap/");b.addVariable("settings_file",escape("/ammap_settings.xml?type="+$F("mapType")+"&r="+getRandomInt()));b.addVariable("data_file",escape("/ammap_data.xml?symbolOid="+a+"&type="+$F("mapType")+"&r=")+getRandomInt());b.addVariable("preloader_color","#999999");b.write("flashcontent")}function calClick(a){if($("calAdif"+a)){$("calAdif"+a).src="/calendar-ad.html"}fxAjax.sendRequest(fxVars.calendarClick,{contentType:"text/html",loader:false})}function trackLinkClick(b,a){var c=["link=",b,"&type=",a].join("");window.open("/link-track-redirect.html?"+c)}function blockUser(a,c){var b=["&uid=",a,"&block=",c].join("");fxAjax.sendRequest(fxVars.blockUser+b,{contentType:"text/html",params:{block:c,uid:a},returnJson:true,loader:true,callback:"blockUserResponse"})}function removeBlockUserFromList(a){fxAjax.sendRequest(fxVars.removeUserBlock+a,{contentType:"text/html",returnJson:true,loader:true,callback:"removeBlockUserFromListResponse"})}function removeBlockUserFromListResponse(a){if(!a.error){$("blockDiv").innerHTML=a.content}}function blockUserResponse(a,b){if(!a.error){$("blockButton").onclick=function(){blockUser(b.uid,!b.block)};if(b.block){$("blockButton").innerHTML=$T("tUnblockUser")}else{$("blockButton").innerHTML=$T("tBlockUser")}}}function selectAllCB(el,name){var cb=document.getElementsByName(name);var checked=eval(el.getAttribute("allChecked"));el.setAttribute("allChecked",!checked);el.innerHTML=checked?labelAll:labelNone;for(var i=0;i<cb.length;i++){if(cb[i].className.indexOf("skipCheckAll")==-1){cb[i].checked=checked?"":"checked"}}}function newsClick(b,a){$("newsTitle"+b).style.color="#a7a4a4";$("box"+b).style.color="#a7a4a4";window.open("/news-redirect.html?link="+a+"&id="+b,"Myfxbook")}function getNews(a){if(!busy){busy=true;var d;var b=document.getElementsByName("newsTimeItem");if(a){d=b[b.length-1].value;showElement("newsLoader")}else{d=b[0].value}var c=[d,"&old=",a,"&tag=",$F("nTag")];fxAjax.sendRequest(fxVars.forexNews+c.join(""),{contentType:"text/html",params:{old:a},returnJson:true,loader:false,callback:"getNewsResponse"})}}var monthsArray=[];var MAX_NEWS_ITEMS=50;function getNewsResponse(s,c){if(!s.error){try{if(c.old){$("newsCont").innerHTML+=s.content}else{$("newsCont").innerHTML="<div id='newCont"+(refresh)+"' style='display:none'>"+s.content+"</div>"+$("newsCont").innerHTML;Effect.SlideDown($("newCont"+refresh),{duration:0.5});refresh++;var r=document.getElementsByClassName("newsBoxes");if(r.length>50){for(var o=r.length-1;o>MAX_NEWS_ITEMS;o--){$(r[o]).remove()}}}}catch(k){}}hideElement("newsLoader");var f=document.getElementsByClassName("publishedNewsTime");for(var h=0;h<f.length;h++){var b=parseInt(f[h].getAttribute("data"));var g=dt.getTime()+MINUTE*dt.getTimezoneOffset()*-1;var q=g-b;var m="<span style='font-size:30px;'>";var l="</span><br/>";var d;if((q/MINUTE)<1){d=$T("tSecondsAgo",[m+(q/SECOND).toFixed(0)+l])}else{if((q/HOUR)<1){d=$T("tMinutesAgo",[m+(q/MINUTE).toFixed(0)+l])}else{if((q/DAY)<1){d=$T("tHoursAgo",[m+(q/HOUR).toFixed(0)+l])}else{var a=new Date(b);d=m+(a.getDay())+l+" "+monthsArrayGetMonth(a.getMonth())}}}f[h].innerHTML=d}if(!c.old){setTimeout("getNews("+c.old+")",30000)}busy=false}function boldColumn(a){var c=$("riskOfRuin").getElementsByClassName("col"+a);for(var b=0;b<c.length;b++){if(c[b].style.fontWeight=="bold"){c[b].style.fontWeight=""}else{c[b].style.fontWeight="bold"}}}function buildSentence(a){var b=$("riskOfRuin").getElementsByClassName("col"+a);$("sen").className="center padd10 font12";$("sen").innerHTML=$T("tChanceLosingAccount",["<span class='red bold'>"+b[1].innerHTML+"</span>","<span class='red bold'>"+b[0].innerHTML+"</span>","<span class='red bold'>"+b[2].innerHTML+" </span>"])}function cleanSentence(){$("sen").className="center padd10 font12 gray";$("sen").innerHTML=$T("tHoverOverTheDesired")}function removeFromArray(c,b){for(var a=0;a<=c.length-1;a++){if(c[a]==b){c[a]="";return c}}}function changeColor(b,c,a,d){if(d==1){$(c).style.backgorund=a;$(b).onclick=function(){changeColor(b,c,a,2);return false}}else{if(d==2){$(c).style.backgorund="";$(b).onclick=function(){changeColor(b,c,a,1);return false}}}}var WATCH_SYSTEMS_PAGE=1;var WATCH_SYSTEM_PAGE=2;var WATCH_DASHBOARD=3;function addRemoveWatch(k,a,b,f,d){if(!busy){busy=true;if(!hasText(b)){b=""}if(f=="true"){fxAjax.sendRequest(fxVars.addRemoveWatch+k+"&watchOid="+b,{params:{id:k,watchOid:b,watchType:a,session:f,add:d},loader:true,callback:"addRemoveWatchResponse"})}else{finishWatchAdd(k,a,"",f,d);if(d){hideElement("comparePromo");var h=getCookie("aWatch");if(h.indexOf("|"+k)==-1){setCookie("aWatch",h+"|"+k,YEAR,false);$("watchRow"+0).insert({after:'<tr id="watchRow'+k+'"><td class="paddlr10">'+$("systemLink"+k).innerHTML+'</td><td width="25" align="center"><a class="remove" onclick="addRemoveWatch('+k+","+WATCH_SYSTEMS_PAGE+",'');\"></a></td></tr>"})}}else{var h=getCookie("aWatch");h=h.replace("|"+k,"");setCookie("aWatch",h,YEAR,false);var g=$("watchRow"+k);if(g!=null){g.remove()}var c=$$("#watchTable tr").length;if(c<3){showElement("comparePromo")}}busy=false}}}function addRemoveWatchResponse(b,g){var c=b.error;var d=b.content.watchOid;var a=b.content.data;var f=b.content.menu;if(!c){$("watchCont").innerHTML=a;finishWatchAdd(g.id,g.watchType,d,g.session,g.add);$("accountsNav").innerHTML=f;runAjaxScripts(f)}busy=false}function finishWatchAdd(f,a,b,d,c){switch(a){case WATCH_SYSTEMS_PAGE:$$("[num="+f+"]").each(function(g){g.className=c?"starOn":"starOff";g.onclick=function(){addRemoveWatch(f,a,b,d,!c)}});break}}function loadWatchCookie(){try{var c=getCookie("aWatch");if(hasText(c)){hideElement("comparePromo");var l=c.split("|");for(var g=0;g<l.length;g++){var a=l[g];if(!hasText(a)){continue}var b=$("star"+a);if(b!=null){b.className="starOn";var h=new WatchF(a,WATCH_SYSTEMS_PAGE,"","",false);b.onclick=h.runFunc.bind(h)}var m=$("systemLink"+a);if(m!=null&&$("watchRow"+a)==null){$("watchRow"+0).insert({after:'<tr id="watchRow'+a+'"><td class="paddlr10">'+m.innerHTML+'</td><td width="25" align="center"><a class="remove" onclick="addRemoveWatch('+a+","+WATCH_SYSTEMS_PAGE+",'');\"></a></td></tr>"})}}}var d=document.getElementsByName("starLink");for(var g=0;g<d.length;g++){var b=d[g];if(b.className=="starOn"){continue}var a=b.getAttribute("num");var h=new WatchF(a,WATCH_SYSTEMS_PAGE,"","",true);b.onclick=h.runFunc.bind(h)}}catch(k){}}function WatchF(f,a,b,d,c){this.id=f;this.watchType=a;this.watchOid=b;this.session=d;this.add=c;this.runFunc=function(){addRemoveWatch(this.id,this.watchType,this.watchOid,this.session,this.add)}}var MAX_COMPARISON_ACCOUNTS=5;function getCompareAccount(a,b){closeCompareCharts();var f=$F(a);if(f!=0){fxAjax.sendRequest(fxVars.getCompareAccount+f,{contentType:"text/xml",params:{id:f,num:b},returnJson:false,loader:true,callback:"getCompareAccountResponse"})}else{for(var c=0;c<cellTypes.length;c++){var d=$(cellTypes[c]+b+"td");if(d!=null){d.innerHTML=""}}createComparePerma()}}function getCompareAccountResponse(d,f){var b=d.getElementsByTagName("response")[0];var c=b.getAttribute("error");var a=(typeof b.children!="undefined"&&b.children.length!=0)?b.children:b.childNodes;refillCompareTable(a,f.num)}function refillCompareTable(a,d){for(var b=0;b<a.length;b++){var c=$(a[b].nodeName+d+"td");if(c!=null){c.innerHTML=getContent(a[b])}}colorCompareTable()}var compareCharts=["gain","balance","equity","profit"];function closeCompareCharts(){for(var a=0;a<compareCharts.length;a++){var b=$(compareCharts[a]+"Chart");if(b!=null){if(b.style.display==""){b.style.display="none"}}}}function createComparePerma(){var a=document.getElementsByName("compareCombo");var f=[];var c=[];for(var b=0;b<a.length;b++){var d=a[b];if(d.selectedIndex!=0){c.push($F(a[b]));f.push(d.options[d.selectedIndex].id)}}if(c.length!=0){$("comparePermaLink").value=serverPath+"/compare-systems/"+f.join("-vs-")+"/"+c.join(",")}else{$("comparePermaLink").value=""}}function colorCompareTable(){for(var b=0;b<cellTypes.length;b++){var d=document.getElementsByClassName(cellTypes[b]+"Cell");var h=new Object();var a=new Object();var k;var g=0;for(var f=0;f<d.length;++f){d[f].style.color="black";if(!hasText(d[f].innerHTML)){continue}else{g++}k=parseFloat(getNumber(d[f].innerHTML));if(isNaN(k)){continue}var c=d[f].getAttribute("high");if(c!=null&&c=="none"){continue}if(c==null){if(typeof h.td=="undefined"||k>h.val){if(k>h.val&&typeof a.td=="undefined"){a.td=h.td;a.val=h.val}h.td=d[f];h.val=k}else{if((typeof a.td=="undefined"||k<a.val)&&k!=h.val){a.td=d[f];a.val=k}}}else{if(c=="min"){if(typeof h.td=="undefined"||k<h.val){if(k<h.val&&typeof a.td=="undefined"){a.td=h.td;a.val=h.val}h.td=d[f];h.val=k}else{if((typeof a.td=="undefined"||k>a.val)&&k!=h.val){a.td=d[f];a.val=k}}}else{if(c=="zero"){if(typeof h.td=="undefined"||Math.abs(k)<h.val){if(k<h.val&&typeof a.td=="undefined"){a.td=h.td;a.val=h.val}h.td=d[f];h.val=k}else{if((typeof a.td=="undefined"||Math.abs(k)>a.val)&&k!=h.val){a.td=d[f];a.val=k}}}}}}if(g>1&&typeof h.td!="undefined"&&typeof a.td!="undefined"){h.td.style.color="green";a.td.style.color="red"}}createComparePerma()}function rebuildCompareCharts(){}function compareChart(g,f){if(isVisible(g)){hideElement(g)}else{var d=document.getElementsByName("compareCombo");var c=[];for(var a=0;a<d.length;a++){var h=$F(d[a]);if(h!=0){c.push(h)}}if(c.length!=0){showElement(g);var b=new Chart(820,314,"chart"+f);b.renderChart("/compare-chart.json?ids="+c.join(",")+"&type="+f+"&r="+Math.random())}}}function saveComparison(){if(validate("compareName",VALID_NAME_1_CHAR)){if(!busy){var c=document.getElementsByName("compareCombo");var b=[];for(var a=0;a<c.length;a++){if($F(c[a])!=0){b.push($F(c[a]))}}if(b.length!=0){fxAjax.sendRequest(fxVars.saveCompare+b.join(",")+"&name="+encodeParameter($F("compareName")),{contentType:"text/xml",params:{},loader:true,callback:"saveComparisonResponse"})}else{inlineMsg($("saveCompareLink"),$T("tSelect1System"),true)}}}}function saveComparisonResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");if(b=="false"){var c=new Option(getContent(d.getElementsByTagName("name")[0]),getContent(d.getElementsByTagName("id")[0]),true);$("savedComparison").options.add(c);$("savedComparison").options[$("savedComparison").options.length-1].selected="1";showElement("saveSearch");hideElement("saveComp");showElement("remove");clearElement("compareName")}busy=false}function selectOptionByValue(a,d){var b=a.options;for(var c=0;c<b.length;c++){if(b[c].value==d){a.selectedIndex=c}}}function loadComparison(b){closeCompareCharts();var a=$("savedComparison")!=null?$F("savedComparison"):0;if(b&&a==0){clearCompare(0);clearElement("comparePermaLink");hideElement("remove")}else{fxAjax.sendRequest(fxVars.loadComparison+a,{contentType:"text/xml",params:{fill:b},returnJson:false,loader:true,callback:"loadComparisonResponse"})}}function loadComparisonResponse(k,d){var f=k.getElementsByTagName("response")[0];var q=f.getAttribute("error");var c=k.getElementsByTagName("account");if(q=="false"){showElement("remove");var s=document.getElementsByName("compareCombo");var g={};for(var o=0;o<s[0].options.length;o++){g[s[0].options[o].value]=true}for(var r=0;r<s.length;r++){for(var h=0;h<c.length;h++){var b=getContent(c[h].getElementsByTagName("id")[0]);var a=c[h].getElementsByTagName("name")[0];var m=a.getAttribute("clean");var l=new Option(getContent(a),b);l.id=m;if(!(b in g)){s[r].options.add(l)}}}if(d.fill){for(var h=0;h<c.length&&h<MAX_COMPARISON_ACCOUNTS;h++){selectOptionByValue(s[h],getContent(c[h].getElementsByTagName("id")[0]));refillCompareTable(typeof c[h].children!="undefined"?c[h].children:c[h].childNodes,h+1)}clearCompare(c.length)}}}function clearCompare(c){var b=document.getElementsByName("compareCombo");for(var d=MAX_COMPARISON_ACCOUNTS;d>c;d--){b[d-1].selectedIndex=0;for(var a=0;a<cellTypes.length;a++){var f=$(cellTypes[a]+d+"td");if(f!=null){f.innerHTML=""}}}}function removeComparison(){if(!busy){busy=true;fxAjax.sendRequest(fxVars.removeComparison+$F("savedComparison"),{contentType:"text/xml",params:{selectedIndex:$("savedComparison").selectedIndex},returnJson:true,loader:true,callback:"removeComparisonResponse"})}}function removeComparisonResponse(a,b){if(!a.error){$("savedComparison").options[b.selectedIndex].remove();hideElement("remove");clearCompare(0);clearElement("comparePermaLink")}busy=false}function getNumber(a){return a.replace(/[^0-9.-]/g,"")}function addTradeDiary(f,b,a,c){if(validate(c+"text"+f,VALID_TEXT)){var g=["oid=",f,"&comment=",encodeParameter($(c+"text"+f).value),"&accountOid=",b,"&delete=",a,"&type="+c];var d=getLinksTitleByName(c+"orderFiles"+f);if(hasText(d)){g.push("&files=");g.push(d)}fxAjax.sendRequest(fxVars.tradeDiary+g.join(""),{contentType:"text/xml",params:{oid:f,deleteComment:a,type:c},loader:true,callback:"addTradeDiaryResponse"})}}function addTradeDiaryResponse(g,h){var a=g.getElementsByTagName("response")[0];var b=a.getAttribute("error");var f=a.getAttribute("message");var k=getContent(a);var c=h.type;var d=h.oid;if(b=="false"){if(h.deleteComment){}}}var templateMap={};function addTimerTemplate(c,b,a){templateMap[c]={template:b,func:a};countDownTimer(c)}function countDownTimer(a){var k=templateMap[a].template;var f=parseInt($(a).getAttribute("time"));var d=f;var l=Math.floor(d/day);d-=l*day;var g=Math.floor(d/hour);d-=g*hour;var c=Math.floor(d/minute);d-=c*minute;var h=Math.floor(d/second);k=k.replace("{0}",l);k=k.replace("{1}",g);k=k.replace("{2}",c);k=k.replace("{3}",h);$(a).innerHTML=k;var b=f-1000;if(b<=0){templateMap[a].func()}else{$(a).setAttribute("time",b);setTimeout('countDownTimer("'+a+'")',1000)}}function rateTopics(a,b){disable("rateButton");var c=["&topicOid=",a,"&rating=",getRadioValue("rate")];fxAjax.sendRequest(fxVars.rateTopics+c.join(""),{contentType:"text/xml",params:{ratingVotes:b},loader:true,callback:"rateTopicsResponse"})}function rateTopicsResponse(f,g){var a=f.getElementsByTagName("response")[0];var c=a.getAttribute("error");if(c=="false"){$("rateResponse").innerHTML=$T("tThankYou");var d=getContent(a);var b="";for(i=0;i<Math.round(d);i++){b=b+"<img src='"+staticServerPath+"/images/star-small.png' alt='' style='margin-right:-4px' alt='Full Star' title='"+$T("tVotesAverageRating",[g.ratingVotes+1,d])+"'/>"}for(i=0;i<5-Math.round(d);i++){b=b+"<img src='"+staticServerPath+"/images/star-small-empty.png' alt='' style='margin-right:-4px' alt='Empty Star' title='"+$T("tVotesAverageRating",[g.ratingVotes+1,d])+"'/>"}$("starRating").innerHTML=b;enable("rateButton");hideElement("rateTopic")}else{}}function dashAccountsHide(){var d=document.getElementsByName("portfolioAccount");var a=[];for(var c=0;c<d.length;c++){var b=d[c].value;if(!d[c].checked){a.push(b)}}setCookie("hpc",a.join("~"),YEAR,false);refreshDashSystemsTable()}function checkMtLogin(c,b,a){fxAjax.sendRequest(fxVars.checkMtLogin+c+"&lastStatus="+b,{contentType:"text/xml",params:{id:c,newAccount:a},loader:false,callback:"checkMtLoginResponse"})}var STATUS_LOGIN_ACCOUNT_EXIST=-2;var STATUS_LOGIN_PENDING=0;var STATUS_LOGIN_PASS=1;var STATUS_LOGIN_FAILED=2;var STATUS_CREATING_ACCOUNT=3;var STATUS_CALCULATING=4;var STATUS_CALC_COMPLETE=5;var STATUS_SERVER_DOWN=6;var STATUS_ERROR=7;var STATUS_OWNER_VERIFICATION_DONE=8;var STATUS_OWNER_VERIFICATION_FAILED=9;function checkMtLoginResponse(data,params){var response=data.getElementsByTagName("response")[0];var accountUrl=getContent(data.getElementsByTagName("accountUrl")[0]);var accountOid=getContent(data.getElementsByTagName("accountOid")[0]);var owner=eval(getContent(data.getElementsByTagName("ownerVerified")[0]));var info=getContent(data.getElementsByTagName("info")[0]);var error=response.getAttribute("error");var message=response.getAttribute("message");var code=response.getAttribute("code");var status=parseInt(response.getAttribute("newAccountStatus"));var hideLoader=true;if(error=="false"&&status!=STATUS_ERROR){if(params.newAccount){$("loginResponse").innerHTML=message+info;if(status==STATUS_LOGIN_PENDING||status==STATUS_LOGIN_PASS||status==STATUS_CREATING_ACCOUNT||status==STATUS_CALCULATING){checkMtLogin(params.id,status,true);hideLoader=false}else{if(status==STATUS_LOGIN_FAILED||status==STATUS_CALC_COMPLETE||status==STATUS_SERVER_DOWN){if(status==STATUS_CALC_COMPLETE){hideElement("settings");hideElement("broker");showElement("connection");$("takeMe").href=accountUrl;$("setPrivacy").onclick=function(){getAccountForm(parseInt(accountOid))}}}}}else{showElement("loginResponse");if(status==STATUS_LOGIN_PENDING||status==STATUS_LOGIN_PASS||status==STATUS_CALCULATING){$("loginResponse").innerHTML=message;checkMtLogin(params.id,status);hideLoader=false}else{if(status==STATUS_LOGIN_FAILED||status==STATUS_OWNER_VERIFICATION_FAILED){showElement("testButton");$("loginResponse").innerHTML=message}else{if(status==STATUS_CALC_COMPLETE){if(owner){if($("ov")){$("ov").value=true}hideElement("testButton");hideElement("ownerValidationKey");showElement("validPass")}else{showElement("testButton")}$("loginResponse").innerHTML=message;if($("wd")){$("wd").value=true}}else{if(status==STATUS_SERVER_DOWN){$("loginResponse").innerHTML=message}else{if(status==STATUS_OWNER_VERIFICATION_DONE){if(owner){if($("ov")){$("ov").value=true}hideElement("testButton");hideElement("loginResponse");hideElement("ownerValidationKey");showElement("validPass")}}}}}}}}else{$("loginResponse").innerHTML=message;if(params.newAccount){$("loginResponse").innerHTML+=getContent(response)}else{}}if(hideLoader){hideElement("loginLoad");hideElement("overlay")}}function returnToAddAccount(){showElement("settings");hideElement("connection");showElement("broker");$("status1").src="/../images/circle1.gif";$("status2").src="/../images/circle1.gif";$("status3").src="/../images/circle1.gif"}function tryMtLogin(a,f){hideElement("loginResponse");var c=true;var d=["&newAccount=",a,"&id=",f];if(a){var b=$("serverId").value;if(validate("systemName",VALID_SYSTEM_NAME)){if(b==0&&!$("serverId").disabled){inlineMsg("serverId",$T("tChooseBroker"),3);c=false}if(c&&validate("accountId",VALID_ACCOUNT)&&validate("investorPassword",VALID_ACCOUNT_PASSWORD)){showElement("overlay");showElement("loginResponse");$("loginResponse").innerHTML="Connecting to your account <img src='../../../images/circle1.gif' alt=''";showElement("loginLoad");d.push("&accountId=",$F("accountId"),"&serverId=",$("serverId").value,"&platformId=",$("platformId").value,"&name=",encodeParameter($F("systemName")));d.push("&mt4ServerId=",$("mt4ServerId").value,"&investorPassword=",encodeParameter($F("investorPassword")))}else{c=false}}}else{showElement("loginResponse");showElement("loginLoad");hideElement("testButton");$("loginResponse").innerHTML="Connecting to your account";d.push("&mt4ServerId=",$F("mt4ServerId"),"&investorPassword=",$F("investorPassword"))}if(c){fxAjax.sendRequest(fxVars.tryMtLogin+d.join(""),{contentType:"text/xml",params:{id:f,newAccount:a},loader:false,callback:"checkMtLoginResponse"})}}function monthsArrayGetMonth(a){if(monthsArray.length==0){monthsArray=new Array($T("tJanuary"),$T("tFebruary"),$T("tMarch"),$T("tApril"),$T("tMay"),$T("tJune"),$T("tJuly"),$T("tAugust"),$T("tSeptember"),$T("tOctober"),$T("tNovember"),$T("tDecember"))}return monthsArray[a]}function switchPublish(a,b,c){if(!busy){busy=true;fxAjax.sendRequest(fxVars.switchPublish+a+"&accountOid="+b,{contentType:"text/xml",params:{old:a,accountOid:b,isValidatedOnFirstTime:c},loader:true,returnJson:true,callback:"switchPublishResponse"})}}function switchPublishResponse(a,b){if(!a.error){if(b.old){if(b.isValidatedOnFirstTime){$("switchButton").innerHTML='<span class="underline">Use the login credentials to update my account</span> <span class="red">(Beta)</span>';$("switchButton").onclick=function(){switchPublish(false,b.accountOid,b.isValidatedOnFirstTime)};showElement("switchButton")}else{hideElement("switchButton")}hideElement("testButton");hideElement("loginTitle");hideElement("loginField")}else{$("switchButton").innerHTML='<span class="underline">Use the publisher/EA to update my account</span>';$("switchButton").onclick=function(){switchPublish(true,b.accountOid,b.isValidatedOnFirstTime)};if($F("wd")=="false"&&$F("ov")=="false"){showElement("testButton")}showElement("accountId");showElement("loginTitle");showElement("loginField");showElement("switchButton")}}else{showElement("loginResponse");$("loginResponse").innerHTML=a.message}busy=false}var MRC_COOKIE="mrc";function masterSlaveSwitch(){var a=$F("mrcSelect");if(a==MRC_COOKIE){setCookie(MRC_COOKIE,'""',YEAR)}else{setCookie(MRC_COOKIE,'""',0)}location.reload(true)}function switchAccountAddForm(a){showElement("f");switch(parseInt(a)){case 0:hideElement("settings");hideElement("fxcmText");hideElement("f");hideElement("oanda");hideElement("dukascopy");break;case 2:hideElement("fxcmText");showElement("settings");setAccountForm(a);hideElement("oanda");break;case 3:hideElement("oanda");showElement("fxcmText");hideElement("settings");window.location.href=$F("tradingStationLink");break;case 4:hideElement("settings");hideElement("fxcmText");hideElement("f");showElement("oanda")}}function addOrderTagMap(a,d,k,c,g,l){if(l=="h"){tabId=0}if(l=="o"){tabId=2}if(l=="t"){tabId=1}var f=$F("originalTagColor"+d);var b=$F("originalTags"+d);var h=["orderId=",a,"&tagId=",d,"&accountOid=",k,"&selected=",g,"&oid=",c,"&type=",tabId];fxAjax.sendRequest(fxVars.addOrderTagMap+h.join(""),{returnJson:true,params:{orderid:a,tagId:d,accountOid:k,oid:c,color:f,name:b,selected:g,type:l,tabid:tabId},loader:false,callback:"addOrderTagResponse"})}function addOrderTagResponse(a,h){if(!a.error){var f=getContent(a.response);var g;var c=escapeHtml(h.name);if(h.selected){g="allOrderTags"+h.type+h.orderid;$("tagWindow"+h.type+h.orderid).appendChild(new Element("div",{style:"width:6px;height:6px;background:#"+h.color,id:"tagColor"+h.type+h.orderid+""+h.tagId,name:c,className:"floatLeft"}))}else{g="addTags"+h.type+h.orderid;$("tagColor"+h.type+h.orderid+""+h.tagId).remove()}$(h.type+""+h.orderid+""+h.tagId).remove();var b=new Element("div",{id:h.type+""+h.orderid+""+h.tagId,className:"tagBG"});var k=new Element("div",{className:"tagBlock",id:"c"+h.type+""+h.orderid+""+h.tagId+"",style:"background:#"+h.color});var d=new Element("a",{href:"javascript:void(0);",style:"text-decoration:none",id:"v"+h.type+""+h.orderid+""+h.tagId+"",className:"underline allTagsList"+h.type});b.onclick=function(){addOrderTagMap(h.orderid,h.tagId,h.accountOid,f,!h.selected,h.type,h.tabid)};d.update(c);b.appendChild(k);b.appendChild(d);$(g).appendChild(b);if($$("#allOrderTags"+h.type+h.orderid+" div.tagBG").length>0){hideElement("pointer"+h.type+h.orderid);hideElement("noTagsAttached"+h.type+h.orderid)}else{$("pointer"+h.type+h.orderid).style.display="";showElement("noTagsAttached"+h.type+h.orderid)}if($$("#addTags"+h.type+h.orderid+" div.tagBG").length>0){hideElement("noTags"+h.type+h.orderid)}else{showElement("noTags"+h.type+h.orderid)}}else{inlineMsg("addButton",a.message,3)}updateTagTip("tagTd"+h.type+h.orderid)}function deleteOrderTagMessage(a){inlineAlert($("remove"+a),$T("tConfirmTagDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>","deleteOrderTag("+a+")")}function deleteOrderTag(a){fxAjax.sendRequest(fxVars.deleteOrderTag+a,{returnJson:true,params:{oid:a,name:$("checkedOrder"+a).value},loader:true,callback:"deleteTagResponse"})}function deleteTagResponse(a,h){var g;var b;var f;if(!a.error){$("tagColor"+h.oid).remove();$("originalTagColor"+h.oid).remove();$("checkedOrder"+h.oid).remove();$("originalTags"+h.oid).remove();$("remove"+h.oid).remove();$("orderTag"+h.oid).remove();var d=document.getElementsByName("recordId");for(var c=0;c<d.length;c++){b=$(d[c]).getAttribute("recordId");f=$(d[c]).getAttribute("tagType");if($(f+""+b+""+h.oid)!=null){$(f+""+b+""+h.oid).remove()}if($("tagColor"+f+""+b+h.oid)!=null){$("tagColor"+f+""+b+h.oid).remove()}if($("saveButton"+h.oid)){$("saveButton"+h.oid).remove()}if($("cancel"+h.oid)){$("cancel"+h.oid).remove()}if($$("#allOrderTags"+f+b+" div.tagBG").length>0){hideElement("pointer"+f+b);hideElement("noTagsAttached"+f+b)}else{$("pointer"+f+b).style.display="";showElement("noTagsAttached"+f+b)}if($$("#addTags"+f+b+" div.tagBG").length>0){hideElement("noTags"+f+b)}else{showElement("noTags"+f+b)}}if(document.getElementsByName("accountTag").length==0){hideElement("allTagsCheck");showElement("noTagsDiv")}}else{inlineMsg("addButton",a.message,3)}updateAllTagsTips()}function updateOrderTag(f){var g=new Array();var c=$F("checkedOrder"+f);var b=$F("originalTags"+f);var a=$("tagColor"+f).getAttribute("hex");var d=$F("originalTagColor"+f);if((c!=b&&validate($("checkedOrder"+f),VALID_NAME))||a!=d){g.push("&tagOid=");g.push(f);if(c!=b){g.push("&tagName=");g.push(encodeParameter(c))}g.push("&tagColor=");g.push(a)}fxAjax.sendRequest(fxVars.updateOrderTag+g.join(""),{returnJson:true,params:{tagOid:f},loader:true,callback:"updateTagResponse"})}function updateTagResponse(a,h){if(!a.error){var c;var f;var b;var g;f=document.getElementsByName("recordId");c=$("tagColor"+h.tagOid).getAttribute("hex");$("originalTags"+h.tagOid).value=$F("checkedOrder"+h.tagOid);$("originalTagColor"+h.tagOid).value=c;for(var d=0;d<f.length;d++){b=$(f[d]).getAttribute("recordId");g=$(f[d]).getAttribute("tagType");if($("tagColor"+g+""+b+""+h.tagOid)!=null){$("tagColor"+g+""+b+""+h.tagOid).style.backgroundColor="#"+c}$("c"+g+""+b+""+h.tagOid).style.backgroundColor="#"+c;$("v"+g+""+b+""+h.tagOid).innerHTML=$F("checkedOrder"+h.tagOid)}$("labelOrderTag"+h.tagOid).innerHTML=$F("checkedOrder"+h.tagOid);$("color"+h.tagOid).style.background="#"+c;hideElement("cancel"+h.tagOid);hideElement("saveButton"+h.tagOid)}else{inlineMsg("addButton",a.message,3)}updateAllTagsTips()}function createOrderTag(b){if(validate($("checkedOrder"),VALID_NAME)){var a=$("addTagColor").getAttribute("hex");var c=["&name=",encodeParameter($F("checkedOrder")),"&tagColor=",a];fxAjax.sendRequest(fxVars.createOrderTag+c.join(""),{returnJson:true,params:{name:escapeHtml($F("checkedOrder")),accountOid:b,color:a},loader:true,callback:"createTagResponse"})}}function TagF(g,d,a,f,c,b){this.orderid=g;this.tagId=d;this.accountOid=a;this.oid=f;this.selected=c;this.type=b;this.runFunc=function(){addOrderTagMap(this.orderid,this.tagId,this.accountOid,this.oid,this.selected,this.type)}}function createTagResponse(s,A){if(!s.error){var u;var o;var a=getContent(s.response);var t;var v;var h;var d,m;var f;var r=5;$("checkedOrder").value="";var g=new Element("div",{id:"orderTagInfo"+a,className:"marginB5"});g.innerHTML+="<INPUT type='text' class='field3 color' hex='"+A.color+"' name='tagsColors' value='' style='width:16px'  id='tagColor"+a+"' onchange='tagChanged("+a+")'/>";g.innerHTML+="<INPUT type='text' name='originalTagsColors' value='"+A.color+"' style='display:none' id='originalTagColor"+a+"'>";g.innerHTML+="<INPUT type='text' name='tagsNumbers' tagId='"+a+"' value='"+A.name+"' id='checkedOrder"+a+"' class='field1' onkeypress='tagChanged("+a+")'/>";g.innerHTML+="<INPUT type='text' name='originalTagsNumbers' style='display:none' value='"+A.name+"' id='originalTags"+a+"'>";var b=new Element("input",{id:"saveButton"+a,type:"button",value:"Save",style:"display:none;",className:"miniOff"});b.onclick=function(){updateOrderTag(a)};var k=new Element("input",{id:"cancel"+a,type:"button",value:"Cancel",style:"display:none;",className:"miniOff"});k.onclick=function(){cancel(a)};var c=new Element("input",{id:"remove"+a,type:"button",value:"Delete",style:"display:",className:"miniOff"});c.onclick=function(){deleteOrderTagMessage(a)};g.appendChild(c);g.appendChild(b);g.appendChild(k);$("orderTagCont").appendChild(g);t=document.getElementsByName("tagsColors");for(var x=0;x<t.length;x++){var B=new jscolor.color(t[x],{required:false});if(t[x].value.length!=0){B.fromString(t[x].value)}}u=document.getElementsByName("recordId");v=$("tagColor"+a).getAttribute("hex");for(var x=0;x<u.length;x++){o=$(u[x]).getAttribute("recordId");h=$(u[x]).getAttribute("tagType");var z=new Element("div",{id:h+""+o+""+a,className:"tagBG"});var D=new Element("div",{className:"tagBlock",id:"c"+h+""+o+""+a,style:"background:#"+v});var q=new TagF(o,a,A.accountOid,0,true,h);var l=new Element("a",{href:"javascript:void(0);",style:"text-decoration:none",id:"v"+h+""+o+""+a,className:"underline allTagsList"+h});z.onclick=q.runFunc.bind(q);l.update(A.name);z.appendChild(D);z.appendChild(l);$("addTags"+h+o).appendChild((z));hideElement("noTags"+h+o)}var C=new Element("div",{id:"orderTag"+a,className:"filterTag paddL10"});C.innerHTML+="<input class='floatLeft' type='checkbox' name='accountTag' id='analyseTag"+a+"' value='"+a+"'>";C.innerHTML+="<div class='floatLeft' id='color"+a+"' style='margin:4px 4px 0 4px;width:8px;height:8px;background:#"+v+"'>";C.innerHTML+="<label  for='analyseTag"+a+"'  id='labelOrderTag"+a+"'>"+A.name+"";showElement("analyzeTags");var w=$$("#analyzeTable tr").last();var y=$$("#analyzeTable td").last();f=$$("#analyzeTable td").length;if(f%r==0){d=new Element("tr",{});m=new Element("td",{});m.appendChild(C);d.appendChild(m);w.insert({after:d})}else{m=new Element("td",{});m.appendChild(C);y.insert({after:m})}if(f==0){showElement("allTagsCheck");hideElement("noTagsDiv")}}else{inlineMsg("addButton",s.message,3)}jQuery(".addTagsWindow").each(function(){var E=jQuery(".addTagsWindow");var F=jQuery(this);F.append(F.find(".tagBG").get().sort(function(H,G){var J=jQuery(H).find("a").text();var I=jQuery(G).find("a").text();if(J>I){return 1}if(J<I){return -1}return 0}))});jQuery("#orderTagCont").each(function(){var E=jQuery(this);E.append(E.find("div.marginB5").get().sort(function(G,F){var I=jQuery(G).find('[name="tagsNumbers"]').val();var H=jQuery(F).find('[name="tagsNumbers"]').val();if(I>H){return 1}if(I<H){return -1}return 0}))});switchTab("tabs18","analyzeTags",$("orderTagTab"))}function isShown(a){return $(a)!=null&&$(a).style.display==""}var lastRowId=undefined;function showHideTags(b,a){var c=$(b);if(c){if(isShown(c.getAttribute("commentWindowId"))){boldTD(c.getAttribute("tagIconId"))}if(isShown(c.getAttribute("tagWindowId"))){hideElement(c.getAttribute("tagWindowId"));boldTD(c.getAttribute("tagIconId"));lastRowId=undefined}else{boldTD(c.getAttribute("tagIconId"));if(a==null&&lastRowId!=undefined){showHideTags(lastRowId,true)}showElement(c.getAttribute("tagWindowId"));lastRowId=b}}}function tagChanged(a){showElement("saveButton"+a);showElement("cancel"+a)}function cancel(b){$("checkedOrder"+b).value=$("originalTags"+b).value;$("tagColor"+b).setAttribute("hex",$("originalTagColor"+b).value);var a=new jscolor.color($("tagColor"+b),{required:false});if($("tagColor"+b).value.length!=0){a.fromString($("tagColor"+b).value)}hideElement("cancel"+b);hideElement("saveButton"+b)}function hideLastWindow(){if(lastRowId){hideElement("orderMenu");hideElement($(lastRowId).getAttribute("tagWindowId"));boldTD($(lastRowId).getAttribute("tagIconId"));lastRowId=undefined}}function updateQuotes(){var a=collectQuotesParamters();fxAjax.sendRequest(fxVars.updateQuotes+a.join(","),{contentType:"text/html",returnJson:true,loader:true,callback:"updateQuotesResponse"})}function updateQuotesResponse(a){if(!a.error){$("liveRatesDiv").innerHTML=a.content;runAjaxScripts(a.content)}}function collectQuotesParamters(){var a=new Array();a.push($("quotes1").options[$("quotes1").selectedIndex].value);a.push($("quotes2").options[$("quotes2").selectedIndex].value);a.push($("quotes3").options[$("quotes3").selectedIndex].value);a.push($("quotes4").options[$("quotes4").selectedIndex].value);a.push($("quotes5").options[$("quotes5").selectedIndex].value);return a}function getFileLink(b){var a=$(b);if(a.type=="image"){return"<a href='"+a.href+"' target='_blank'><img src='"+a.href+"'/></a>"}else{return"<a href='"+a.href+"' target='_blank'>"+a.title+"</a>"}}function dateToString(c){var b=dt.getTime();b+=MINUTE*dt.getTimezoneOffset()*-1;var f=b-c;if((f/HOUR)<1){var d=Math.floor(f/MINUTE);if(d<=0){if((Math.floor(f/SECOND))==0){return $T("tAmomentAgo")}if((Math.floor(f/SECOND))<0){return $T("tAsecondAgo")}else{return $T("tSecondsAgo",[Math.floor(f/SECOND)])}}else{if(d==1){return $T("tOneMinuteAgo")}else{return $T("tMinutesAgo",[d])}}}if((f/DAY)<1){var a=Math.floor(f/HOUR);if(a<=1){return $T("tOneHourAgo")}else{return $T("tHoursAgo",[a])}}if((f/DAY)>1){return"false"}}function rateVps(a){if(isRated()){var b=["vpsId=",a,"&features=",$("features").value,"&pricing=",$("pricing").value,"&service=",$("service").value,"&easeOfUse=",$("easeOfUse").value].join("");fxAjax.sendRequest(fxVars.rateVps+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateReviewResponse(c,a){if(!c.error){$(a).innerHTML=c.content.data;runAjaxScripts(c.content.data);var b=FusionCharts("chartRate");b.setXMLData(c.content.chartData)}else{inlineMsg("rateButton","<strong>"+$T("tError")+"</strong><br/>"+$T("tInOrderToSubmitAReview"))}}function rateEap(a){if(isRated()){var b=["eapId=",a,"&quality=",$("quality").value,"&pricing=",$("pricing").value,"&service=",$("service").value,"&completion=",$("completion").value].join("");fxAjax.sendRequest(fxVars.rateEap+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function currentProfile(){var tempElement={};var list=[];var allElements=carpeGetElementsByClass("profileAnalyze");for(var i=0;i<allElements.length;i++){if(allElements[i].type&&allElements[i].type=="checkbox"&&allElements[i].checked){list=tempElement[$AT(allElements[i],"name")];if($AT(allElements[i],"checkboxType")=="boolean"){list=eval(allElements[i].checked)}else{if(list==null){list=allElements[i].value}else{list+=","+allElements[i].value}}tempElement[$AT(allElements[i],"name")]=list}if(allElements[i].nodeName=="OPTION"&&allElements[i].selected){if(allElements[i].getAttribute("optionId")){tempElement[$AT(allElements[i],"optionId")]=allElements[i].value}else{tempElement[$AT(allElements[i],"itemOption")]=allElements[i].value}}else{if(allElements[i].type&&allElements[i].type=="text"){list=tempElement[$AT(allElements[i],"name")];if(list==null){list=allElements[i].value}else{list+=","+allElements[i].value}tempElement[$AT(allElements[i],"name")]=list}}}tempElement.oid="temp";return tempElement}function SwitchToTradeTab(a){this.params=a;this.runFunc=function(){switchTab(this.params[0],this.params[1],this.params[2]);showElement(this.params[3])}}function addSearchProfile(g){if($("showMain")){var d=$("showMain").checked}if($("magic")){var b=$("magic").checked}var a=["tabs18","tradeList",$("analyzeTradeTab"),"showActualGrowth"];var f=new SwitchToTradeTab(a);if(validate("profileName",VALID_PROFILE)&&validate("yieldStart",VALID_DOUBLE,f)&&validate("yieldEnd",VALID_DOUBLE,f)&&validate("netProfitStart",VALID_DOUBLE,f)&&validate("netProfitEnd",VALID_DOUBLE,f)&&validate("durationStart",VALID_INTEGER_OR_EMPTY,f)&&validate("durationEnd",VALID_INTEGER_OR_EMPTY,f)&&validate("pipsStart",VALID_DOUBLE,f)&&validate("pipsEnd",VALID_DOUBLE,f)&&validate("takeProfitStart",VALID_DOUBLE_POSITIVE,f)&&validate("takeProfitEnd",VALID_DOUBLE_POSITIVE,f)&&validate("stopLoss",VALID_DOUBLE_POSITIVE,f)&&validate("stopLossEnd",VALID_DOUBLE_POSITIVE,f)&&validate("sizingStart",VALID_DOUBLE_POSITIVE,f)&&validate("sizingEnd",VALID_DOUBLE_POSITIVE,f)){var c=["&accountOid=",g,"&profileName=",encodeParameter($F("profileName")),"&showGrowth=",d,"&showTrades=",b,"&accountMagic=",getCheckBoxesValues("accountMagic"),"&accountSymbol=",getCheckBoxesValues("accountSymbol"),"&orderTags=",getCheckBoxesValues("accountTag"),"&days=",getCheckBoxesValues("days"),"&hours=",getCheckBoxesValues("hours"),getCommentBoxesValues(),"&buySell=",getCheckBoxesValues("buySell"),"&yieldStart=",$F("yieldStart"),"&yieldEnd=",$F("yieldEnd"),"&netProfitStart=",$F("netProfitStart"),"&netProfitEnd=",$F("netProfitEnd"),"&durationStart=",$F("durationStart"),"&durationEnd=",$F("durationEnd"),"&durationTime=",$F("selectedDuration"),"&takeProfitStart=",$F("takeProfitStart"),"&takeProfitEnd=",$F("takeProfitEnd"),"&stopLoss=",$F("stopLoss"),"&stopLossEnd=",$F("stopLossEnd"),"&sizingStart=",$F("sizingStart"),"&sizingEnd=",$F("sizingEnd"),"&selectedTime=",getCheckBoxesValues("selectedTime"),"&pipsStart=",$F("pipsStart"),"&pipsEnd=",$F("pipsEnd"),getCommentsOptions("commentOption")];fxAjax.sendRequest(fxVars.searchProfile+c.join(""),{contentType:"text/xml",loader:true,params:{name:$F("profileName")},callback:"addSearchProfileResponse"})}}function addSearchProfileResponse(result,params){var tr;var td;var numOfColumns=5;var response=result.getElementsByTagName("response")[0];if(!result.error){var elements=eval("("+getContent(response)+")");for(var i=0;i<elements.list.length;i++){var id=elements.list[i].oid;if(!$("profile"+id)){var div=new Element("div",{id:"profile"+id,className:"tagBG"});var profileName=new Element("span",{name:"profiles",profileId:id});profileName.update(elements.list[i].name+"&nbsp;&nbsp;");profileName.onclick=function(){setProfileInfo(id,params.name)};profileName.onmouseover=function(){addSaveProfileTip(id,"profile"+id)};var remove=new Element("a",{href:"javascript:void(0);",id:"removeProfile"+id,className:"remove"});remove.onclick=function(){removeProfileMessage(id)};div.appendChild(profileName);div.appendChild(remove);$("profilesList").appendChild(div);createProfileTip("profile"+id)}}$("profileName").value="";$("profileList").value=JSON.stringify(elements)}}function isContains(b,a){for(var c=0;c<b.length;c++){if(b[c]==a){return true}}return false}function clearProfile(b){for(var a=0;a<b.length;a++){if(b[a].type=="checkbox"){if(b[a].checked){b[a].checked=false}}else{if(b[a].type=="text"){b[a].value=""}else{if(b[a].nodeName=="OPTION"){b[a].selected=false}}}}}function setProfileInfo(profileOid,profileMessage){var allElements;for(var i=0;i<commentsName.length;i++){var commentElement=$(commentsName[i]);if(commentElement!=null){removeElement(commentElement)}}var profileList=eval("("+$F("profileList")+")");var elementInfo;for(var j=0;j<profileList.list.length;j++){if(profileList.list[j].oid==profileOid){if(profileList.list[j].comment2!=null){createCommentBox()}if(profileList.list[j].comment3!=null){createCommentBox()}if(profileList.list[j].comment4!=null){createCommentBox()}if(profileList.list[j].comment5!=null){createCommentBox()}allElements=carpeGetElementsByClass("profileAnalyze");clearProfile(allElements);for(var i=0;i<allElements.length;i++){if(allElements[i].type=="checkbox"){if(profileList.list[j][allElements[i].name]!=null){if(typeof(profileList.list[j][allElements[i].name])=="boolean"){allElements[i].checked=profileList.list[j][allElements[i].name]}else{elementInfo=profileList.list[j][allElements[i].name].split(",");allElements[i].checked=isContains(elementInfo,allElements[i].value)}}}if(allElements[i].type=="text"){if(profileList.list[j][allElements[i].name]!=null){allElements[i].value=profileList.list[j][allElements[i].name]}}if(allElements[i].nodeName=="OPTION"){if(allElements[i].getAttribute("optionId")){elementInfo=profileList.list[j][allElements[i].getAttribute("optionId")];if(elementInfo==null){elementInfo="1"}}else{elementInfo=profileList.list[j][allElements[i].getAttribute("itemOption")]}if(elementInfo==allElements[i].value){allElements[i].selected=true}}}}}if(profileMessage!=null){if($("profileChangedMessage").style.display=="none"){$("profileChangedMessage").innerHTML=$T("tSearchProfileLoaded",[[profileMessage]]);showElement("profileChangedMessage");window.setTimeout(function(){Effect.toggle("profileChangedMessage","appear")},(1000))}}showInputTip()}function removeElement(a){try{if($(a)){$(a).remove()}}catch(b){}}function removeProfileMessage(a){inlineAlert($("profile"+a),$T("tConfirmProfileDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>","removeProfile("+a+")")}function removeProfile(a){fxAjax.sendRequest(fxVars.removeProfile+a,{contentType:"text/xml",loader:true,params:{profileId:a},callback:"removeProfileResponse"})}function removeProfileResponse(a,b){if(!a.error){removeElement("profile"+b.profileId);removeElement("removeProfile"+b.profileId);Tipped.remove("profile"+b.profileId)}}function sortComparator(d,c){return $AT(c,"sortId")-$AT(d,"sortId")}function buildProfileText(){var m={};var a={};var s=[];var k;var c="";var o="";var r=true;var l=carpeGetElementsByClass("profileAnalyze");l.sort(sortComparator);for(var g=0;g<l.length;g++){a=m[$AT(l[g],"menuId")];if(a==null){a={}}if($AT(l[g],"mainName")!=null){k=a[$AT(l[g],"mainName")]}if(k==null){k={}}if($(l[g].type=="checkbox")&&$($AT(l[g],"labelId"))&&l[g].checked){k.type=$AT(l[g],"option");if(k.size==null){k.size=1}else{if(k!=""){k.size=k.size+1}}if($AT(l[g],"checkboxType")=="boolean"){k[$AT(l[g],"mainName")]=""}else{k[$($AT(l[g],"labelId")).innerHTML]=$($AT(l[g],"labelId")).innerHTML}a[$AT(l[g],"mainName")]=k}else{if(l[g].nodeName=="OPTION"){if(l[g].selected){if(l[g].getAttribute("optionId")){k[l[g].getAttribute("optionId")]=l[g].innerHTML}else{k[l[g].getAttribute("itemOption")]=l[g].innerHTML}a[$AT(l[g],"mainName")]=k}}else{if(l[g].type&&l[g].type=="text"){k[$AT(l[g],"range")]=escapeHtml(l[g].value);if(k.size==null&&l[g].value!=""){k.size=1}else{if(l[g].value!=""||l[g].getAttribute("commentId")){k.size=k.size+1}}if($AT(l[g],"scale")){k.scale=$AT(l[g],"scale")}k.type=$AT(l[g],"option");if($AT(l[g],"mainName")){a[$AT(l[g],"mainName")]=k}else{a[$AT(l[g],"mainName")]=k}}}}m[$AT(l[g],"menuId")]=a}s.push("<table>");for(var b in m){if(b!=null){a=m[b];if(b!="global"&&!profileIsEmpty(a)){s.push("<tr><td><b>"+b+" </b></td>")}else{s.push("<tr><td></td>")}if(!profileIsEmpty(a)){r=false;for(var f in a){k=a[f];if(k.size){s.push("<td>");if(k.type=="notDisplay"||(k.start==""&&k.end=="")||k.comment==""){s.push("")}else{s.push(f+" ");if(a[f].commentOption1){s.push(":");s.push("</br>");k.size=k.size*2;for(var q=1;q<=k.size;q++){if(hasText(k["comment"+q])){s.push(k["commentOption"+q]);s.push(" ");s.push("'"+k["comment"+q]+"'");s.push("<br/>")}}}}if(k.type=="range"){if(k.scale=="$"){c="$"}else{if(k.scale!=null){o=k.scale}}if(k.start!=""&&k.end!=""&&k.start!=k.end){s.push(""+$T("tBetween",[c+k.start+o,c+k.end+o]))}if(k.start!=""&&k.end!=""&&k.start==k.end){s.push(""+$T("tEqual",[c+k.start+o]))}if(k.start!=""&&k.end==""){s.push($T("tMorethan")+" "+c+k.start+o)}if(k.start==""&&k.end!=""){s.push($T("tLessthan")+" "+c+k.end)}if(f=="Duration"&&(k.start!=""||k.end!="")){s.push(" "+k.durationTime+" ")}if(k.scale&&(k.start!=""||k.end!="")){c=""}o=""}else{for(var d in k){var h=d.startsWith("comment");if(k[d]!=null&&d!="type"&&k[d]!=""&&d!="size"){if(!h){s.push(k[d]);k.size=k.size-1;if(k.size>0&&!h){s.push(",")}}}}}s.push(" ");s.push("</td></tr><tr><td></td>")}}}s.push("</tr>")}}s.push("</table>");if(r){return $T("tNoDataToDisplay")}return s.join("")}function addSaveProfileTip(profileId,showProfileId){var profile=currentProfile();var profileList=eval("("+$F("profileList")+")");profileList.list.push(profile);var size=profileList.list.length-1;$("profileList").value=JSON.stringify(profileList);setProfileInfo(profileId);createProfileTip(showProfileId);setProfileInfo("temp");profileList.list.splice(size,1);$("profileList").value=JSON.stringify(profileList)}function createProfileTip(a){new Tip("#"+a,buildProfileText(),{title:$T("tCurrentSearchSettings"),maxWidth:500})}function profileIsEmpty(b){var f=["durationTime","type","size","scale"];var a=["Show actual growth","Show Manual trades"];for(var d in b){if(b.hasOwnProperty(d)){for(var c in b[d]){if((f.indexOf(c)==-1&&b[d][c]!="")||a.indexOf(c)!=-1){return false}}}}return true}function showInputTip(){new Tip("#profileName",buildProfileText(),{title:$T("tCurrentSearchSettings"),maxWidth:500,showOn:"click",hideOn:{element:"target",event:"blur"}});hideElement("showActualGrowth")}var monthType=0;function monthChart(h,m,d,r){disposeCharts(["chartMonthly"]);var k=document.getElementById("chartYearsUl").getElementsByTagName("li");var o;for(var g=0;g<k.length;g++){if(k[g].className=="on"){o=k[g].getAttribute("year")}}var f=new Date(userFormatToDefaultFormat($F("startDate"),$F("userTimeFormat")));var q=new Date("01/01/"+o);var c;if(q<f){c=getDbDateFormat(f)}else{c=o+"-01-01"}monthType=m;var a=new Chart(480,250,"monthlyCont",3);if(d!="st"){var b="&startDate="+c+"&endDate="+getDbDateFormat(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")))+"&l="+d+"&startDateYear="+getDbDateFormat(f);a.renderChart("/charts.xml?chartType=3&accountOid="+h+"&monthType="+monthType+b+buildAdvancedStatisticsUrl(true,false))}else{var b="&startDate="+c+"&endDate="+getDbDateFormat(userFormatToDefaultFormat($F("endDate"),$F("userTimeFormat")))+"&l="+d+"&startDateYear="+getDbDateFormat(f);a.renderChart("/strategy-chart.json?chartType=3&monthType="+monthType+"&id="+h+b)}}function showCommentWatchDashboard(b){if(!isShown("watched"+b)){Tipped.hideAll()}var a=($("pencil"+b)==null?$("ballon"+b):$("pencil"+b));if(!isShown("watched"+b)){var c=jQuery("#watched"+b).remove().clone();jQuery("#"+b).after(c);$("watched"+b).style.display="";boldTD(a);a.onclick=function(){showCommentWatchDashboard(b)}}else{$("watched"+b).style.display="none";boldTD(a);a.onclick=function(){showCommentWatchDashboard(b)}}}function addCommentWatch(c,a){var d;var b;if(a=="d"){d=["oid=",c,"&comment=",encodeParameter($F("text"+c))];b=getLinksTitleByName(a+"files"+c)}else{if(a=="s"){d=["oid=",c,"&comment=",encodeParameter($F("textComment"))];b=getLinksTitleByName(a+"files")}}if(hasText(b)){d.push("&files=");d.push(b)}fxAjax.sendRequest(fxVars.commentWatch,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:d.join(""),params:{oid:c,type:a},loader:true,callback:"addWatchCommentResponse"})}function addWatchCommentResponse(k,g){var l=k.content.comment;var f=g.oid;if(g.type=="d"){if(!k.error){var a=getLinksTitleByName(g.type+"files"+f);var h=hasText(a);attachFiles(f,a,"");var c=$("pencil"+f);var d=k.content.commentEscape;if(h){d+="<br/><br/>"+$T("tAttachments")+":<br/><div>"+$("files"+f).innerHTML}else{d+="</div>"}var m;if(c!=null){c.className="ballonSmall pointer";c.id="ballon"+f;buildOrderTip(c.id,d,h);c.onclick=function(){showCommentWatchDashboard(f)}}else{if(c!=null&&h){m=$("ballon"+f);buildOrderTip(m.id,d,h);m.onclick=function(){showCommentWatchDashboard(f)}}else{if(c==null&&!h&&l.length==0){m=$("ballon"+f);m.className="pencilSmall pointer";m.id="pencil"+f;Tipped.remove(m);m.onclick=function(){showCommentWatchDashboard(f)}}else{m=$("ballon"+f);buildOrderTip(m.id,d,h);m.onclick=function(){showCommentWatchDashboard(f)}}}}$("originalComment"+f).value=k.content.commentEscape}hideElement("watched"+f);var b=$("pencil"+f);if(b==null){b=$("ballon"+f)}boldTD(b)}else{if(g.type=="s"){if(!k.error){$("textComment").value=l;$("displayComment").innerHTML=k.content.commentEscape;if(k.content.commentEscape.trim()==""){$("displayComment").innerHTML="<span class='gray'>"+$T("tYourCommentIsEmpty")+"</span>"}attachFilesFunction("",getLinksTitleByName("sfiles"),$F("sessionUsername"));if($F("filesSize")=="0"){hideElement("files")}else{showElement("files")}}else{$("textComment").value=$F("originalComment");$("displayComment").innerHTML=$F("originalComment")}hideElement("textAccountWatchComment");showElement("displayAccountWatchComment")}}}function closeAddWatchComment(c){hideElement("watched"+c);var a=$("originalComment"+c);if(a!=null){$("text"+c).value=$("originalComment"+c).value}var b=$("pencil"+c);if(b==null){b=$("ballon"+c)}b.onclick=function(){showCommentWatchDashboard(c)};boldTD(b)}function openEditCommentWatch(a){if(a=="open"){showElement("textAccountWatchComment");hideElement("displayAccountWatchComment");$("originalCommentText").value=$("textComment").value;$("textComment").focus();hideElement("files")}else{if($F("filesSize")=="0"){hideElement("files")}else{showElement("files")}hideElement("textAccountWatchComment");showElement("displayAccountWatchComment");$("textComment").value=$("originalCommentText").value}}function attachFilesFunction(k,b,a){$("files").innerHTML="";try{var g=b.split(",");g=orderFiles(g);if(g==""){$("filesSize").value="0"}else{$("filesSize").value=g.length}for(var d=0;d<g.length;d++){var c=removeSpace(g[d]);if(isImage(c)){var f="img"+getRandomInt();$("files").innerHTML+="<a id="+f+' target="_blank" href="/files/'+a+"/"+encodeParameter(c)+'" style="color:white;text-align:center"></a>&nbsp;';$(f).insert(new Element("img",{src:"/files/"+a+"/"+c,style:"margin-bottom:2px; border:2px solid #5F5F5F;max-width:220px; max-height:220px"}))}else{$("files").innerHTML+='<a style="color:black" target="_blank" href="/files/'+a+"/"+c+'">'+c+"</a><br/>"}}}catch(h){}}function removeAccountWatchMessageSystemPage(b,a,c){inlineAlert($("buttAccountWatch"),$T("tConfirmWatchDelete"),"removeAccountWatch("+b+","+a+",'"+c+"')")}function sumOfCheckBoxElements(b){var f=0;var d=document.getElementsByName(b);var a=d.length;for(var c=0;c<a;c++){if(d[c].checked){f++}}return f}function showHideElementByClass(className,columns,tableName,button,func){var columnLimit=14;if(tableName=="portfolioOverallTable"||tableName=="dashboardSystemsTable"){columnLimit=10}if(tableName=="watchTable"){columnLimit=9}if($(className)!=undefined){var checkStatus=$F(className)}if(checkStatus=="off"||sumOfCheckBoxElements(columns)<(columnLimit+1)){var table=document.getElementById(tableName);if(table!=undefined){var rows=table.getElementsByTagName("tr");var cels;var pattern=new RegExp("\\b"+className+"\\b");for(var row=0;row<rows.length;row++){if(row==0){cels=rows[row].getElementsByTagName("th")}else{cels=rows[row].getElementsByTagName("td")}for(var i=0;i<cels.length;i++){if(pattern.test(cels[i].className)){if(isShown(cels[i])){hideElement(cels[i])}else{showElement(cels[i])}}}}if(tableName=="watchTable"){$J(".dynamicColspan").attr("colspan",sumOfCheckBoxElements(columns)+2)}}eval(func)}else{if(tableName=="tradingOpenOrdersTable"){$(className+"OpenOrders").checked=false}else{if(tableName=="tradingOpenTradesTable"){$(className+"OpenTrades").checked=false}else{if(tableName=="tradingHistoryTable"){$(className+"History").checked=false}else{$(className).checked=false}}}inlineMsg($(button),$T("tMaxNumberOfColumns",[columnLimit]),3)}}function updatePortfolioOverallFilter(){fxAjax.sendRequest(fxVars.updatePortfolioOverallFilter+getCheckBoxesIds("moreColumnName"),{loader:false,id:{id:"portfolioOverallMore"},callback:"updateGeneralColumnsResponse"})}function completeCallbackFunction(a,d){var f;if(a.error=="false"){if(a.id==null){f=""}else{f=a.id}var b=Math.floor(Math.random()*99999);var c="<a target='_blank' href='/files/"+d.username+"/"+a.file+"' title='"+a.file+"' name='"+a.type+"files"+a.id+"' id='"+a.type+"fileLink"+b+"'>"+a.file+"</a> &nbsp;<a href='javascript:void(0)' class='font10 underline' id='"+a.type+"fileRemove"+b+"' onclick='removeFileLink("+b+',"'+a.type+"\")'>Remove</a><br id='"+a.type+"fileBr"+b+"'/>";$(a.type+"files"+f).innerHTML+=c}else{inlineMsg("cabinetLabel",a.message,3)}}function removeFileLink(b,a){$(a+"fileLink"+b).remove();$(a+"fileRemove"+b).remove();$(a+"fileBr"+b).remove();if($(a+"insert"+b)){$(a+"insert"+b).remove()}}function showHideTableRows(d,g,k,c){var b=document.getElementById(d);var f=b.getElementsByTagName("tr");for(var h=g;h<f.length;h++){if(isShown(f[h])){hideElement(f[h])}else{showElement(f[h])}}var a=document.getElementById(c);if(k=="show"){a.onclick=function(){showHideTableRows(d,g,"hide",c)};a.innerHTML=$T("tHideAll")}else{a.onclick=function(){showHideTableRows(d,g,"show",c)};a.innerHTML=$T("tShowAll")}}function selectSpreadsBestBroker(el){var elements=$$("#bestBrokerTable tr");var checked=eval(el.getAttribute("allSelected"));for(var i=0;i<elements.length;i++){if(checked){$(elements[i]).style.display=""}else{if(i>5){$(elements[i]).style.display="none"}}}el.setAttribute("allSelected",!checked);el.innerHTML=checked?$T("tLess"):$T("tMore")}function navigateToNewWindow(a){window.open(a,"","scrollbars=yes,menubar=no,fullscreen=yes,resizable=yes,toolbar=no,location=no,status=no")}function searchTranslate(){if($F("searchTranslate").trim().length>0){fxAjax.sendRequest(fxVars.searchTranslate+"search="+encodeParameter($F("searchTranslate")),{loader:true,callback:"searchTranslateResponse"})}}function searchTranslateResponse(a){if(!a.error){$("translateCont").innerHTML=a.content.translationList}}function searchTranslateVote(){if($F("searchTranslate").trim().length>0){fxAjax.sendRequest(fxVars.searchTranslateVote+"search="+encodeParameter($F("searchTranslate")),{loader:true,callback:"searchTranslateVoteResponse"})}}function searchTranslateVoteResponse(a){if(!a.error){$("translateCont").innerHTML=a.content.translationList;$("pagingSize").innerHTML=a.content.pagingSize}}function authorizeOanda(real){if(eval(real)){window.location.href="https://fxtrade.oanda.com/account/tpa/authorize?client_id=myfxbook&response_type=code&redirect_uri=https://www.myfxbook.com/?back=settings&scope=can_view_transaction_history"}else{window.location.href="https://fxtrade.oanda.com/account/demo/tpa/authorize?client_id=myfxbook&response_type=code&redirect_uri=https://www.myfxbook.com/?back=settings&scope=can_view_transaction_history"}}function autoResize(a){var c=a.cols;var b=0;$A(a.value.split("\n")).each(function(d){b+=1+Math.floor(d.length/c)});a.rows=b}function autoResize(b,a){var d=b.cols;var c=0;$A(b.value.split("\n")).each(function(f){c+=1+Math.floor(f.length/d)});if(c<a){c=a}b.rows=c}function styleFigure(d,c,a,f,b,h){var g=d.toFixed(h);if(d>=0){return f?"<span class='green'>"+(b?"+":"")+c+g+a+"</span>":(b?"+":"")+c+g+a}else{return f?"<span class='red'>-"+c+Math.abs(g)+a+"</span>":"-"+(c)+Math.abs(g)+a}}function getProfit(c,b){var a="";if(c>=0){a=(b=="%")?c+b:b+c}else{a=(b=="%")?Math.abs(c)+b:b+Math.abs(c);a="-"+a}return a}function tryOandaLogin(g,f,c,a){if(validate("accountName"+g,VALID_SYSTEM_NAME)){hideElement("accountConnButton"+g);hideElement("loginResponse"+g);showElement("loginResponse"+g);showElement("loginLoad"+g);hideElement("testButton");$("loginResponse"+g).innerHTML=" &nbsp;&nbsp;Connecting to your account";var b=$F("accountName"+g);var d="accountId="+g+"&accountName="+b+"&oauthToken="+f+"&isAccountReal="+c;fxAjax.sendRequest(fxVars.addOandaAccount+d,{params:{id:g,newAccount:a},loader:false,callback:"checkOandaLoginResponse"})}}function checkOandaLogin(c,b,a){fxAjax.sendRequest(fxVars.checkOandaLogin+c+"&lastStatus="+b,{params:{id:c,newAccount:a},loader:false,callback:"checkOandaLoginResponse"})}function checkOandaLoginResponse(g,d){var b=g.content.menu;var c=g.content.accountUrl;var h=d.id;var k=g.error;var l=g.message;var a=g.content.code;var f=g.content.newAccountStatus;if(!k&&f!=STATUS_ERROR){if(d.newAccount){$("loginResponse"+h).innerHTML=" &nbsp;&nbsp;"+l;if(f==STATUS_LOGIN_PENDING||f==STATUS_LOGIN_PASS||f==STATUS_CREATING_ACCOUNT||f==STATUS_CALCULATING){checkOandaLogin(d.id,f,true)}else{if(f==STATUS_LOGIN_FAILED||f==STATUS_CALC_COMPLETE||f==STATUS_SERVER_DOWN){hideElement("loginLoad"+h);if(f==STATUS_CALC_COMPLETE){showElement("connection"+h);$("takeMe"+h).href=c;$("accountsNav").innerHTML=b;runAjaxScripts(getContent(b))}}}}}else{$("loginResponse"+h).innerHTML=l;hideElement("loginLoad"+h);if(d.newAccount){if(hasText(g.content.data)){$("loginResponse"+h).innerHTML+=g.content.data}hideElement("accountName"+h);hideElement("accountConnButton"+h)}else{}}}function stop(a){if(!a){var a=window.event}a.cancelBubble=true;if(a.stopPropagation){a.stopPropagation()}}function closeSystemAlertWindow(){hideElement("systemAlertMsg");setCookie("systemAlertWindow","0",MINUTE*10)}function editRemoveGoal(oid,edit){var data;var error=false;if(edit){if(validate("goalsEditTargetInput"+oid,30)){var selectFieldType=$("goalsEditTypeSelect"+oid);var isPercent=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"isPercent"));var target=$F("goalsEditTargetInput"+oid);if(isPercent&&(target<0||target>100)){inlineMsg("goalsEditTargetInput"+oid,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3);error=true}data=["oid=",oid,"&edit=","true","&target=",target]}else{error=true}}else{data=["oid=",oid,"&edit=","false"]}if(!error){fxAjax.sendRequest(fxVars.editRemoveGoal+data.join(""),{loader:false,params:{oid:oid,edit:edit},callback:"editRemoveGoalResponse"})}}function editRemoveGoalResponse(a,b){if(!a.error){$(a.content.goalPeriod+"Goals").innerHTML=a.content.data;$(a.content.goalPeriod+"DateScroll").innerHTML=a.content.scroll;if(!b.edit){removeElement("goalsEditRow"+b.oid)}else{hideElement("goalSave"+b.oid);hideElement("goalCancel"+b.oid)}}else{inlineMsg("goalsEditTargetInput"+b.oid,a.message,3)}}function showHideElement(a){if(isShown(a)){hideElement(a)}else{showElement(a)}}function addGoal(goalPeriod,accountOid){if(validate("goalsTargetInputNew"+goalPeriod,30)){var target=$F("goalsTargetInputNew"+goalPeriod);var selectFieldType=$("goalsTypeSelectNew"+goalPeriod);var selectType=selectFieldType.selectedIndex;var isPercent=eval($AT(selectFieldType.options[selectType],"isPercent"));if(isPercent&&(target<0||target>100)){inlineMsg("goalsTargetInputNew"+goalPeriod,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3)}else{showElement("add"+goalPeriod);var relation=$F("goalsRelationSelectNew"+goalPeriod);var data=["accountOid=",accountOid,"&period=",goalPeriod,"&type=",selectType,"&relation=",relation,"&target=",target];fxAjax.sendRequest(fxVars.addGoal+data.join(""),{loader:false,callback:"addGoalResponse"})}}}function addGoalResponse(a,b){if(!a.error){$(a.content.goalPeriod+"Goals").innerHTML=a.content.data;$(a.content.goalPeriod+"GoalsEdit").innerHTML=a.content.edit;$(a.content.goalPeriod+"DateScroll").innerHTML=a.content.scroll;showElement(a.content.goalPeriod+"GoalsEdit")}else{inlineMsg("goalsEditTargetInput"+b.oid,a.message,3)}}function switchGoalsEditWindows(c){var a=convertGoalPeriod(c)+"GoalsEdit";for(var b=0;b<allPeriodGoalsEdit.length;b++){if(a==allPeriodGoalsEdit[b]){showElement(allPeriodGoalsEdit[b])}else{hideElement(allPeriodGoalsEdit[b]);cancelAddGoal(c)}}}function changeGoalDate(b,g,a,f,d){showElement("Load"+g);var c=["accountOid=",b,"&goalsPeriod=",g,"&curDate=",a,"&action=",f,"&page=",d];fxAjax.sendRequest("/changeGoalDate.json?"+c.join(""),{loader:false,callback:"changeGoalDateResponse"})}function changeGoalDateResponse(a,b){if(!a.error){$(a.content.goalPeriod+"Goals").innerHTML=a.content.data;$(a.content.goalPeriod+"DateScroll").innerHTML=a.content.scroll}else{}}function cancelGoal(a){hideElement("goalSave"+a);hideElement("goalCancel"+a);$("goalsEditTargetInput"+a).value=$F("originalGoalValue"+a)}function deleteGoalMessage(a){inlineAlert($("goalRemove"+a),$T("tConfirmDeleteIt"),"editRemoveGoal("+a+",false)")}function onClickDivMarkingCheckBox(a){$(a).checked=!$(a).checked}function goalsRelationSwitch(d){var a=$("goalsRelationSelectNew"+d);var c=$("goalsTypeSelectNew"+d);var b=$AT(c.options[c.selectedIndex],"permissions");a.selectedIndex=(b=="all"||b=="positive")?0:1;a.disabled=(b=="all")?"":"true"}function convertGoalPeriod(a){switch(a){case 0:return"daily";case 1:return"weekly";case 2:return"monthly";case 3:return"yearly";default:return""}}function cancelAddGoal(a){hideElement(convertGoalPeriod(a)+"GoalsAdd");showElement("add"+a);$("goalsRelationSelectNew"+a).selectedIndex=0;$("goalsRelationSelectNew"+a).disabled="true";$("goalsTypeSelectNew"+a).selectedIndex=0;$("goalsTargetInputNew"+a).value=""}function clearField(a){$(a).value=""}function updatePortfolioSettings(){fxAjax.sendRequest(fxVars.updatePortfolioSettings+collectPortfolioSettings(),{})}function collectPortfolioSettings(){var a=[];a.push("tradingColumnsHistory="+getCheckBoxesAttribute("tradingColumnsHistory","field"));a.push("&tradingColumnsOpenTrades="+getCheckBoxesAttribute("tradingColumnsOpenTrades","field"));a.push("&tradingColumnsOpenOrders="+getCheckBoxesAttribute("tradingColumnsOpenOrders","field"));a.push("&growthChart=",getAttributeByRadioChecked("growthOptions","field"));a.push("&monthChart=",getAttributeByRadioChecked("growthMonthOptions","field"));a.push("&drawDownChart=",getAttributeByRadioChecked("drawdownOptions","field"));a.push("&advancedStatisticsSummary=",getAttributeByRadioChecked("symbolOptions","field"));a.push("&advancedStatisticsDuration=",getAttributeByRadioChecked("durationOptions","field"));a.push("&advancedStatisticsHourly=",getAttributeByRadioChecked("hourlyOptions","field"));a.push("&filterHistory=",getCheckBoxesValues("filterOption"));a.push("&slTpFormat="+getComboValue("formatSlTp"));a.push("&showBrokerTime="+getComboValue("timeSwitcher"));return a.join("")}function getCheckBoxesIds(b){var f=[];var d=getElemsByInputName(b);var a=d.length;for(var c=0;c<a;c++){if(d[c].checked){f.push(d[c].id)}}return f.join(",")}function getCheckBoxesValuesByNameAndAttr(b,a){var c=[];$J("input[name='"+b+"']:checked").each(function(){c.push($J(this).attr(a))});return c.join(",")}function getNumSign(a){if(a>0){return"+"+a}else{return a}}function getCheckBoxesAttribute(a,c){var f=getElemsByInputName(a);var d=[];for(var b=0;b<f.length;b++){if(f[b].checked){d.push(f[b].getAttribute(c))}}return d.join(",")}function countGroupChecked(d){var c=getElemsByInputName(d);var b=0;for(var a=0;a<c.length;a++){if(c[a].checked){b++}}return b}function countCheckboxes(a){return getElemsByInputName(a).length}function getElemsByInputName(a){return $$("input[name="+a+"]")}function contestResendEmail(a){fxAjax.sendRequest(fxVars.contestResendMail+a,{params:{},loader:false,callback:"contestResendEmailResponse"})}function contestResendEmailResponse(c){var a=c.error;var b=c.message;if(!a){hideElement("contestReg");hideElement("resendMail");showElement("resendEmailResponse")}else{inlineMsg("resendMail","<b>"+$T("tError")+"</b><br>"+b,3)}}function convertObjectToJson(a){return JSON.stringify(a)}var drawdownChartStatus=0;function updateDrawdownChart(c,a){var b;var g=document.getElementsByName("drawdownOptions");for(var d=0;d<g.length;d++){if(g[d].checked){b=d;break}}if(drawdownChartStatus!=b){drawdownChartStatus=b;var f=new Chart(630,314,"chart4",0);f.renderChart("/charts.json?chartType=15&type=1&period=6&l=p&accountOid="+c+"&drawdownShowType="+a+buildAdvancedStatisticsUrl(false,false))}}function createCommentBox(){var b=$("commentTradeTable");var k=$$("#commentTradeTable tr").length;var m=b.insertRow(b.rows.length);m.id=commentsName[k-3];var h=new Element("select",{id:m.id+"Option",name:"commentOption",className:"font10 padd3 field1",style:"width: 80px"});var c=new Element("option",{"for":m.id+"Option",optionId:"commentOption"+(k-1),itemOption:"commentOption",sortId:"2",menuId:$T("tTrade"),mainName:$T("tCommentContains"),name:$T("tIncludeComment"),id:"includeComment"+(k-1),value:"1",className:"profileAnalyze"}).update($T("tIncludeComment"));var l=new Element("option",{"for":m.id+"Option",optionId:"commentOption"+(k-1),itemOption:"commentOption",sortId:"2",menuId:$T("tTrade"),mainName:$T("tCommentContains"),name:$T("tExcludeComment"),id:"excludeComment"+(k-1),value:"0",className:"profileAnalyze"}).update($T("tExcludeComment"));var o=new Element("input",{commentId:"1",mainName:$T("tCommentContains"),menuId:$T("tTrade"),sortId:"2",range:"comment"+(k-1),name:m.id,type:"text",className:"padd3 field1 profileAnalyze",onfocus:"borderChange(this);",onblur:"borderReturn(this);"});var g=new Element("a",{style:"display:",className:"underline paddlr5 profileAnalyze",trId:m.id,href:"javascript:void(0);"}).update($T("tRemove"));var f=m.insertCell(m.cells.length);f.appendChild(h);h.appendChild(c);h.appendChild(l);var d=m.insertCell(m.cells.length);d.appendChild(o);var a=m.insertCell(m.cells.length);a.appendChild(g);if(k==6){hideElement("addMoreComments")}else{showElement("addMoreComments")}g.onclick=function(){$(this.getAttribute("trId")).remove();showElement("addMoreComments")}}function getCommentBoxesValues(){var a=[];$$("input[commentId=1]").map(Form.Element.getValue).each(function(b){if(hasText(b)){b=b.trim();a.push("&comment=");a.push(encodeParameter(b))}});return a.join("")}function updateTagTip(f){var c=$$("#"+f+" div[name]");var a=new Element("div",{});var b="";Tipped.remove(f);if(c.length>0){for(var d=0;d<c.length;d++){b+='<span style="'+c[d].style.cssText+'" class="inlineBlock"></span>  '+escapeHtml(c[d].getAttribute("name"))+" &nbsp;<br/>"}new Tip("#"+f,b,{title:"Trade Tags"})}}var tagsTables=["tradingHistoryTable","tradingOpenTradesTable","tradingOpenOrdersTable"];function updateAllTagsTips(){for(var b=0;b<tagsTables.length;b++){var a=$$("#"+tagsTables[b]+" [name=tagWindow]");for(var c=0;c<a.length;c++){updateTagTip(a[c].id)}}}function clearTable(b){var a=$(b);while(a.rows.length>0){a.deleteRow(0)}$("attachmentsSpan").innerHTML="";$("tradeComment").innerHTML=""}function lockUnlockTopic(b,a){var c="";if(a){c=prompt("Enter reason:");if(c&&hasText(c)){fxAjax.sendRequest(fxVars.changeTopicLockStatus+b+"&locked="+a+"&lockReason="+c,{contentType:"text/xml",params:{oid:b,locked:a,lockReason:c},loader:true,callback:"lockUnlockTopicResponse"})}}else{fxAjax.sendRequest(fxVars.changeTopicLockStatus+b+"&locked="+a+"&lockReason="+c,{contentType:"text/xml",params:{oid:b,locked:a,lockReason:c},loader:true,callback:"lockUnlockTopicResponse"})}}function lockUnlockTopicResponse(b){var a=b.error;if(!a){window.location.reload()}}function traceObject(b,a){return a.flashObject.traceObject(b)}function ratePamm(b){if(isRated()){var a=["pammId="+b,"&profit=",$("profit").value,"&pricing=",$("pricing").value,"&service=",$("service").value,"&platform=",$("platform").value].join("");fxAjax.sendRequest(fxVars.ratePamm+a,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function rateRebateProgram(b){if(isRated()){var a=["rebateId="+b,"&profitability=",$("profitability").value,"&pricing=",$("pricing").value,"&service=",$("service").value,"&use=",$("use").value].join("");fxAjax.sendRequest(fxVars.rateRebateProgram+a,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function showHideSlTpOptions(optionId,func){var allSlTpElements=[{el:$$("span.slPrice"),id:"tradesPrice"},{el:$$("span.tpPrice"),id:"tradesPrice"},{el:$$("span.slPips"),id:"tradesPips"},{el:$$("span.tpPips"),id:"tradesPips"}];var obj,element;for(obj in allSlTpElements){var object=allSlTpElements[obj];for(element in object.el){if(object.id==optionId){showElement(object.el[element].id)}else{hideElement(object.el[element].id)}}}var header=$(optionId).label;$J(".slHeader").each(function(){this.innerHTML=header});$J(".tpHeader").each(function(){this.innerHTML=header});if(hasText(func)){eval(func)}}function tradingActivityTimeSwitcher(optionId,func){if(optionId==1){$J(".userTime").css("display","none");$J(".brokerTime").css("display","")}if(optionId==0){$J(".brokerTime").css("display","none");$J(".userTime").css("display","")}if(hasText(func)){eval(func)}}function setPortfoliosChartsOptions(){mainChartStatus=getRadioIndex("growthOptions");drawdownChartStatus=getRadioIndex("drawdownOptions");monthType=getRadioIndex("growthMonthOptions");symbolChartStatus=getRadioIndex("symbolOptions")}function startPostUploadMain(a){hideElement("uploadResponse"+a);$("fileLoader"+a).style.display="";return true}function completePostUploadMain(response,params){if(response.error=="false"){var id=response.id;hideElement("fileLoader"+id);var tempId=Math.floor(Math.random()*99999);var link="<a target='_blank' href='"+response.path+"' title='"+response.file+"' type='image'  name='orderFiles"+params.id+"' id='"+response.type+"orderFileLink"+tempId+"'>"+response.file+"</a> &nbsp;<a href='javascript:void(0)' class='font10 underline' id='"+response.type+"orderFileRemove"+tempId+"' onclick='removeOrderFile("+tempId+',"'+response.type+"\")'>"+$T("tRemove")+"</a>&nbsp;<br id='"+response.type+"orderFileBr"+tempId+"'/>&nbsp;";var image=eval(response.isImage);if(image){var insert=new Element("a",{href:"javascript:void(0);",style:"display:",id:""+response.type+"insert"+tempId,className:"font10 underline"});insert.update($T("tInsert"));insert.onclick=function(){insertAtCursor($(params.text),response.path+"\n")}}new Insertion.Before($(params.upload),link);new Insertion.Before($(response.type+"orderFileBr"+tempId),insert)}else{hideElement("fileLoader"+id);inlineMsg("cabinetLabel"+id,response.message,6)}}function removeFile(a){filesUploaded.pop($("fileLink"+a).name);$("uploadForm"+a).remove()}function getFileLink(b){var a=$("fileLink"+b);if(a.title=="image"){return"\n"+a.href+"\n"}else{return"<a href='"+a.href+"' target='_blank'>"+a.name+"</a>"}}function getRadioIndex(b){var a=$$("input[name="+b+"]");for(var c=0;c<a.length;c++){if(a[c].checked){return c}}}function getAttributeByRadioChecked(a,b){return $$("input[name="+a+"]:checked")[0].getAttribute(b)}function getCommentsOptions(b){var a=[];var f=$$("input[commentId=1]").map(Form.Element.getValue);var d=$$("select[name="+b+"]");for(var c in d){if(!isNaN(c)&&hasText(d[c].value)&&hasText(f[c])){a.push("&commentOption=");a.push(d[c].value)}}return a.join("")}function escapeHtml(a){return(a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}function beforeRunFunc(a){if(a!=undefined){a.runFunc()}}function disposeCharts(b){try{b.each(function(c){try{FusionCharts(c).dispose()}catch(d){}})}catch(a){}}function getAccountTracking(b,a){if(hasText(b)&&!hasText($("tracking").innerHTML)&&hasText(a)){fxAjax.sendRequest(fxVars.getAccountTracking+b+"&l="+a,{loader:true,callback:"getAccountTrackingResponse"})}else{showHideElement("tracking")}}function getAccountTrackingResponse(a){if(!a.error){$("tracking").innerHTML=a.content.data;showElement("tracking")}else{inlineMsg("trackingButton","<b>"+$T("tError")+"</b><br>"+a.message,3)}}function getCalendarChart(b){var a=new Chart(820,314,"chart"+b);a.renderChart("/calendar-chart.json?id="+b)}function displayElementByClass(a,c){var b=document.getElementsByClassName(a);for(i=0;i<b.length;i++){if(c==0){b[i].style.display="none"}else{if(c==1){b[i].style.display=""}}}}var $JD=(function(){function b(g){$J(g).dialog("open")}function f(g){if(g=="#accountNotification"){notificationDialogIsOpen=false}$J(g).dialog("close")}function d(g){$J(g).dialog("destroy")}function c(g,h){$J(g).dialog(h)}function a(g,h){$J(g).dialog({modal:true,position:"center",open:function(k,l){$J("input").blur();$J(this).parent().css("left","505.5px");$J(this).css("overflow","hidden");$J(".ui-widget-overlay").bind("click",function(){$J(g).dialog("close")})}});$J(g).dialog(h)}return{open:b,close:f,destroy:d,create:c,createWithModal:a}})();function getServerTime(){var a=dt.getTime();a+=MINUTE*dt.getTimezoneOffset()*-1;return a}function updateTimeById(f,c){var b=$(f).getAttribute("time");var a=dateToString(b);if(a!="false"){$(f).innerHTML=a;var d=getServerTime()-b;if((d/HOUR)>1){c=MINUTE}setTimeout('updateTimeById("'+f+'", "'+c+'")',c)}}function loadWallPostNotification(f,g,c,k,a,o){if(typeof chartsLoc=="undefined"&&hasText(a)){var b=createChartUrl(f,g,c,k,a,o);window.open(b,"_self")}var h="";var m;if(g==10){h="comment"+c}else{if(g==11){h="post"+c}}if($(h)!=null){goToChartNotification(h,false,true)}else{if(showMoreBloack){if(f==lastChartId){if($("post"+k)==null){var l=$$("#userMessages [postId]");m=l[l.length-1].getAttribute("postId")}if(Number(m)>k){var d=["firstPostOid=",k,"&invite="+o];if(m!=null){d.push("&lastPostOid="+m)}showMoreBloack=false;fxAjax.sendRequest(fxVars.getWallPosts+d.join(""),{params:{lastPostOid:m,firstPostOid:k,id:c,objectId:h},loader:false,callback:"loadWallPostNotificationResponse"})}else{jQuery("#userMessages [lastOid]").each(function(r){var s=Number(this.getAttribute("firstOid"));var q=Number(this.getAttribute("lastOid"));if(k<q&&k>s){getWallPostsBetweenOids(s,q,this,o,h)}})}}else{switchTab("tabs21","chartContainer",$("chartTab"+f));loadChart(f,chart_type_chart,true,null,h,false,g,c,k);hideElement("feedLoader")}}}hideElement("notificationCont")}function goToChartNotification(b,c,a){goToNotification(b,c,a,"chartDiscussion")}function goToNotification(b,d,a,c){var f=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0; top: 0;z-index:1",className:"absolute"});if(!d){f=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0; top:0;;z-index:1",className:"absolute"})}if($(b)!=null){if(a){moveScroller(c,b)}$(b).insertBefore(f,$(b).firstChild);f.fade({duration:3})}}function loadWallPostNotificationResponse(a,d){if(!a.error){var f=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0px; top: 0px;z-index:1",className:"absolute"});var b=a.content.post;if(d.lastPostOid==null){$("post"+d.firstPostOid).innerHTML=b}else{var c=new Element("span",{});c.innerHTML=b;$("userMessages").appendChild(c)}if(a.content.lastOid!=null){$("showMoreWallPost").setAttribute("lastOid",a.content.lastOid)}else{hideElement("showMoreWallPost");$("showMoreWallPost").setAttribute("lastOid",0)}if(a.content.lastTime!=null){$("showMoreWallPost").setAttribute("lastTime",a.content.lastTime)}updateFeedScrooler("chartDiscussion");moveScroller("chartDiscussion",d.objectId);$(d.objectId).insertBefore(f,$(d.objectId).firstChild);f.fade({duration:3})}showMoreBloack=true}function moveScroller(a,b){Position.prepare();container_y=Position.cumulativeOffset($(a))[1];element_y=Position.cumulativeOffset($(b))[1];var d=jQuery("#"+a);var c=d.data("jsp");c.scrollTo(0,element_y-container_y);return false}function createNotificationScroller(){jQuery("#notify").jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).bind("jsp-scroll-y",function(c,b,d,a){if(a){updateNotifications($("notificationElement"),ACTIVITY_PAGING)}});jQuery("#notify").hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(a){stopWheel(a)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")});jQuery("#loggedIn").disableSelection()}function stopWheel(a){if(!a){a=window.event}if(a.preventDefault){a.preventDefault()}a.returnValue=false}function isLogin(){return hasText($F("userId"))}function getJElementsByAttribute(a,b){return $J("["+a+"='"+b+"']")}function showHideElementByElement(b,a){if(a){showElement(b)}else{hideElement(b)}}function displayJElementByAttribute(b,d,a){var c=getJElementsByAttribute(b,d);for(i=0;i<c.length;i++){showHideElementByElement(c[i],a)}}function showHidePortfolioAccounts(id){var portfolio=$J("#portfolioTitle"+id);var isOpen=eval(portfolio.attr("isOpen"));displayJElementByAttribute("portfolioOid",id,!isOpen);portfolio.attr("isOpen",!isOpen);if(!isOpen){$J("#expandButton"+id).text("-")}else{$J("#expandButton"+id).text("+")}}function updateSettingsPortfolioAccountsSize(newId,oldId){var id=0;var toIncrease=true;for(i=0;i<2;i++){if(i==0){id=newId}else{id=oldId;toIncrease=false}var accountsSize=$J("#portfolioAccountsSize"+id);var oldAccountSize=eval(accountsSize.attr("accountsSize"));var newValue=0;if(toIncrease){newValue=oldAccountSize+1}else{newValue=oldAccountSize-1}accountsSize.attr("accountsSize",newValue);accountsSize.text(newValue)}}function rateTradingPlatform(a){if(isRated()){var b=["tradingPlatformId=",a,"&features=",$("features").value,"&design=",$("design").value,"&mobility=",$("mobility").value,"&easeOfUse=",$("easeOfUse").value].join("");fxAjax.sendRequest(fxVars.rateTradingPlatform+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function addAccountSwitchPlatform(){var a=$J("#platformId option:selected").attr("type");if(a=="none"){$J("#accountSettings").html("");$J("#mainCancel").show()}else{fxAjax.sendRequest(fxVars.settingsAddAccountSwitch+a,{loader:true,callback:"addAccountSwitchPlatformResponse"})}}function addAccountSwitchPlatformResponse(a){$J("#mainCancel").hide();$J("#accountSettings").html(a.content.data)}function getRecentTopicFromPage(){var b=$J(".recent td");var a=[];for(var c=0;c<b.length;c++){a.push(b[c].id)}return a}function setLastPostsEffect(c,a){for(var b=0;b<a.length;b++){if($J.inArray(a[b],c)==-1){Effect.Pulsate(a[b],{pulses:5,duration:5})}}}function getCalendar(k,l){var c=collectionCalendarFilter();var d="";var g="";var h=$("startDate");var b=$("endDate");if(h!=undefined&&$F(h)!=""&&b!=undefined&&$F(b)!=""){d=getDbTimeFormat(userFormatToDefaultFormat($F(h),l));g=getDbTimeFormat(userFormatToDefaultFormat($F(b),l))}var m=$F("calPeriod");var f=["?start=",d,"&end=",g,"&filter=",c,"&calPeriod=",m];var a=$(k+"Statement").href;if($is(a)){$(k+"Statement").href=a.substring(0,a.indexOf("?")!=-1?a.indexOf("?"):a.length)+f.join("")}}function isFlashEnabled(){var a=false;try{var b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(b){a=true}}catch(c){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined){a=true}}return a}function showInformationFlashMsg(c){if(!isFlashEnabled()){var b="http://get.adobe.com/flashplayer/";var a=new Element("div",{className:"center information relative",style:"top: 50%; left: 25%; width: 45%; padding: 0px 7px; z-index:110;"});var d=new Element("a",{className:"underline pointer",href:b,target:"_blank"});a.innerHTML="This site requires the latest flash version to be installed. Please go here to download: ";d.innerHTML=b;a.appendChild(d);c.appendChild(a)}}function bubbleResponse(b){if(b!=null){var a=new Element("div").update(b.bubble);var c=$("bubbleWindow");var d=b.time;c.insertBefore(a,c.firstChild);fxWebsocket.updateLastCalendarEventTime(d)}}function changeInboxSubscribe(c){var b=[];b.push("conId="+c);var a=$("subscribe").checked;b.push("&subscribe="+a);fxAjax.sendRequest(fxVars.changeInboxSubscribe+b.join(""),{params:{subscribe:a},loader:true,callback:"changeInboxSubscribeResponse"})}function changeInboxSubscribeResponse(a,b){if(!a.error){}}function switchSwapChartSymbol(){var b=[];var a=getRadioValue("symbol");var c=getRadioValue("swapLongShort");if(a!=undefined&&c!=undefined){b.push("symbolInfoOid="+a);b.push("&swapShortLong="+c);swapDifferenceChart.renderChart("/get-swap-chart-by-symbol.json?"+b.join(""))}}var TYPE_LOW="low";var TYPE_HIGH="high";function findTableLowHigh(b){var a=false;var d=$F(b+"Window");switch(b){case TYPE_LOW:$J(".lightRed").attr("class","");break;case TYPE_HIGH:$J(".lightGreen").attr("class","");break}if(d!="-"){if(isNaN(d)&&d!=""){inlineMsg(b+"Window",$T("tYouMustEnterValidNumber"),3);a=true}if(!a){var c=parseFloat(d);$J("[minMax=1]").each(function(f,g){switch(b){case TYPE_LOW:if(c>=parseFloat(g.textContent)){g.className="lightRed radius3 padd5"}break;case TYPE_HIGH:if(c<=parseFloat(g.textContent)){g.className="lightGreen radius3 padd5"}break}})}}}function changeBrokerSwapsSymbols(a){var c=5;if(sumOfCheckBoxElements("moreColumnName")<(c+1)){var b=getCheckBoxesIds("moreColumnName");setCookie("brokerSwapSymbols",'"'+b+'"',YEAR,false);fxAjax.sendRequest(fxVars.changeBrokerSwapsSymbols,{params:{},loader:true,callback:"changeBrokerSwapsSymbolsResponse"})}else{$(a).checked=false;inlineMsg($("moreButt"),$T("tMaxNumberOfColumns",[c]),3)}}function changeBrokerSwapsSymbolsResponse(a,b){if(!a.error){$("swapsTable").innerHTML=a.content.newTable;$("swapSponsorBrokerTableContainer").innerHTML=a.content.swapSponsorBokerTable;SortableTable.find();findTableLowHigh(TYPE_LOW);findTableLowHigh(TYPE_HIGH)}}function setOnMouseOutClass(b,a){if(a==undefined){a="zebraSort"}b.className=b.getAttribute(a)}function removeExistChildren(d,g){var f=[];var c=d.children;for(var b=0;b<c.length;b++){var a=c[b];if($$("#"+g+" [id="+a.id+"]").length>0){f.push(a)}}for(var b=0;b<f.length;b++){f[b].remove()}}function sortDashboard(){var a=$J("#sortable").sortable("toArray");var c=[];for(var b=0;b<a.length;b++){if(a[b+1]!=undefined){try{$J("."+a[b]).after($J("."+a[b+1]))}catch(d){}}c.push($(a[b]).getAttribute("orderId"))}fxAjax.sendRequest(fxVars.saveUserDashboardOrder+c,{params:{},callback:""})}function getActivity(){if(!busy&&!stopScroll){busy=true;var a;var b=document.getElementsByName("lastNotificationOid");if(b.length>0){a=b[b.length-1].value;showElement("acLoader");fxAjax.sendRequest(fxVars.getActivity+a,{contentType:"text/html",loader:false,callback:"getActivityResponse"})}}}var stopScroll=false;function getActivityResponse(a,b){if(!a.error){if(hasText(a.content.data)){$("activityCont").innerHTML+=a.content.data}else{hideElement("showMoreActivity");stopScroll=true}}hideElement("acLoader");busy=false}function createInboxNotificationScroller(){jQuery("#inboxNotify").jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).bind("jsp-scroll-y",function(c,b,d,a){if(a){updateInboxNotifications($("inboxNotificationElement"),ACTIVITY_PAGING)}});jQuery("#inboxNotify").hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(a){stopWheel(a)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")})}function removeExistsChildren(c,g){var f=c.children;for(var b=0;b<f.length;b++){var a=f[b];var d=$$("#"+g+" [id="+a.id+"]")[0];if(d!=null){d.remove()}}}function buildSparklines(){$J("span[parsed='false']").each(function(a,b){this.buy=$J(b).attr("position")==0;$J(b).sparkline("html",{type:"line",width:"90",height:"30",minSpotColor:"#ff0000",maxSpotColor:"#00bf00",lineColor:this.buy?"#6064FF":"#F27B85",fillColor:this.buy?"#CCDDFF":"#EAD7D9"});var c=$AT(b,"data");if(c!=undefined){new Tip(b,c,{hook:{target:"rightmiddle",tooltip:"leftmiddle"}});if(b.innerHTML.trim()[0]=="<"){$J(b).attr("parsed","true")}}})}function showJqueryMessageWithTitle(d,b,c){var a=$(d);a.title=c;showJqueryMessage(d,b)}function showJqueryMessage(d,c){var b=$(d);if(b!=null){if(hasText(c)){$(d).innerHTML=c}var a=jQuery("#"+d).dialog({resizable:false,modal:true,buttons:[{text:"Ok",click:function(){a.dialog("close")}}]})}}function newBubble(c){var a=new Element("div").update(c);var b=$("bubbleWindow");b.insertBefore(a,b.firstChild)}function selectAllCalendarSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$("#symbolsTable input[name=eventsSymbol]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected)}function roundNumUp(a,c){var b=Math.pow(10,c);return Math.ceil(a*b)/b}function updateMaeMfeChart(a){var c=[];c.push(getAttributeByRadioChecked("maeMfeOptions","maeMfeType"));c.push(getAttributeByRadioChecked("maeMfeSecondOptions","maeMfeSecondType"));var b=new Chart(856,319,"scatterChartMaeMfe",2);b.renderChart("/charts.json?chartType=16&l=p&type="+c+"&accountOid="+a+buildAdvancedStatisticsUrl(false,true))}function getCalendarEvents(){var a=$("pageNumber").value;var d=$("dataForMore").value;var c=$("cnt").value;var f=$("lastDay").value;var b=$("futureEventFound").value;showElement("acLoader");fxAjax.sendRequest(fxVars.getMoreCalendarEvents+a+d+"&cnt="+c+"&lastDay="+f+"&futureEventFound="+b,{contentType:"text/html",loader:false,callback:"getCalendarEventsResponse"})}function getCalendarEventsResponse(c,d){if(!c.error){var b=c.content.rows;for(var a=0;a<b.length;a++){$J("#calendar tr:last").after(b[a])}$("pageNumber").value=c.content.pageNumber;$("cnt").value=c.content.newCnt;$("lastDay").value=c.content.lastDay;$("futureEventFound").value=c.content.futureEventFound;if(!c.content.hasMore){$J("#showMoreCustomCalendar").remove()}hideElement("acLoader")}}function getCalendarNextDayEvents(){var b=$F("filter");var c=$F("lastEventDate");var a=$F("cnt");showElement("acLoader");fxAjax.sendRequest(fxVars.getCalendarNextDayEvents+"filter="+b+"&cnt="+a+"&lastEventDate="+c,{contentType:"text/html",loader:false,callback:"getCalendarNextDayEventsResponse"})}function getCalendarNextDayEventsResponse(c,d){if(!c.error){var b=c.content.rows;for(var a=0;a<b.length;a++){$J("#calendar tr:last").after(b[a])}$("lastEventDate").value=c.content.lastEventDate;if(c.content.newCnt!=null){$("cnt").value=c.content.newCnt}hideElement("acLoader")}}function showJquerySubmitDialog(id,func,close,width,buttonText){var buttons=[];if(func!=null){buttons=[{text:(buttonText!=null)?buttonText:"Submit",click:function(){eval(func);if(close){popup.dialog("close")}}},{text:"Cancel",click:function(){popup.dialog("close")}}]}var popup=jQuery("#"+id).dialog({resizable:false,modal:true,width:width,buttons:buttons})}function scaleInputText(b,f){var d=b.value;var a=parseFloat(d);if(!isNaN(a)){var c=(/^\d+(\.\d+)*$/).exec(d);if(c!=null){b.value=(a==0)?d:parseFloat((parseFloat(d)).toFixed(f))}}}function buildCalendarWidgetURL(b,c){var a=["?ps=",c];$("calendarWidgetLink").value='<!-- myfxbook.com economic calendar widget - Start -->\n       <script type="text/javascript" src='+b+"/scripts/fxCalendar.js"+a.join("")+"><\/script>\n       <!-- myfxbook.com market widget - End -->"}function analyzeByMaster(a){$J("#commentAnalyze").val(a);$J("#openTime").attr("checked",true);$J("#analyzeButton").click()}function tryDukascopyLogin(a){hideElement("loginResponse");var b=false;var c=["&newAccount=",a];if(a){if(validate("systemName",VALID_SYSTEM_NAME)&&validate("loginVal",VALID_TEXT)&&validate("investorPassword",VALID_ACCOUNT_PASSWORD)&&validate("accountType",VALID_ACCOUNT_TYPE)){b=true;showElement("overlay");showElement("loginResponse");$("loginResponse").innerHTML="Connecting to your account <img src='../../../images/circle1.gif' alt=''";showElement("loginLoad");c.push("&login=",$F("loginVal"),"&accountType=",$("accountType").value,"&accountName=",encodeParameter($F("systemName")));c.push("&investorPassword=",encodeParameter($F("investorPassword")))}}if(b){fxAjax.sendRequest(fxVars.tryDukascopyLogin+c.join(""),{params:{login:$F("loginVal"),newAccount:a},loader:false,callback:"checkDukascopyLoginResponse"})}}function checkDukascopyLogin(b,c,a){fxAjax.sendRequest(fxVars.checkDukascopyLogin+b+"&lastStatus="+c,{params:{login:b,newAccount:a},loader:false,callback:"checkDukascopyLoginResponse"})}function checkDukascopyLoginResponse(h,f){var c=h.content.menu;var d=h.content.accountUrl;var k=h.content.accountOid;var l=h.error;var m=h.message;var b=h.content.code;var g=h.content.newAccountStatus;var a=true;if(!l&&g!=STATUS_ERROR){if(f.newAccount){$("loginResponse").innerHTML=m;if(g==STATUS_LOGIN_PENDING||g==STATUS_LOGIN_PASS||g==STATUS_CREATING_ACCOUNT||g==STATUS_CALCULATING){checkDukascopyLogin(f.login,g,true);a=false}else{if(g==STATUS_LOGIN_FAILED||g==STATUS_CALC_COMPLETE||g==STATUS_SERVER_DOWN){if(g==STATUS_CALC_COMPLETE){hideElement("settings");hideElement("broker");showElement("connection");$("takeMe").href=d;$("setPrivacy").onclick=function(){getAccountForm(parseInt(k))};runAjaxScripts(getContent(c))}}}}}else{$("loginResponse").innerHTML=m;if(f.newAccount&&h.content.data!=undefined){$("loginResponse").innerHTML+=h.content.data}}if(a){hideElement("loginLoad");hideElement("overlay")}}function isMobile(){var a=false;(function(b){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))){a=true}})(navigator.userAgent||navigator.vendor||window.opera);return a}function authorizeCtrade(){window.location.href="https://connect.spotware.com/oauth/v2/auth?access_type=online&approval_prompt=auto&client_id=3_2dbx8f89z30gg4oskc8oswwgwo4kkcgc88w0k4g4o448k08g88&redirect_uri=https://www.myfxbook.com/ctrader_auth&response_type=code&scope=accounts"}function tryCtraderLogin(f,d,a){if(validate("accountName"+f,VALID_SYSTEM_NAME)){hideElement("accountConnButton"+f);hideElement("loginResponse"+f);showElement("loginResponse"+f);showElement("loginLoad"+f);$("loginResponse"+f).innerHTML=" &nbsp;&nbsp;Connecting to your account";var b=$F("accountName"+f);var c="accountId="+f+"&accountName="+encodeParameter(b)+"&oauthToken="+d+"&login="+a;fxAjax.sendRequest(fxVars.addCtraderAccount+c,{params:{id:f},loader:false,callback:"checkCtraderLoginResponse"})}}function checkCtraderLogin(b,a){fxAjax.sendRequest(fxVars.checkCtraderLogin+b+"&lastStatus="+a,{params:{id:b},loader:false,callback:"checkCtraderLoginResponse"})}function checkCtraderLoginResponse(g,d){var b=g.content.menu;var c=g.content.accountUrl;var h=d.id;var k=g.error;var l=g.message;var a=g.content.code;var f=g.content.newAccountStatus;if(!k&&f!=STATUS_ERROR){$("loginResponse"+h).innerHTML=" &nbsp;&nbsp;"+l;if(f==STATUS_LOGIN_PENDING||f==STATUS_LOGIN_PASS||f==STATUS_CREATING_ACCOUNT||f==STATUS_CALCULATING){checkCtraderLogin(d.id,f)}else{if(f==STATUS_LOGIN_FAILED||f==STATUS_CALC_COMPLETE||f==STATUS_SERVER_DOWN){hideElement("loginLoad"+h);if(f==STATUS_CALC_COMPLETE){showElement("connection"+h);$("takeMe"+h).href=c;$("accountsNav").innerHTML=b;runAjaxScripts(getContent(b))}}}}else{$("loginResponse"+h).innerHTML=l;hideElement("loginLoad"+h);if(d.newAccount){if(hasText(g.content.data)){$("loginResponse"+h).innerHTML+=g.content.data}hideElement("accountName"+h);hideElement("accountConnButton"+h)}else{}}}function defaultFormatTouserFormat(a,d){try{var c=a.split("/");if(d==TIME_FORMAT_CUSTOM){a=c[1]+"/"+c[0]+"/"+c[2]}}catch(b){}return a}function showJqueryMessageWithOkAndCancel(id,message,okFunc,cancelFunc,size){if(hasText(message)){$(id).innerHTML=message}var popup=jQuery("#"+id).dialog({resizable:false,modal:true,width:(size!=null)?size:306,buttons:[{text:"Ok",click:function(){if(hasText(okFunc)){eval(okFunc)}popup.dialog("close")}},{id:"button-cancel",text:"Cancel",click:function(){if(hasText(cancelFunc)){eval(cancelFunc)}popup.dialog("close")}}]})}function isRated(){try{var pass=false;$J("[attr=rate]").each(function(index,element){if(eval($J(element).val())>0){pass=true;return false}});if(!pass){inlineMsg("rateButton","<strong>"+$T("tError")+"</strong><br/>"+$T("tPleaseProvideRating"));return false}}catch(e){}return true}function createLineBreakes(b){try{if(b==null){return null}return b.replace(/\n/g,"<br/>").replace(/\r/g,"")}catch(a){return""}}(function(a){a.titleAlert=function(f,c){if(a.titleAlert._running){a.titleAlert.stop()}a.titleAlert._settings=c=a.extend({},a.titleAlert.defaults,c);if(c.requireBlur&&a.titleAlert.hasFocus){return}c.originalTitleInterval=c.originalTitleInterval||c.interval;a.titleAlert._running=true;a.titleAlert._initialText=document.title;document.title=f;var b=true;var d=function(){if(!a.titleAlert._running){return}b=!b;document.title=(b?f:a.titleAlert._initialText);a.titleAlert._intervalToken=setTimeout(d,(b?c.interval:c.originalTitleInterval))};a.titleAlert._intervalToken=setTimeout(d,c.interval);if(c.stopOnMouseMove){a(document).mousemove(function(g){a(this).unbind(g);a.titleAlert.stop()})}if(c.duration>0){a.titleAlert._timeoutToken=setTimeout(function(){a.titleAlert.stop()},c.duration)}};a.titleAlert.defaults={interval:500,originalTitleInterval:null,duration:0,stopOnFocus:true,requireBlur:false,stopOnMouseMove:false};a.titleAlert.stop=function(){clearTimeout(a.titleAlert._intervalToken);clearTimeout(a.titleAlert._timeoutToken);document.title=a.titleAlert._initialText;a.titleAlert._timeoutToken=null;a.titleAlert._intervalToken=null;a.titleAlert._initialText=null;a.titleAlert._running=false;a.titleAlert._settings=null};a.titleAlert.hasFocus=true;a.titleAlert._running=false;a.titleAlert._intervalToken=null;a.titleAlert._timeoutToken=null;a.titleAlert._initialText=null;a.titleAlert._settings=null;a.titleAlert._focus=function(){a.titleAlert.hasFocus=true;if(a.titleAlert._running&&a.titleAlert._settings.stopOnFocus){var b=a.titleAlert._initialText;a.titleAlert.stop();setTimeout(function(){if(a.titleAlert._running){return}document.title=".";document.title=b},1000)}};a.titleAlert._blur=function(){a.titleAlert.hasFocus=false};a(window).bind("focus",a.titleAlert._focus);a(window).bind("blur",a.titleAlert._blur)})(jQuery);function getTime(b){var a=new Date(b+Number(MINUTE*$F("userTimezoneOffset"))+(MINUTE*dt.getTimezoneOffset()));return format2Digits(a.getHours())+":"+format2Digits(a.getMinutes())}function clearCheckbox(b){var a=document.getElementsByName(b);for(var c=0;c<a.length;c++){a[c].checked=false}}function dashboardOutlookMore(b){var a=10;var c=false;if(sumOfCheckBoxElements("outlookSymbolsNames")<=a){$J("tr[symbolId='"+b+"']").toggle();c=true}else{$("outlookSN"+b).checked=false;inlineMsg($("outlookMore"),$T("tMaxNumberOfSymbols",[a]),3)}if(c){fxAjax.sendRequest(fxVars.updateOutlookSymbolsFilter+getCheckBoxesValuesByNameAndAttr("outlookSymbolsNames","symbolId"),{loader:false})}}function getUserPositionsSlippage(element,slaveAccountOid,masterAccountOid,unsubscribed){var positionsSlippageElement=$("positionsSlipage"+masterAccountOid);if(!eval(element.getAttribute("hasData"))){fxAjax.sendRequest(fxVars.getUserPositionsSlippage+"slaveAccountOid="+slaveAccountOid+"&masterAccountOid="+masterAccountOid,{params:{positionsSlippageElement:positionsSlippageElement,element:element},loader:true,callback:"getUserPositionsSlippageResponse"})}else{showHideElement(positionsSlippageElement);element.innerHTML=isShown(positionsSlippageElement)?"-":"+";if(isShown(positionsSlippageElement)){element.parentNode.parentNode.className="bg6"}else{element.parentNode.parentNode.className=(unsubscribed)?"lightRed":""}}}function getUserPositionsSlippageResponse(a,d){if(!a.error){var c=a.content.data;if(hasText(c)){showHideElement(d.positionsSlippageElement);d.positionsSlippageElement.innerHTML=c;d.element.setAttribute("hasData",true);d.element.innerHTML=isShown(d.element.id)?"-":"+";d.element.parentNode.parentNode.className=isShown(d.element.id)?"bg6":"";runAjaxScripts(c)}}else{var b=a.message;if(b!=null){showJqueryMessage("positionsSlipageMsg",b)}}}function sortPortfolioAutoTrade(){jQuery("#autotradeMasterStats [oid]").each(function(){try{var c=this.getAttribute("oid");var a=$("positionsSlipage"+c);jQuery(a.parentNode).insertAfter(this)}catch(b){}})}function showSubscribedAndUnsubscribedAutoTrade(a){jQuery("#autotradeMasterStats [unsubscribed="+a+"]").each(function(b){var d=this.getAttribute("oid");var c=$("positionsSlipage"+d);var g=$("expandButton"+d);if(a){if($("showUnsubscribed").checked){showElement(this)}else{hideElement(this);hideElement(c);try{g.innerHTML="+"}catch(f){}this.className="lightRed"}}else{if($("showSubscribed").checked){showElement(this)}else{hideElement(this);hideElement(c);try{g.innerHTML="+"}catch(f){}this.className=""}}});toggleAutotradeTabContent()}function toggleAutotradeTabContent(){if(countVisibleRowsWithAttrebute("autotradeMasterStats","unsubscribed")==0){showElement("autoTradeIsEmpty");hideElement("autotradeMasterStats")}else{hideElement("autoTradeIsEmpty");showElement("autotradeMasterStats")}}function countVisibleRowsWithAttrebute(b,a){return $J("#"+b+" tr["+a+'][style!="display: none;"]').length}function selectAllCheckboxesByName(b){var a=document.getElementsByName(b);for(var c=0;c<a.length;c++){a[c].checked=true}}function trackBrokerManageLinkClick(c,a,b){var d=["link=",encodeParameter(c),"&type=",a,"&oid=",b].join("");window.open("/link-track-redirect.html?"+d)}function refreshDashSystemsTable(){fxAjax.sendRequest(fxVars.refreshDashSystemsTable,{params:{},callback:"refreshDashSystemsTableResponse"})}function refreshDashSystemsTableResponse(a,c){if(!a.error){var b=a.content.systems;if(hasText(b)){$J("#my").html(b);runAjaxScripts(b)}}}function htmlDecode(a){var b=document.createElement("div");b.innerHTML=a;return b.childNodes.length===0?"":b.childNodes[0].nodeValue}function createScroller(d){try{var c=jQuery("#"+d);var a=c.data("jsp");if(a!=null){a.reinitialise()}else{jQuery("#"+d).jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(f){stopWheel(f)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")})}}catch(b){}}function getStrategiesPerPage(b){var a=$J("#strategyGroupCombo").val();if(hasText(b)&&!isNaN(b)&&hasText(a)&&!isNaN(a)){setCookie("usrpp",b,YEAR);var c=["results=",b,"&groupOid=",a];fxAjax.sendRequest(fxVars.getStrategiesPerPage+c.join(""),{params:{},loader:true,callback:"getStrategiesPerPageResponse"})}}function getStrategiesPerPageResponse(a,c){if(!a.error){var b=a.content.data;if(hasText(b)){$J("#myStrategiesTable").html(b);runAjaxScripts(b)}}}function showExposureTableByDirection(b){var a=$J("#exposuresData0");var c=$J("#exposuresData1");if(b.checked){c.hide();a.show()}else{a.hide();c.show()}}function changeOutlookSymbols(){var a=getCheckBoxesIds("outlookSymbols");if(!hasText(a)){a="0"}setCookie("ous",'"'+a+'"',YEAR,false);fxAjax.sendRequest(fxVars.changeOutlookSymbols,{params:{},loader:true,callback:"changeOutlookSymbolsResponse"})}function changeOutlookSymbolsResponse(a,c){if(!a.error){var b=a.content.newTable;$("outlookSymbolsTable").innerHTML=b;runAjaxScripts(b)}}function selectAllOutlookSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$("#outlookSymbolsTableMore input[name=outlookSymbols]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);changeOutlookSymbols()}function Tip(b,c,a){$J(document).ready(function(d){if(a!=undefined){Tipped.create(b,buildTip(a.title,c),a)}else{Tipped.create(b,buildTip("",c))}})}function buildTip(c,b){var a=$J("<div/>");if(hasText(c)){a.append("<b>"+c+"</b>");a.append("</br>")}a.append("<div>"+b+"</div>");return a.html()}function updateIndicatorsTable(d,c,b){var a=getCheckBoxesValues("symbols");var h=getCheckBoxesValues("indicators");if(a.split(",").length<=10){hideElement("symbolChangedMessage");var g=getComboValue("timeScales");$J("#selectedTimeFrame").val(g);$J("#selectedSymbols").val(a);$J("#selectedIndicators").val(h);var f=["&symbols=",a,"&indicators=",h,"&timeFrame=",g,"&isPatterns=",b];fxAjax.sendRequest(fxVars.updateIndicatorsTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),loader:c,callback:"updateIndicatorsTableResponse"})}else{if(!isShown($("symbolChangedMessage"))){$("symbolChangedMessage").innerHTML=$T("tOnly10Symbols");showElement("symbolChangedMessage")}if($("symbol"+d)){$("symbol"+d).checked=false}}}function updateIndicatorsTableResponse(b){if(!b.error){var a=b.content.indicatorsTable;if(a){$("indicatorsTable").innerHTML=a;runAjaxScripts($("indicatorsTable").innerHTML)}}}function updateSingleIndicatorTable(c,d,a){var b=getCheckBoxesValues("symbols");var g=getCheckBoxesValues("indicators");$J("#selectedSymbols").val(b);$J("#selectedIndicators").val(g);var f=["&symbols=",b,"&indicators=",g,"&isPatterns=",c,"&type=",d,"&oid=",a];fxAjax.sendRequest(fxVars.updateSingleIndicatorTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),loader:false,callback:"updateSingleIndicatorResponse"})}function updateSingleIndicatorResponse(b){if(!b.error){var a=b.content.singleTable;if(a){$("singleTable").innerHTML=a}}}function refreshIndicatorsTable(a){var b=$J("#selectedSymbols").val();var f=$J("#selectedIndicators").val();var d=$J("#selectedTimeFrame").val();var c=["&symbols=",b,"&indicators=",f,"&timeFrame=",d];fxAjax.sendRequest(fxVars.refreshIndicatorsTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:c.join(""),params:{isPattern:a,single:false},loader:false,callback:"refreshIndicatorsTableResponse"})}function refreshIndicatorSingleTable(a){var b=$J("#selectedSymbols").val();var g=$J("#selectedIndicators").val();var c=$J("#singleType").val();var d=$J("#selectedObjectOid").val();var f=["&symbols=",b,"&indicators=",g,"&type=",c,"&oid=",d];fxAjax.sendRequest(fxVars.refreshIndicatorSingleTable,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),params:{isPattern:a,single:true,type:c,indicatorOid:d},loader:false,callback:"refreshIndicatorsTableResponse"})}var neutralPatterns=new Array(35,37,41,42,47,57,66,74);function refreshIndicatorsTableResponse(a,b){if(!a.error){jQuery.each(a.content.data,function(f,g){if(b.isPattern){var c="-";var d=$J("#"+f);var h=d.attr("pName");if((b.single&&((b.type==1&&isContains(neutralPatterns,b.indicatorOid))||(b.type==0&&(f.contains("o35")||f.contains("o37")||f.contains("o41")||f.contains("o42")||f.contains("o47")||f.contains("o57")||f.contains("o66")||f.contains("o74")))))||(f.contains("i35")||f.contains("i37")||f.contains("i41")||f.contains("i42")||f.contains("i47")||f.contains("i57")||f.contains("i66")||f.contains("i74"))){if(g==100||g==-100){c="<img src='"+staticServerPath+"/images/circle2.gif' alt='"+h+" Bullish/Bearish/Uncertainty' title='"+h+" Bullish/Bearish/Uncertainty'>"}}else{if(g==100){c="<img src='"+staticServerPath+"/images/up_arrow.png' alt='"+h+" Bullish' title='"+h+" Bullish'>"}else{if(g==-100){c="<img src='"+staticServerPath+"/images/down_arrow.png' alt='"+h+" Bearish' title='"+h+" Bearish'>"}}}d.html(c)}else{$J("#"+f).html(g)}})}}function selectAllCheckBoxes(element,countDivName,checkBoxName,callFunction){var selected=isAllCheckBoxesSelected(countDivName,checkBoxName);var elements=$$("#"+countDivName+" input[name="+checkBoxName+"]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}eval(callFunction)}function isAllCheckBoxesSelected(a,b){return !($J("#"+a+" input[name="+b+"]").not(":checked").length>0)}function calcBarWidth(c,d){var b=60;if(c>20){c=20}var a="<div class='floatLeft' style='background:#00dd4e;width:"+Math.round(c/20*b)+"px;height:7px;'</div>";document.getElementById(d).innerHTML=a}function updateDashboardWatchedFilter(){fxAjax.sendRequest(fxVars.updateDashboardWatchedFilter+getCheckBoxesIds("watchedMoreColumnName"),{loader:false})}function declineProvider(a){fxAjax.sendRequest(fxVars.declineProvider+"accountOid="+a,{params:{accountOid:a},loader:false,callback:"declineProviderResponse"})}function declineProviderResponse(a,b){if(!a.error){hideElement("declineProviderMsg"+b.accountOid)}}function buildConfirmationTip(element,content,func){var msg;var msgcontent;msg=document.createElement("div");msgcontent=document.createElement("div");msg.appendChild(msgcontent);msgcontent.innerHTML=content+"<br/><br/>";msg.style.display="block";var buttons;buttons=document.createElement("div");buttons.id="buttons";var cancelButt=document.createElement("input");cancelButt.type="button";cancelButt.className="popupButton";cancelButt.value="  No  ";cancelButt.onclick=function(){Tipped.remove(element)};var okButt=document.createElement("input");okButt.type="button";okButt.className="popupButton";okButt.value="  Yes  ";okButt.onclick=function(){Tipped.remove(element);eval(func)};buttons.appendChild(okButt);buttons.appendChild(cancelButt);msgcontent.appendChild(buttons);return msg}function ConfirmationTip(b,a,d,c){$J(document).ready(function(f){if(Tipped.findElement(b)==null){if(a!=undefined){Tipped.create(b,buildConfirmationTip(b,d,c),a)}else{Tipped.create(b,buildConfirmationTip(b,d,c))}Tipped.show(b)}})}function calendarMultiEmailAlert(c,b){var a=[];jQuery("[calendarOid]").each(function(d){var f=Number(this.getAttribute("calendarOid"));if(calRequests[f]!=true){calRequests[f]=true;a.push(f)}});if(a.length>0){fxAjax.sendRequest(fxVars.calendarMultiNotification,{contentType:"application/x-www-form-urlencoded; charset=utf-8",params:{foundOids:a,add:b,e:c},postBody:["oids=",a.join(","),"&add=",b].join(""),method:"post",loader:true,callback:"calendarMultiEmailAlertResponse"});c.cancelBubble=true;if(c.stopPropagation){c.stopPropagation()}}}function calendarMultiEmailAlertResponse(a,g){var f=a.message;var b=a.content.list;if(!a.error){for(var c=0;c<b.length;c++){var d=b[c];if(g.add){$("calendarAlert"+d).onclick=function(h){calendarEmailAlert(h?h:window.event,Number(this.getAttribute("calendaroid")),false)};$("calendarAlert"+d).className="notifyOn"}else{$("calendarAlert"+d).onclick=function(h){calendarEmailAlert(h?h:window.event,Number(this.getAttribute("calendaroid")),true)};$("calendarAlert"+d).className="notifyOff"}}}else{inlineMsg("calendarAlertMain","<b>Error</b><br>"+f,3)}for(c=0;c<g.foundOids.length;c++){d=Number(g.foundOids[c]);calRequests[d]=false}}String.prototype.contains=function(a){return this.indexOf(a)!=-1};function enableOrDisableTimeZoneData(a){jQuery(".enableOrDisableTimeZone").each(function(b){jQuery(this).prop("disabled",a)})}function getTimezoneOffset(){return new Date().getTimezoneOffset()/60*(-1)}function deletePostAttachment(a,d,b){if(confirm("Are you sure?")&&a!=undefined&&d!=undefined){var c=["postOid=",a,"&attachmentOid=",d];fxAjax.sendRequest(fxVars.deletePostAttachment+c.join(""),{loader:false,params:{postOid:a,attachmentOid:d,lastAttachment:b},callback:"deletePostAttachmentResponse"})}}function deletePostAttachmentResponse(a,b){if(hasText(a)){$J("#postAttachment"+b.attachmentOid+b.postOid).remove();if(b.lastAttachment){$J("#postAttachments").remove()}}}function buildOutlookWidgetURL(b){var c=Number(getRadioValue("outlookSymbolWidgetMode"));var a=[];jQuery("#outlookWidgetLink input:checked").each(function(){a.push(this.getAttribute("oid"))});var f=["type=",c,"&symbols=",a.join(",")];var d=b+"/widgets/outlook.html?"+f.join("");jQuery("[name=outlook_iframe").each(function(){this.setAttribute("src",d)});$("outlookWidgetText").value='<!-- myfxbook.com outlook widget - Start -->\n       <script type="text/javascript" src='+b+"/scripts/fxOutlook.js?"+f.join("")+"><\/script>\n       <!-- myfxbook.com outlook widget - End -->"}function onOffCalendarNotify(b,a){$("calendarAlert"+b).className=(a)?"notifyOff":"notifyOn";$("calendarAlert"+b).onclick=function(c){calendarEmailAlert(c?c:window.event,b,a)}}function getUrlVars(){var d=[],c;var a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var b=0;b<a.length;b++){c=a[b].split("=");d.push(c[0]);d[c[0]]=c[1]}return d}function rateBinaryBroker(a){if(isRated()){var b=["brokerId="+a,"&platform=",$("platform").value,"&spreads=",$("spreads").value,"&service=",$("service").value,"&features=",$("features").value].join("");fxAjax.sendRequest(fxVars.rateBinaryBroker+b,{contentType:"text/xml",params:"rateCont",loader:true,callback:"rateReviewResponse"})}}function showSendTrySignalStartConfirmation(a){var b="sendTrySignalStart("+a+")";showJquerySubmitDialog("trySignalStartDataMsg",b,false,416,"Send Invite")}function sendTrySignalStart(a){fxAjax.sendRequest(fxVars.sendTrySignalStart+"accountOid="+a,{params:{oid:a},callback:"sendTrySignalStartResponse"})}function sendTrySignalStartResponse(a,b){if(!a.error){$J("#trySignalStart"+b.oid).removeClass("blue").css({cursor:"default"}).addClass("bg7 whiteColor").removeAttr("onclick");$J("#trySignalStartDataMsg").dialog("close");showJqueryMessage("trySignalStartMsg"+b.oid,a.message)}}function getSpreadsByType(b){var a;if(typeof b=="undefined"||b==null){a=jQuery("#typeComboBox option:selected").val()}else{a=b}fxAjax.sendRequest(fxVars.getSpreadsByType+"serverType="+a,{params:{serverType:a},loader:true,callback:"getSpreadsByTypeResponse"})}function getSpreadsByTypeResponse(a){if(!a.error){jQuery(".ds1.marginB10").html(a.content.spreadsTable)}}if(!window.DHTMLSuite){var DHTMLSuite=new Object()}if(!String.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")}}var DHTMLSuite_funcs=new Object();if(!window.DHTML_SUITE_THEME){var DHTML_SUITE_THEME="blue"}if(!window.DHTML_SUITE_THEME_FOLDER){var DHTML_SUITE_THEME_FOLDER="../images/calendar/"}if(!window.DHTML_SUITE_JS_FOLDER){var DHTML_SUITE_JS_FOLDER=staticServerPath+"/scripts/"}var DHTMLSuite=new Object();var standardObjectsCreated=false;DHTMLSuite.eventEls=new Array();var widgetDep=new Object();widgetDep.formValidator=["dhtmlSuite-formUtil.js"];widgetDep.paneSplitter=["dhtmlSuite-paneSplitter.js","dhtmlSuite-paneSplitterModel.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.menuBar=["dhtmlSuite-menuBar.js","dhtmlSuite-menuItem.js","dhtmlSuite-menuModel.js"];widgetDep.windowWidget=["dhtmlSuite-windowWidget.js","dhtmlSuite-resize.js","dhtmlSuite-dragDropSimple.js","ajax.js","dhtmlSuite-dynamicContent.js"];widgetDep.colorWidget=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js"];widgetDep.colorSlider=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js","dhtmlSuite-slider.js"];widgetDep.colorPalette=["dhtmlSuite-colorWidgets.js","dhtmlSuite-colorUtil.js"];widgetDep.calendar=["dhtmlSuite-calendar.js","dhtmlSuite-dragDropSimple.js"];widgetDep.dragDropTree=["dhtmlSuite-dragDropTree.js"];widgetDep.slider=["dhtmlSuite-slider.js"];widgetDep.dragDrop=["dhtmlSuite-dragDrop.js"];widgetDep.imageEnlarger=["dhtmlSuite-imageEnlarger.js","dhtmlSuite-dragDropSimple.js"];widgetDep.imageSelection=["dhtmlSuite-imageSelection.js"];widgetDep.floatingGallery=["dhtmlSuite-floatingGallery.js","dhtmlSuite-mediaModel.js"];widgetDep.contextMenu=["dhtmlSuite-contextMenu.js","dhtmlSuite-menuBar.js","dhtmlSuite-menuItem.js","dhtmlSuite-menuModel.js"];widgetDep.dynamicContent=["dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.textEdit=["dhtmlSuite-textEdit.js","dhtmlSuite-textEditModel.js","dhtmlSuite-listModel.js"];widgetDep.listModel=["dhtmlSuite-listModel.js"];widgetDep.resize=["dhtmlSuite-resize.js"];widgetDep.dragDropSimple=["dhtmlSuite-dragDropSimple.js"];widgetDep.dynamicTooltip=["dhtmlSuite-dynamicTooltip.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.modalMessage=["dhtmlSuite-modalMessage.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.tableWidget=["dhtmlSuite-tableWidget.js","ajax.js"];widgetDep.progressBar=["dhtmlSuite-progressBar.js"];widgetDep.tabView=["dhtmlSuite-tabView.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.infoPanel=["dhtmlSuite-infoPanel.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.form=["dhtmlSuite-formUtil.js","dhtmlSuite-dynamicContent.js","ajax.js"];widgetDep.autoComplete=["dhtmlSuite-autoComplete.js","ajax.js"];widgetDep.chainedSelect=["dhtmlSuite-chainedSelect.js","ajax.js"];var depCache=new Object();DHTMLSuite.include=function(b){if(!widgetDep[b]){alert("Cannot find the files for widget "+b+". Please verify that the name is correct");return}var a=widgetDep[b];for(var c=0;c<a.length;c++){if(!depCache[a[c]]){document.write("<script");document.write(' language="javascript"');document.write(' type="text/javascript"');document.write(' src="'+DHTML_SUITE_JS_FOLDER+a[c]+'">');document.write("<\/script>");depCache[a[c]]=true}}};DHTMLSuite.discardElement=function(a){a=DHTMLSuite.commonObj.getEl(a);var b=document.getElementById("IELeakGBin");if(!b){b=document.createElement("DIV");b.id="IELeakGBin";b.style.display="none";document.body.appendChild(b)}b.appendChild(a);b.innerHTML=""};DHTMLSuite.createStandardObjects=function(){DHTMLSuite.clientInfoObj=new DHTMLSuite.clientInfo();DHTMLSuite.clientInfoObj.init();if(!DHTMLSuite.configObj){DHTMLSuite.configObj=new DHTMLSuite.config();DHTMLSuite.configObj.init()}DHTMLSuite.commonObj=new DHTMLSuite.common();DHTMLSuite.variableStorage=new DHTMLSuite.globalVariableStorage();DHTMLSuite.commonObj.init();DHTMLSuite.domQueryObj=new DHTMLSuite.domQuery();DHTMLSuite.commonObj.addEvent(window,"unload",function(){DHTMLSuite.commonObj.__clearMemoryGarbage()});standardObjectsCreated=true};DHTMLSuite.config=function(){var a;var c;var b;var d};DHTMLSuite.config.prototype={init:function(){this.imagePath=DHTML_SUITE_THEME_FOLDER+DHTML_SUITE_THEME+"/";this.cssPath="/styles/";this.defaultCssPath=this.cssPath;this.defaultImagePath=this.imagePath},setCssPath:function(a){this.cssPath=a},resetCssPath:function(){this.cssPath=this.defaultCssPath},resetImagePath:function(){this.imagePath=this.defaultImagePath},setImagePath:function(a){this.imagePath=a}};DHTMLSuite.globalVariableStorage=function(){var c;this.menuBar_highlightedItems=new Array();var d;var b;this.arrayDSObjects=new Array();this.arrayOfDhtmlSuiteObjects=this.arrayDSObjects;var a;this.ajaxObjects=new Array()};DHTMLSuite.globalVariableStorage.prototype={};DHTMLSuite.common=function(){var d;var c;var a;var b;this.okToSelect=true;this.cssCacheStatus=true;this.eventEls=new Array()};DHTMLSuite.common.prototype={init:function(){this.loadedCSSFiles=new Array()},loadCSS:function(b,c){if(!c&&c!==false){c=true}if(!this.loadedCSSFiles[b]){this.loadedCSSFiles[b]=true;var a=document.createElement("LINK");if(!this.cssCacheStatus){if(b.indexOf("?")>=0){b=b+"&"}else{b=b+"?"}b=b+"rand="+Math.random()}if(c){a.href=DHTMLSuite.configObj.cssPath+b}else{a.href=b}a.rel="stylesheet";a.media="screen";a.type="text/css";document.getElementsByTagName("HEAD")[0].appendChild(a)}},__setTextSelOk:function(a){this.okToSelect=a},__isTextSelOk:function(){return this.okToSelect},setCssCacheStatus:function(a){this.cssCacheStatus=a},getEl:function(a){if(typeof a=="string"){if(document.getElementById(a)){return document.getElementById(a)}if(document.forms[a]){return document.forms[a]}if(document[a]){return document[a]}if(window[a]){return window[a]}}return a},isArray:function(a){if(a.constructor.toString().indexOf("Array")!=-1){return true}return false},getStyle:function(b,c){b=this.getEl(b);if(document.defaultView&&document.defaultView.getComputedStyle){var d=null;var a=document.defaultView.getComputedStyle(b,"");if(a){d=a[c]}return b.style[c]||d}if(document.documentElement.currentStyle&&DHTMLSuite.clientInfoObj.isMSIE){var d=null;if(b.currentStyle){value=b.currentStyle[c]}return(b.style[c]||d)}return b.style[c]},getLeftPos:function(b){if(document.getBoxObjectFor){if(b.tagName!="INPUT"&&b.tagName!="SELECT"&&b.tagName!="TEXTAREA"){return document.getBoxObjectFor(b).x}}var a=b.offsetLeft;while((b=b.offsetParent)!=null){if(b.tagName!="HTML"){a+=b.offsetLeft;if(document.all){a+=b.clientLeft}}}return a},getTopPos:function(b){if(document.getBoxObjectFor){if(b.tagName!="INPUT"&&b.tagName!="SELECT"&&b.tagName!="TEXTAREA"){return document.getBoxObjectFor(b).y}}var a=b.offsetTop;while((b=b.offsetParent)!=null){if(b.tagName!="HTML"){a+=(b.offsetTop-b.scrollTop);if(document.all){a+=b.clientTop}}}return a},getCookie:function(c){var d=document.cookie.indexOf(c+"=");var a=d+c.length+1;if((!d)&&(c!=document.cookie.substring(0,c.length))){return null}if(d==-1){return null}var b=document.cookie.indexOf(";",a);if(b==-1){b=document.cookie.length}return unescape(document.cookie.substring(a,b))},setCookie:function(b,g,c,l,d,a){c=c*60*60*24*1000;var f=new Date();var h=new Date(f.getTime()+(c));var k=b+"="+escape(g)+((c)?";expires="+h.toGMTString():"")+((l)?";path="+l:"")+((d)?";domain="+d:"")+((a)?";secure":"");document.cookie=k},deleteCookie:function(a,c,b){if(this.getCookie(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}},cancelEvent:function(){return false},addEvent:function(d,b,a,c){if(!c){c=""}if(d.attachEvent){if(typeof DHTMLSuite_funcs[b+a+c]!="function"){DHTMLSuite_funcs[b+a+c]=function(){a.apply(window.event.srcElement)};d.attachEvent("on"+b,DHTMLSuite_funcs[b+a+c])}d=null}else{d.addEventListener(b,a,false)}this.__addEventEl(d)},removeEvent:function(d,b,a,c){if(d.detachEvent){d.detachEvent("on"+b,DHTMLSuite_funcs[b+a+c]);DHTMLSuite_funcs[b+a+c]=null;d=null}else{d.removeEventListener(b,a,false)}},__clearMemoryGarbage:function(){if(!DHTMLSuite.clientInfoObj.isMSIE){return}for(var c=0;c<DHTMLSuite.eventEls.length;c++){try{var a=DHTMLSuite.eventEls[c];a.onclick=null;a.onmousedown=null;a.onmousemove=null;a.onmouseout=null;a.onmouseover=null;a.onmouseup=null;a.onfocus=null;a.onblur=null;a.onkeydown=null;a.onkeypress=null;a.onkeyup=null;a.onselectstart=null;a.ondragstart=null;a.oncontextmenu=null;a.onscroll=null;a=null}catch(b){}}for(var c in DHTMLSuite.variableStorage.arrayDSObjects){DHTMLSuite.variableStorage.arrayDSObjects[c]=null}window.onbeforeunload=null;window.onunload=null;DHTMLSuite=null},__addEventEl:function(a){DHTMLSuite.eventEls[DHTMLSuite.eventEls.length]=a},getSrcElement:function(b){var a;if(b.target){a=b.target}else{if(b.srcElement){a=b.srcElement}}if(a.nodeType==3){a=a.parentNode}return a},getKeyFromEvent:function(b){var a=this.getKeyCode(b);return String.fromCharCode(a)},getKeyCode:function(a){if(a.keyCode){code=a.keyCode}else{if(a.which){code=a.which}}return code},isObjectClicked:function(c,b){var d=this.getSrcElement(b);var a=d.tagName+"("+d.className+")";if(d==c){return true}while(d.parentNode&&d.tagName.toLowerCase()!="html"){d=d.parentNode;a=a+","+d.tagName+"("+d.className+")";if(d==c){return true}}return false},getObjectByClassName:function(b,a){var c=this.getSrcElement(b);if(c.className==a){return c}while(c&&c.tagName.toLowerCase()!="html"){c=c.parentNode;if(c.className==a){return c}}return false},getObjectByAttribute:function(c,b){var d=this.getSrcElement(c);var a=d.getAttribute(b);if(!a){a=d[b]}if(a){return d}while(d&&d.tagName.toLowerCase()!="html"){d=d.parentNode;var a=d.getAttribute("attribute");if(!a){a=d[b]}if(a){return d}}return false},getUniqueId:function(){var b=Math.random()+"";b=b.replace(".","");var a=Math.random()+"";a=a.replace(".","");return b+a},getAssociativeArrayFromString:function(b){if(!b){return}var a=new Array();var c=b.split(/,/g);for(var f=0;f<c.length;f++){var d=c[f].split(/:/);a[d[0]]=d[1]}return a},correctPng:function(f){f=DHTMLSuite.commonObj.getEl(f);var b=f;var d=b.width;var a=b.height;var c="<span style=\"display:inline-block;filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+b.src+"',sizingMethod='scale');width:"+d+";height:"+a+'"></span>';b.outerHTML=c},__evaluateJs:function(g){g=this.getEl(g);var f=g.getElementsByTagName("SCRIPT");var b="";var d="";for(var h=0;h<f.length;h++){if(f[h].src){var c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",f[h].src)}else{if(DHTMLSuite.clientInfoObj.isOpera){d=d+f[h].text+"\n"}else{d=d+f[h].innerHTML}}}if(d){this.__installScript(d)}},__installScript:function(a){try{if(!a){return}if(window.execScript){window.execScript(a)}else{if(window.jQuery&&jQuery.browser.safari){window.setTimeout(a,0)}else{window.setTimeout(a,0)}}}catch(b){}},__evaluateCss:function(b){b=this.getEl(b);var d=b.getElementsByTagName("STYLE");var a=document.getElementsByTagName("HEAD")[0];for(var c=0;c<d.length;c++){a.appendChild(d[c])}}};DHTMLSuite.clientInfo=function(){var d;var c;var a;var f;var g;var b;var f};DHTMLSuite.clientInfo.prototype={init:function(){this.browser=navigator.userAgent;this.isOpera=(this.browser.toLowerCase().indexOf("opera")>=0)?true:false;this.isFirefox=(this.browser.toLowerCase().indexOf("firefox")>=0)?true:false;this.isMSIE=(this.browser.toLowerCase().indexOf("msie")>=0)?true:false;this.isOldMSIE=(this.browser.toLowerCase().match(/msie\s[0-6]/gi))?true:false;this.isSafari=(this.browser.toLowerCase().indexOf("safari")>=0)?true:false;this.navigatorVersion=navigator.appVersion.replace(/.*?MSIE\s(\d\.\d).*/g,"$1")/1;this.isOldMSIE=(this.isMSIE&&this.navigatorVersion<7)?true:false},getBrowserWidth:function(){if(self.innerWidth){return self.innerWidth}return document.documentElement.offsetWidth},getBrowserHeight:function(){if(self.innerHeight){return self.innerHeight}return document.documentElement.offsetHeight}};DHTMLSuite.domQuery=function(){document.getElementsByClassName=this.getElementsByClassName;document.getElementsByAttribute=this.getElementsByAttribute};DHTMLSuite.domQuery.prototype={};var jscolor={dir:"/images/jscolor/",bindClass:"color",binding:true,preloading:true,removeColorPicker:function(){if(jscolor.picker!=undefined){if(jscolor.picker.owner!=undefined){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}}},install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){if(jscolor.binding){jscolor.bind()}if(jscolor.preloading){jscolor.preload()}},getDir:function(){if(!jscolor.dir){var a=jscolor.detectDir();jscolor.dir=a!=false?a:"/images/jscolor/"}return jscolor.dir},detectDir:function(){var c=location.href;var d=document.getElementsByTagName("base");for(var a=0;a<d.length;a++){if(d[a].href){c=d[a].href}}var d=document.getElementsByTagName("script");for(var a=0;a<d.length;a++){if(d[a].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(d[a].src)){var f=new jscolor.URI(d[a].src);var b=f.toAbsolute(c);b.path=b.path.replace(/[^\/]+$/,"");delete b.query;delete b.fragment;return b.toString()}}return false},bind:function(){var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i");var e=document.getElementsByTagName("input");for(var i=0;i<e.length;i++){var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3]){try{eval("prop="+m[3])}catch(eInvalidProp){}}e[i].color=new jscolor.color(e[i],prop)}}},preload:function(){for(var a in jscolor.imgRequire){jscolor.loadImage(a)}},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(a){jscolor.imgRequire[a]=true},loadImage:function(a){if(!jscolor.imgLoaded[a]){jscolor.imgLoaded[a]=new Image();jscolor.imgLoaded[a].src=jscolor.getDir()+a}},fetchElement:function(a){return typeof(a)=="string"?document.getElementById(a):a},addEvent:function(a,c,b){if(a.addEventListener){return a.addEventListener(c,b,false)}else{if(a.attachEvent){return a.attachEvent("on"+c,b)}else{return false}}},fireEvent:function(a,c){if(!a){return false}else{if(document.createEventObject){var b=document.createEventObject();return a.fireEvent("on"+c,b)}else{if(document.createEvent){var b=document.createEvent("HTMLEvents");b.initEvent(c,true,true);return a.dispatchEvent(b)}else{if(a["on"+c]){return a["on"+c]()}else{return false}}}}},getElementPos:function(c){var d=c,b=c;var a=0,f=0;if(d.offsetParent){do{a+=d.offsetLeft;f+=d.offsetTop}while(d=d.offsetParent)}while((b=b.parentNode)&&b.nodeName!="BODY"){a-=b.scrollLeft;f-=b.scrollTop}return[a,f]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getMousePos:function(a){if(!a){a=window.event}if(typeof a.pageX=="number"){return[a.pageX,a.pageY]}else{if(typeof a.clientX=="number"){return[a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.clientY+document.body.scrollTop+document.documentElement.scrollTop]}}},getViewPos:function(){if(typeof window.pageYOffset=="number"){return[window.pageXOffset,window.pageYOffset]}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){return[document.body.scrollLeft,document.body.scrollTop]}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]}else{return[0,0]}}}},getViewSize:function(){if(typeof window.innerWidth=="number"){return[window.innerWidth,window.innerHeight]}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){return[document.body.clientWidth,document.body.clientHeight]}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){return[document.documentElement.clientWidth,document.documentElement.clientHeight]}else{return[0,0]}}}},URI:function(a){this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(d){var c=d.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=c[3]?c[2]:null;this.authority=c[5]?c[6]:null;this.path=c[7];this.query=c[9]?c[10]:null;this.fragment=c[12]?c[13]:null;return this};this.toString=function(){var c="";if(this.scheme!=null){c=c+this.scheme+":"}if(this.authority!=null){c=c+"//"+this.authority}if(this.path!=null){c=c+this.path}if(this.query!=null){c=c+"?"+this.query}if(this.fragment!=null){c=c+"#"+this.fragment}return c};this.toAbsolute=function(f){var f=new jscolor.URI(f);var d=this;var c=new jscolor.URI;if(f.scheme==null){return false}if(d.scheme!=null&&d.scheme.toLowerCase()==f.scheme.toLowerCase()){d.scheme=null}if(d.scheme!=null){c.scheme=d.scheme;c.authority=d.authority;c.path=b(d.path);c.query=d.query}else{if(d.authority!=null){c.authority=d.authority;c.path=b(d.path);c.query=d.query}else{if(d.path==""){c.path=f.path;if(d.query!=null){c.query=d.query}else{c.query=f.query}}else{if(d.path.substr(0,1)=="/"){c.path=b(d.path)}else{if(f.authority!=null&&f.path==""){c.path="/"+d.path}else{c.path=f.path.replace(/[^\/]+$/,"")+d.path}c.path=b(c.path)}c.query=d.query}c.authority=f.authority}c.scheme=f.scheme}c.fragment=d.fragment;return c};function b(f){var c="";while(f){if(f.substr(0,3)=="../"||f.substr(0,2)=="./"){f=f.replace(/^\.+/,"").substr(1)}else{if(f.substr(0,3)=="/./"||f=="/."){f="/"+f.substr(3)}else{if(f.substr(0,4)=="/../"||f=="/.."){f="/"+f.substr(4);c=c.replace(/\/?[^\/]*$/,"")}else{if(f=="."||f==".."){f=""}else{var d=f.match(/^\/?[^\/]*/)[0];f=f.substr(d.length);c=c+d}}}}}return c}if(a){this.parse(a)}},color:function(E,d){this.required=true;this.adjust=true;this.hash=false;this.caps=true;this.valueElement=E;this.styleElement=E;this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=true;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerFace=10;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=10000;for(var v in d){this[v]=d[v]}this.hidePicker=function(){if(w()){g()}};this.showPicker=function(){if(!w()){var O=jscolor.getElementPos(E);var L=jscolor.getElementSize(E);var I=jscolor.getViewPos();var Q=jscolor.getViewSize();var H=[2*this.pickerBorder+4*this.pickerInset+2*this.pickerFace+jscolor.images.pad[0]+2*jscolor.images.arrow[0]+jscolor.images.sld[0],2*this.pickerBorder+2*this.pickerInset+2*this.pickerFace+jscolor.images.pad[1]];var P,N,M;switch(this.pickerPosition.toLowerCase()){case"left":P=1;N=0;M=-1;break;case"right":P=1;N=0;M=1;break;case"top":P=0;N=1;M=-1;break;default:P=0;N=1;M=1;break}var K=(L[N]+H[N])/2;var J=[-I[P]+O[P]+H[P]>Q[P]?(-I[P]+O[P]+L[P]/2>Q[P]/2&&O[P]+L[P]-H[P]>=0?O[P]+L[P]-H[P]:O[P]):O[P],-I[N]+O[N]+L[N]+H[N]-K+K*M>Q[N]?(-I[N]+O[N]+L[N]/2>Q[N]/2&&O[N]+L[N]-K-K*M>=0?O[N]+L[N]-K-K*M:O[N]+L[N]-K+K*M):(O[N]+L[N]-K+K*M>=0?O[N]+L[N]-K+K*M:O[N]+L[N]-K-K*M)];l(J[P],J[N])}};this.importColor=function(){if(!a){this.exportColor()}else{if(!this.adjust){if(!this.fromString(a.getAttribute("hex"),z)){G.style.backgroundColor=G.jscStyle.backgroundColor;G.style.color=G.jscStyle.color;this.exportColor(z|F)}}else{if(!this.required&&/^\s*$/.test(a.getAttribute("hex"))){a.setAttribute("hex","");G.style.backgroundColor=G.jscStyle.backgroundColor;G.style.color=G.jscStyle.color;this.exportColor(z|F)}else{if(this.fromString(a.getAttribute("hex"))){}else{this.exportColor()}}}}};this.exportColor=function(H){if(!(H&z)&&a){var I=this.toString();if(this.caps){I=I.toUpperCase()}if(this.hash){I="#"+I}a.setAttribute("hex",I)}if(!(H&F)&&G){G.style.backgroundColor="#"+this.toString();G.style.color=0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]<0.5?"#FFF":"#000"}if(!(H&x)&&w()){u()}if(!(H&f)&&w()){D()}};this.fromHSV=function(K,J,I,H){K<0&&(K=0)||K>6&&(K=6);J<0&&(J=0)||J>1&&(J=1);I<0&&(I=0)||I>1&&(I=1);this.rgb=h(K==null?this.hsv[0]:(this.hsv[0]=K),J==null?this.hsv[1]:(this.hsv[1]=J),I==null?this.hsv[2]:(this.hsv[2]=I));this.exportColor(H)};this.fromRGB=function(L,K,H,I){L<0&&(L=0)||L>1&&(L=1);K<0&&(K=0)||K>1&&(K=1);H<0&&(H=0)||H>1&&(H=1);var J=A(L==null?this.rgb[0]:(this.rgb[0]=L),K==null?this.rgb[1]:(this.rgb[1]=K),H==null?this.rgb[2]:(this.rgb[2]=H));if(J[0]!=null){this.hsv[0]=J[0]}if(J[2]!=0){this.hsv[1]=J[1]}this.hsv[2]=J[2];this.exportColor(I)};this.fromString=function(J,I){var H=J.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(!H){return false}else{if(H[1].length==6){this.fromRGB(parseInt(H[1].substr(0,2),16)/255,parseInt(H[1].substr(2,2),16)/255,parseInt(H[1].substr(4,2),16)/255,I)}else{this.fromRGB(parseInt(H[1].charAt(0)+H[1].charAt(0),16)/255,parseInt(H[1].charAt(1)+H[1].charAt(1),16)/255,parseInt(H[1].charAt(2)+H[1].charAt(2),16)/255,I)}return true}};this.toString=function(){return((256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1))};function A(M,L,I){var N=Math.min(Math.min(M,L),I);var J=Math.max(Math.max(M,L),I);var H=J-N;if(H==0){return[null,0,J]}var K=M==N?3+(I-L)/H:(L==N?5+(M-I)/H:1+(L-M)/H);return[K==6?0:K,H/J,J]}function h(L,K,I){if(L==null){return[I,I,I]}var J=Math.floor(L);var M=J%2?L-J:1-(L-J);var H=I*(1-K);var N=I*(1-K*M);switch(J){case 6:case 0:return[I,N,H];case 1:return[N,I,H];case 2:return[H,I,N];case 3:return[H,N,I];case 4:return[N,H,I];case 5:return[I,H,N]}}function g(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function l(H,O){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div")};for(var K=0,N=4;K<jscolor.images.sld[1];K+=N){var I=document.createElement("div");I.style.height=N+"px";I.style.fontSize="1px";I.style.lineHeight="0";jscolor.picker.sld.appendChild(I)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.boxB.appendChild(jscolor.picker.box)}var M=jscolor.picker;s=[H+m.pickerBorder+m.pickerFace+m.pickerInset,O+m.pickerBorder+m.pickerFace+m.pickerInset];B=[null,O+m.pickerBorder+m.pickerFace+m.pickerInset];M.box.onmouseup=M.box.onmouseout=function(){E.focus()};M.box.onmousedown=function(){q=true};M.box.onmousemove=function(P){c&&y(P);r&&k(P)};M.padM.onmouseup=M.padM.onmouseout=function(){if(c){c=false;jscolor.fireEvent(a,"change")}};M.padM.onmousedown=function(P){c=true;y(P)};M.sldM.onmouseup=M.sldM.onmouseout=function(){if(r){r=false;jscolor.fireEvent(a,"change")}};M.sldM.onmousedown=function(P){r=true;k(P)};M.box.style.width=4*m.pickerInset+2*m.pickerFace+jscolor.images.pad[0]+2*jscolor.images.arrow[0]+jscolor.images.sld[0]+"px";M.box.style.height=2*m.pickerInset+2*m.pickerFace+jscolor.images.pad[1]+"px";M.boxB.style.position="absolute";M.boxB.style.clear="both";M.boxB.style.left=H+"px";M.boxB.style.top=O+"px";M.boxB.style.zIndex=m.pickerZIndex;M.boxB.style.border=m.pickerBorder+"px solid";M.boxB.style.borderColor=m.pickerBorderColor;M.boxB.style.background=m.pickerFaceColor;M.pad.style.width=jscolor.images.pad[0]+"px";M.pad.style.height=jscolor.images.pad[1]+"px";M.padB.style.position="absolute";M.padB.style.left=m.pickerFace+"px";M.padB.style.top=m.pickerFace+"px";M.padB.style.border=m.pickerInset+"px solid";M.padB.style.borderColor=m.pickerInsetColor;M.padM.style.position="absolute";M.padM.style.left="0";M.padM.style.top="0";M.padM.style.width=m.pickerFace+2*m.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";M.padM.style.height=M.box.style.height;M.padM.style.cursor="crosshair";M.sld.style.overflow="hidden";M.sld.style.width=jscolor.images.sld[0]+"px";M.sld.style.height=jscolor.images.sld[1]+"px";M.sldB.style.position="absolute";M.sldB.style.right=m.pickerFace+"px";M.sldB.style.top=m.pickerFace+"px";M.sldB.style.border=m.pickerInset+"px solid";M.sldB.style.borderColor=m.pickerInsetColor;M.sldM.style.position="absolute";M.sldM.style.right="0";M.sldM.style.top="0";M.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+m.pickerFace+2*m.pickerInset+"px";M.sldM.style.height=M.box.style.height;try{M.sldM.style.cursor="pointer"}catch(J){M.sldM.style.cursor="hand"}switch(b){case 0:var L="hs.png";break;case 1:var L="hv.png";break}M.padM.style.background="url('"+jscolor.getDir()+"cross.gif') no-repeat";M.sldM.style.background="url('"+jscolor.getDir()+"arrow.gif') no-repeat";M.pad.style.background="url('"+jscolor.getDir()+L+"') 0 0 no-repeat";u();D();jscolor.picker.owner=m;document.getElementsByTagName("body")[0].appendChild(M.boxB)}function u(){switch(b){case 0:var K=1;break;case 1:var K=2;break}var O=Math.round((m.hsv[0]/6)*(jscolor.images.pad[0]-1));var N=Math.round((1-m.hsv[K])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=(m.pickerFace+m.pickerInset+O-Math.floor(jscolor.images.cross[0]/2))+"px "+(m.pickerFace+m.pickerInset+N-Math.floor(jscolor.images.cross[1]/2))+"px";var H=jscolor.picker.sld.childNodes;switch(b){case 0:var M=h(m.hsv[0],m.hsv[1],1);for(var I=0;I<H.length;I++){H[I].style.backgroundColor="rgb("+(M[0]*(1-I/H.length)*100)+"%,"+(M[1]*(1-I/H.length)*100)+"%,"+(M[2]*(1-I/H.length)*100)+"%)"}break;case 1:var M,P,L=[m.hsv[2],0,0];var I=Math.floor(m.hsv[0]);var J=I%2?m.hsv[0]-I:1-(m.hsv[0]-I);switch(I){case 6:case 0:M=[0,1,2];break;case 1:M=[1,0,2];break;case 2:M=[2,0,1];break;case 3:M=[2,1,0];break;case 4:M=[1,2,0];break;case 5:M=[0,2,1];break}for(var I=0;I<H.length;I++){P=1-1/(H.length-1)*I;L[1]=L[0]*(1-P*J);L[2]=L[0]*(1-P);H[I].style.backgroundColor="rgb("+(L[M[0]]*100)+"%,"+(L[M[1]]*100)+"%,"+(L[M[2]]*100)+"%)"}break}}function D(){switch(b){case 0:var H=2;break;case 1:var H=1;break}var I=Math.round((1-m.hsv[H])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(m.pickerFace+m.pickerInset+I-Math.floor(jscolor.images.arrow[1]/2))+"px"}function w(){return jscolor.picker&&jscolor.picker.owner==m}function t(){if(a==E){m.importColor()}if(m.pickerOnfocus){m.hidePicker()}}function o(){if(a!=E){m.importColor()}}function y(I){var K=jscolor.getMousePos(I);var H=K[0]-s[0];var J=K[1]-s[1];switch(b){case 0:m.fromHSV(H*(6/(jscolor.images.pad[0]-1)),1-J/(jscolor.images.pad[1]-1),null,f);break;case 1:m.fromHSV(H*(6/(jscolor.images.pad[0]-1)),null,1-J/(jscolor.images.pad[1]-1),f);break}}function k(H){var J=jscolor.getMousePos(H);var I=J[1]-s[1];switch(b){case 0:m.fromHSV(null,null,1-I/(jscolor.images.sld[1]-1),x);break;case 1:m.fromHSV(null,1-I/(jscolor.images.sld[1]-1),null,x);break}}var m=this;var b=this.pickerMode.toLowerCase()=="hvs"?1:0;var q=false;var a=jscolor.fetchElement(this.valueElement),G=jscolor.fetchElement(this.styleElement);var c=false,r=false;var s,B;var z=1<<0,F=1<<1,x=1<<2,f=1<<3;jscolor.addEvent(E,"focus",function(){if(m.pickerOnfocus){m.showPicker()}});jscolor.addEvent(E,"blur",function(){if(!q){setTimeout(function(){q||t();q=false},0)}else{q=false}});if(a){var C=function(){m.fromString(a.getAttribute("hex"),z)};jscolor.addEvent(a,"keyup",C);jscolor.addEvent(a,"input",C);jscolor.addEvent(a,"blur",o);a.setAttribute("autocomplete","off")}if(G){G.jscStyle={backgroundColor:G.style.backgroundColor,color:G.style.color}}switch(b){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png");break}jscolor.requireImage("cross.gif");jscolor.requireImage("arrow.gif");this.importColor()}};jscolor.install();var spreadsTh;var spreadsSpan;var spreadsTable;var sortable=false;var spreadTableStyle=false;var simulatorHistoryTh;var simulatorHistorySpan;var simulatorHistoryTable;var simulatorHistorySortable=false;var simulatorHistoryTableStyle=false;var simulatorPage=false;var dynamicSort=false;SortableTable=function(b){var c=$J("#"+b.id+" tr").not(".skipSort");var a=this;this.table=b;this.rows=$A(c).map(function(d){return $(d)});this.headerRow=this.rows.shift();this.headers=Selector.findChildElements(this.headerRow,["th"]);this.headers.each(function(f){var d=$(document.createElement("span"));d.table=b.id;$A(f.childNodes).each(function(g){d.appendChild(g)});f.appendChild(d);d.onclick=function(){if($("spreadMainTable")!=undefined&&this.table=="spreadMainTable"){spreadsTable=a;sortable=true;spreadsTh=f;spreadsSpan=d;spreadTableStyle=true;sortPromotedTable(true,spreadsTable,spreadsTh,spreadsSpan);sortPromotedTable(false,spreadsTable,spreadsTh,spreadsSpan,true)}else{if($("forexBrokerSwapTable")!=undefined&&this.table=="forexBrokerSwapTable"){sortPromotedTable(true,a,f,d);sortPromotedTable(false,a,f,d,true)}else{if($("symbolMarketHeatMap")!=undefined&&this.table=="symbolMarketHeatMap"){dynamicSort=true;a.sortOnColumn(f,d)}else{if(hasText(f.getAttribute("sort"))){a.sortOnColumn(f,d)}}}}if($("simulatorHistoryTable")!=undefined&&this.table=="simulatorHistoryTable"){var g=false;if(!simulatorHistorySortable){g=true}simulatorHistorySortable=true;simulatorHistoryTh=f;simulatorHistorySpan=d;simulatorHistoryTableStyle=true;simulatorHistoryTable=a;if(g){initSimulatorHistoryTable()}}}})};SortableTable.find=function(){$$("table.sortable").each(function(a){new SortableTable(a)})};SortableTable.prototype.simpleCompare=function(d,c){return d<c?-1:d==c?0:1};SortableTable.prototype.compareComposer=function(b){var a=this;return function(d,c){if(d==""||d=="-"){d=0}else{if(c==""||c=="-"){c=0}}return a.simpleCompare(b(d),b(c))}};SortableTable.prototype.compareComposerDate=function(b){var a=this;return function(d,c){if(d==""||d=="-"){d=0}else{if(c==""||c=="-"){c=0}}return a.simpleCompare(b(d),b(c))}};SortableTable.prototype.compareFunction=function(a){switch(a){case"caseSensitive":return this.simpleCompare;case"integer":return this.compareComposer(function(b){return parseInt(b.replace(/^.*?(\d+).*$/,"$1"))});case"float":return this.compareComposer(function(b){return parseFloat(b)});case"date":return this.compareComposerDate(Date.parse);case"long":return this.compareComposer(function(b){return b});default:return this.compareComposer(function(b){return String(b).toLowerCase()})}};SortableTable.prototype.sortOnColumn=function(th,span,sortRule){if($("forexBrokerSwapTable")==undefined&&$("portfolioOverallTable")==undefined&&$("userTable")==undefined&&$("strategiesTable")==undefined&&$("spreadMainTable")==undefined&&$("symbolMarket")==undefined&&$("symbolMarketVolatility")==undefined&&$("symbolMarketHeatMap")==undefined&&$("symbolMarketCorrelation")==undefined&&$("mastersTable")==undefined&&$("dashboardSystemsTable")==undefined&&$("watchTable")==undefined&&$("masterFollowersTable")==undefined&&$("exposuresTable0")==undefined&&$("exposuresTable1")==undefined){deleteAllRows()}var pos=$A(this.headerRow.cells).indexOf(th);var ss=$A(span.childNodes);var sortFn=this.compareFunction(th.getAttribute("sort"));span.order=span.order||1;if(sortRule!=undefined){span.order*=-1}removeRowsZebraColor();this.rows.sort(function(rowA,rowB){if(rowA.getElementsByTagName("td")[pos]==undefined||rowA.getElementsByTagName("td")[pos].getAttribute("val")==null){return span.order*sortFn(dismissSymbol(rowA.getCellText(pos)),dismissSymbol(rowB.getCellText(pos)))}else{return span.order*sortFn(rowA.getElementsByTagName("td")[pos].getAttribute("val"),rowB.getElementsByTagName("td")[pos].getAttribute("val"))}});span.order*=-1;for(var i=0;i<=this.headers.length;i++){if($(this.table.id+"Img"+i)!=undefined){$(this.table.id+"Img"+i).className=""}}if(span.order<0){$(this.table.id+"Img"+pos).className="sortUp"}else{$(this.table.id+"Img"+pos).className="sortDown"}var alt=0;var tbody=this.table.tBodies[0];this.rows.each(function(row){if((alt+=1)%2){if(!row.hasClassName("alt")){row.addClassName("alt")}}else{row.removeClassName("alt")}tbody.appendChild(row)});tbody=moveEmptyRowsDown(this.rows,tbody,pos);var skipedRows=$J(".bottomRow");skipedRows.each(function(index){if(tbody==skipedRows[index].parentNode){tbody.appendChild(skipedRows[index])}});setRowsZebraColor();var endSortFunc=this.table.getAttribute("endSortFunc");if(hasText(endSortFunc)){eval(endSortFunc)}};Element.addMethods({getText:function(a){return a.text=a.text||a.textContent||a.innerText||""},getNewText:function(a){return a.text=a.textContent||a.innerText||""},getCellText:function(a,b){a.cellTexts=a.cellTexts||[];if(dynamicSort){a.cellTexts[b]=a.down("td",b).getNewText()}else{if(sortable){if(isNaN(a.down("td",b).getText())){a.cellTexts[b]="-1"}else{a.cellTexts[b]=a.down("td",b).getText()}}else{a.cellTexts[b]=a.cellTexts[b]||a.down("td",b).getText()}}return a.cellTexts[b]}});document.observe("dom:loaded",function(){$$("table.ListTable tr:nth-child(odd)").invoke("bg1","oddRow")});SortableTable.prototype.setup;if(!simulatorPage){Event.observe(window,"load",SortableTable.find,false)}function dismissSymbol(a){return a.replace(RegExp("[$|€|%|:]"),"").trim()}function setRowsZebraColor(){$J(".zebraStyle tr:not(.skipSort):not(.headersRow):odd").addClass("bg1").attr("zebraSort","bg1")}function removeRowsZebraColor(){$J(".zebraStyle tr").removeClass("bg1").attr("zebraSort","")}function moveEmptyRowsDown(d,a,g){var f=[];var c;d.each(function(h){if(h.getElementsByTagName("td")[g]==undefined||h.getElementsByTagName("td")[g].getAttribute("val")==null){c=h.getCellText(g)}else{c=h.getElementsByTagName("td")[g].getAttribute("val")}if(c=="-"){f.push(h)}});if(f.length>0){for(var b=0;b<f.length;b++){a.appendChild(f[b])}}return a}function sortPromotedTable(h,f,d,b,a){if(f){var g;var c=f.table.id;if(h){g=$J("#"+c+" tr.promote, tr.headerPromoted").not(".skipSort")}else{g=$J("#"+c+" tr").not(".promote").not(".skipSort")}f.rows=$A(g).map(function(k){return $(k)});f.headerRow=f.rows.shift();f.headers=Selector.findChildElements(f.headerRow,["th"]);f.sortOnColumn(d,b,a)}}Ajax.JSONRequest=Class.create(Ajax.Base,(function(){var b=0,a=document.getElementsByTagName("head")[0]||document.body;return{initialize:function($super,d,c){$super(c);this.options.url=d;this.options.callbackParamName=this.options.callbackParamName||"callback";this.options.timeout=this.options.timeout||10;this.options.invokeImmediately=(!Object.isUndefined(this.options.invokeImmediately))?this.options.invokeImmediately:true;if(!Object.isUndefined(this.options.parameters)&&Object.isString(this.options.parameters)){this.options.parameters=this.options.parameters.toQueryParams()}if(this.options.invokeImmediately){this.request()}},_cleanup:function(){if(this.timeout){clearTimeout(this.timeout);this.timeout=null}if(this.transport&&Object.isElement(this.transport)){this.transport.remove();this.transport=null}},request:function(){var d=new Ajax.JSONResponse(this);var h=this.options.callbackParamName,g="_prototypeJSONPCallback_"+(b++),c=function(){if(Object.isFunction(this.options.onComplete)){this.options.onComplete.call(this,d)}Ajax.Responders.dispatch("onComplete",this,d)}.bind(this);if(this.options.parameters[h]!==undefined){g=this.options.parameters[h]}else{this.options.parameters[h]=g}this.options.parameters[h]=g;var f=this.options.url+((this.options.url.include("?")?"&":"?")+Object.toQueryString(this.options.parameters));window[g]=function(k){this._cleanup();window[g]=undefined;d.status=200;d.statusText="OK";d.setResponseContent(k);if(Object.isFunction(this.options.onSuccess)){this.options.onSuccess.call(this,d)}Ajax.Responders.dispatch("onSuccess",this,d);c()}.bind(this);this.transport=new Element("script",{type:"text/javascript",src:f});if(Object.isFunction(this.options.onCreate)){this.options.onCreate.call(this,d)}Ajax.Responders.dispatch("onCreate",this);a.appendChild(this.transport);this.timeout=setTimeout(function(){this._cleanup();window[g]=Prototype.emptyFunction;if(Object.isFunction(this.options.onFailure)){d.status=504;d.statusText="Gateway Timeout";this.options.onFailure.call(this,d)}c()}.bind(this),this.options.timeout*1000)},toString:function(){return"[object Ajax.JSONRequest]"}}})());Ajax.JSONResponse=Class.create({initialize:function(a){this.request=a},request:undefined,status:0,statusText:"",responseJSON:undefined,responseText:undefined,setResponseContent:function(a){this.responseJSON=a;this.responseText=Object.toJSON(a)},getTransport:function(){if(this.request){return this.request.transport}},toString:function(){return"[object Ajax.JSONResponse]"}});var windowOpen=0;function getGeneralData(){var b=true;clearTimeout(toolbar);var a=isShown($("footerToolbar"));if(a){if(!isNaN(windowOpen)){if(isShown("calendarTop")){windowOpen=1}else{if(isShown("newsTop")){windowOpen=2}else{if(isShown("symbolTop")){windowOpen=3}else{windowOpen=4}}}}else{windowOpen=0}var d={};d.r=Math.random();var c=getServerTime();if(getlastCalendarEventTime()-c>=0){b=false}if(b){var f=[isShown($("symbolTop")),"&getCalendarEvents=",b,"&windowOpen=",windowOpen];fxAjax.sendRequest(fxVars.getGeneralData+f.join(""),{loader:false,callback:"getGeneralResponse"})}else{toolbar=setTimeout("getGeneralData()",60000)}}else{hideElement("footerToolbar")}}function getlastCalendarEventTime(){var a=$$("#calendarToolbar [name=calendarTime]")[0];return(a!=null)?a.getAttribute("time"):0}var toolbar;function getGeneralResponse(a){if(!a.error){var b=a.content;if(b){if(b.calendarTop){$("calendarTop").innerHTML=b.calendarTop}if(b.calendarToolbar){$("calendarToolbar").innerHTML=b.calendarToolbar}}}if(b.newsToolbar){$("newsToolbar").innerHTML=b.newsToolbar}if(b.newsTop){$("newsTop").innerHTML=b.newsTop}toolbar=setTimeout("getGeneralData()",60000)}function showToolbarNew(a){fxWebsocket.getTokenForToolbar(a)}function showToolBar(a,b){fxAjax.sendRequest(fxVars.showToolbar+a+"&token="+b,{params:{showToolbar:a},loader:false,callback:"showToolbarNewResponse"})}function showToolbarNewResponse(response,params){if(!response.error){clearTimeout(toolbar);if(eval(params.showToolbar)){showElement("footerToolbar")}else{hideElement("footerToolbar")}}getGeneralData()}function dateToText(b,a,m){var k=a-b;var l;if(k<=MINUTE&&k>0){var g=Math.floor(k/SECOND);if(m){l=$T("tTimeLeftSecondsAgo",[g])}else{l=$T("tTimeLeftSeconds",[g])}}else{if(k>=MINUTE&&k<=HOUR){var c=Math.floor(k/MINUTE);if(m){l=$T("tTimeLeftMinAgo",[c])}else{l=$T("tTimeLeftMin",[c])}}else{if(k>=HOUR&&k<=DAY){var d=Math.floor(k/HOUR);c=Math.floor((k%HOUR)/MINUTE);if(m){l=$T("tTimeLeftHMinAgo",[d,c])}else{l=$T("tTimeLeftHMin",[d,c])}}else{if(k>=DAY){var f=Math.floor(k/DAY);if(m){l=f<=1?$T("tTimeLeftDayAgo",[f]):$T("tTimeLeftDaysAgo",[f])}else{l=f<=1?$T("tTimeLeftDay",[f]):$T("tTimeLeftDays",[f])}}else{if(m){l=$T("tTimeLeftSecondsAgo",[0])}else{l=$T("tTimeLeftSeconds",[0])}}}}}return l}function limitString(b,a){if(b.length>a){return b.substring(0,a)+"..."}else{return b}}function toolbarUrl(a){this.url=a;this.runFunc=function(b){navigateToNewWindow(this.url);stop(b)}}function toolBarSymbolUpdateResponse(h){var m=h[1];var b={};if(hasText(m)){var q=m.split(";");if(q.length>0){for(var t=0;t<q.length;t++){var r=q[t].split("|");if(r.length==2){var d=false;var k=r[1];var c=(r[0]!=null)?symbolOidToNameMap[r[0]]:null;var o="symbol"+c;b[o]=k}}}var a=$$("#symbolTop span[name]","#symbolToolbar span[name]");for(var g=0;g<a.length;g++){var f=a[g];k=b[f.getAttribute("name")];if(k!=null){var l=$AT(f,"value");if(hasText(l)){if(l<k){f.className="greenBG"}else{if(l>k){f.className="redBG"}}}f.setAttribute("value",k);f.innerHTML=k}else{f.className="paddlr2"}}}}function updateToolbarTimes(){var calendarTimeElements=jQuery("[name=calendarTime][name=calendarTime]");for(var i=0;i<calendarTimeElements.length;i++){var calendarTime=calendarTimeElements[i];var timestamp=eval(calendarTime.getAttribute("time"));var newCalendarTime=dateToText(getServerTime(),timestamp,false);calendarTime.innerHTML="("+newCalendarTime+")"}var calendarElements=jQuery("[name=calendarCircle][name=calendarCircle]");for(var i=0;i<calendarElements.length;i++){var calendar=calendarElements[i];if(parseFloat(calendar.getAttribute("time"))-getServerTime()<=60000){Effect.Pulsate(calendar.id,{pulses:3,duration:1.5})}}var newsElements=jQuery("[name=newsTime][name=newsTime]");for(var i=0;i<newsElements.length;i++){var newsTime=newsElements[i];var timestamp=eval(newsTime.getAttribute("time"));newsTime.innerHTML="("+dateToText(timestamp,getServerTime(),true)+")"}}function submitEnterWallComment(h,k,c,f,d,b,g){var a;if(window.event){a=window.event.keyCode}else{if(h){a=h.which}else{return true}}if(a==13){if(h.preventDefault){h.preventDefault()}else{h.returnValue=false}if(h.shiftKey){$(k).value=$(k).value+"\n"}else{addWallPost(k,c,f,d,b,null,null,true,g);$(k).value=""}}}var showMoreBloack=true;function showMoreWallPost(k,b,g,l){var d=true;var h=true;if(showMoreBloack){showMoreBloack=false;var f=["userPageId=",k,"&wallPostType=",b,"&objectId=",g];if(b==1){var c=$AT($("showMoreWallPost"),"paging");if(Number(c)!=0){f.push("&paging="+c)}else{d=false}}else{if(b==2||b==3){var a=$AT($(getWallPostIdsByType(b).showMoreWallPost),"lastTime");h=false;if(Number(a)!=0){f.push("&lastTime="+a);showElement(getWallPostIdsByType(b).feedLoader)}else{d=false}if(hasText(l)){f.push("&invite=",l)}}}if(d){fxAjax.sendRequest(fxVars.showMoreWallPosts+f.join(""),{params:{objectId:g},loader:h,callback:"showMoreWallPostResponse"})}else{showMoreBloack=true;hideElement(getWallPostIdsByType(b).feedLoader)}}}function showMoreWallPostResponse(b,d){if(!b.error){var a=b.content.wallPostType;var c=new Element("span",{});c.innerHTML=b.content.posts;$(getWallPostIdsByType(a).userMessages).appendChild(c);if(a==1){if(b.content.paging!=null){$("showMoreWallPost").setAttribute("paging",b.content.paging)}else{hideElement("showMoreWallPost");$("showMoreWallPost").setAttribute("paging",0)}}else{if(a==2){if(b.content.lastTime!=null){$("showMoreWallPost").setAttribute("lastTime",b.content.lastTime)}else{hideElement("showMoreWallPost");$("showMoreWallPost").setAttribute("lastTime",0)}if(chartsArray[d.objectId]==null){chartsArray[d.objectId]={}}chartsArray[d.objectId].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",false);hideElement("feedLoader")}else{if(a==3){if(b.content.lastTime!=null){$("newsShowMoreWallPost").setAttribute("lastTime",b.content.lastTime)}else{hideElement("newsShowMoreWallPost");$("newsShowMoreWallPost").setAttribute("lastTime",0)}updateFeedScrooler("newsDiscussion",false);hideElement("newsFeedLoader")}}}}runAjaxScripts(b.content.posts);showMoreBloack=true}function removeWallPost(d,f,b,c,a){fxAjax.sendRequest(fxVars.removeWallPosts+f+"&isComment="+b+"&userPageId="+c,{params:{element:d,id:f,isComment:b,wallPostType:a},loader:true,callback:"removeWallPostResponse"})}function removeWallPostResponse(b,c){if(!b.error){$(c.element).remove();var a=getWallPostIdsByType(c.wallPostType).postText+c.id;if(!c.isComment&&$(a)!=undefined){$(a).remove()}}}function editWallPostSave(d,a){var c="commentText"+d;if(validate(c,VALID_TEXT)){var b=["&id=",d,"&text=",encodeParameter($F(c)),"&userPageId=",a];fxAjax.sendRequest(fxVars.editWallPosts,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),params:{id:d},loader:true,callback:"editWallPostResponse"})}}function editWallPostResponse(a,b){if(!a.error){$("postData"+b.id).innerHTML=a.content.text;showElement("postData"+b.id);hideElement("postTextData"+b.id);showElement("editComment"+b.id)}}function editWallPost(a){hideElement("postData"+a);showElement("postTextData"+a);hideElement("editComment"+a)}function addWallPost(k,b,g,c,a,h,f,d){addWallPost(k,b,g,c,a,h,f,d,true)}function addWallPost(text,toUid,commentId,wallPostType,objectId,internalType,internalObjectId,resize,returnResponse){var commentTo="";var allowAddWallPost=true;if(commentId){commentTo="&postOid="+commentId}if(wallPostType==2){var connStatus=$("connStatusOn");if(connStatus!=null){allowAddWallPost=eval(connStatus.getAttribute("connected"))}else{allowAddWallPost=false}}if(allowAddWallPost){if(validate(text,VALID_TEXT)&&$AT($(text),"allowPost")=="true"){var data=["&text=",encodeParameter($F(text)),"&toUser=",toUid,commentTo,"&wallPostType=",wallPostType,"&objectId=",objectId,"&returnResponse=",returnResponse];if(internalType!=null&&internalObjectId!=null){data.push("&internalType="+internalType);data.push("&internalObjectId="+internalObjectId)}fxAjax.sendRequest(fxVars.addWallPost,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:data.join(""),params:{comment:commentId,toUid:toUid,resize:resize,wallPostType:wallPostType,objectId:objectId},loader:false,callback:"addWallPostResponse"})}else{$(text).value="";$(text).setAttribute("allowPost","true");inlineMsg(text,$T("tOops")+"<br>"+$T("tNoTextEntered"),3)}}$(getWallPostIdsByType(wallPostType).userComment).value=""}function addWallPostResponse(response,params){if(!response.error&&response.content.wallPostResponse){$J("#"+getWallPostIdsByType(params.wallPostType).userComment).attr("rows",1);var post=new Element("div",{style:"display:none"});var oid=response.content.oid;var pending=response.content.pending;post.innerHTML=response.content.post;var wallPostType=response.content.wallPostType;var divCopy=new Element("div",{});if(response.content.subscribed){if(wallPostType==1){$("response"+params.toUid).className="";$("response"+params.toUid).innerHTML="";var subscribe=$$("td[name=subscribe"+params.toUid+"]");if(subscribe!=null){for(var i=0;i<subscribe.length;i++){subscribe[i].innerHTML="<a href='javascript:void(0);' onclick='feedUnsubscribe("+params.toUid+","+params.wallPostType+")' class='unsubscribe gray'>"+$T("tFeedUnsucscribe")+"</a>"}}}}if(params.comment){if($(getWallPostIdsByType(params.wallPostType).comment+oid)==null||pending){$(getWallPostIdsByType(params.wallPostType).post+params.comment).appendChild(post);$(getWallPostIdsByType(params.wallPostType).commentText+params.comment).value="";if(wallPostType==2){divCopy.innerHTML=response.content.post;var feedCopy=chartsArray[lastChartId].feedObject;var postCopy=feedCopy.find("#post"+params.comment);postCopy.append(divCopy)}else{if(wallPostType==3){if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($("subscribeToNews"),params.objectId,true)}}}}}else{if($(getWallPostIdsByType(params.wallPostType).post+oid)==null||pending){var firstElement=$(getWallPostIdsByType(params.wallPostType).userMessages);firstElement.insertBefore(post,firstElement.firstChild)}if(wallPostType==2){divCopy.innerHTML=response.content.post;var feedCopy=chartsArray[lastChartId].feedObject;var userMessages=feedCopy.find("#"+getWallPostIdsByType(params.wallPostType).userMessages);if(userMessages.children().size()>0){jQuery(divCopy).insertBefore(userMessages.children()[0])}else{userMessages.append(divCopy)}}else{if(wallPostType==3){if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($("subscribeToNews"),params.objectId,true)}}}}jQuery(post).slideDown(300);runAjaxScripts(response.content.post)}}function removeWallPostCheck(g,f,h,c,d,a){var b={hideOn:[{element:"self",event:"click"}],showOn:"false",hook:{target:"leftmiddle",tooltip:"rightmiddle"}};ConfirmationTip(g,b,$T("tConfirmWallPostDelete")+"<br/><br/><div class='center'><span class='exclamation'>"+$T("tCannotUndo")+"</span></div>","removeWallPost('"+f+"',"+h+","+c+","+d+","+a+")")}function updateWallPostText(a,c){var b=$(a);b.setAttribute("allowPost","false");b.value=c;b.onclick=function(){this.value="";this.onclick={};this.setAttribute("allowPost","true")};b.onchange=function(){this.setAttribute("allowPost","true");this.onclick={}}}function getPostComments(a,d,c,g,h,f,b){var k=$(g);if(k!=null){k.onclick=function(){}}fxAjax.sendRequest(fxVars.getPostComments+a+"&commentId="+d,{params:{postId:a,commentId:d,resize:c,showPostCommentsId:g,postElementId:h,commentElementId:f,scroolerId:b},loader:false,callback:"getPostCommentsResponse"})}function getPostCommentsResponse(b,h){if(!b.error){var g=b.content.comments;var a=b.content.wallPostType;var c=$(h.postElementId);var k=$(h.commentElementId);var f=$(h.showPostCommentsId);if(g!=null){var d=new Element("span",{});d.innerHTML=g;c.insertBefore(d,k);hideElement(h.showPostCommentsId)}if(h.resize){if(a!=null&&(a==2||a==3)){updateFeedScrooler(h.scroolerId,false)}}}if(f!=null){f.onclick=function(){getPostComments(h.postId,h.commentId,h.resize)}}}function getWallPostsBetweenOids(c,g,d,b,a){var f=["firstPostOid=",c,"&lastPostOid=",g,"&invite=",b];fxAjax.sendRequest(fxVars.getWallPostsBetweenOids+f.join(""),{params:{lastPostOid:g,element:d,objectId:a},loader:false,callback:"getWallPostsBetweenOidsResponse"})}function getWallPostsBetweenOidsResponse(c,g){if(!c.error){var f=c.content.posts;var b=c.content.wallPostType;var a=getWallPostIdsByType(b).post;var d=new Element("span",{});d.innerHTML=f;$(a+g.lastPostOid).parentNode.insertBefore(d,$(a+g.lastPostOid).nextSibling);updateFeedScrooler(getWallPostIdsByType(b).discussion,false);g.element.remove();if($(g.objectId)!=null){goToNotification(g.objectId,false,true,getWallPostIdsByType(b).discussion)}}}function feedSubscribe(a,b,c){var d=[a,"&type=",b];if(c){d.push("&objectOid="+c)}fxAjax.sendRequest(fxVars.feedSubscribe+d.join(""),{params:{toUid:a,subscribe:true,type:b,objectOid:c},callback:"feedResponse"})}function feedResponse(d,f){var b=d.content.wallPostType;if(b==1){$("response"+f.toUid).innerHTML=d.message;showElement("response"+f.toUid);$("response"+f.toUid).className="response";var a=$$("td[name=subscribe"+f.toUid+"]");for(var c=0;c<a.length;c++){if(f.subscribe){a[c].innerHTML="<a href='javascript:void(0);' onclick='feedUnsubscribe("+f.toUid+","+f.type+")' class='unsubscribe gray'>"+$T("tFeedUnsucscribe")+"</a>"}else{a[c].innerHTML="<a href='javascript:void(0);' onclick='feedSubscribe("+f.toUid+","+f.type+")' class='subscribe gray'>"+$T("tFeedSubscribe")+"</a>"}}}else{if(b==3){updateNewsSubscribeCheckboxElement($("subscribeToNews"),f.objectOid,f.subscribe)}}}function feedUnsubscribe(a,b,c){var d=[a,"&type=",b];if(c){d.push("&objectOid="+c)}fxAjax.sendRequest(fxVars.feedUnsubscribe+d.join(""),{params:{toUid:a,subscribe:false,type:b,objectOid:c},callback:"feedResponse"})}function feedSubscriptionDelete(b,a){fxAjax.sendRequest(fxVars.feedSubscriptionDelete+a,{callback:"feedSubscriptionDeleteResponse"})}function feedSubscriptionDeleteResponse(a,b){$("subscriptionsFeedCont").innerHTML=a.content.data}function submitEnterWallPost(g,l,d,c,a,k,o,m,b,h){var f;if(window.event){f=window.event.keyCode}else{if(g){f=g.which}else{return true}}if(f==13&&!g.shiftKey){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}addWallPost(l,d,c,a,k,o,m,b,h)}}function getWallPostIdsByType(a){if(a==1||a==2){return{post:"post",comment:"comment",commentText:"commentText",userComment:"userComment",userMessages:"userMessages",showMoreWallPost:"showMoreWallPost",feedLoader:"feedLoader",discussion:"chartDiscussion",postText:"postText"}}else{if(a==3){return{post:"newsPost",comment:"newsComment",commentText:"newsCommentText",userComment:"userCommentNews",userMessages:"newsUserMessages",showMoreWallPost:"newsShowMoreWallPost",feedLoader:"newsFeedLoader",discussion:"newsDiscussion",postText:"newsPostText"}}}}var showAsk=true;var brokerPipsChart=-1;var PARAM_SPREAD=0;var PARAM_ASK=1;var PARAM_SPREAD_WITH_COMMISSION=2;var PARAM_VOLUME=3;var PARAM_SYMBOL=1;var PARAM_SERVER=0;var symbolId=-1;var RED="E48585";var GREEN="83B242";var ROW_HEIGHT=20;var CSV_PARAM_KEY=0;var CSV_PARAM_V=1;var spreads;var quotes;function getSpreads(a,c,g){var d={};if(g!=undefined){showAsk=g}if(!c){showLoading()}d.symbols=getCheckBoxesValues("spreadsSymbols");d.mt4Servers=getCheckBoxesValues("spreadsServer");d.r=Math.random();var b=[spreadTomcatUrl+"/getSpreads.html"];new Ajax.JSONRequest(b,{timeout:50,callbackParamName:"cb",method:"get",parameters:d,onCreate:function(h){},onSuccess:function(h){f(h)},onFailure:function(h){f(h)},onComplete:function(h){hideLoading()}});function f(h){if(a=="brokerQuotes"){getBrokerQuotesResponse(h.responseJSON,a)}else{if(a=="brokerVolume"){getBrokerVolumeResponse(h.responseJSON,a,c)}else{getSpreadsResponse(h.responseJSON,a)}}}}function getSpreadsResponse(b,a){var d=0;if(a=="quotes"){d=PARAM_ASK}else{if(a=="volume"){d=PARAM_VOLUME}}clearTimeout(spreads);if(b){var c=b.split(";");c.forEach(function(o){if(o.length>0){var l=o.split(",");var g="spreadHref"+l[CSV_PARAM_KEY];if($(g)){var m=l[CSV_PARAM_V].split("|");var k;if(d==PARAM_ASK){var f=parseInt($("symbol"+l[CSV_PARAM_KEY].split("_")[PARAM_SYMBOL]).getAttribute("decimals"));if(showAsk){k=roundNumber(m[PARAM_ASK],f)}else{k=roundNumber(parseFloat(m[PARAM_ASK])-parseFloat(m[PARAM_SPREAD]/Math.pow(10,f-1)),f)}}else{if(d==PARAM_VOLUME){k=m[d];if(k<0){return}}else{isIncludeCommission(m)?k=m[PARAM_SPREAD]:k=m[PARAM_SPREAD_WITH_COMMISSION];var h=l[CSV_PARAM_KEY].split("_")[PARAM_SYMBOL]}}$(g).innerHTML=(k>=0)?k:"-";$(g).className=(a=="spreads")?"spreadTd tdUnderline":"spreadTd";$(g).parentNode.text=(k>=0)?k:"-"}}});sortSpreadTable();spreadTableColor(a);spreads=setTimeout(function(){getSpreads(a,true)},(a=="volume")?20000:1000)}}function isIncludeCommission(a){return $("includeCommission")!=undefined&&(!$("includeCommission").checked||!hasText(a[PARAM_SPREAD_WITH_COMMISSION]))}function setCookieIncludeCommission(){setCookie("includeCommission",$("includeCommission").checked?"1":"0",YEAR,false)}function ChartRow(a,d,f){var c=GREEN;var b=RED;if(!f){d=d*-1}return{label:a,value:d,color:d>0?c:b}}function brokersChart(c,a,b){return{chart:{yaxisname:b,xaxisname:"",canvasbgcolor:"FFFFFF",bgcolor:"FFFFFF",bgangle:"90",numdivlines:"0",canvasborderthickness:"0",animation:"0",yAxisMinValue:c,yAxisMaxValue:a,plotGradientColor:"",plotBorderThickness:"0",showBorder:"0",plotSpacePercent:"0%"},data:[]}}function getBrokerQuotesResponse(g,c){if(g&&$("noData")==undefined){clearTimeout(quotes);var a=8;var r;var q;var b;var d;var f=showAsk;var k=1;var m;var l;var h=[];var s=g.split(";");s.forEach(function(w){if(w.length>0){l=w.split(",");d=l[CSV_PARAM_V].split("|");m=l[CSV_PARAM_KEY];var v=m.split("_");if($(m)){var u=parseInt($("symbol"+m.split("_")[1]).getAttribute("decimals"));if(u==1||u==2||u==3){u=3}if(u==4||u==5){u=5}r=roundNumber(d[PARAM_ASK],u);q=roundNumber(parseFloat(d[PARAM_ASK])-parseFloat(d[PARAM_SPREAD]/Math.pow(10,u-1)),u);$(m+"Spread").innerHTML=d[PARAM_SPREAD];$(m+"Ask").innerHTML=r;$(m+"Bid").innerHTML=q;if(parseInt(v[PARAM_SYMBOL])==symbolId){if(showAsk){b=r}else{b=q}}}if(v[PARAM_SYMBOL]==symbolId){if(parseFloat(d[PARAM_ASK])!=-1){u=parseInt($("symbol"+symbolId).getAttribute("decimals"));if(u==1||u==2||u==3){u=3}if(u==4||u==5){u=5}if(showAsk){param=roundNumber(b-parseFloat(d[PARAM_ASK]),u)}else{param=roundNumber(b-(parseFloat(d[PARAM_ASK])-parseFloat(d[PARAM_SPREAD]/Math.pow(10,u-1))),u)}if($("server"+v[0])){var t=roundNumber(param*Math.pow(10,u-1),u);h.push(new ChartRow($("server"+v[PARAM_SERVER]).getAttribute("serverName"),t,f));k++;if(Math.abs(t)>a){a=parseInt(Math.abs(t))}}}}}});a=a+2;var o=brokersChart("-"+a,a.toString(),"Pips");o.data=h.sort(sort_by("label",true,function(t){return t.toUpperCase()}));$("chartPips").setStyle("height:"+(50+k*ROW_HEIGHT)+"px");brokerPipsChart.setJSONData(o)}quotes=setTimeout(function(){getSpreads(c,true)},1000)}function getBrokerVolumeResponse(d,b,k){if(d&&$("noData")==undefined){clearTimeout(quotes);var a=8;var q;var c;var h=1;var f=[];var g;var m;var l;var r=d.split(";");r.forEach(function(v){if(v.length>0){l=v.split(",");m=l[CSV_PARAM_KEY];var u=m.split("_");c=l[CSV_PARAM_V].split("|");if($(m)){var s=parseInt(c[PARAM_VOLUME]);if(s<0){s=0}$(m+"Volume").innerHTML=s;if(parseInt(u[PARAM_SYMBOL])==symbolId){g=s}}if(u[PARAM_SYMBOL]==symbolId){if($("server"+u[PARAM_SERVER])){var t=parseInt(c[PARAM_VOLUME]);if(t<0){t=0}f.push(new ChartRow($("server"+u[PARAM_SERVER]).getAttribute("serverName"),t-g,true));h++;if(t>a){a=t}}}}});a=a+2;var o=brokersChart("-"+a,a.toString(),"Volume");o.data=f.sort(sort_by("label",true,function(s){return s.toUpperCase()}));$("chartPips").setStyle("height:"+(50+h*ROW_HEIGHT)+"px");brokerPipsChart.setJSONData(o)}if(!k){hideLoading()}quotes=setTimeout(function(){getSpreads(b,true)},60000)}function updateSpreadMenu(c,g){var d=c;if(g!=undefined&&g){$("spreadServer"+c).checked=true}var b=getCheckBoxesValues("spreadsSymbols");if(b.split(",").length<=10){hideElement("spreadChangedMessage");var a=$("pageId").getAttribute("pageId");var f=["&spreadSymbols=",b,"&servers=",getCheckBoxesValues("spreadsServer"),"&pageId=",a,"&promoteServer=",g!=undefined?d:""];fxAjax.sendRequest(fxVars.updateSpreadMenu,{params:{pageId:a},contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),loader:false,callback:"updateSpreadMenuResponse"});clearSortSpreadsTableParams()}else{if(!isShown($("spreadChangedMessage"))){$("spreadChangedMessage").innerHTML=$T("tOnly10Symbols");showElement("spreadChangedMessage")}if($("spreadSymbol"+c)){$("spreadSymbol"+c).checked=false}}}function updateSpreadMenuResponse(c,g){if(!c.error){var f=c.content.spreadsTable;var b=c.content.spreadsSponsorTable;var a=c.content.brokerPromoteWidget;if(f){$("spreadTable").innerHTML=f;if(b){$("spreadSponsorTable").innerHTML=b}$J("#brokerPromoteWidget").html(a);runAjaxScripts(f);SortableTable.find();if(spreadsTable!=undefined){for(var d=0;d<spreadsTable.headers.length;d++){if($(spreadsTable.table.id+"Img"+d)!=undefined){$(spreadsTable.table.id+"Img"+d).className=""}}}getSpreads(g.pageId,false)}}}function spreadTableColor(d){var h={};var o={};var l={};var c={};var b=getCheckBoxesValues("spreadsSymbols").split(",");if(b){symbolsSize=b.length}var g=$$("#spreadMainTable a");for(var k=0;k<g.length;k++){var q=parseFloat(g[k].innerHTML);if(!isNaN(q)&&g[k].getAttribute("tdId")){spreadValue=q;selectedSymbol=g[k].getAttribute("tdId")%symbolsSize;if(o[selectedSymbol]==null){o[selectedSymbol]=spreadValue;l[selectedSymbol]=g[k].id;h[selectedSymbol]=spreadValue;c[selectedSymbol]=g[k].id}else{if(parseFloat(o[selectedSymbol])<=parseFloat(spreadValue)){o[selectedSymbol]=spreadValue;l[selectedSymbol]=g[k].id}else{if(parseFloat(o[selectedSymbol])>parseFloat(spreadValue)&&parseFloat(h[selectedSymbol])>parseFloat(spreadValue)){h[selectedSymbol]=spreadValue;c[selectedSymbol]=g[k].id}}}}}var f;var m;if(d=="volume"||(showAsk!=undefined&&!showAsk)){f=" lightRed ";m=" lightGreen "}else{f=" lightGreen ";m=" lightRed "}var a=(d=="spreads"||d=="volume")?" tdUnderline ":"";for(var k=0;k<g.length;k++){var q=parseFloat(g[k].innerHTML);if(!isNaN(q)&&g[k].getAttribute("tdId")){spreadValue=q;selectedSymbol=g[k].getAttribute("tdId")%symbolsSize;if(o[selectedSymbol]!=null&&o[selectedSymbol]==spreadValue&&o[selectedSymbol]!=h[selectedSymbol]){g[k].parentNode.className="spreadTd"+m+a}else{if(h[selectedSymbol]!=null&&h[selectedSymbol]==spreadValue&&o[selectedSymbol]!=h[selectedSymbol]){g[k].parentNode.className="spreadTd"+f+a}else{if(h[selectedSymbol]!=null&&h[selectedSymbol]==spreadValue&&o[selectedSymbol]==spreadValue&&o[selectedSymbol]==h[selectedSymbol]){g[k].parentNode.className="spreadTd "+a}else{g[k].parentNode.className="spreadTd "+a}}}}}h=null;o=null;l=null;c=null}function getCurrentSpreadFromChart(c,b,f){var g={};g.r=Math.random();var d=c+"_"+b;var a=[spreadTomcatUrl+"/getCurrentSpreadFromChart.json?key=",d].join("");new Ajax.JSONRequest(a,{timeout:5,callbackParamName:"cb",method:"get",parameters:g,onCreate:function(h){},onSuccess:function(h){getCurrentSpreadFromChartResponse(h.responseJSON,c,b,f)},onFailure:function(h){getCurrentSpreadFromChartResponse(h.responseJSON,c,b,f)},onComplete:function(h){}})}function getCurrentVolumeFromChartResponse(a,c,b,d){if(a){var f=a.split(",");if(f[PARAM_VOLUME]>0){$("currentVolume").innerHTML=f[PARAM_VOLUME]}}if(d){setTimeout("getCurrentVolumeFromChart("+c+","+b+","+d+")",1000)}}function getCurrentVolumeFromChart(c,b,f){var g={};g.r=Math.random();var d=c+"_"+b;var a=[spreadTomcatUrl+"/getCurrentSpreadFromChart.json?key=",d].join("");new Ajax.JSONRequest(a,{timeout:5,callbackParamName:"cb",method:"get",parameters:g,onCreate:function(h){},onSuccess:function(h){getCurrentVolumeFromChartResponse(h.responseJSON,c,b,f)},onFailure:function(h){getCurrentVolumeFromChartResponse(h.responseJSON,c,b,f)},onComplete:function(h){}})}function getCurrentSpreadFromChartResponse(a,c,b,d){if(a){var f=a.split(",");$("currentSpread").innerHTML=isIncludeCommission(f)?f[PARAM_SPREAD]:f[PARAM_SPREAD_WITH_COMMISSION]}if(d){setTimeout("getCurrentSpreadFromChart("+c+","+b+","+d+")",1000)}}function selectAllBrokers(element,serverId){var selected=eval(element.getAttribute("selected"));var elements=$$("#serversTable input[name=spreadsServer]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);updateSpreadMenu(serverId)}function sortSpreadTable(){if(sortable){var a=true;$J("#spreadMainTable tr").removeClass("bg1");sortPromotedTable(true,spreadsTable,spreadsTh,spreadsSpan,a);sortPromotedTable(false,spreadsTable,spreadsTh,spreadsSpan,a);$J("#spreadMainTable tr:odd").addClass("bg1")}}function clearSortSpreadsTableParams(){spreadsTh=null;spreadsSpan=null;spreadsTable=null;sortable=false;spreadTableStyle=false}function getSpreadsLastUpdateDate(b){var c={};c.r=Math.random();c.timeLimitColor=b;var a=[spreadTomcatUrl+"/getSpreadsLastUpdateDate.json?limitInSec=",b].join("");new Ajax.JSONRequest(a,{timeout:5,method:"get",callbackParamName:"cb",parameters:c,onCreate:function(d){},onSuccess:function(d){getSpreadsLastUpdateDateResponse(d.responseJSON,b)},onFailure:function(d){getSpreadsLastUpdateDateResponse(d.responseJSON,b)},onComplete:function(d){}})}function getSpreadsLastUpdateDateResponse(b,d){if(b){for(var c in b){var a="broker_"+c;if($(a)){$(a).innerHTML=b[c]}}}setTimeout(function(){getSpreadsLastUpdateDate(d)},30000)}function roundNumber(a,b){return(parseFloat(a)).toFixed(b).toString()}var activeSymbol;function updateSymbol(c,d,a){var b;if(d!=activeSymbol){if(isNaN(c)){b=$(c).getAttribute("symbolId")}else{b=c}if(parseInt(b)!=symbolId){$(d).setStyle({background:"#f8f8f8"});if(hasText(activeSymbol)){$(activeSymbol).setStyle({background:""})}$("symbolLabel").innerHTML=$(d).getAttribute("symbolName")}activeSymbol=d;symbolId=b;getSpreads(a,false)}}var sort_by=function(c,a,d){var b=function(f){return d?d(f[c]):f[c]};return function(h,g){var f=b(h),k=b(g);return((f<k)?-1:(f>k)?+1:0)*[-1,1][+!!a]}};var loading="Loading...";var no_more_data="No more data.";var lastEventId;var haveTradeData=true;var selectedTimeScale=60;var tradesHistory={};var openTradesHistory={};var GOLD_OID=132;var SILVER_OID=138;var XAUUSD_OID=51;var XAGUSD_OID=50;var GOLDUS_OID=2550;function getTradeBrowserInfo(b,a){if(haveTradeData){loadTradeChart(true,loading);var d=tradeChart.getFirstDate().getTime();var f=tradeChart.getLastDate().getTime();if(!lastSymbol){lastSymbol=$F("tradeSymbols")}var c=["accountOid=",b,"&symbolOid=",lastSymbol,"&timeScale=",selectedTimeScale,"&lastPoint=",d,"&closeTime=",f,"&l=",a,"&invitation=",invitation];fxAjax.sendRequest(fxVars.getTradeBrowserInfo+c.join("")+buildTradeBrowserUrl(),{loader:false,callback:"getTradeBrowserInfoResponse"})}else{loadTradeChart(true,no_more_data);setTimeout("loadTradeChart("+false+")",3000)}}var firstDate;function getTradeBrowserInfoResponse(a){if(!a.error){var c=a.content.data;if(c!=null){firstDate=tradeChart.getFirstDate().getTime();tradeChart.appendData("trade",a.content.data);tradeChart.commitDataChanges();(a.content.tradeHistory)?$("tradeHistoryPaging").innerHTML=a.content.tradeHistory:$("tradeHistoryPaging").innerHTML="";(a.content.openTradesHistory)?$("openTradesPaging").innerHTML=a.content.openTradesHistory:$("openTradesPaging").innerHTML="";var d=a.content.history;var f=a.content.openTrades;addAnnotationAndEvents(d,"tradeHistory",tradesHistory,$("closedTradesCheckBox").checked,($("showEvents").checked&&$("closedTradesCheckBox").checked));addAnnotationAndEvents(f,"openTradeHistory",openTradesHistory,$("openTradeCheckBox").checked,($("openTradeCheckBox").checked&&$("showEvents").checked));tradeChart.applyEventMarkersChanges();var b=new Date(tradeChart.getFirstDate().getTime()+selectedTimeScale*60*1000*5);tradeChart.scrollTo(b)}else{haveTradeData=false;loadTradeChart(true,no_more_data);setTimeout("loadTradeChart("+false+")",3000)}}loadTradeChart(false)}function addAnnotationAndEvents(l,s,d,g,a){for(var h in l){var o="";var m;var k;var c;if(!d[h]){d[h]=l[h];var b=l[h];var r=new Date(b.openTime);var t=b.openValue;if(b.closeTime){m=new Date(b.closeTime);k=b.closeValue}else{m=tradeChart.getLastDate();k=t}o=b.action;var f;var q;if(o==0){f="#0000FF";q="Up";c="B"}else{if(o==1){f="#FF0000";q="Down";c="S"}}addArrow(h+"r",r,t,o,"Right",g,f);addArrow(h+"l",m,k,o,"Left",g,f);tradeChart.addAnnotation({id:h+"li",type:"Line",allowEdit:false,chart:"idMainChart",lineAnnotation:{color:f,firstTimeAnchor:r,firstValueAnchor:t,secondTimeAnchor:m,secondValueAnchor:k,settings:{line:{dashed:true,thickness:1,enabled:g}}}});addEventMarker(h,o,r,s,a,f,c)}}}function addArrow(h,g,d,c,f,a,b){tradeChart.addAnnotation({id:h,type:"Arrow",allowEdit:false,chart:"idMainChart",arrowAnnotation:{timeAnchor:g,valueAnchor:d,direction:f,color:b,width:7,length:7,tailLengthRatio:0,tailWidthRatio:0,settings:{fill:{enabled:a}}}})}function addEventMarker(g,f,k,h,c,d,b){if(c==null){c=$("showEvents").checked}var a=tradeChart.getEventMarkersGroupById(h);a.events.push({date:k,format:b,id:g,visible:c,settings:{font:{color:d,size:10}}})}var lastTrade;var getTradeInfo=true;var firstTradeLogin=true;function getTradeConfig(b,d,g,o,k,m,h,q,r){if(hasText(m)){if(m.startsWith("h")){$("closedTradesCheckBox").checked=true}else{$("openTradeCheckBox").checked=true}$("showEvents").checked=true}if(getTradeInfo){getTradeInfo=false;haveTradeData=true;updateTimeScale(h);hideElement("tooltip");var c="";lastSymbol=d;var f=$("tradeSymbol"+getFilteredSymbolId(d));if(f){f.selected="true"}if(g){c="&timeScale="+selectedTimeScale;tradesHistory={};openTradesHistory={}}else{switchTab("tabs19","tradeBrowser",$("tradeBrowserElement"))}if(r==null&&!firstTradeLogin){loadTradeChart(true,loading)}var l="&symbolOid=";if(d){l+=d}var a=["accountOid=",b,l+"&selectTab=",g,"&openTime=",o,"&closeTime=",k,"&eventMarkId=",m+c,"&showOpen=",$("openTradeCheckBox").checked,"&showEvents=",$("showEvents").checked,"&l="+q,"&invitation=",invitation,"&showClose=",$("closedTradesCheckBox").checked];fxAjax.sendRequest(fxVars.getTradeConfigInfo+a.join("")+buildTradeBrowserUrl(),{params:{selectTab:g,eventMarkId:m},loader:false,callback:"getTradeConfigResponse"})}}function getTradeConfigResponse(response,params){getTradeInfo=true;if(!response.error){var config=response.content.config;if(config){tradeChart.setConfig(config);tradesHistory={};openTradesHistory={};tradeChart.objectModel=eval("("+config+")");var history=response.content.history;var openTrades=response.content.openTrades;for(var i in history){tradesHistory[i]=history[i]}for(var trade in openTrades){openTradesHistory[trade]=openTrades[trade]}var eventId=response.content.eventId;if(eventId){lastEventId=eventId}if(!params.selectTab){showTooltip(params.eventMarkId);elementIsSelected=true}else{elementIsSelected=false;hideElement("tradeBrowserWindow")}if(response.content.tradeHistory){$("tradeHistoryPaging").innerHTML=response.content.tradeHistory}if(response.content.openTradesHistory){$("openTradesPaging").innerHTML=response.content.openTradesHistory}var timeScale=response.content.timeScale;if(timeScale){updateTimeScale(timeScale)}}}loadTradeChart(false);firstTradeLogin=false}function loadTradeChart(a,b){if(a){if(tradeChart.showWaitingState(b)){tradeChart.disableInteractivity()}}else{if(tradeChart.hideWaitingState()){tradeChart.enableInteractivity()}}}function showOpenTrades(d){loadTradeChart(true,loading);var a=$("showEvents").checked;var b=(d)?b=20:b=0;for(var f in openTradesHistory){tradeChart.updateAnnotation(f+"r",{arrowAnnotation:{settings:{fill:{enabled:d}}}});tradeChart.updateAnnotation(f+"li",{lineAnnotation:{settings:{line:{enabled:d}}}});var c=tradeChart.getEventMarkerById("openTradeHistory",f);c.visible=(d&&a)}tradeChart.applyEventMarkersChanges();loadTradeChart(false,loading)}function showClosedTrades(b){loadTradeChart(true,loading);var a=$("showEvents").checked;var c=(b)?c=20:c=0;for(var f in tradesHistory){tradeChart.updateAnnotation(f+"r",{arrowAnnotation:{settings:{fill:{enabled:b}}}});tradeChart.updateAnnotation(f+"l",{arrowAnnotation:{settings:{fill:{enabled:b}}}});tradeChart.updateAnnotation(f+"li",{lineAnnotation:{settings:{line:{enabled:b}}}});var d=tradeChart.getEventMarkerById("tradeHistory",f);d.visible=(b&&a)}tradeChart.applyEventMarkersChanges();loadTradeChart(false,loading)}function showEvents(a){loadTradeChart(true,loading);if($("openTradeCheckBox").checked){for(var c in openTradesHistory){var b=tradeChart.getEventMarkerById("openTradeHistory",c);b.visible=a}}if($("closedTradesCheckBox").checked){for(var d in tradesHistory){var b=tradeChart.getEventMarkerById("tradeHistory",d);b.visible=a}}tradeChart.applyEventMarkersChanges();loadTradeChart(false,loading)}function saveTradesAsPNG(c){tradeChart.objectModel.settings.labels.push({yPadding:420,xPadding:10,format:"Chart by Myfxbook.com",font:{color:"#3b3b3b",family:"tahoma",size:11}});var b=tradeChart.getLastDate();var g=tradeChart.getFirstDate();var f=$F("tradeSymbols");var a=c+"."+$("tradeSymbol"+f).innerHTML+"."+g.toUTCString()+"-"+b.toUTCString();var d={fileName:a};tradeChart.applySettingsChanges(d);tradeChart.exportAsPNG(d);tradeChart.objectModel.settings.labels=[];tradeChart.applySettingsChanges()}var openTradePageNum=1;var historyPageNum=1;var startDate;var endDate;function getTradePaging(f,b,h,d,l){var a;if(d.className.indexOf("gray")==-1){loadTradeChart(true,loading);if(b=="openTradeHistory"){a="&openTradePageNum="+h;openTradePageNum=h}if(b=="tradeHistory"){a="&historyPageNum="+h;historyPageNum=h}hideElement("tooltip");var k=tradeChart.getFirstDate().getTime();var g=tradeChart.getLastDate().getTime();var c=["accountOid=",f,"&symbolOid=",$F("tradeSymbols"),"&openTime=",k,"&closeTime=",g,a,"&l=",l,"&invitation=",invitation,"&showEvents=",$("showEvents").checked,"&showOpenTrades=",$("openTradeCheckBox").checked,"&showClose=",$("closedTradesCheckBox").checked];fxAjax.sendRequest(fxVars.getTradePaging+c.join("")+buildTradeBrowserUrl(),{params:{pageType:b,pageNum:h},loader:false,callback:"getTradePagingResponse"})}}function getTradePagingResponse(response,params){if(!response.error){var type=params.pageType;var pageNum=params.pageNum;if(type=="tradeHistory"){removeTradeData(params.pageType,tradesHistory);tradesHistory={};(response.content.tradeHistory)?$("tradeHistoryPaging").innerHTML=response.content.tradeHistory:$("tradeHistoryPaging").innerHTML="";var history=response.content.history;for(var i in history){if(!tradesHistory[i]){tradesHistory[i]=history[i]}}}if(type=="openTradeHistory"){removeTradeData(params.pageType,openTradesHistory);openTradesHistory={};(response.content.openTradesHistory)?$("openTradesPaging").innerHTML=response.content.openTradesHistory:$("openTradesPaging").innerHTML="";var openTrades=response.content.openTrades;for(var i in openTrades){if(!openTradesHistory[i]){openTradesHistory[i]=openTrades[i]}}}var group=tradeChart.getEventMarkersGroupById(type);var oldAnnontation=eval(traceObject(tradeChart.getAnnotationListAsJSON(),tradeChart));var newAnnontation=eval(response.content.trades);var newEvents=eval("("+response.content.tradesEvents+")");for(var i=0;i<oldAnnontation.length;i++){newAnnontation.push(oldAnnontation[i])}for(var j=0;j<newEvents.length;j++){group.events.push(newEvents[j])}tradeChart.objectModel.annotations.annotationList=newAnnontation;tradeChart.setAnnotationList(newAnnontation);tradeChart.applyEventMarkersChanges();elementIsSelected=false;hideElement("tradeBrowserWindow")}loadTradeChart(false,loading)}function removeTradeData(b,c){for(var d in c){tradeChart.removeAnnotation(d+"l");tradeChart.removeAnnotation(d+"r");tradeChart.removeAnnotation(d+"li")}var a=tradeChart.getEventMarkersGroupById(b);a.events=[]}function traceObject(b,a){return a.flashObject.traceObject(b)}function updateTimeScale(a){$("tradeTimeScale"+selectedTimeScale).className="tagBG";if(a!=null){selectedTimeScale=a}$("tradeTimeScale"+selectedTimeScale).className="tagBG bold"}function getFilteredSymbolId(a){switch(a){case GOLD_OID:case GOLDUS_OID:a=XAUUSD_OID;break;case SILVER_OID:a=XAGUSD_OID;break}return a}function buildTradeBrowserUrl(){var c=new Array();var a="";var b="";if(hasText($F("durationStart"))){a=parseInt($F("durationStart"))*parseInt($F("selectedDuration"))}if(hasText($F("durationEnd"))){b=parseInt($F("durationEnd"))*parseInt($F("selectedDuration"))}c.push("&magicNumbers=");c.push(getCheckBoxesValues("accountMagic"));c.push("&tags=");c.push(getCheckBoxesValues("accountTag"));c.push("&days=");c.push(getCheckBoxesValues("days"));c.push("&hours=");c.push(getCheckBoxesValues("hours"));c.push(getCommentBoxesValues());c.push("&buySell=");c.push(getCheckBoxesValues("buySell"));c.push("&yieldStart=");c.push($F("yieldStart"));c.push("&yieldEnd=");c.push($F("yieldEnd"));c.push("&netProfitStart=");c.push($F("netProfitStart"));c.push("&netProfitEnd=");c.push($F("netProfitEnd"));c.push("&durationStart=");c.push(a);c.push("&durationEnd=");c.push(b);c.push("&takeProfitStart=");c.push($F("takeProfitStart"));c.push("&takeProfitEnd=");c.push($F("takeProfitEnd"));c.push("&stopLoss=");c.push($F("stopLoss"));c.push("&stopLossEnd=");c.push($F("stopLossEnd"));c.push("&sizingStart=");c.push($F("sizingStart"));c.push("&sizingEnd=");c.push($F("sizingEnd"));c.push("&selectedTime=");c.push(getCheckBoxesValues("selectedTime"));c.push("&pipsStart=");c.push($F("pipsStart"));c.push("&pipsEnd=");c.push($F("pipsEnd"));c.push(getCommentsOptions("commentOption"));return c.join("")}var Jlinker={createLinker:function(d,a){var c="(?!(?:(?!</?[aA].*?>).)*?</[aA].*?>)(?![^<>]*>)";var b=a==null?$J(".linker"):$J("#"+a);b.each(function(){Jlinker.initLinkerProcess(d,this,c)})},initLinkerProcess:function(c,a,b){c.each(function(h){var d=new RegExp("\\b"+h.word+"\\b","i");var g=a.innerHTML.match(d);if(g!=null){var f=$J.unique(g);f.each(function(k){if(h.link!="warning"){a.innerHTML=a.innerHTML.replace(new RegExp("\\b"+k+"\\b"+b),"<a href="+h.link+' title="'+h.link+'" class="underline" target="_blank">'+k+"</a>")}else{a.innerHTML=a.innerHTML.replace(new RegExp('href="'+k+'"'),'href="'+serverPath+"/warningPage.html?link="+encodeParameter(k)+'"')}})}})},destroyLinker:function(){$J(".linker a").each(function(){this.outerHTML=this.textContent})}};function roundNumber(a,b){return Number(a).toFixed(b)}function roundNumberBySymbolDecimals(a,b){return roundNumber(a,((b==2||b==4)?b=b+1:b))}function calculatePips(d,b,a){var c=d-b;return roundNumber(c*Math.pow(10,(a==5||a==4)?(4):(a==2||a==3)?(2):(a)),1)}function calculatePercents(b,a,c){return roundNumber((b-a)/a*100,c)}function changePipsAndPercentColor(a,b){if(b>=0){a.className="green"}else{a.className="red"}}function changeValueColor(a,c,b){if(c<b){a.className="lightGreen radius3 padd5"}if(c>b){a.className="lightRed radius3 padd5"}}function changeElementValueColor(a,b){var c=$AT(a,"value");if(c<b){a.className="lightGreen radius3 paddlr5"}if(c>b){a.className="lightRed radius3 paddlr5"}}var symbolElementsMap={};var elementsSparksMap={};var sparkRangeSize=15;function quotesChannelResponse(k){var m=k[5];var s=k[8];var r=k[7];var f=k[6];var c=(hasText(k[1]))?symbolOidToNameMap[k[1]]:null;var a=symbolElementsMap[c];var b=parseInt($AT(a[0],"decimals"));var q=calculatePips(s,m,b);var d=calculatePercents(s,m,2);for(var h=0;h<a.length;h++){var g=a[h];var l=$AT(g,"value");if(hasText(l)){updateSymbolRange(c,m,f,r,s);var t=g.attributes.name.value;if(t=="high"+c){g.setAttribute("value",f);g.innerHTML=roundNumberBySymbolDecimals(f,b)}else{if(t=="low"+c){g.setAttribute("value",r);g.innerHTML=roundNumberBySymbolDecimals(r,b)}else{if(t=="changePips"+c){g.setAttribute("value",q);g.parentNode.text=q;g.innerHTML=(q>=0?"+":"")+q;changePipsAndPercentColor(g,q)}else{if(t=="changePercent"+c){g.setAttribute("value",d);g.parentNode.text=d;g.innerHTML=(d>=0?"+":"")+d+"%";changePipsAndPercentColor(g,d)}else{if(t=="open"+c){g.setAttribute("value",m);g.innerHTML=roundNumberBySymbolDecimals(m,b)}else{if(t=="close"+c){changeValueColor(g,l,s);g.setAttribute("value",s);g.innerHTML=roundNumberBySymbolDecimals(s,b);var o=elementsSparksMap["spark"+c][elementsSparksMap["spark"+c].length-1];if(o!=s){elementsSparksMap["spark"+c].push(s);if(elementsSparksMap["spark"+c].length>sparkRangeSize){elementsSparksMap["spark"+c].splice(0,1)}setSparkLine("#spark"+c,elementsSparksMap["spark"+c])}}}}}}}}}}function getSymbolAnalysisConfig(a){fxAjax.sendRequest(fxVars.getSymbolAnalysisConfig+a,{params:{},callback:"getSymbolAnalysisConfigResponse"})}function getSymbolAnalysisConfigResponse(a,c){if(!a.error){var b=a.content.config;$J("#chartTooltipEvents").html(a.content.toolTips);marketObject.setConfig(b)}}function getSymbolAnalysisByTime(d,c,b){var f=$J(".tagBG.bold.radius2")[0];if(b!=f){var g=marketObject.getFirstDate();var a=marketObject.getLastDate();f.className="tagBG radius2";fxAjax.sendRequest(fxVars.getSymbolAnalysis+d+"&symbols="+c,{params:{time:d,symbol:c,start:g,end:a},callback:"getSymbolAnalysisByTimeResponse"})}}var symbolAnalysisCandleLimit=100;function getSymbolAnalysisByTimeResponse(b,c){if(!b.error){marketObject.removeDataRange("dataSetFirstQuoteSymbol",c.start,c.end);if(c.symbol){marketObject.appendData("dataSetFirstQuoteSymbol",b.content.quotesData[c.symbol])}marketObject.commitDataChanges();var a=new Date(marketObject.getLastDate().getTime()-c.time*60*1000*symbolAnalysisCandleLimit);marketObject.zoomTo(a,marketObject.getLastDate());$("symbolAnalysisTimeScale"+c.time).className="tagBG bold radius2"}}var TIME_SCALE_D1=1440;var lastClose=0;function symbolAnalysisChannelResponse(z){var m=z[5];var q=z[8];var A=z[7];var g=z[6];var c=Number(z[4]);var v=z[2];var b=0;var u=(hasText(z[1]))?symbolOidToNameMap[z[1]]:null;var o=(hasText(z[9]))?Number(z[9])+(userTime):null;var k=marketObject.getChartById("main");var t=$J(".tagBG.bold")[0];var l=$("symbolAnalysisPips");var B=parseInt(l.attributes.decimals.value);var a=$("symbolAnalysisRange"+v);updateSymbolRange(u,m,g,A,q,v);if(v==TIME_SCALE_D1){var x=$("symbolAnalysisBid");changeElementValueColor(x,q);x.setAttribute("value",q);var r=$("symbolAnalysisPercent");var y=calculatePercents(q,m,2);var h=calculatePips(q,m,B);x.innerHTML=roundNumberBySymbolDecimals(q,B);r.innerHTML=(y>=0?"+":"")+y+"%";changePipsAndPercentColor(r,y);l.innerHTML=(h>=0?"+":"")+h+" pips";changePipsAndPercentColor(l,h)}if(k!=null&&v==t.attributes.timeScale.value){var s=k.seriesList;for(var w=0;w<s.length;w++){var f=c+(userTime)-b*1000*60;if(s[w].name.indexOf(u)>=0){if(o!=null){marketObject.appendData(chartsDataSets[w],o+",,,,;")}if(lastClose!=q){var d=[];d.push(f);d.push(m);d.push(g);d.push(A);d.push(q);marketObject.appendData("dataSetFirstQuoteSymbol",d.join(","));marketObject.commitDataChanges()}lastClose=q}}}}function volatilityChannelResponse(m){var q=m[5];var u=m[8];var t=m[7];var k=m[6];var d=Number(m[4]);var s=m[2];var g=(hasText(m[1]))?symbolOidToNameMap[m[1]]:null;var h=$("symbol"+g);var l=$(g+"TimeScale"+s);var o=$AT(l,"value");var c=parseInt($AT(h,"decimals"));var f=calculatePips(k,t,c);var a=$F("lowVolatility");var r=$F("highVolatility");if($("pipsVolatility").checked){if(o!=f){l.setAttribute("value",f);l.innerHTML=f;compareTableValues(parseFloat(a),parseFloat(r),l,f)}}else{var b=calculatePercents(k,t,2);if(o!=b){l.setAttribute("value",b);l.innerHTML=b+"%";compareTableValues(parseFloat(a),parseFloat(r),l,b)}}l.setAttribute("high",k);l.setAttribute("low",t)}function updateSymbolRange(b,g,c,l,o,h){var q=150;var a=(o-g)/(c-l)*q;var f;var m=o-g;if(m>=0){f="#6fd265"}else{f="#fa8482"}var k=(g-l)/(c-l)*q;var d=k+a;if(a<0){a=a*-1;k=k-a}elem1=$("trend"+b+((h!=null)?h+"":""));elem1.style.width=a+"px";elem1.style.left=k+"px";elem1.style.background=f;elem1=$("pos"+b+((h!=null)?h+"":""));elem1.style.left=d+"px"}function updateMarketMenu(){var a=$("pageId").getAttribute("pageId");var b=getCheckBoxesValues("marketSymbols");var c=["&symbols=",b,"&pageId=",a];fxAjax.sendRequest(fxVars.updateMarketSymbolMenu,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:c.join(""),loader:false,params:{pageId:a},callback:"updateMarketMenuResponse"})}function updateMarketMenuResponse(b,f){if(!b.error){var d;var a;if(f.pageId=="forexMarket"){a=b.content.marketCurrenciesTable;if(hasText(a)){$("marketCurrenciesTable").innerHTML=a;d=$("symbolMarket")}symbolElementsMap={};setSymbolElementsMap(b.content.symbols);setSparkLine(".marketSparkline",[1,1])}else{if(f.pageId=="forexMarketVolatility"){a=b.content.marketVolatilityTable;if(hasText(a)){$("marketVolatilityTable").innerHTML=a;runAjaxScripts(a);d=$("symbolMarketVolatility")}quotesVolatilitySymbols=[];setVolatilitySymbols(b.content.symbols);if($("percentVolatility").checked){changeVolatilityPipsOrPercent("percentVolatility")}findVolatility()}else{if(f.pageId=="forexMarketHeatMap"){a=b.content.marketHeatMapTable;if(hasText(a)){$("marketHeatMapTable").innerHTML=a;runAjaxScripts(a);d=$("symbolMarketHeatMap");updateHeatMapColor(null)}quotesHeatMapSymbols=[];setHeatMapSymbols(b.content.symbols);if($("percentHeatMap").checked){changeHeatMapPipsOrPercent("percentHeatMap")}}}}for(var c=0;c<getHeaders(d).length;c++){if($(d.id+"Img"+c)!=undefined){$(d.id+"Img"+c).className=""}}SortableTable.find();notificationTip()}}function selectAllMarketSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$("#symbolsTable input[name=marketSymbols]");for(var i=0;i<elements.length;i++){elements[i].checked=!selected}if(!selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);updateMarketMenu()}function getTableRows(a){return $A(a.rows).map(function(b){return $(b)})}function getHeaders(b){var a=getTableRows(b).shift();return Selector.findChildElements(a,["th"])}function setSymbolElementsMap(b){for(var d=0;d<b.length;d++){var a=[];symbolElementsMap[b[d]]=$$("#symbolMarket span[name=symbol"+b[d]+"]","#symbolMarket span[name=open"+b[d]+"]","#symbolMarket span[name=high"+b[d]+"]","#symbolMarket span[name=low"+b[d]+"]","#symbolMarket span[name=close"+b[d]+"]","#symbolMarket span[name=changePips"+b[d]+"]","#symbolMarket span[name=changePercent"+b[d]+"]");var c=$("spark"+b[d]);if(c!=undefined){a.push($AT(c,"value"));elementsSparksMap["spark"+b[d]]=a}}}function getHistoricalDataByDate(c,g,f){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),c))){$("startDate").value=$("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),c))){$("endDate").value=$("endDate").defaultValue}var k=userFormatToDefaultFormat($F("startDate"),c);var b=userFormatToDefaultFormat($F("endDate"),c);var a=new Date(k);var h=new Date(b);var d=["&start=",getDbTimeFormat(a),"&end=",getDbTimeFormat(h),"&symbol=",g,"&timeScale=",f,"&userTimeFormat=",c];if(a>h){inlineMsg("startDate",$T("tStartBeforeEnd"),3)}else{fxAjax.sendRequest(fxVars.getHistoricalDataByDate+d.join(""),{loader:true,callback:"getHistoricalDataByDateResponse"})}}function getHistoricalDataByDateResponse(a,f){var b=a.error;var c=a.message;var g=a.content.historyData;var d=$("historyData");if(!b){if(g!=undefined){d.innerHTML=g;$("startDate").value=a.content.startDate;$("endDate").value=a.content.endDate;SortableTable.find()}else{d.innerHTML="<div class='padd10 font12 center'><span class='information'>"+c+"</span></div><br/>"}}}function historicalSymbolChannelResponse(f){var g=f[5];var c=f[6];var l=f[7];var o=f[8];var d=$("symbolHistoryPips");var h=$("symbolHistoryBid");var m=$("symbolHistoryPercent");var a=parseInt(d.attributes.decimals.value);var b=calculatePercents(o,g,2);var k=calculatePips(o,g,a);changeElementValueColor(h,o);h.setAttribute("value",o);h.innerHTML=roundNumberBySymbolDecimals(o,a);m.innerHTML=(b>=0?"+":"")+b+"%";changePipsAndPercentColor(m,b);d.innerHTML=(k>=0?"+":"")+k+" pips";changePipsAndPercentColor(d,k)}var quotesVolatilitySymbols=[];function setVolatilitySymbols(a){for(var c=0;c<a.length;c++){var b=$("symbol"+a[c]);if(b!=undefined){quotesVolatilitySymbols.push($AT(b,"name"))}}cleanVolatilityElementsColor()}var timeScales=[1,5,15,30,60,240,1440,10080,43200];function findVolatility(){cleanVolatilityElementsColor();var a=$F("lowVolatility");var b=$F("highVolatility");if(isNaN(a)&&a!=""){inlineMsg("lowVolatility",$T("tYouMustEnterValidNumber"),3)}if(isNaN(b)&&b!=""){inlineMsg("highVolatility",$T("tYouMustEnterValidNumber"),3)}findAndChangeVolatilityColor(parseFloat(a),parseFloat(b))}function compareTableValues(c,a,b,d){if(c>=d){b.className="lightRed radius3 padd5"}else{if(a<=d){b.className="lightGreen radius3 padd5"}else{b.className=""}}}function findAndChangeVolatilityColor(d,g){for(var c=0;c<quotesVolatilitySymbols.length;c++){for(var a=0;a<timeScales.length;a++){var b=$(quotesVolatilitySymbols[c]+"TimeScale"+timeScales[a]);var f=parseFloat($AT(b,"value"));compareTableValues(d,g,b,f)}}}function cleanVolatilityElementsColor(){for(var c=0;c<quotesVolatilitySymbols.length;c++){for(var a=0;a<timeScales.length;a++){var b=$(quotesVolatilitySymbols[c]+"TimeScale"+timeScales[a]);if(b!=undefined){b.className=""}}}}function changeVolatilityPipsOrPercent(l){cleanVolatilityElementsColor();for(var h=0;h<quotesVolatilitySymbols.length;h++){for(var g=0;g<timeScales.length;g++){var k=$(quotesVolatilitySymbols[h]+"TimeScale"+timeScales[g]);if(k.getAttribute("value")!="-"){var m=parseFloat($AT(k,"value"));var d=parseFloat($AT(k,"high"));var c=parseFloat($AT(k,"low"));var a=parseFloat($AT(k,"decimals"));if(l=="pipsVolatility"){$("type1").innerHTML="pips";$("type2").innerHTML="pips";var f=calculatePips(d,c,a);k.setAttribute("value",f);k.innerHTML=f}else{$("type1").innerHTML="%";$("type2").innerHTML="%";var b=calculatePercents(d,c,2);k.setAttribute("value",b);k.innerHTML=b+"%"}}}}}function symbolVolatilityChannelResponse(f){var g=f[5];var c=f[6];var l=f[7];var o=f[8];var d=$("symbolVolatilityPips");var h=$("symbolVolatilityBid");var m=$("symbolVolatilityPercent");var a=parseInt(d.attributes.decimals.value);var b=calculatePercents(c,l,2);var k=calculatePips(c,l,a);changeElementValueColor(h,o);h.setAttribute("value",o);h.innerHTML=roundNumberBySymbolDecimals(o,a);m.innerHTML=(b>=0?"+":"")+b+"%";changePipsAndPercentColor(m,b);d.innerHTML=(k>=0?"+":"")+k+" pips";changePipsAndPercentColor(d,k)}chartsTypes=["1","2","3"];function analyzeVolatility(d,f){var b=getAttributeByRadioChecked("volatilityRadio","volatilityRadioType");for(var a=0;a<chartsTypes.length;a++){var c=["chartType=",chartsTypes[a],"&symbol=",d,"&type=",b,buildVolatilityChartsUrl(d)];fxAjax.sendRequest(fxVars.volatilityCharts+c.join(""),{params:{chartType:chartsTypes[a],isChangeType:f,symbol:d},loader:true,callback:"analyzeVolatilityResponse"})}}function analyzeVolatilityResponse(a,c){if(!a.error){var b;var d="";switch(c.chartType){case"1":b=FusionCharts("hourlyChart");d="afterHourly";break;case"2":b=FusionCharts("weekDailyChart");d="afterWeek";break;case"3":b=FusionCharts("monthDailyChart");d="afterMonth";break}b.setXMLData(a.content.chartData);if(!c.isChangeType){setVolatilityStatAnalyze(a.content.afterAnalyzeData,d,c.symbol)}}reloadAds()}function getVolatilityChart(c,b,f,g){var a=getAttributeByRadioChecked("volatilityRadio","volatilityRadioType");var d=["chartType=",b,"&symbol=",f,"&type=",a,buildVolatilityChartsUrl(f)];fxAjax.sendRequest(fxVars.volatilityCharts+d.join(""),{params:{chart:c,chartType:b,isChangeType:g,symbol:f},loader:true,callback:"getVolatilityChartResponse"})}function getVolatilityChartResponse(a,c){if(!a.error){c.chart.setXMLData(a.content.chartData);var d="";var b=a.content.beforeAnalyzeData;switch(c.chartType){case"1":c.chart.render("hourlyVolatilityChart");d="afterHourly";break;case"2":c.chart.render("weekDailyVolatilityChart");d="afterWeek";break;case"3":c.chart.render("monthDailyVolatilityChart");d="afterMonth";break}if(!c.isChangeType){setVolatilityStatAnalyze(a.content.afterAnalyzeData,d,c.symbol)}}}function setVolatilityStatAnalyze(f,g,d){var c="";var b="";var a=$J("select").val();$(g+"Percent").innerHTML=f[d][0]+"%";$(g+"Pips").innerHTML=f[d][1];$(g+"Total").innerHTML=f[d][2];if(d!=a&&a!="Please select"){if(f[a]!=undefined){$("secondSymbol").innerHTML=a;$(g+"Percent1").innerHTML=f[a][0]+"%";$(g+"Pips1").innerHTML=f[a][1];$(g+"Total1").innerHTML=f[a][2]}else{setEmptyStat(g)}}else{$("secondSymbol").innerHTML="2nd symbol";setEmptyStat(g)}}function setEmptyStat(a){$(a+"Pips1").innerHTML="-";$(a+"Percent1").innerHTML="-";$(a+"Total1").innerHTML="-"}function buildVolatilityChartsUrl(d){var c=new Array();var b=new Array();var a=$J("select").val();c.push("&currencies=");b.push(encodeParameter(d));if(d!=a&&a!="Please select"){b.push(encodeParameter(a));b.join(",")}c.push(b);c.push("&weekDays=");c.push(getCheckBoxesValues("weekDays"));c.push("&hours=");c.push(getCheckBoxesValues("hours"));c.push("&monthDays=");c.push(getCheckBoxesValues("monthDays"));return c.join("")}function updateCorrelationMenu(b,a){var g=getCheckBoxesValues("colSymbols");var c=getCheckBoxesValues("rowSymbols");if(g.split(",").length<=10){hideElement("correlationSymbolChangedMessage");var f=getComboValue("timeScales");var d=["&colSymbols=",g,"&rowSymbols=",c,"&timeScale=",f];fxAjax.sendRequest(fxVars.updateCorrelationSymbolMenu,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:d.join(""),loader:a,callback:"updateCorrelationMenuResponse"})}else{if(!isShown($("correlationSymbolChangedMessage"))){$("correlationSymbolChangedMessage").innerHTML=$T("tOnly10Symbols");showElement("correlationSymbolChangedMessage")}if($("colSymbol"+b)){$("colSymbol"+b).checked=false}}}function updateCorrelationMenuResponse(b){if(!b.error){var d;var a=b.content.marketCorrelationTable;if(a){$("marketCorrelationTable").innerHTML=a;d=$("symbolMarketCorrelation");correlationSymbolsMap=[];setCorrelationSymbolMap();findCorrelation()}for(var c=0;c<getHeaders(d).length;c++){if($(d.id+"Img"+c)!=undefined){$(d.id+"Img"+c).className=""}}SortableTable.find()}reloadAds()}function selectAllCorrelationRowSymbols(element){var selected=eval(element.getAttribute("selected"));var elements=$$("#correlationSymbolsTable input[name=rowSymbols]");for(var i=0;i<elements.length;i++){elements[i].checked=selected}if(selected){element.innerHTML=$T("tHideAll")}else{element.innerHTML=$T("tShowAll")}element.setAttribute("selected",!selected);updateCorrelationMenu("")}var correlationSymbolsMap=[];function setCorrelationSymbolMap(){correlationSymbolsMap=$J(".correlation span")}function findAndChangeCorrelationColor(d,b){for(var a=0;a<correlationSymbolsMap.length;a++){var c=parseFloat($AT(correlationSymbolsMap[a],"value"));if(c!=0){compareTableValues(d,b,correlationSymbolsMap[a],c)}}}function cleanCorrelationElementsColor(){for(var a=0;a<correlationSymbolsMap.length;a++){correlationSymbolsMap[a].className=""}}function findCorrelation(){cleanCorrelationElementsColor();var b=$F("lowCorrelation");var a=$F("highCorrelation");if(b!="-"&&a!="-"){if(isNaN(b)&&b!=""){inlineMsg("lowCorrelation",$T("tYouMustEnterValidNumber"),3)}if(isNaN(a)&&a!=""){inlineMsg("highCorrelation",$T("tYouMustEnterValidNumber"),3)}findAndChangeCorrelationColor(parseFloat(b),parseFloat(a))}}function getCorrelationConfig(a,b){fxAjax.sendRequest(fxVars.getCorrelationConfig+a+"&colSymbol="+b,{params:{},callback:"getCorrelationConfigResponse"})}function getCorrelationConfigResponse(a,c){if(!a.error){var b=a.content.config;correlationObject.setConfig(b)}}function getSymbolCorrelationByTime(c,g){var b=[];var d=[];for(var h=0;h<$$("#correlationPairs td").length;h++){var l=$F("firstCorSymbol"+h);var m=$F("secondCorSymbol"+h);if(hasText(l)&&hasText(m)){b.push(l);d.push(m)}}var k=$J(".tagBG.bold.radius2")[0];if(g!=k){var a=correlationObject.getFirstDate();var f=correlationObject.getLastDate();k.className="tagBG radius2";fxAjax.sendRequest(fxVars.getSymbolCorrelationByTime+c+"&firstSymbols="+b+"&secondSymbols="+d,{params:{time:c,start:a,end:f},loader:true,callback:"getSymbolCorrelationByTimeResponse"})}}function getSymbolCorrelationByTimeResponse(a,f){if(!a.error){for(var c=0;c<$$("#correlationPairs td").length;c++){correlationObject.removeDataRange("dataSet"+c,f.start,f.end);var h=$F("firstCorSymbol"+c);var g=$F("secondCorSymbol"+c);if(hasText(h)&&hasText(g)){var d=a.content.quotesData[h+g];var b=correlationObject.getSeriesById("main","series"+c);if(d!=undefined&&hasText(d)){removeLabel();correlationObject.appendData("dataSet"+c,d);b.enabled=true}else{b.enabled=false;addLabel()}correlationObject.applySettingsChanges()}correlationObject.commitDataChanges()}$("symbolCorrelationTimeScale"+f.time).className="tagBG bold radius2"}}function initAutoCompleteCorr(a){for(var b=1;b<$$("#correlationPairs td").length;b++){$J("#firstCorSymbol"+b).autocompleteV2(a,{matchContains:true,minChars:0,max:54}).result(getCorrelationChart).next().click(function(){$J(this).prev().search()});$J("#secondCorSymbol"+b).autocompleteV2(a,{matchContains:true,minChars:0,max:54}).result(getCorrelationChart).next().click(function(){$J(this).prev().search()})}}function clearCorrelationPair(b){$J("#firstCorSymbol"+b)[0].value="";$J("#secondCorSymbol"+b)[0].value="";$("firstCorSymbol"+b).disabled=false;$("secondCorSymbol"+b).disabled=false;var a=correlationObject.getSeriesById("main","series"+b);a.enabled=false;correlationObject.applySettingsChanges();removeLabel();addLabel()}function checkSymbolsIfEquals(d,c,b){for(var a=0;a<$$("#correlationPairs td").length;a++){if(d==$F("firstCorSymbol"+a)&&c==$F("secondCorSymbol"+a)&&b!=a){clearCorrelationPair(b);return true}}return false}function checkIfInputIsSymbol(a){for(var b=0;b<symbols.size();b++){if(a==symbols[b]){return true}}return false}function getCorrelationChart(c){var b=c.target.getAttribute("nameId");var g=$F("firstCorSymbol"+b);var d=$F("secondCorSymbol"+b);if(hasText(g)&&hasText(d)){if(!checkSymbolsIfEquals(g,d,b)&&checkIfInputIsSymbol(g)&&checkIfInputIsSymbol(d)){var f=parseInt($J(".tagBG.bold.radius2")[0].getAttribute("timeScale"));var h=correlationObject.getFirstDate();var a=correlationObject.getLastDate();$("firstCorSymbol"+b).disabled=true;$("secondCorSymbol"+b).disabled=true;fxAjax.sendRequest(fxVars.getSymbolCorrelationByTime+f+"&firstSymbols="+g+"&secondSymbols="+d,{params:{time:f,firstCorSymbol:g,secondCorSymbol:d,start:h,end:a,numTd:b},loader:true,callback:"getCorrelationChartResponse"})}}}function getCorrelationChartResponse(a,d){if(!a.error){correlationObject.removeDataRange("dataSet"+d.numTd,d.start,d.end);var b=correlationObject.getSeriesById("main","series"+d.numTd);if(d.firstCorSymbol&&d.secondCorSymbol){var c=a.content.quotesData[d.firstCorSymbol+d.secondCorSymbol];if(c!=undefined&&hasText(c)){removeLabel();b.name=d.firstCorSymbol+"-"+d.secondCorSymbol;b.enabled=true;correlationObject.applySettingsChanges();correlationObject.appendData("dataSet"+d.numTd,c);correlationObject.selectRange("Max")}else{addLabel()}}correlationObject.commitDataChanges()}}function getTopCorrelationByTimeScale(c){var b=getComboValue("timeScales");var a=["&symbol=",c,"&timeScale=",b];fxAjax.sendRequest(fxVars.getTopCorrelationByTimeScale+a.join(""),{loader:true,callback:"getTopCorrelationByTimeScaleResponse"})}function getTopCorrelationByTimeScaleResponse(b,d){if(!b.error){var c;var a=b.content.topCorrelationTable;if(a){$("topCorrelationTable").innerHTML=a}FusionCharts("absoluteChart").setXMLData(b.content.absoluteChartData);FusionCharts("positiveChart").setXMLData(b.content.positiveChartData);FusionCharts("negativeChart").setXMLData(b.content.negativeChartData)}}var chartsDivs=["topAbsoluteCorrelationChart","topPositiveCorrelationChart","topNegativeCorrelationChart"];var chartsData=["absoluteChartData","positiveChartData","negativeChartData"];function getTopCorrelationCharts(d,c,a){var b=["&symbol=",d,"&timeScale=",c];fxAjax.sendRequest(fxVars.getTopCorrelationCharts+b.join(""),{params:{charts:a},callback:"getTopCorrelationChartsResponse"})}function getTopCorrelationChartsResponse(a,c){if(!a.error){if(c.charts){for(var b=0;b<c.charts.length;b++){c.charts[b].setXMLData(a.content[chartsData[b]]);c.charts[b].render(chartsDivs[b])}}}}function addLabel(){var c=correlationObject.getChartById("main").seriesList;var a=false;for(var b=0;b<c.length;b++){a=a||c[b].enabled}if(!a){correlationObject.objectModel.settings.labels.push({anchor:"Center",yPadding:0,xPadding:0,format:"Insufficient data. Please choose a different timeframe.",font:{color:"#000000",family:"tahoma",size:11,bold:true}});correlationObject.applySettingsChanges()}}function removeLabel(){correlationObject.objectModel.settings.labels=[];correlationObject.applySettingsChanges()}function setSparkLine(a,b){$J(a).sparkline(b,{type:"line",width:"80 ",height:"25",minSpotColor:"#ff0000",maxSpotColor:"#00bf00",disableInteraction:true,disableTooltips:true,disableHighlight:true})}var quotesHeatMapSymbols=[];function setHeatMapSymbols(a){for(var c=0;c<a.length;c++){var b=$("symbol"+a[c]);if(b!=undefined){quotesHeatMapSymbols.push($AT(b,"name"))}}}function changeHeatMapPipsOrPercent(h){for(var f=0;f<quotesHeatMapSymbols.length;f++){for(var c=0;c<timeScales.length;c++){var g=$(quotesHeatMapSymbols[f]+"TimeScale"+timeScales[c]);if(g.getAttribute("value")!="-"){var k=parseFloat($AT(g,"value"));var l=parseFloat($AT(g,"close"));var d=parseFloat($AT(g,"openVal"));var a=parseFloat($AT(g,"decimals"));if(h=="pipsHeatMap"){var b=calculatePips(l,d,a);g.setAttribute("value",b);g.innerHTML=b}else{var m=calculatePercents(l,d,2);g.setAttribute("value",m);g.innerHTML=m+"%"}}}}updateHeatMapColor(null)}Array.max=function(a){return Math.max.apply(Math,a)};Array.min=function(a){return Math.min.apply(Math,a)};function updateHeatMapColor(){var k=2;var c=10;var d;var f=jQuery(".heat-map th").length;for(k;k<=f;k++){var h=jQuery(".heat-map tbody tr td:nth-child("+k+")").not(".stats-title").map(function(){return parseFloat(jQuery(this).text()).toFixed(2)}).get();var b=h.sort(function(m,l){return l-m});var a=Array.max(h).toFixed(2);var g=Array.min(h).toFixed(2);n=150;xr=255;xg=255;xb=255;yr=228;yg=76;yb=74;gr=88;gg=195;gb=63;jQuery(".heat-map tbody tr td:nth-child("+k+")").not(".stats-title").each(function(){var l=parseFloat(jQuery(this).text()).toFixed(2);var m;clr="rgb("+xr+","+xg+","+xb+")";if(l>0){d=(a/c);if(l/d>1){m=parseInt((Math.round(((l/d)/c)*100)).toFixed(0))}else{m=((1/c)*100).toFixed(0)}red=parseInt((xr+((m*(gr-xr))/(n-1))).toFixed(0));green=parseInt((xg+((m*(gg-xg))/(n-1))).toFixed(0));blue=parseInt((xb+((m*(gb-xb))/(n-1))).toFixed(0));clr="rgb("+red+","+green+","+blue+")"}else{d=(Math.abs(g)/c);if(l/d<-1){m=parseInt((Math.round(((Math.abs(l)/d)/c)*100)).toFixed(0))}else{m=((1/c)*100).toFixed(0)}red=parseInt((xr+((m*(yr-xr))/(n-1))).toFixed(0));green=parseInt((xg+((m*(yg-xg))/(n-1))).toFixed(0));blue=parseInt((xb+((m*(yb-xb))/(n-1))).toFixed(0));clr="rgb("+red+","+green+","+blue+")"}jQuery(this).css({backgroundColor:clr})})}}function heatMapChannelResponse(g){for(var f in g.data){for(var d in g.data[f]){var h=jQuery("#"+f+"TimeScale"+d);var k=g.data[f][d].open;var a=g.data[f][d].close;var b=h.attr("decimals");h.attr("openVal",k);h.attr("close",a);h.attr("close",a);if($("pipsHeatMap").checked){var c=calculatePips(a,k,b);h.html(c);h.text(c);h.attr("value",c)}else{var l=calculatePercents(a,k,2);h.html(l+"%");h.text(l+"%");h.attr("value",l)}}}updateHeatMapColor()}jQuery.atmosphere=function(){jQuery(window).bind("beforeunload",function(){jQuery.atmosphere.unsubscribe()});var a=function(c){var b,f=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,d={};while(b=f.exec(c)){d[b[1]]=b[2]}return d};return{version:"1.0",requests:[],callbacks:[],connected:false,onError:function(b){},onClose:function(b){},onOpen:function(b){},onMessage:function(b){},onReconnect:function(c,b){},onMessagePublished:function(b){},onTransportFailure:function(b){},onLocalMessage:function(b){},AtmosphereRequest:function(F){var H={timeout:300000,method:"GET",headers:{},contentType:"",callback:null,url:"",data:"",suspend:true,maxRequest:60,reconnect:true,maxStreamingLength:10000000,lastIndex:0,logLevel:"info",requestCount:0,fallbackMethod:"GET",fallbackTransport:"streaming",transport:"long-polling",webSocketImpl:null,webSocketUrl:null,webSocketPathDelimiter:"@@",enableXDR:false,rewriteURL:false,attachHeadersAsQueryString:true,executeCallbackBeforeReconnect:false,readyState:0,lastTimestamp:0,withCredentials:false,trackMessageLength:false,messageDelimiter:"|",pingTimeout:35,lastPingTime:0,connectTimeout:-1,reconnectInterval:0,dropAtmosphereHeaders:false,uuid:0,shared:false,readResponsesHeaders:true,onError:function(ap){},onClose:function(ap){},onOpen:function(ap){},onMessage:function(ap){},onReconnect:function(aq,ap){},onMessagePublished:function(ap){},onTransportFailure:function(aq,ap){},onLocalMessage:function(ap){}};var P={status:200,responseBody:"",partialMessage:"",junkFull:false,expectedBodySize:-1,headers:[],state:"messageReceived",transport:"polling",error:null,request:null,id:0};var S=null;var k=null;var s=null;var z=null;var B=null;var ab=true;var g=0;var am=false;var T=null;var ah;var m=null;var E=jQuery.now();ao(F);function ai(){ab=true;am=false;g=0;S=null;k=null;s=null;z=null}function w(){ad();ai()}function ao(ap){w();H=jQuery.extend(H,ap)}function l(){return H.webSocketImpl!=null||window.WebSocket||window.MozWebSocket}function L(){return window.EventSource}function q(){if(H.shared&&!jQuery.browser.opera){m=aa(H);if(m!=null){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Storage service available. All communication will be local")}if(m.open(H)){return}}if(H.logLevel=="debug"){jQuery.atmosphere.debug("No Storage service available.")}m=null}if(H.transport!="websocket"&&H.transport!="sse"){G("opening",H.transport,H);o()}else{if(H.transport=="websocket"){if(!l()){J("Websocket is not supported, using request.fallbackTransport ("+H.fallbackTransport+")")}else{ac(false)}}else{if(H.transport=="sse"){if(!L()){J("Server Side Events(SSE) is not supported, using request.fallbackTransport ("+H.fallbackTransport+")")}else{D(false)}}}}}function aa(au){var aq,at,ar="atmosphere-"+au.url,ap={storage:function(){if(!jQuery.atmosphere.supportStorage()){return}var ay=window.localStorage,aw=function(az){return jQuery.parseJSON(ay.getItem(ar+"-"+az))},ax=function(az,aA){ay.setItem(ar+"-"+az,jQuery.stringifyJSON(aA))};return{init:function(){ax("children",aw("children").concat([E]));jQuery(window).on("storage.socket",function(az){az=az.originalEvent;if(az.key===ar&&az.newValue){av(az.newValue)}});return aw("opened")},signal:function(az,aA){ay.setItem(ar,jQuery.stringifyJSON({target:"p",type:az,data:aA}))},close:function(){var az,aA=aw("children");jQuery(window).off("storage.socket");if(aA){az=jQuery.inArray(au.id,aA);if(az>-1){aA.splice(az,1);ax("children",aA)}}}}},windowref:function(){var aw=window.open("",ar.replace(/\W/g,""));if(!aw||aw.closed||!aw.callbacks){return}return{init:function(){aw.callbacks.push(av);aw.children.push(F.id);return aw.opened},signal:function(ax,ay){if(!aw.closed&&aw.fire){aw.fire(jQuery.stringifyJSON({target:"p",type:ax,data:ay}))}},close:function(){function ax(aA,az){var ay=jQuery.inArray(az,aA);if(ay>-1){aA.splice(ay,1)}}if(!at){ax(aw.callbacks,av);ax(aw.children,F.id)}}}}};function av(aw){var ay=jQuery.parseJSON(aw),ax=ay.data;if(ay.target==="c"){switch(ay.type){case"open":G("opening","local",H);break;case"close":at=true;if(ax.reason==="aborted"){af()}else{A("","closed",200,H.transport);if(ax.heir===E){af()}else{setTimeout(function(){af()},100)}}break;case"message":A(ax,"messageReceived",200,au.transport);break;case"localMessage":W(ax);break}}}if(!new RegExp("(?:^|; )("+encodeURIComponent(ar)+")=([^;]*)").test(document.cookie)){return}aq=ap.storage()||ap.windowref();if(!aq){return}return{open:function(){var aw;aw=aq.init();if(aw){setTimeout(function(){G("opening","local",au)},50)}return aw},send:function(aw){aq.signal("send",aw)},localSend:function(aw){aq.signal("localSend",jQuery.stringifyJSON({id:E,event:aw}))},close:function(){if(!am){aq.signal("close");aq.close()}}}}function X(){var aq,ap="atmosphere-"+H.url,au={storage:function(){if(!jQuery.atmosphere.supportStorage()){return}var av=window.localStorage;return{init:function(){jQuery(window).on("storage.socket",function(aw){aw=aw.originalEvent;if(aw.key===ap&&aw.newValue){ar(aw.newValue)}})},signal:function(aw,ax){av.setItem(ap,jQuery.stringifyJSON({target:"c",type:aw,data:ax}))},get:function(aw){return jQuery.parseJSON(av.getItem(ap+"-"+aw))},set:function(aw,ax){av.setItem(ap+"-"+aw,jQuery.stringifyJSON(ax))},close:function(){jQuery(window).off("storage.socket");av.removeItem(ap);av.removeItem(ap+"-opened");av.removeItem(ap+"-children")}}},windowref:function(){var av=ap.replace(/\W/g,""),aw=(jQuery('iframe[name="'+av+'"]')[0]||jQuery('<iframe name="'+av+'" />').hide().appendTo("body")[0]).contentWindow;return{init:function(){aw.callbacks=[ar];aw.fire=function(ax){var ay;for(ay=0;ay<aw.callbacks.length;ay++){aw.callbacks[ay](ax)}}},signal:function(ax,ay){if(!aw.closed&&aw.fire){aw.fire(jQuery.stringifyJSON({target:"c",type:ax,data:ay}))}},get:function(ax){return !aw.closed?aw[ax]:null},set:function(ax,ay){if(!aw.closed){aw[ax]=ay}},close:function(){}}}};function ar(av){var ax=jQuery.parseJSON(av),aw=ax.data;if(ax.target==="p"){switch(ax.type){case"send":ae(aw);break;case"localSend":W(aw);break;case"close":af();break}}}T=function at(av){aq.signal("message",av)};document.cookie=encodeURIComponent(ap)+"="+jQuery.now();aq=au.storage()||au.windowref();aq.init();if(H.logLevel=="debug"){jQuery.atmosphere.debug("Installed StorageService "+aq)}aq.set("children",[]);if(aq.get("opened")!=null&&!aq.get("opened")){aq.set("opened",false)}ah=aq}function G(ar,au,aq){if(H.shared&&au!="local"&&!jQuery.browser.opera){X()}if(ah!=null){ah.set("opened",true)}aq.close=function(){af();aq.reconnect=false};P.request=aq;var at=P.state;P.state=ar;P.status=200;var ap=P.transport;P.transport=au;y();P.state=at;P.transport=ap}function v(ar){var aq=H;if((ar!=null)&&(typeof(ar)!="undefined")){aq=ar}var ap=aq.url;var at=aq.data;if(aq.attachHeadersAsQueryString){ap=Q(aq);if(at!=""){ap+="&X-Atmosphere-Post-Body="+at}at=""}B=jQuery.ajax({url:ap,type:aq.method,dataType:"jsonp",error:function(au,aw,av){if(au.status<300&&aq.requestCount++<aq.maxRequest){K(B,aq)}else{A(aw,"error",au.status,aq.transport)}},jsonp:"jsonpTransport",success:function(au){if(aq.requestCount++<aq.maxRequest){if(!aq.executeCallbackBeforeReconnect){K(B,aq)}var aw=au.message;if(aw!=null&&typeof aw!="string"){try{aw=jQuery.stringifyJSON(aw)}catch(av){}}A(aw,"messageReceived",200,aq.transport);if(aq.executeCallbackBeforeReconnect){K(B,aq)}}else{jQuery.atmosphere.log(H.logLevel,["JSONP reconnect maximum try reached "+H.requestCount]);Z()}},data:aq.data,beforeSend:function(au){b(au,aq,false)}})}function U(ar){var aq=H;if((ar!=null)&&(typeof(ar)!="undefined")){aq=ar}var ap=aq.url;var at=aq.data;if(aq.attachHeadersAsQueryString){ap=Q(aq);if(at!=""){ap+="&X-Atmosphere-Post-Body="+at}at=""}B=jQuery.ajax({url:ap,type:aq.method,error:function(au,aw,av){if(au.status<300&&aq.requestCount++<aq.maxRequest){K(B,aq)}else{A(aw,"error",au.status,aq.transport)}},success:function(av,aw,au){if(aq.requestCount++<aq.maxRequest){if(!aq.executeCallbackBeforeReconnect){K(B,aq)}A(av,"messageReceived",200,aq.transport);if(aq.executeCallbackBeforeReconnect){K(B,aq)}}else{jQuery.atmosphere.log(H.logLevel,["AJAX reconnect maximum try reached "+H.requestCount]);Z()}},data:aq.data,beforeSend:function(au){b(au,aq,false)}})}function d(ap){if(H.webSocketImpl!=null){return H.webSocketImpl}else{if(window.WebSocket){return new WebSocket(ap)}else{return new MozWebSocket(ap)}}}function f(){var ap=Q(H);return decodeURI(jQuery('<a href="'+ap+'"/>')[0].href.replace(/^http/,"ws"))}function an(){var ap=Q(H);return ap}function D(aq){P.transport="sse";var ap=an(H.url);if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking executeSSE");jQuery.atmosphere.debug("Using URL: "+ap)}if(aq){G("re-opening","sse",H)}if(!H.reconnect){if(k!=null){k.close()}return}k=new EventSource(ap,{withCredentials:H.withCredentials});if(H.connectTimeout>0){H.id=setTimeout(function(){if(!aq){k.close()}},H.connectTimeout)}k.onopen=function(ar){if(H.logLevel=="debug"){jQuery.atmosphere.debug("SSE successfully opened")}if(!aq){G("opening","sse",H)}aq=true;if(H.method=="POST"){P.state="messageReceived";k.send(H.data)}};k.onmessage=function(at){if(at.origin!="http://"+window.location.host){jQuery.atmosphere.log(H.logLevel,["Origin was not http://"+window.location.host]);return}P.state="messageReceived";P.status=200;var at=at.data;var ar=u(at,H,P);if(jQuery.trim(at).length==0){ar=true}if(!ar){y();P.responseBody=""}};k.onerror=function(ar){clearTimeout(H.id);P.state="closed";P.responseBody="";P.status=!aq?501:200;y();if(am){jQuery.atmosphere.log(H.logLevel,["SSE closed normally"])}else{if(!aq){J("SSE failed. Downgrading to fallback transport and resending")}else{if(H.reconnect&&(P.transport=="sse")){if(g++<H.maxRequest){H.requestCount=g;P.responseBody="";D(true)}else{k.close();jQuery.atmosphere.log(H.logLevel,["SSE reconnect maximum try reached "+H.requestCount]);Z()}}}}}}function ac(aq){P.transport="websocket";var ap=f(H.url);var ar=false;if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking executeWebSocket");jQuery.atmosphere.debug("Using URL: "+ap)}if(aq){G("re-opening","websocket",H)}if(!H.reconnect){if(S!=null){S.close()}return}S=d(ap);if(H.connectTimeout>0){H.id=setTimeout(function(){if(!aq){var at={code:1002,reason:"",wasClean:false};S.onclose(at);try{S.close()}catch(au){}}},H.connectTimeout)}S.onopen=function(at){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Websocket successfully opened")}if(!aq){G("opening","websocket",H)}else{H.onOpen(H)}aq=true;if(H.method=="POST"){P.state="messageReceived";S.send(H.data)}};S.onmessage=function(au){if(au.data.indexOf("parent.callback")!=-1){jQuery.atmosphere.log(H.logLevel,["parent.callback no longer supported with 0.8 version and up. Please upgrade"])}P.state="messageReceived";P.status=200;var au=au.data;var at=u(au,H,P);if(!at){y();P.responseBody=""}};S.onerror=function(at){clearTimeout(H.id)};S.onclose=function(at){if(ar){return}var au=at.reason;if(au===""){switch(at.code){case 1000:au="Normal closure; the connection successfully completed whatever purpose for which it was created.";break;case 1001:au="The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection.";break;case 1002:au="The endpoint is terminating the connection due to a protocol error.";break;case 1003:au="The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data).";break;case 1004:au="The endpoint is terminating the connection because a data frame was received that is too large.";break;case 1005:au="Unknown: no status code was provided even though one was expected.";break;case 1006:au="Connection was closed abnormally (that is, with no close frame being sent).";break}}jQuery.atmosphere.warn("Websocket closed, reason: "+au);jQuery.atmosphere.warn("Websocket closed, wasClean: "+at.wasClean);P.state="closed";P.responseBody="";P.status=!aq?501:200;y();clearTimeout(H.id);ar=true;if(am){jQuery.atmosphere.log(H.logLevel,["Websocket closed normally"])}else{if(!aq){J("Websocket failed. Downgrading to Comet and resending")}else{if(H.reconnect&&P.transport=="websocket"){if(H.reconnect&&g++<H.maxRequest){H.requestCount=g;P.responseBody="";ac(true)}else{jQuery.atmosphere.log(H.logLevel,["Websocket reconnect maximum try reached "+H.requestCount]);jQuery.atmosphere.warn("Websocket error, reason: "+at.reason);Z()}}}}}}function Z(){P.state="error";P.responseBody="";P.status=500;y()}function u(av,au,aq){if(au.trackMessageLength){var at=[];var ap=av.indexOf(au.messageDelimiter);if(aq.partialMessage.length==0){while(ap!=-1){var ar=av.substring(0,ap);at.push(ar);av=av.substring(ap+au.messageDelimiter.length,av.length);ap=av.indexOf(au.messageDelimiter)}}if(av.length!=0){aq.partialMessage+=av}ap=aq.partialMessage.indexOf(au.messageDelimiter);while(ap!=-1){ar=aq.partialMessage.substring(0,ap);at.push(ar);aq.partialMessage=aq.partialMessage.substring(ap+au.messageDelimiter.length,aq.partialMessage.length);ap=aq.partialMessage.indexOf(au.messageDelimiter)}if(at.length!=0){aq.responseBody=at.join(au.messageDelimiter);return false}else{return true}}else{aq.responseBody=av}return false}function J(ap){jQuery.atmosphere.log(H.logLevel,[ap]);if(typeof(H.onTransportFailure)!="undefined"){H.onTransportFailure(ap,H)}else{if(typeof(jQuery.atmosphere.onTransportFailure)!="undefined"){jQuery.atmosphere.onTransportFailure(ap,H)}}H.transport=H.fallbackTransport;if(H.reconnect&&H.transport!="none"||H.transport==null){H.method=H.fallbackMethod;P.transport=H.fallbackTransport;H.id=setTimeout(function(){q()},H.reconnectInterval)}}function Q(ar){var aq=H;if((ar!=null)&&(typeof(ar)!="undefined")){aq=ar}var ap=aq.url;if(!aq.attachHeadersAsQueryString){return ap}if(ap.indexOf("X-Atmosphere-Framework")!=-1){return ap}ap+=(ap.indexOf("?")!=-1)?"&":"?";ap+="X-Atmosphere-tracking-id="+aq.uuid;ap+="&X-Atmosphere-Framework="+jQuery.atmosphere.version;ap+="&X-Atmosphere-Transport="+aq.transport;ap+="&token="+TOKEN;ap+="&lastCalendarEventTime="+lastCalendarEventTime;ap+=getAtmosphereParams();if(aq.trackMessageLength){ap+="&X-Atmosphere-TrackMessageSize=true"}if(aq.lastTimestamp!=undefined){ap+="&X-Cache-Date="+aq.lastTimestamp}else{ap+="&X-Cache-Date="+0}if(aq.contentType!=""){ap+="&Content-Type="+aq.contentType}jQuery.each(aq.headers,function(at,av){var au=jQuery.isFunction(av)?av.call(this,aq,ar,P):av;if(au!=null){ap+="&"+encodeURIComponent(at)+"="+encodeURIComponent(au)}});return ap}function aj(){if(jQuery.browser.msie){if(typeof XMLHttpRequest=="undefined"){XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(ap){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(ap){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(ap){}throw new Error("This browser does not support XMLHttpRequest.")}}}return new XMLHttpRequest()}function o(at){var aq=H;if((at!=null)||(typeof(at)!="undefined")){aq=at}if((aq.transport=="jsonp")||((aq.enableXDR)&&(jQuery.atmosphere.checkCORSSupport()))){v(aq);return}if(aq.transport=="ajax"){U(at);return}if((aq.transport=="streaming")&&(jQuery.browser.msie&&jQuery.browser.version<10)){aq.enableXDR&&window.XDomainRequest?I(aq):al(aq);return}if((aq.enableXDR)&&(window.XDomainRequest)){I(aq);return}if(aq.reconnect&&aq.requestCount++<aq.maxRequest){var ar=aj();b(ar,aq,true);if(aq.suspend){s=ar}if(aq.transport!="polling"){P.transport=aq.transport}var ap=false;if(!jQuery.browser.msie){ar.onerror=function(){ap=true;try{P.status=XMLHttpRequest.status}catch(au){P.status=404}P.state="error";K(ar,aq,true)}}ar.onreadystatechange=function(){if(am){return}var ax=false;var aw=false;if(aq.transport=="streaming"){if(jQuery.browser.msie&&ar.readyState!=4){if(ar.readyState>=3){aw=true}}else{if(aq.readyState>2&&ar.readyState==4){aq.readyState=0;aq.lastIndex=0;K(ar,aq,true);return}}}aq.readyState=ar.readyState;if(ar.readyState==4){if(jQuery.browser.msie){aw=true}else{if(aq.transport=="streaming"){aw=true}else{if(aq.transport=="long-polling"){aw=true;clearTimeout(aq.id)}}}}else{if((!jQuery.browser.msie||jQuery.browser.msie&&jQuery.browser.version>=10)&&ar.readyState==3&&ar.status==200&&aq.transport!="long-polling"){aw=true;if(!jQuery.atmosphere.connected){jQuery.atmosphere.connected=true;H.onOpen(P)}else{jQuery.atmosphere.connected=true}}else{clearTimeout(aq.id)}}try{if(aq.readResponsesHeaders){var aB=ar.getResponseHeader("X-Atmosphere-tracking-id");if(aB!=null||aB!=undefined){H.uuid=aB.split(" ").pop()}}}catch(ay){}if(aw){var aA=ar.responseText;try{if(aq.readResponsesHeaders){var au=ar.getResponseHeader("X-Cache-Date");if(au!=null||au!=undefined){H.lastTimestamp=au.split(" ").pop()}}}catch(ay){}if(aq.transport=="streaming"){aq.lastPingTime=(new Date()).getTime();var aD=aA.substring(aq.lastIndex,aA.length);P.isJunkEnded=true;if(!P.junkFull&&(aD.indexOf("<!-- Welcome to the Atmosphere Framework.")==-1||aD.indexOf("<!-- EOD -->")==-1)){if(!jQuery.browser.opera){return}}else{P.junkFull=true}if(aq.lastIndex==0&&aD.indexOf("<!-- Welcome to the Atmosphere Framework.")!=-1&&aD.indexOf("<!-- EOD -->")!=-1){P.isJunkEnded=false}if(!P.isJunkEnded){var aC="<!-- EOD -->";var az=aC.length;var av=aD.indexOf(aC)+az;if(av>az&&av!=aD.length){P.responseBody=aD.substring(av);ax=u(P.responseBody,aq,P)}else{ax=true}}else{var aE=aA.substring(aq.lastIndex,aA.length);ax=u(aE,aq,P)}aq.lastIndex=aA.length;if(jQuery.browser.opera){jQuery.atmosphere.iterate(function(){if(ar.responseText.length>aq.lastIndex){try{P.status=ar.status;P.headers=a(ar.getAllResponseHeaders());if(H.readResponsesHeaders&&H.headers){jQuery.each(H.headers,function(aK){var aJ=ar.getResponseHeader(aK);if(aJ){P.headers[aK]=aJ}})}}catch(aI){P.status=404}if(!P.junkFull){var aH="<!-- EOD -->";var aF=aH.length;var aG=ar.responseText.indexOf(aH)+aF;aq.lastIndex=aG;P.junkFull=true}else{aq.lastPingTime=(new Date()).getTime();P.state="messageReceived";P.responseBody=ar.responseText.substring(aq.lastIndex);aq.lastIndex=ar.responseText.length;y();if((aq.transport=="streaming")&&(ar.responseText.length>aq.maxStreamingLength)){ar.abort();b(ar,aq,true)}}}},0)}if(ax){return}}else{ax=u(aA,aq,P);aq.lastIndex=aA.length}try{P.status=ar.status;P.headers=a(ar.getAllResponseHeaders());if(H.readResponsesHeaders&&H.headers){jQuery.each(H.headers,function(aG){var aF=ar.getResponseHeader(aG);if(aF){P.headers[aG]=aF}})}}catch(ay){P.status=404}if(aq.suspend){P.state=P.status==0?"closed":"messageReceived"}else{P.state="messagePublished"}if(!aq.executeCallbackBeforeReconnect){K(ar,aq,false)}if(P.responseBody.indexOf("parent.callback")!=-1){jQuery.atmosphere.log(aq.logLevel,["parent.callback no longer supported with 0.8 version and up. Please upgrade"])}y();if(aq.executeCallbackBeforeReconnect){K(ar,aq,false)}if((aq.transport=="streaming")&&(aA.length>aq.maxStreamingLength)){ar.abort();b(ar,aq,true)}}};ar.send(aq.data);if(aq.suspend){aq.id=setTimeout(function(){if(ab){ar.abort();ao(aq);q()}},aq.timeout);aq.lastPingTime=(new Date()).getTime();aq.ping=setTimeout(function(){r(ar,aq)},aq.pingTimeout*1000)}ab=true}else{jQuery.atmosphere.log(aq.logLevel,["Max re-connection reached."]);Z()}}function r(ar,aq){var ap=(new Date().getTime()-aq.lastPingTime)/1000;if((jQuery.atmosphere.connected||(!jQuery.atmosphere.connected&&jQuery.browser.msie))&&ap>aq.pingTimeout){if(ar!=null){ar.abort();ao(aq);q()}else{Y(aq);al(aq)}}clearTimeout(aq.ping);aq.ping=setTimeout(function(){r(ar,aq)},(aq.pingTimeout)*1000)}function b(ar,at,aq){var ap=Q(at);ap=jQuery.atmosphere.prepareURL(ap);if(aq){ar.open(at.method,ap,true);if(at.connectTimeout>-1){at.id=setTimeout(function(){if(at.requestCount==0){ar.abort();A("Connect timeout","closed",200,at.transport)}},at.connectTimeout)}}if(H.withCredentials){if("withCredentials" in ar){ar.withCredentials=true}}if(!H.dropAtmosphereHeaders){ar.setRequestHeader("X-Atmosphere-Framework",jQuery.atmosphere.version);ar.setRequestHeader("X-Atmosphere-Transport",at.transport);if(at.lastTimestamp!=undefined){ar.setRequestHeader("X-Cache-Date",at.lastTimestamp)}else{ar.setRequestHeader("X-Cache-Date",0)}if(at.trackMessageLength){ar.setRequestHeader("X-Atmosphere-TrackMessageSize","true")}if(at.contentType!=""){ar.setRequestHeader("Content-Type",at.contentType)}ar.setRequestHeader("X-Atmosphere-tracking-id",at.uuid)}jQuery.each(at.headers,function(au,aw){var av=jQuery.isFunction(aw)?aw.call(this,ar,at,aq,P):aw;if(av!=null){ar.setRequestHeader(au,av)}})}function K(ap,aq,ar){if(ar||(aq.suspend&&ap.status==200&&aq.transport!="streaming"&&ab)){if(aq.reconnect){jQuery.atmosphere.connected=false;P.junkFull=false;G("re-opening",aq.transport,aq);clearTimeout(aq.id);aq.id=setTimeout(function(){if(!jQuery.atmosphere.connected){o()}},aq.reconnectInterval)}}}function I(ap){z=O(ap);z.open()}function O(at){var ar=H;if((at!=null)&&(typeof(at)!="undefined")){ar=at}var aq="";var ax=ar.transport;var aw=0;var av=function(az){var aC=az.responseText;var aD=false;if(aC.indexOf("<!-- Welcome to the Atmosphere Framework.")!=-1){aD=true}if(aD){var aB="<!-- EOD -->";var ay=aB.length;var aA=aC.indexOf(aB);if(aA!==-1){aC=aC.substring(aA+ay+aw);aw+=aC.length}}A(aC,"messageReceived",200,ax)};var ap=new window.XDomainRequest();var au=ar.rewriteURL||function(az){var ay=/(?:^|;\s*)(JSESSIONID|PHPSESSID)=([^;]*)/.exec(document.cookie);switch(ay&&ay[1]){case"JSESSIONID":return az.replace(/;jsessionid=[^\?]*|(\?)|$/,";jsessionid="+ay[2]+"$1");case"PHPSESSID":return az.replace(/\?PHPSESSID=[^&]*&?|\?|$/,"?PHPSESSID="+ay[2]+"&").replace(/&$/,"")}return az};ap.onprogress=function(){av(ap)};ap.onerror=function(){if(ar.transport!="polling"){A(ap.responseText,"error",500,ax)}};ap.onload=function(){if(aq!=ap.responseText){av(ap)}if(ar.transport=="long-polling"){o()}};return{open:function(){if(ar.method=="POST"){ar.attachHeadersAsQueryString=true}var ay=Q(ar);if(ar.method=="POST"){ay+="&X-Atmosphere-Post-Body="+ar.data}ap.open(ar.method,au(ay));ap.send();if(ar.connectTimeout>-1){ar.id=setTimeout(function(){if(ar.requestCount==0){ap.abort();A("Connect timeout","closed",200,ar.transport)}},ar.connectTimeout)}},close:function(){ap.abort();A(ap.responseText,"closed",200,ax)}}}function Y(ap){if(z!=null){z.close();z=null}jQuery.atmosphere.connected=false}function al(ap){z=t(ap);z.open()}function t(at){var ar=H;if((at!=null)&&(typeof(at)!="undefined")){ar=at}var aq;var au=new window.ActiveXObject("htmlfile");au.open();au.close();var ap=ar.url;if(ar.transport!="polling"){P.transport=ar.transport}return{open:function(){var av=au.createElement("iframe");ap=Q(ar);if(ar.data!=""){ap+="&X-Atmosphere-Post-Body="+ar.data}ap=jQuery.atmosphere.prepareURL(ap);av.src=ap;au.body.appendChild(av);ar.lastPingTime=(new Date()).getTime();if(ar.ping==null){ar.ping=setTimeout(function(){r(null,ar)},ar.pingTimeout*1000)}var aw=av.contentDocument||av.contentWindow.document;aq=jQuery.atmosphere.iterate(function(){try{if(!aw.firstChild){return}if(aw.readyState==="complete"){try{jQuery.noop(aw.fileSize)}catch(aC){A("Connection Failure","error",500,ar.transport);return false}}var az=aw.body?aw.body.lastChild:aw;var aB=function(){jQuery.atmosphere.connected=true;var aI=az.cloneNode(true);aI.appendChild(aw.createTextNode("."));var aG=aI.innerText;var aH=true;if(aG.indexOf("<!-- Welcome to the Atmosphere Framework.")==-1){aH=false}if(aH){var aF="<!-- EOD -->";var aD=aF.length;var aE=aG.indexOf(aF)+aD;aG=aG.substring(aE)}return aG.substring(0,aG.length-1)};if(!jQuery.nodeName(az,"pre")){var ay=aw.head||aw.getElementsByTagName("head")[0]||aw.documentElement||aw;var ax=aw.createElement("script");ax.text="document.write('<plaintext>')";ay.insertBefore(ax,ay.firstChild);ay.removeChild(ax);az=aw.body.lastChild}A(aB(),"opening",200,ar.transport);aq=jQuery.atmosphere.iterate(function(){var aD=aB();if(aD.length>ar.lastIndex){P.status=200;A(aD,"messageReceived",200,ar.transport);az.innerText="";ar.lastIndex=0}if(aw.readyState==="complete"){A("","re-opening",200,ar.transport);al(ar);return false}},null);return false}catch(aA){jQuery.atmosphere.error(aA)}})},close:function(){if(aq){aq()}au.execCommand("Stop");A("","closed",200,ar.transport)}}}function ae(ap){if(m!=null){h(ap)}else{if(s!=null||k!=null){c(ap)}else{if(z!=null){R(ap)}else{if(B!=null){N(ap)}else{if(S!=null){C(ap)}}}}}}function h(ap){m.send(ap)}function x(aq){try{if(m){m.localSend(aq)}else{ah.signal("localMessage",jQuery.stringifyJSON({id:E,event:aq}))}}catch(ap){jQuery.atmosphere.error(ap)}}function c(aq){var ap=ag(aq);o(ap)}function R(aq){if(H.enableXDR&&jQuery.atmosphere.checkCORSSupport()){var ap=ag(aq);ap.reconnect=false;v(ap)}else{c(aq)}}function N(ap){c(ap)}function M(ap){var aq=ap;if(typeof(aq)=="object"){aq=ap.data}return aq}function ag(aq){var ar=M(aq);var ap={connected:false,timeout:60000,method:"POST",url:H.url,contentType:H.contentType,headers:{},reconnect:true,callback:null,data:ar,suspend:false,maxRequest:60,logLevel:"info",requestCount:0,transport:"polling",attachHeadersAsQueryString:true,enableXDR:H.enableXDR,uuid:H.uuid};if(typeof(aq)=="object"){ap=jQuery.extend(ap,aq)}return ap}function C(ap){var at=M(ap);var aq;try{if(H.webSocketUrl!=null){aq=H.webSocketPathDelimiter+H.webSocketUrl+H.webSocketPathDelimiter+at}else{aq=at}S.send(aq)}catch(ar){S.onclose=function(au){};S.close();J("Websocket failed. Downgrading to Comet and resending "+aq);c(ap)}}function W(aq){var ap=jQuery.parseJSON(aq);if(ap.id!=E){if(typeof(H.onLocalMessage)!="undefined"){H.onLocalMessage(ap.event)}else{if(typeof(jQuery.atmosphere.onLocalMessage)!="undefined"){jQuery.atmosphere.onLocalMessage(ap.event)}}}}function A(at,ap,aq,ar){if(ap=="messageReceived"){H.lastPingTime=(new Date()).getTime();if(u(at,H,P)){return}}P.transport=ar;P.status=aq;if(P.expectedBodySize==-1){P.responseBody=at}P.state=ap;y()}function V(ap){ak(ap,H);ak(ap,jQuery.atmosphere)}function ak(ap,aq){switch(ap.state){case"messageReceived":if(typeof(aq.onMessage)!="undefined"){aq.onMessage(ap)}break;case"error":if(typeof(aq.onError)!="undefined"){aq.onError(ap)}break;case"opening":if(typeof(aq.onOpen)!="undefined"){aq.onOpen(ap)}break;case"messagePublished":if(typeof(aq.onMessagePublished)!="undefined"){aq.onMessagePublished(ap)}break;case"re-opening":if(typeof(aq.onReconnect)!="undefined"){aq.onReconnect(H,ap)}break;case"unsubscribe":case"closed":if(typeof(aq.onClose)!="undefined"){aq.onClose(ap)}break}}function y(){var at=function(aw,ax){ax(P)};if(m==null&&T!=null){T(P.responseBody)}var au=typeof(P.responseBody)=="string"?P.responseBody.split(H.messageDelimiter):new Array(P.responseBody);for(var aq=0;aq<au.length;aq++){if(au.length>1&&au[aq].length==0){continue}P.responseBody=jQuery.trim(au[aq]);if(P.responseBody.length==0&&P.transport=="streaming"&&P.state=="messageReceived"){var ap=navigator.userAgent.toLowerCase();var ar=ap.indexOf("android")>-1;if(ar){continue}}V(P);if(jQuery.atmosphere.callbacks.length>0){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking "+jQuery.atmosphere.callbacks.length+" global callbacks: "+P.state)}try{jQuery.each(jQuery.atmosphere.callbacks,at)}catch(av){jQuery.atmosphere.log(H.logLevel,["Callback exception"+av])}}if(typeof(H.callback)=="function"){if(H.logLevel=="debug"){jQuery.atmosphere.debug("Invoking request callbacks")}try{H.callback(P)}catch(av){jQuery.atmosphere.log(H.logLevel,["Callback exception"+av])}}}}function af(){H.reconnect=false;P.request=H;ab=false;am=true;P.state="unsubscribe";P.responseBody="";P.status=408;y();ad();if(m==null&&T!=null){ah.signal("close",{reason:"",heir:!am?E:ah.get("children")[0]});document.cookie=encodeURIComponent("atmosphere-"+H.url)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"}if(ah!=null){ah.close()}if(m!=null){m.close()}}function ad(){if(z!=null){z.close();z=null}if(B!=null){B.abort();B=null}if(s!=null){s.abort();s=null}if(S!=null){S.close();S=null}if(k!=null){k.close();k=null}}this.subscribe=function(ap){ao(ap);q()};this.execute=function(){q()};this.invokeCallback=function(){y()};this.close=function(){af()};this.getUrl=function(){return H.url};this.push=function(ap){ae(ap)};this.pushLocal=function(ap){x(ap)};this.response=P},subscribe:function(b,f,d){jQuery.atmosphere.unsubscribe();if(typeof(f)=="function"){jQuery.atmosphere.addCallback(f)}if(typeof(b)!="string"){d=b}else{d.url=b}var c=new jQuery.atmosphere.AtmosphereRequest(d);c.execute();jQuery.atmosphere.requests[jQuery.atmosphere.requests.length]=c;return c},addCallback:function(b){if(jQuery.inArray(b,jQuery.atmosphere.callbacks)==-1){jQuery.atmosphere.callbacks.push(b)}},removeCallback:function(c){var b=jQuery.inArray(c,jQuery.atmosphere.callbacks);if(b!=-1){jQuery.atmosphere.callbacks.splice(b,1)}},unsubscribe:function(){if(jQuery.atmosphere.requests.length>0){for(var b=0;b<jQuery.atmosphere.requests.length;b++){jQuery.atmosphere.requests[b].close();clearTimeout(jQuery.atmosphere.requests[b].id);clearTimeout(jQuery.atmosphere.requests[b].response.request.ping)}}jQuery.atmosphere.requests=[];jQuery.atmosphere.callbacks=[]},unsubscribeUrl:function(c){var b=-1;if(jQuery.atmosphere.requests.length>0){for(var f=0;f<jQuery.atmosphere.requests.length;f++){var d=jQuery.atmosphere.requests[f];if(d.getUrl()==c){d.close();clearTimeout(d.id);b=f;break}}}if(b>=0){jQuery.atmosphere.requests.splice(b,1)}},publish:function(c){if(typeof(c.callback)=="function"){jQuery.atmosphere.addCallback(callback)}c.transport="polling";var b=new jQuery.atmosphere.AtmosphereRequest(c);jQuery.atmosphere.requests[jQuery.atmosphere.requests.length]=b;return b},checkCORSSupport:function(){if(jQuery.browser.msie&&!window.XDomainRequest){return true}else{if(jQuery.browser.opera){return true}}var b=navigator.userAgent.toLowerCase();var c=b.indexOf("android")>-1;if(c){return true}return false},S4:function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)},guid:function(){return(jQuery.atmosphere.S4()+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+"-"+jQuery.atmosphere.S4()+jQuery.atmosphere.S4()+jQuery.atmosphere.S4())},prepareURL:function(c){var d=jQuery.now();var b=c.replace(/([?&])_=[^&]*/,"$1_="+d);return b+(b===c?(/\?/.test(c)?"&":"?")+"_="+d:"")},param:function(b){return jQuery.param(b,jQuery.ajaxSettings.traditional)},supportStorage:function(){var c=window.localStorage;if(c){try{c.setItem("t","t");c.removeItem("t");return !!window.StorageEvent||Object.prototype.toString.call(c)==="[object Storage]"}catch(b){}}return false},iterate:function(d,c){var f;c=c||0;(function b(){f=setTimeout(function(){if(d()===false){return}b()},c)})();return function(){clearTimeout(f)}},log:function(d,c){if(window.console){var b=window.console[d];if(typeof b=="function"){b.apply(window.console,c)}}},warn:function(){jQuery.atmosphere.log("warn",arguments)},info:function(){jQuery.atmosphere.log("info",arguments)},debug:function(){jQuery.atmosphere.log("debug",arguments)},error:function(){jQuery.atmosphere.log("error",arguments)}}}();(function(d){var h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(f){return'"'+f.replace(h,function(k){var l=c[k];return typeof l==="string"?l:"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4)})+'"'}function b(f){return f<10?"0"+f:f}function g(q,o){var m,l,f,k,s=o[q],r=typeof s;if(s&&typeof s==="object"&&typeof s.toJSON==="function"){s=s.toJSON(q);r=typeof s}switch(r){case"string":return a(s);case"number":return isFinite(s)?String(s):"null";case"boolean":return String(s);case"object":if(!s){return"null"}switch(Object.prototype.toString.call(s)){case"[object Date]":return isFinite(s.valueOf())?'"'+s.getUTCFullYear()+"-"+b(s.getUTCMonth()+1)+"-"+b(s.getUTCDate())+"T"+b(s.getUTCHours())+":"+b(s.getUTCMinutes())+":"+b(s.getUTCSeconds())+'Z"':"null";case"[object Array]":f=s.length;k=[];for(m=0;m<f;m++){k.push(g(m,s)||"null")}return"["+k.join(",")+"]";default:k=[];for(m in s){if(Object.prototype.hasOwnProperty.call(s,m)){l=g(m,s);if(l){k.push(a(m)+":"+l)}}}return"{"+k.join(",")+"}"}}}d.stringifyJSON=function(f){if(window.JSON&&window.JSON.stringify){return window.JSON.stringify(f)}return g("",{"":f})}}(jQuery));var socket=jQuery.atmosphere;var subSocket;var callbackArray={1:"toolBarSymbolUpdateResponse",2:"updateOutloookQuotes",3:"updateQuotes",4:"symbolAnalysisChannelResponse",5:"volatilityChannelResponse",6:"quotesChannelResponse",7:"historicalSymbolChannelResponse",8:"symbolVolatilityChannelResponse",9:"autoCompleteUpdateSymbol",10:"heatMapChannelResponse"};var CHANNEL_SUSBSCRIBE=1;var CHANNEL_UNSUSBSCRIBE=2;var CHANNEL_SEND=3;var SOCKET_CLOSE=4;var connectinTimeout=1000*3;var showDisconnectMsg=false;var onOpenArray=[];var lastCalendarEventTime=0;var fxWebsocketData={};var rand=function(){return Math.random().toString(36).substr(2)};var token=function(){return rand()+rand()};var TOKEN=token();var reconnectTime=null;var reconnectTimeDelay=20000;var tokenEvent=jQuery.Deferred();jQuery(this).keypress(function(a){if(a.keyCode==27){a.preventDefault()}});var channels={_size:0,_channels:{},put:function(b,a){this._channels[b]=a;this._size++},remove:function(a){delete this._channels[a];this._size--},size:function(){return this._size},getAll:function(){return this._channels},get:function(a){return this._channels[a]}};var fxWebsocket={domain:null,parent:null,child:null,iframeId:null,_getChild:function(){if(this.child==null){this.child=document.getElementById(this.iframeId).contentWindow}return this.child},init:function(){if(window.addEventListener){addEventListener("message",onMessage,false)}else{attachEvent("onmessage",onMessage)}function onMessage(event){if(event.origin==atmosphereUrl||event.origin==serverPath){eval("fxWebsocket."+event.data)}}if(fxWebsocket.parent!=null){fxWebsocket.sendToParent("onChildReady()")}},setChild:function(b,a){this.iframeId=b;this.domain=a;fxWebsocket.init()},setParent:function(a,b){this.parent=a;this.domain=b;fxWebsocket.init()},sendToParent:function(a){this.parent.postMessage(a,fxWebsocket.domain)},sendToChild:function(a){this._getChild().postMessage(a,fxWebsocket.domain)},onChildReady:function(){},onOpen:function(){},onClose:function(){if($("connStatusOn")){$("connStatusOn").style.display="none";$("connStatusOff").style.display="";$("connStatusOn").setAttribute("connected","false")}},onMessage:function(responseBody){try{var decodedData=unescape(responseBody);var responseArray=decodedData.split("<@>");var data;for(var i=0;i<responseArray.length;i++){var response=responseArray[i];if(hasText(response)){if(response[0]=="{"){data=eval("("+response+")")}if(data!=null){var runCallback=eval(data.callback);runCallback(data)}else{var data=response.split(",");var runCallback=eval(callbackArray[data[0]]);runCallback(data)}}}}catch(e){}},onReconnect:function(){if(reconnectTime==null){reconnectTime=new Date().getTime()}if(new Date().getTime()-reconnectTime>reconnectTimeDelay){connectionLostMsg()}fxWebsocket.onClose()},onShowToolbar:function(a,b){showToolBar(a,b)},onSaveEmailMinAlert:function(c,a,b){saveEmailMinAlert(c,a,b)},onGetToken:function(a){tokenEvent.resolve(a);tokenEvent=jQuery.Deferred()},connect:function(){initConnectParams();fxWebsocket.sendToChild("connectChild("+JSON.stringify(fxWebsocketData)+")")},subscribe:function(b,d,c,a){this.subscribeWithMsg(b,d,c,a,"")},subscribeWithMsg:function(c,f,d,a,b){fxWebsocket.sendToChild("subscribeChild('"+c+"','"+f+"','"+d+"','"+a+"','"+b+"')")},send:function(a,b,c){fxWebsocket.sendToChild("sendChild('"+a+"','"+escape(b)+"','"+c+"')")},sendWithInvite:function(b,c,d,a){fxWebsocket.sendToChild("sendChildWithInvite('"+b+"','"+escape(c)+"','"+d+"','"+a+"')")},disconnect:function(){fxWebsocket.sendToChild("disconnectChild()")},updateChartData:function(b,a){fxWebsocket.sendToChild("childUpdateChartData('"+b+"','"+a+"')")},reconnectIe:function(){fxWebsocket.sendToChild("onReconnectIe()")},unsubscribe:function(a,b){fxWebsocket.sendToChild("unSubscribeChild('"+a+"','"+b+"')")},updateLastCalendarEventTime:function(a){fxWebsocket.sendToChild("updateLastCalendarEventTimeChild('"+a+"')")},getTokenForToolbar:function(a){fxWebsocket.sendToChild("getTokenForToolbarChild('"+a+"')")},getTokenForsaveEmailMinAlert:function(b,a){fxWebsocket.sendToChild("getTokenForsaveEmailMinAlertChild('"+b+"','"+a+"')")},sendChatMsg:function(c,d,f,a,b){fxWebsocket.sendToChild("sendChatMsgChild('"+c+"','"+escape(d)+"','"+f+"','"+a+"','"+b+"')")},getToken:function(){fxWebsocket.sendToChild("getTokenChild()");return tokenEvent},childUpdateChartData:function(c,b){var a=channels.get(c);if(a!=null){a.time=b}},connectChild:function(a){fxWebsocketData=a;jQuery(document).ready(function(){var b={url:atmosphereUrl+"/atmosphere/websocket?url="+encodeParameter(gup("url")),transport:"streaming",trackMessageLength:true,messageDelimiter:"<@>",reconnectInterval:30000};b.contentType="text/html; charset=UTF-8; charset=UTF-8";b.onReconnect=function(c){TOKEN=token();fxWebsocket.sendToParent("onReconnect()")};b.onMessage=function(c){if(jQuery.atmosphere.connected&&c.status==200){fxWebsocket.sendToParent("onMessage('"+escape(c.responseBody)+"')")}};b.onOpen=function(c){if(jQuery.atmosphere.connected){fxWebsocket.sendToParent("onOpen()")}};b.onClose=function(c){TOKEN=token();if(jQuery.browser.msie){fxWebsocket.sendToParent("onReconnect()")}else{fxWebsocket.sendToParent("onClose()")}};subSocket=socket.subscribe(b)})},subscribeChild:function(channel,id,time,invite,message){time=eval(time);var channelObject={channel:channel,id:id,time:time,invite:invite};channels.put(channel+id,channelObject);fxWebsocket.push(CHANNEL_SUSBSCRIBE,channel,message,id,time,invite)},unSubscribeChild:function(a,b){channels.remove(a+b);fxWebsocket.push(CHANNEL_UNSUSBSCRIBE,a,"",b,null,null)},updateLastCalendarEventTimeChild:function(a){lastCalendarEventTime=a},getTokenForToolbarChild:function(a){fxWebsocket.sendToParent("onShowToolbar('"+a+"','"+TOKEN+"')")},getTokenForsaveEmailMinAlertChild:function(b,a){fxWebsocket.sendToParent("onSaveEmailMinAlert('"+b+"','"+a+"','"+TOKEN+"')")},getTokenChild:function(){fxWebsocket.sendToParent("onGetToken('"+TOKEN+"')")},sendToChart:function(b,a){if(hasText($F("userId"))){this.send("chart",JSON.stringify(a),b)}},sendChild:function(a,b,c){fxWebsocket.push(CHANNEL_SEND,a,unescape(b),c,null,null);jQuery("#text").val("");jQuery("#text").focus()},sendChildWithInvite:function(b,c,d,a){fxWebsocket.push(CHANNEL_SEND,b,unescape(c),d,null,a)},sendChatMsgChild:function(c,d,f,a,b){fxWebsocket.pushChatMsg(CHANNEL_SEND,c,unescape(d),f,a,b)},onReconnectIe:function(){jQuery.atmosphere.connected=false;fxWebsocket.sendToParent("onClose()");fxWebsocket.connectChild();fxWebsocket.sendToParent("onOpen()")},push:function(b,d,c,h,g,a){var f={};if(g!=null&&g!=0){f.l=g}this.initAndPushBaseParams(f,b,d,c,h,a)},disconnectChild:function(){fxWebsocket.push(SOCKET_CLOSE,"","");socket.unsubscribe()},pushChatMsg:function(c,f,d,h,a,b){var g={};if(b!=null&&hasText(b)){g.ty=b}this.initAndPushBaseParams(g,c,f,d,h,a)},initAndPushBaseParams:function(f,b,d,c,g,a){f.token=TOKEN;f.t=b;f.c=encodeParameter(d);f.m=c;f.id=g;if(a!=null&&hasText(a)){f.i=a}if(subSocket!=null){subSocket.push({data:JSON.stringify(f)})}}};function encodeParameter(a){return(encodeURI(a).replace(/&/g,"%26").replace(/=/g,"%3D").replace(/\+/g,"%2B").replace(/#/g,"%23").replace(/\?/g,"%3F").replace(/\:/g,"%3A"))}function getAtmosphereParams(){var a="";for(var b in fxWebsocketData){a+="&"+b+"="+fxWebsocketData[b]}return a}function initConnectParams(){var b=isVisible("footerToolbar");var a=[];jQuery("#newsTop span[newsId]").each(function(){a.push($AT(this,"newsId"))});fxWebsocketData.t=b;fxWebsocketData.newsOids=encodeParameter(a)}var haveChanges=false;var sendMailToChartSubscribers=true;var currentTabNameChanged=false;var lastChartId=0;var loading="Loading...";var userLogin=false;var owner=false;var saveLock=false;var saveTimeOut;var effectActive=false;var NO_ACCOUNT=0;var elementIsSelected=false;var openTradesHistoryEvents={};var historyEvents={};var accountOid;var tradeBrowserOrder=[];var lastEventId;var timeFormat;var GOLD="GOLD";var GOLD_SYMBOL_NAME="XAUUSD";var SILVER="SILVER";var SILVER_SYMBOL_NAME="XAGUSD";function saveCharts(t,c,k){try{if(!saveLock&&chartLoaderOff&&userLogin!=null&&owner!=null&&!updateScenario&&chart!=null&&chart.getSelectedAnnotationId()==null&&((haveChanges||currentTabNameChanged)&&owner)||(userLogin&&t)){saveLock=true;var a;var l=lastChartId;var v=null;var o="";if(t){l=0;v=lastChartId;if(chartsArray[lastChartId]!=null){o=chartsArray[lastChartId].i}}var h=true;if(k!=null){h=k}var m=getChartSymbol(2);var f=getChartSymbol(3);var s={size:"Custom",quality:100,width:335,height:180,resizingMode:"Stretch"};var q=chart.getAnnotationListAsJSON();var d=[];for(var r=0;r<q.length;r++){if(!isContains(chartsArray[lastChartId].accountAnnotation,q[r].id)){d.push(q[r])}}if(t){for(var r=0;r<d.length;r++){if(d[r]!=null){d[r].allowEdit=true}}}var b=getChartSymbol(1)+","+$("chartProfileTime"+quoteTime).getAttribute("time");var g={b:"#"+$AT($("chartProfileBackgroundColor"),"hex"),g:"#"+$AT($("chartProfileGridColor"),"hex"),s:"#"+$AT($("scrollerColor"),"hex"),t:"#"+$AT($("textColor"),"hex")};var w=["&charts=",encodeParameter(traceObject(chart.objectModel.settings.charts,chart)),"&annontations=",encodeParameter(traceObject(d,chart)),"&timeScale=",quoteTime,"&startTime=",chart.getFirstVisibleDate().getTime(),"&chartId=",l,"&type=",c,"&settings=",encodeParameter(traceObject(g,chart)),"&firstSymbol=",encodeParameter(getChartSymbol(1)),"&copyId=",v,"&i=",o,"&sendMailToChartSubscribers=",sendMailToChartSubscribers];if(hasText(m)){w.push("&secondSymbol=",encodeParameter(m))}if(hasText(f)){w.push("&thirdSymbol=",encodeParameter(f))}try{w.push("&image=");w.push(encodeParameter(chart.getPNGImageBase64Encoded(s)))}catch(u){}fxAjax.sendRequest(fxVars.saveCharts,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",asynchronous:h,postBody:w.join(""),params:{symbols:a,saveNew:t,chartName:b,id:JSON.stringify(lastChartId)},loader:false,callback:"saveChartsResponse"})}else{clearTimeout(saveTimeOut);saveTimeOut=setTimeout("saveCharts(false,0)",10000)}}catch(u){saveLock=false}}function saveChartsResponse(response,params){try{if(!response.error){var tempId=Number(eval(params.id));var lastTime=response.content.lastTime;var saved=(response.content.saved!=null)?response.content.saved:false;if(lastTime!=null){chartsArray[tempId].lastUpdate=lastTime}chartsArray[tempId].saved=saved;fxWebsocket.updateChartData(chart_subscribe+tempId,dt.getTime());fxWebsocket.sendToChart(tempId,{type:"chartLastUpdate",o:{id:chart_subscribe+tempId,time:dt.getTime()},callback:"chartUpdate"});if(params.saveNew&&!updateScenario){userChartsCount++;var oid=response.content.oid;if(oid!=null){var url=createChartUrl(oid,null,null,null,params.chartName,response.content.invite);var li=new Element("li",{});var aMenu=new Element("a",{id:"chartMenuItem"+oid,href:url});aMenu.innerHTML=params.chartName;li.appendChild(aMenu);$("chartsMenu").appendChild(li);var a=new Element("a",{className:"underline pointer"});var br=new Element("br",{});var span=new Element("span",{});a.onclick=function(){window.open(url)};a.innerHTML=params.chartName;span.appendChild(a);showChartMsg("Chart copied to your workspace: ",span);hideElement("copyChart")}else{showChartMsg("Error copying the chart.")}}if(params.element!=null){var element=params.element;addWallPost(element.text,element.toUid,element.commentId,element.wallPostType,element.objectId,element.internalType,response.content.oid,true)}haveChanges=false;currentTabNameChanged=false;sendMailToChartSubscribers=true;clearTimeout(saveTimeOut);saveTimeOut=setTimeout("saveCharts(false,0)",10000)}if(selectedAnnotationId!=null){chart.selectAnnotation(selectedAnnotationId);selectedAnnotationId=null}}catch(e){saveLock=false}saveLock=false}var chartLoading=true;var chartLoaderOff=true;var chartsZindex=101;var chartsPosts={};var chartsComments={};function loadChart(c,h,o,l,a,t,z,b,y){if(!chartLoading){if(lastChartId!=c||l){chartLoading=true;showElement("feedLoader");hideElement("seriesSettings");hideElement("chartCompare");hideElement("indicatorFirstOption");hideElement("chartTimeScale");hideElement("linkToChart");try{chart.deselectAnnotaion();saveCharts(false,chart_type_chart)}catch(w){}var m="chart"+c;if($(m)==null||l){if(l==null){createChartFlash(c,false,null,null)}var A=["oid=",c,"&type=",h];if(o!=null){A.push("&loadWallPost="+o)}fxAjax.sendRequest(fxVars.loadChart+A.join(""),{params:{type:h,load:l,oid:c,objectId:a,post:t,notificationType:z,notificationId:b,postOid:y},callback:"loadChartResponse"})}else{chart=chartsArray[c].o;$("chart"+c).style.zIndex=chartsZindex;for(var u in chartsArray){if(u!=c){$("chart"+u).style.zIndex=99}}chartsZindex++;if(l!=null&&l){changePostChoice(false,"0")}fillChartSettings(chartsArray[c].s,chartsArray[c].n,chartsArray[c].t,chartsArray[c].p,c,chartsArray[c].userVote,chartsArray[c].totalVotes,chartsArray[c].v,chartsArray[c].type,chartsArray[c].i,chartsArray[c].d,chartsArray[c].subscribers,chartsArray[c].users);var k=chartsArray[c].feedObject;$("feedData").innerHTML=k.html();var f=chartsPosts[c];if(f!=null){for(var u=0;u<f.length;u++){if(f[u]!=null){if(f[u].remove!=null){var v=$("post"+f[u].oid);var r=$("postText"+f[u].oid);if(r!=null&&v!=null){r.remove();v.remove();var B=k.find("#"+v.id);var q=k.find("#"+r.id);if(q!=null){q.remove()}if(B!=null){B.remove()}updateFeedScrooler("chartDiscussion",false)}}else{createChartPost(f[u].lastOid,f[u].post,c)}}goToChartNotification("post"+f[u].lastOid,true,false)}delete chartsPosts[c]}for(var u in chartsComments){if(u==c){var g=chartsComments[u];for(var s=0;s<g.length;s++){var t=$("post"+g[s].p);if(t!=null){if(g[s].remove!=null){var d=$("comment"+g[s].oid);if(d!=null){d.remove();var x=k.find("#"+d.id);if(x!=null){x.remove()}updateFeedScrooler("chartDiscussion",false)}}else{addChartComment(g[s].p,g[s].c,c);goToChartNotification("comment"+g[s].id,false,false)}}}}}delete chartsComments[c];chartLoading=false;hideElement("feedLoader");updateFeedScrooler("chartDiscussion",true);addQuoteDataPoints(c);lastChartId=c;if(t!=null&&a!=null){loadWallPostNotification(c,z,b,y,"","")}}lastChartId=c;updateChartNotification(true,lastChartId)}}haveChanges=false;sendMailToChartSubscribers=true}function loadChartResponse(response,params){if(!response.error){var configObject;var chartObject=response.content.chart;var config=response.content.config;var type=chartObject.type;if(config){configObject=eval("("+config+")");if(type==chart_type_scenario){showScenarioMode(configObject,true)}chart.setConfig(configObject);chart.objectModel=configObject}if(params.load==null||!params.load){var chartSettings=chartObject.settings;var chartName=chartObject.profileName;var chartId=chartObject.oid;var publishChart=chartObject.publishChart;var timeScale=chartObject.timeScale;var userVote=chartObject.userVote;var totalVotes=chartObject.votes;var views=chartObject.views;var firstSymbol=chartObject.firstSymbol;var secondSymbol=chartObject.secondSymbol;var thirdSymbol=chartObject.thirdSymbol;var invite=chartObject.invite;var deleted=chartObject.deleted;var subscribers=chartObject.subscribers;var lastUpdate=chartObject.lastUpdate;var saved=hasText(chartObject.imageName);chartsArray[params.oid].n=chartName;chartsArray[params.oid].t=timeScale;chartsArray[params.oid].userVote=userVote;chartsArray[params.oid].totalVotes=totalVotes;chartsArray[params.oid].p=publishChart;chartsArray[params.oid].v=views;chartsArray[params.oid].type=type;chartsArray[params.oid].s=chartSettings;chartsArray[params.oid].firstSymbol=firstSymbol;chartsArray[params.oid].secondSymbol=secondSymbol;chartsArray[params.oid].thirdSymbol=thirdSymbol;chartsArray[params.oid].lastPoints=eval("("+chartObject.lastPoints+")");chartsArray[params.oid].i=invite;chartsArray[params.oid].d=deleted;chartsArray[params.oid].subscribers=subscribers;chartsArray[params.oid].lastUpdate=lastUpdate;chartsArray[params.oid].saved=saved;updateWallPost(response,chartId);chartsArray[params.oid].feedObject=jQuery("#feedData").clone();jQuery("#chartDiscussion").scrollTop(0);fillChartSettings(chartSettings,chartName,timeScale,publishChart,chartId,userVote,totalVotes,views,type,invite,deleted,subscribers,chartsArray[params.oid].users);if(!hasText(chartObject.lastPoints)){showChartMsg("Chart is not available currently, please try again later.<br/><br/>We apologize for the inconvenience.")}fxWebsocket.subscribe(firstSymbol,timeScale,null,null);if(secondSymbol!=null){fxWebsocket.subscribe(secondSymbol,timeScale,null,null)}if(thirdSymbol!=null){fxWebsocket.subscribe(thirdSymbol,timeScale,null,null)}chartsArray[params.oid].o.enableInteractivity();updateAnnotations(eval($F("chartOwner")))}if(params.objectId!=null&&params.post!=null){loadWallPostNotification(params.oid,params.notificationType,params.notificationId,params.postOid,"","")}delete chartsPosts[params.oid];if(chartsComments[params.oid]!=null){delete chartsComments[params.oid]}}haveChanges=false;sendMailToChartSubscribers=true;chartsLoader(false,loading);hideElement("feedLoader");if(params.type==chart_type_chart){$("showMoreWallPost").setAttribute("paging",2);showMoreBloack=true}if(params.load!=null&&params.load){changePostChoice(false,"0")}lastChartId=params.oid;updateChartNotification(true,lastChartId);hideElement("feedLoader");feedChannelSubscribe(true)}function clearIndicatorsLinks(){$("firstIndictorList").parentNode.parentNode.style.display="none";$("secondIndictorList").parentNode.parentNode.style.display="none";$("thirdIndictorList").parentNode.parentNode.style.display="none"}function createIndicatorsLinks(){clearIndicatorsLinks();$("firstIndictorList").innerHTML="";$("secondIndictorList").innerHTML="";$("thirdIndictorList").innerHTML="";var d=chart.objectModel.settings.charts;for(var c=0;c<d.length;c++){var a=d[c];var f=a.technicalIndicators;for(var b=0;b<f.length;b++){loadIndicator(f[b],a.id,false)}}}function getChartSymbol(a){if(a==1){return chartsArray[lastChartId].firstSymbol}else{if(a==2){return chartsArray[lastChartId].secondSymbol}else{if(a==3){return chartsArray[lastChartId].thirdSymbol}}}}function removeChartConfirm(){var b=$("chartMsg");b.innerHTML=$T("tConfirmChartDelete");var a=jQuery(b).dialog({resizable:false,modal:true,buttons:{Delete:function(){removeChart();a.dialog("close")},Cancel:function(){a.dialog("close")}}})}function removeChart(b){var a=lastChartId;if(b!=null){a=Number(b)}tabs=$$("#chartsTabs li");if(tabs.length>2||b!=null){fxAjax.sendRequest(fxVars.removeChart+a,{params:{chartId:a},callback:"removeChartResponse"})}reloadAds()}function removeChartResponse(d,c){if(!d.error){var l=c.chartId;var h=$("chartTab"+l);if(h!=null){h.remove()}tabs=$$("#chartsTabs li");var g=tabs[tabs.length-2];if(g!=null){switchTab("tabs21","chartContainer",g);loadChart(g.getAttribute("chartOid"),chart_type_chart,true)}initializeTabScroller();var f=$("publishChart"+l);var b=$("userChart"+l);if(f){f.remove()}if(b){b.remove()}var k=$("chart"+l);if(k){k.remove()}delete chartsArray[l];hideElement("seriesSettings");if($("createNewChart")!=null){$("createNewChart").disabled=false}var a=$("chartMenuItem"+c.chartId);if(a){a.parentNode.remove()}userChartsCount--;if(userChartsCount==1){hideElement("removeChart")}showElement("newChart");scroolToSelectedChart()}}function publishChartConfirm(b){chart.deselectAnnotaion();haveChanges=true;sendMailToChartSubscribers=true;saveCharts(false,chart_type_chart);if($("publishChart").innerHTML!="Published"){$("chartMsg").innerHTML="Publish your chart to share it with the Myfxbook community and make it public.<br/>After publication, others can follow, discuss and analyze it in real-time!";var a=jQuery("#chartMsg").dialog({resizable:false,modal:true,buttons:{"Publish Chart":function(){updatePublishChart();a.dialog("close")},Cancel:function(){a.dialog("close")}}})}}function updatePublishChart(a){if(lastChartId!=0){fxAjax.sendRequest(fxVars.updatePublishChart+lastChartId+"&invite="+chartsArray[lastChartId].i,{params:{oid:lastChartId,element:$("publishChart")},callback:"updatePublishChartResponse"})}else{(publishChart)?showElement("chartTopicDiscussion"):hideElement("chartTopicDiscussion")}}function updatePublishChartResponse(a,c){if(!a.error){var b=c.element;b.innerHTML="Published";b.className="default buttonOn floatRight";haveChanges=true;sendMailToChartSubscribers=true;saveCharts(false,chart_type_chart);chartsArray[lastChartId].p=true;$("chartFirstSymbol").disabled="disabled"}}function changeTimeScale(c){if(c!=null){quoteTime=c}var b=$$("#chartTimeScale li");for(var a=0;a<b.length;a++){if(b[a].getAttribute("value")==c){b[a].className="selected";$("chartTimeScaleLabel").innerHTML=b[a].getAttribute("time")}else{b[a].className=""}}}function getQuotesByTime(c){$("chartTimeScaleLabel").innerHTML=c.getAttribute("time");var g=c.value;chartsLoader(true,loading);if(g!=null){quoteTime=g}var h=chart.getFirstDate();var a=chart.getLastDate();var b;b=getChartSymbol(1);var d=getChartSymbol(2);if(hasText(d)&&d!=getChartSymbol(1)){b+="%2c"+d}var f=getChartSymbol(3);if(hasText(f)&&f!=getChartSymbol(1)&&f!=d){b+="%2c"+f}fxAjax.sendRequest(fxVars.getQuotes+quoteTime+"&symbols="+b,{params:{firstSymbol:getChartSymbol(1),secondSymbol:d,thirdSymbol:f,start:h,end:a},callback:"getQuotesByTimeResponse"})}function getQuotesByTimeResponse(response,params){if(!response.error){var lastPoints=response.content.lastPoint;if(hasText(lastPoints)){chartsArray[lastChartId].lastPoints=eval("("+lastPoints+")")}chart.removeDataRange("dataSetFirstQuoteSymbol",params.start,params.end);chart.removeDataRange("dataSetSecondQuoteSymbol",params.start,params.end);chart.removeDataRange("dataSetThirdQuoteSymbol",params.start,params.end);if(params.firstSymbol){chart.appendData("dataSetFirstQuoteSymbol",response.content.quotesData[params.firstSymbol])}if(hasText(params.secondSymbol)){chart.appendData("dataSetSecondQuoteSymbol",response.content.quotesData[params.secondSymbol]);fxWebsocket.subscribe(params.secondSymbol,quoteTime,null,null)}if(hasText(params.thirdSymbol)){chart.appendData("dataSetThirdQuoteSymbol",response.content.quotesData[params.thirdSymbol]);fxWebsocket.subscribe(params.thirdSymbol,quoteTime,null,null)}chart.commitDataChanges();var startDate=new Date(chart.getLastDate().getTime()-quoteTime*60*1000*100);chart.zoomTo(startDate,chart.getLastDate());changeCurrentTabName(false);fxWebsocket.subscribe(params.firstSymbol,quoteTime,null,null)}chartsLoader(false,loading);updateChartMenu();chartsArray[lastChartId].t=quoteTime}function updateSeriesScale(){var g=getChartSymbol(1);var c=getChartSymbol(2);var d=getChartSymbol(3);var a=chart.getChartById("main");var b=symbolsDecimals[g];var f="{%Value}{numDecimals:"+b+",plusSign:false}";if(hasText(c)||hasText(d)){f="{%Value}{numDecimals:2,plusSign:true}%";a.valueAxes.primary.scale.mode="PercentChanges";a.valueAxes.primary.labels.format=f;changeValueAxisToPercent(true)}else{a.valueAxes.primary.scale.mode="Values";a.valueAxes.primary.labels.format=f;changeValueAxisToPercent(false)}chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.labels[0].format=f;changeSeriesFormat()}function updateSymbolByDataSetId(a,b){switch(a){case"dataSetFirstQuoteSymbol":chartsArray[lastChartId].firstSymbol=b;break;case"dataSetSecondQuoteSymbol":chartsArray[lastChartId].secondSymbol=b;break;case"dataSetThirdQuoteSymbol":chartsArray[lastChartId].thirdSymbol=b;break}updateSeriesScale()}function getQuotesData(m,f){haveChanges=true;sendMailToChartSubscribers=true;chartsLoader(true,loading);var g=m.getAttribute("dataSet");if(owner){fxWebsocket.sendToChart(lastChartId,{type:"compare",o:{elementId:m.id,symbol:f},callback:"chartUpdate"})}if(hasText(f)){var a=chart.getFirstDate();var h=chart.getLastDate();fxAjax.sendRequest(fxVars.getQuotes+quoteTime+"&symbols="+f,{params:{dataSetId:g,symbol:f,start:a,end:h},callback:"quotesResponse"})}else{chart.getSeriesById("main",g+"Series").enabled=false;chart.applySettingsChanges();chartsLoader(false,loading);f="";var k;updateSymbolByDataSetId(g,f)}switch(g){case"dataSetFirstQuoteSymbol":$("chartFirstSymbol").value=f;$("firstSeriesName").innerHTML=f;k="dpFirstQuoteSymbol";break;case"dataSetSecondQuoteSymbol":$("chartSecondSymbol").value=f;$("secondSeriesName").innerHTML=f;k="dpSecondQuoteSymbol";break;case"dataSetThirdQuoteSymbol":$("chartThirdSymbol").value=f;$("thirdSeriesName").innerHTML=f;k="dpThirdQuoteSymbol";break}var d=[];if(!hasText(f)){var q=chart.objectModel.settings.charts;for(var r=0;r<q.length;r++){var b=q[r].technicalIndicators;for(var l=0;l<b.length;l++){if(b[l].dataProvider==k){var o=$("remove"+b[l].id);if(o!=null){d.push(o)}}}}}if(d.length>0){for(var l=0;l<d.length;l++){d[l].onclick()}}}function updateChartMenu(){var c=$("chartMenuItem"+lastChartId);if(c!=null){var b=getChartSymbol(1)+","+$("chartTimeScaleLabel").innerHTML;var a=createChartUrl(lastChartId,null,null,null,b);c.innerHTML=b;c.href=a}}function quotesResponse(response,params){if(!response.error){if(params.symbol){var dataSetId=params.dataSetId;var series=dataSetId+"Series";chart.removeDataRange(dataSetId,params.start,params.end);chart.appendData(dataSetId,response.content.quotesData[params.symbol]);chart.commitDataChanges();chart.getSeriesById("main",series).name=params.symbol;chart.getSeriesById("main",series).enabled=true;chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;updateSymbolByDataSetId(dataSetId,params.symbol);if(dataSetId=="dataSetFirstQuoteSymbol"){changeCurrentTabName(true)}updateChartMenu()}}var lastPoints=eval("("+response.content.lastPoint+")");if(hasText(lastPoints)){for(var i in lastPoints){chartsArray[lastChartId].lastPoints[i]=lastPoints[i]}}chart.applySettingsChanges();chartsLoader(false,loading);fxWebsocket.subscribe(params.symbol,quoteTime,null,null)}function onSeriesTypeChange(g,d,m){var h=chart.getSeriesById("main",dataSetType);h.type=g.getAttribute("value");if(h.type){var a=$$("#seriesType li");for(var k=0;k<a.length;k++){if(a[k]!=g){a[k].className=""}else{a[k].className="selected"}}$("seriesTypeLabel").innerHTML=g.innerHTML;var c=$("chartProfileSeriesColor");$("candlestickRisingLineColor").setAttribute("hex",((h.type=="Candlestick")?h.candlestickSeries.rising.line.color:"#000000"));$("candlestickRisingBorderColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.rising.border.color:"#000000");$("candlestickRisingFillColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.rising.fill.color:"#000000");$("candlestickFallingLineColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.falling.line.color:"#000000");$("candlestickFallingBorderColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.falling.border.color:"#000000");$("candlestickFallingFillColor").setAttribute("hex",(h.type=="Candlestick")?h.candlestickSeries.falling.fill.color:"#000000");new jscolor.color($("candlestickRisingLineColor"));new jscolor.color($("candlestickRisingBorderColor"));new jscolor.color($("candlestickRisingFillColor"));new jscolor.color($("candlestickFallingLineColor"));new jscolor.color($("candlestickFallingBorderColor"));new jscolor.color($("candlestickFallingFillColor"));if(h.type!="Candlestick"){c.setAttribute("hex",h.color);new jscolor.color(c)}$("ohlcRising").setAttribute("hex",(h.type=="OHLC")?h.ohlcSeries.rising.color:"#000000");$("ohlcFaling").setAttribute("hex",(h.type=="OHLC")?h.ohlcSeries.falling.color:"#000000");new jscolor.color($("ohlcRising"));new jscolor.color($("ohlcFaling"));var b=$$("#addSeriesAndIndicators [class=Candlestick]");var l="";if(h.type!="Candlestick"&&h.type!="OHLC"){l="none";showElement("seriesColor");hideElement("ohlcSeries")}else{if(h.type=="OHLC"){showElement("ohlcSeries");hideElement("seriesColor");l="none"}else{hideElement("seriesColor");hideElement("ohlcSeries")}}for(var k=0;k<b.length;k++){b[k].style.display=l}chart.applySettingsChanges();if(m==null||m){haveChanges=true;sendMailToChartSubscribers=true}if(d==null||d){var f={type:"seriesTypeChange",o:{id:g.getAttribute("value"),dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,f)}}}function onSeriesColorChange(b){chart.getSeriesById("main",dataSetType).color="#"+$AT($("chartProfileSeriesColor"),"hex");chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(b){var a={type:"seriesColorChange",o:{color:$AT($("chartProfileSeriesColor"),"hex"),dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,a)}}function changeChartBackroundColor(c,g,l,k){var f=chart.objectModel.settings.charts;var a;if(c){a=c}else{a="#"+$AT($("chartProfileBackgroundColor"),"hex")}for(var d=0;d<f.length;d++){f[d].background.fill.color=a;f[d].legend.background.fill.color=a;f[d].xAxis.labels.background={fill:{color:a}}}chart.objectModel.settings.background.fill.color=a;chart.objectModel.settings.scroller.outsideSelectedRange.backgroundFill.color=a;var h=chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers;for(var d=0;d<h.length;d++){h[d].labels[0].font.color=a}if(!l){haveChanges=true;sendMailToChartSubscribers=true}if(g){createCross($("cross"),true)}if(k){var b={type:"backroundColor",o:$("chartProfileBackgroundColor").getAttribute("hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function changeCandlestickSettings(f,a){var d=chart.getSeriesById("main",dataSetType);var b="#"+f.getAttribute("hex");switch(f.id){case"candlestickRisingLineColor":d.candlestickSeries.rising.line.color=b;break;case"candlestickRisingBorderColor":d.candlestickSeries.rising.border.color=b;break;case"candlestickRisingFillColor":d.candlestickSeries.rising.fill.color=b;break;case"candlestickFallingLineColor":d.candlestickSeries.falling.line.color=b;break;case"candlestickFallingBorderColor":d.candlestickSeries.falling.border.color=b;break;case"candlestickFallingFillColor":d.candlestickSeries.falling.fill.color=b;break}chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(a){var c={type:"candlestickSettings",o:{color:f.getAttribute("hex"),id:f.id,dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,c)}}function changeOhlcSettings(d,f){var c=chart.getSeriesById("main",dataSetType);var a="#"+d.getAttribute("hex");switch(d.id){case"ohlcRising":if(c.ohlcSeries==null){c.ohlcSeries={rising:{color:a}}}else{c.ohlcSeries.rising={color:a}}break;case"ohlcFaling":if(c.ohlcSeries==null){c.ohlcSeries={falling:{color:a}}}else{c.ohlcSeries.falling={color:a}}break}chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(f){var b={type:"ohlcSettings",o:{color:d.getAttribute("hex"),id:d.id,dataSetType:dataSetType},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function showGrid(a,g){var d=chart.objectModel.settings.charts;for(var c=0;c<d.length;c++){var f=d[c];if(f){f.valueAxes.primary.grid.enabled=a;f.xAxis.majorGrid.enabled=a;f.xAxis.minorGrid.enabled=a;chart.applySettingsChanges()}}haveChanges=true;sendMailToChartSubscribers=true;if(g){var b={type:"showGrid",o:a,callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}var dataSetType="dataSetFirstQuoteSymbolSeries";var dataProvider="dpFirstQuoteSymbol";var selectedIndicatorList="firstIndictorList";function hideEditDlg(){dlg.style.display="none"}function changeChartGridColor(c){var f=chart.objectModel.settings.charts;var a="#"+$AT($("chartProfileGridColor"),"hex");for(var d=0;d<f.length;d++){if(f[d].valueAxes.primary.grid==null){f[d].valueAxes.primary={grid:{line:{color:a}}}}else{f[d].valueAxes.primary.grid.line.color=a}if(f[d].xAxis.majorGrid==null){f[d].xAxis.majorGrid={line:{color:a}}}else{f[d].xAxis.majorGrid.line.color=a}if(f[d].xAxis.minorGrid==null){f[d].xAxis.minorGrid={line:{color:a}}}else{f[d].xAxis.minorGrid.line.color=a}}chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(c){var b={type:"gridColor",o:$AT($("chartProfileGridColor"),"hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function exitChartPage(a){if(userLogin!=null&&owner!=null&&(haveChanges&&owner)){chart.deselectAnnotaion();saveCharts(false,chart_type_chart,false)}}function createNewChart(){if(!chartLoading){chartLoading=true;hideElement("seriesSettings");try{saveCharts(false,chart_type_chart)}catch(g){}chartsLoader(true,loading);var d=Math.floor(Math.random()*99999);var a="EURUSD,M30 ";var h=$("chartsTabs");var l=new Element("li",{className:"off"});var k=new Element("span",{});var b=new Element("span",{className:"chartSettings radius3 padd2"});var c=new Element("span",{id:"",style:"display:none"});var f=new Element("a",{className:"pointer"});b.onmouseout=function(){if(this.parentNode.parentNode.className=="on"){this.style.opacity="0.6"}};b.onmouseover=function(){if(this.parentNode.parentNode.className=="on"){this.style.opacity="1"}this.className="chartSettings radius3 padd2";this.style.opacity=0.6};f.onclick=function(){showSeriesSettings(this)};k.innerHTML=a;f.appendChild(b);l.appendChild(k);l.appendChild(f);l.appendChild(c);h.insertBefore(l,$("createNewChart"));switchTab("tabs21","chartContainer",l);initializeTabScroller();fxAjax.sendRequest(fxVars.newChart,{params:{li:l,span:k,name:a,spanNotification:c},callback:"createNewChartResponse"})}}function createNewChartResponse(response,params){if(!response.error){var quotesData=response.content.quotesData;userChartsCount++;var oid=response.content.oid;params.li.id="chartTab"+oid;params.li.setAttribute("chartOid",oid);params.span.id="chartName"+oid;params.spanNotification.id="chartNotification"+oid;params.spanNotification.className="countRedSmall";params.li.onclick=function(){if(!chartLoading&&this.className=="off"){loadChart(oid,chart_type_chart);switchTab("tabs21","chartContainer",params.li)}};var defaultTimeScale=30;createChartFlash(oid,false,params.name,defaultTimeScale,"EURUSD","","",false,0,false,0,chart_type_chart,response.content.lastPoint,response.content.invite,false,0,dt.getTime(),"");var config=response.content.config;if(config){chart.setConfig(config);chart.objectModel=eval("("+config+")")}fillChartSettings(null,params.name,defaultTimeScale,false,oid,false,0,0,chart_type_chart,response.content.invite,false,0,null);haveChanges=true;sendMailToChartSubscribers=true;updateWallPost(response,oid);jQuery("#userComment").autosize();selectTool("crossP");showElement("removeChart");updateChartNotification(true,lastChartId);if(!quotesData){showChartMsg("Chart is not available currently, please try again later.<br/><br/>We apologize for the inconvenience.")}fxWebsocket.subscribe("EURUSD",30,null,null)}scroolToSelectedChart();feedChannelSubscribe(true)}function chartsLoader(b,d,c){var a=chart;if(c!=null){a=c}if(b){if(a.showWaitingState(d)){a.disableInteractivity();chartLoaderOff=false}}else{if(a.hideWaitingState()){a.enableInteractivity();chartLoaderOff=true}}}function changeCurrentTabName(a){sendMailToChartSubscribers=(haveChanges||a);currentTabNameChanged=true;var d=$("chartName"+lastChartId);var c=$$("#chartTimeScale [class=selected]")[0];var b=getChartSymbol(1)+","+c.getAttribute("time")+" ";if(d){d.innerHTML=b;saveCharts(false,chart_type_chart);updateChartFacebookData(lastChartId,b)}}var indicatorList=[{id:"dataSetFirstQuoteSymbolSeries",list:"firstIndictorList"},{id:"dataSetSecondQuoteSymbolSeries",list:"secondIndictorList"},{id:"dataSetThirdQuoteSymbolSeries",list:"thirdIndictorList"}];function changeIndicatorsList(){var b=$$("#dataSetType [class=selected]")[0];var f=b.getAttribute("value");dataProvider=b.getAttribute("dataProvider");switch(f){case"dataSetSecondQuoteSymbolSeries":selectedIndicatorList="secondIndictorList";break;case"dataSetThirdQuoteSymbolSeries":selectedIndicatorList="thirdIndictorList";break;default:selectedIndicatorList="firstIndictorList";break}dataSetType=f;var d=$$("#dataSetType li");for(var a=0;a<d.length;a++){if(d[a]!=b){d[a].className=""}else{d[a].className="selected"}}$("seriesLabel").innerHTML=b.innerHTML;var c=chart.getSeriesById("main",dataSetType).type;var d=$$("#seriesType li");for(var a=0;a<d.length;a++){if(d[a].getAttribute("value")!=c){d[a].className=""}else{d[a].className="selected"}}$("seriesTypeLabel").innerHTML=c;initSeriesSettings()}function initSeriesSettings(){try{var k=chart.getChartById("main");var d=chart.getSeriesById("main",dataSetType);var b=$("chartProfileSeriesColor");if(d.type){var h=$$("#seriesType li[value="+d.type+"]")[0];if(h!=null){onSeriesTypeChange(h,false,false);hideElement("seriesType")}}if(k!=null){var c=$("chartProfileBackgroundColor");if(c!=null){c.setAttribute("hex",k.background.fill.color);new jscolor.color(c)}}$("textColor").setAttribute("hex",chart.objectModel.settings.scroller.gridLine.color);new jscolor.color($("textColor"));var a=k.valueAxes.primary.grid;var l=a.line.color;$("chartProfileGridColor").setAttribute("hex",l);new jscolor.color($("chartProfileGridColor"));$("showGrid").checked=a.enabled;var f=chart.objectModel.settings.scroller.insideSelectedRange.seriesFill.color;$("scrollerColor").setAttribute("hex",f);new jscolor.color($("scrollerColor"));$("chartTimeScaleLabel").innerHTML=$("chartProfileTime"+quoteTime).getAttribute("time");changeTextColor(false,true,false);changeChartBackroundColor(null,null,true,false);showCross();if(userChartsCount==1){hideElement("removeChart")}if($$("#indicatorFirstOption a[remove]").length>0){hideElement("noIndicators")}else{showElement("noIndicators")}}catch(g){}}function changeValueAxisToPercent(f){var b=symbolsDecimals[getChartSymbol(1)];var a=(b!=null)?b:5;var d="{%Value.LastVisible}";var c="{%Value}{numDecimals:"+a+",plusSign:false}";if(f){d="{%PercentValueChange.LastVisible}";c="{%Value}{numDecimals:2,plusSign:false}%"}chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers[0].valueToken=d;chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers[0].labels[0].format=c}function initSymbols(){changeSymbolSelect("chartFirstSymbol","EURUSD");changeSymbolSelect("chartSecondSymbol","");changeSymbolSelect("chartThirdSymbol","")}function showSeriesSettings(a){if(a.parentNode.className.indexOf("off")==-1){showElement("seriesSettings")}}function voteForChart(a){if(a.className.indexOf("buttonOn")!=-1){vote=0}else{vote=1}fxAjax.sendRequest(fxVars.voteForChart+lastChartId+"&vote="+vote+"&invite="+chartsArray[lastChartId].i,{params:{element:a},callback:"voteForChartResponse"})}function voteForChartResponse(a,d){if(!a.error){var b=d.element;var c;if(b.className.indexOf("buttonOn")!=-1){b.className=" floatRight marginR10  pointer buttonOff";chartsArray[lastChartId].userVote=false}else{if(b.className.indexOf("buttonOff")!=-1){b.className=" floatRight marginR10  pointer buttonOn";chartsArray[lastChartId].userVote=true}}if(c!=null){chartsArray[lastChartId].totalVotes=c}}}function undoRedo(g,c){haveChanges=true;sendMailToChartSubscribers=true;var d=g[lastChartId];if(d!=null){var a=d.pop(d.length-1);if(a){if(a.all!=null){if(c==0){pushToAnnotationList(a,false);for(var b=0;b<a.annontations.length;b++){if(a.annontations[b]!=null){chart.addAnnotation(a.annontations[b]);pushAnnotation(a.annontations[b].id)}}}else{pushToAnnotationList(a,true);chart.removeAllAnnotations();fxWebsocket.sendToChart(lastChartId,{type:"annotationRemoveAll",o:{},callback:"chartUpdate"})}}else{var f=chart.getAnnotationAsJSON(a.id);if(f==null){f={newElement:true,id:a.id}}if(c==0){pushToAnnotationList(f,false)}else{pushToAnnotationList(f,true)}if(f){chart.removeAnnotation(a.id);fxWebsocket.sendToChart(lastChartId,{type:"annotationRemove",o:{id:a.id},callback:"chartUpdate"})}if(!a.newElement){chart.addAnnotation(a);pushAnnotation(a.id)}}}}}function addTemplate(d){var h=d.keyCode?d.keyCode:d.which?d.which:d.charCode;if(h==13){var g=[];var a=$F("templateName");var c={};c.c=chart.objectModel.settings.charts;c.s=chart.objectModel.settings.scroller;c.b=chart.objectModel.settings.background;g.push(c);var f=["templateName=",a,"&template=",encodeParameter(traceObject(g,chart))];var b={};b.b=chart.objectModel.settings.background.fill.color;b.b=chart.objectModel.settings.background.fill.color;fxAjax.sendRequest(fxVars.addTemplate,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:f.join(""),params:{template:traceObject(g,chart),templateName:a},loader:false,callback:"addTemplateResponse"})}}function addTemplateResponse(response,params){if(!response.error){var oid=response.content.oid;var mainDiv=$("templateList");var li=new Element("li",{id:"templateRemove"+oid});li.innerHTML=params.templateName;var a=new Element("a",{className:"floatRight closer"});li.onclick=function(){loadTemplate(oid,params.templateName,true);hideElement("tempateSelect")};a.onclick=function(e){removeTemplate(oid);e.stopPropagation()};li.appendChild(a);mainDiv.appendChild(li);$("templateName").value="New Template...";$("templateName").blur();haveChanges=true;sendMailToChartSubscribers=true;templates[oid]=eval("("+params.template+")")}}function removeTemplate(a){fxAjax.sendRequest(fxVars.removeTemplate+a,{params:{oid:a},callback:"removeTemplateResponse"})}function removeTemplateResponse(a,c){if(!a.error){var b=$("templateRemove"+c.oid);if(b){b.remove()}selectDefaultTemplate()}}function loadTemplate(id,name,sendLoadTemplate){if(id!=null){var elements=$$("#templateList li");for(var i=0;i<elements.length;i++){if(elements[i].id=="templateRemove"+id){elements[i].className="selected"}else{elements[i].className=""}}$("tempateSelectName").innerHTML=name+'<img alt="" src="../../../images/controlDown.png">';var secondSeries=$F("chartSecondSymbol");var thirdSeries=$F("chartThirdSymbol");var template=eval("("+traceObject(templates[id],chart)+")");chart.objectModel.settings.charts=template[0]["c"];chart.objectModel.settings.scroller=template[0]["s"];chart.objectModel.settings.background=template[0]["b"];chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").name=getChartSymbol(1);var second=chart.getSeriesById("main","dataSetSecondQuoteSymbolSeries");var third=chart.getSeriesById("main","dataSetThirdQuoteSymbolSeries");if(hasText(secondSeries)){second.name=secondSeries;second.enabled=true}else{second.enabled=false}if(hasText(thirdSeries)){third.name=thirdSeries;third.enabled=true}else{third.enabled=false}updateSeriesScale();chart.applySettingsChanges();createIndicatorsLinks();initSeriesSettings();haveChanges=true;sendMailToChartSubscribers=true;saveCharts(false,chart_type_chart);if(sendLoadTemplate){var object={type:"loadTemplate",o:{id:id,template:templates[id]},callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,object)}}}function updateWallPost(a,c){var b=a.content.wallPost;if(b!=null){$("feedData").innerHTML=b;chartsArray[c].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",true)}}function updateChartView(){var b=lastChartId+"&r="+Math.random();var a=new Element("img",{src:"/ucv.jpg?id="+b,style:"display:none"})}function updateChartSubscribers(c,b){var a=c.checked;fxAjax.sendRequest(fxVars.updateChartSubscribers+a+"&chartId="+lastChartId+"&invite="+b,{params:{element:c,subscribe:a}})}function chartAlert(a){$("chartAlert").innerHTML=a;showElement("chartAlert");Effect.Fade("chartAlert",{duration:5})}var chartsPoints={};var chartsDataSets=["dataSetFirstQuoteSymbol","dataSetSecondQuoteSymbol","dataSetThirdQuoteSymbol"];var chart_type_chart=0;var chart_type_scenario=1;function addScenario(f,b,d,c,a){saveCharts(true,chart_type_scenario,{text:f,toUid:b,commentId:d,wallPostType:c,objectId:a,internalType:chart_type_scenario})}function loadScenario(chartId,scenarioId,element){chartsLoader(true,loading);var load=eval(element.getAttribute("scenario"));var id=chartId;var type=chart_type_chart;var scenarios=$$("#userMessages [scenario]");for(var i=0;i<scenarios.length;i++){scenarios[i].className="pointer floatRight scenarioOn";scenarios[i].setAttribute("scenario","true")}if(load){id=scenarioId;element.className="pointer floatRight scenarioOn";type=chart_type_scenario}else{element.className="pointer floatRight scenarioOff"}loadChart(id,type,false,true);element.setAttribute("scenario",!load)}var updateScenario=false;function changePostChoice(d,f,b){var c=$F("userId");if(hasText(c)&&c!=0){if(d){haveChanges=true;sendMailToChartSubscribers=true;saveCharts(false,chart_type_chart);hideElement("userComment");showElement("scenarioMsg");hideElement("addWallPost");updateScenario=true;showScenarioMode(null,false,true)}else{var a=getWallPostIdsByType(b).postText;var g=getWallPostIdsByType(b).commentText;if($(a+f).style.display=="none"){showElement(a+f);$(g+f).focus()}else{hideElement(a+f);$(g+f).blur()}showElement(getWallPostIdsByType(b).userComment);updateFeedScrooler(getWallPostIdsByType(b).discussion,false);updateScenario=false}}}function showScenarioMode(d,c,a){var b="#"+$AT($("chartProfileBackgroundColor"),"hex");if(c){b=d.settings.background.fill.color}var f=[{anchor:"TopCenter",xPadding:0,yPadding:50,format:"Scenario Mode",font:{family:"Arial",color:b,size:15,bold:true},background:{enabled:true,fill:{enabled:true,color:"#"+$AT($("textColor"),"hex")},insideMargin:{left:10,top:1,right:10,bottom:0},corners:{type:"Rounded",all:"4"}}}];if(c){d.settings.labels=f}else{if(a){chart.objectModel.settings.labels=f}else{chart.objectModel.settings.labels=[]}chart.applySettingsChanges()}}function changeTextColor(k,u,l){var b=chart.objectModel.settings;if(!u){haveChanges=true;sendMailToChartSubscribers=true}var t="#"+$("textColor").getAttribute("hex");var s;var a;for(var d=0;d<b.charts.length;d++){var q=b.charts[d];q.legend.title.font={color:t};q.legend.dateTime.font={color:t};var h=q.seriesList;if(h!=null){for(var g=0;g<h.length;g++){var m=symbolsDecimals[h[g].name];var f=(m!=null)?m:5;s='<textformat><font size="10" color="'+t+'">{%SeriesName}:</font></textformat><textformat><font color="'+t+'">O: {%Open.LastVisible}{numDecimals:'+f+",plusSign:false}   H: {%High.LastVisible}{numDecimals:"+f+",plusSign:false}   L: {%Low.LastVisible}{numDecimals:"+f+",plusSign:false}   C: {%Close.LastVisible}{numDecimals:"+f+",plusSign:false}</font></textformat>";a='<textformat><font size="10" color="'+t+'">{%SeriesName}:</font></textformat><textformat><font color="'+t+'">O: {%Open.Current}{numDecimals:'+f+",plusSign:false}   H: {%High.Current}{numDecimals:"+f+",plusSign:false}   L: {%Low.Current}{numDecimals:"+f+",plusSign:false}   C: {%Close.Current}{numDecimals:"+f+",plusSign:false}</font></textformat>";h[g].legendItem.labels.focusSettings.mouseOut.format=s;h[g].legendItem.labels.focusSettings.mouseOver.format=a}}else{if(q.legend.labels.focusSettings!=null){var r=q.legend.labels.focusSettings.mouseOut.format.indexOf("numDecimals:")+12;f=q.legend.labels.focusSettings.mouseOut.format[r];q.legend.labels.focusSettings.mouseOut.format='{%SeriesIcon} <b><font color="%Color">{%SeriesName} </font><font color="'+t+'">{%Value.LastVisible}{numDecimals:'+f+"}</font>";q.legend.labels.focusSettings.mouseOver.format='{%SeriesIcon} <b><font color="%Color">{%SeriesName} </font><font color="'+t+'"> {%Value.Current}{numDecimals:'+f+"}</font>"}}if(q.xAxis.labels.majorLabels!=null){q.xAxis.labels.majorLabels.font={bold:false,family:"Arial",size:10,color:t}}if(q.xAxis.labels.minorLabels!=null){q.xAxis.labels.minorLabels.font={bold:false,family:"Arial",size:10,color:t}}q.xAxis.dateHighlighter.line.color=t;q.valueAxes.primary.labels.font={color:t};q.legend.background.border={color:t};q.background.border={color:t}}b.scroller.timeScale.labels.font={color:t};chart.objectModel.settings.scroller.border={color:t};chart.objectModel.settings.scroller.selectedRangeOutline={color:t};chart.objectModel.settings.scroller.gridLine.color=t;var o=chart.objectModel.settings.defaults.chart.valueAxes.primary.axisMarkers.lineMarkers;for(var g=0;g<o.length;g++){o[g].labels[0].background.fill.color=t;o[g].line.color=t}if(k){createCross($("cross"),true)}if(l){var c={type:"textColor",o:$("textColor").getAttribute("hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,c)}}function changeScrollerColor(d){var c=chart.objectModel.settings;var a="#"+$AT($("scrollerColor"),"hex");c.scroller.insideSelectedRange.seriesFill.color=a;c.scroller.insideSelectedRange.seriesLine.color=a;c.scroller.outsideSelectedRange.seriesFill.color="LightColor(LightColor(LightColor("+a+")))";c.scroller.outsideSelectedRange.seriesLine.color=a;chart.objectModel.settings.scroller.insideSelectedRange.backgroundFill.color="LightColor(LightColor(LightColor("+a+")))";chart.applySettingsChanges();haveChanges=true;sendMailToChartSubscribers=true;if(d){var b={type:"scrollerColor",o:$AT($("scrollerColor"),"hex"),callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,b)}}function copyAnnotation(){var c=quoteTime*1000*60*2;var b=chart.getSelectedAnnotationId();if(b!=null){var a=chart.getAnnotationAsJSON(b);if(a!=null){a=changeDateTotimestamp(a,2,c);a.id=Math.random();chart.addAnnotation(a);haveChanges=true;sendMailToChartSubscribers=true}}}function createCross(d,c,a){var f="#"+$AT($("textColor"),"hex");var b="#"+$AT($("chartProfileBackgroundColor"),"hex");chart.getChartById("main").xAxis.dateHighlighter.labels[0].background.fill.color=f;chart.getChartById("main").xAxis.dateHighlighter.line.color=f;chart.getChartById("main").xAxis.dateHighlighter.labels[0].font.color=b;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.labels[0].background.fill.color=f;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.line.color=f;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.labels[0].font.color=b;if(!c&&a!=null){chart.getChartById("main").xAxis.dateHighlighter.enabled=a;chart.getSeriesById("main","dataSetFirstQuoteSymbolSeries").valueHighlighter.enabled=a;$("cross").setAttribute("enable",a)}chart.applySettingsChanges()}function addCustomList(a,c,f){var d=$$("#"+a+" li");for(var b=0;b<d.length;b++){d[b].onclick=function(){if(!f){var h=$$("#"+a+" li[class=selected]")[0];if(h==this){return false}}for(var g=0;g<d.length;g++){if(d[g]!=this){d[g].className=""}else{d[g].className="selected"}}c(this)}}}function changeSymbolSelect(b,a){$(b).value=a}function updateFeedScrooler(d,a){var c=jQuery("#"+d);var b=c.data("jsp");b.reinitialise();if(a){b.scrollTo(0,0)}}function destroyFeedScroller(){var b=j("#chartDiscussion");var a=b.data("jsp");a.destroy()}function showCross(){var showCross=eval($("cross").getAttribute("enable"));if(showCross){selectTool("crossP")}else{selectTool("SelectionTool")}createCross($("cross"),false,showCross)}var chartTabsPosition=0;var tabLength=107;var tabsWidth=0;var spacerWidth=12;function chartTabsScroller(a){tabsWidth=$J(document).width()-(120+spacerWidth+(isShown("chartDiscussion")?300:0));tabs=$$("#chartsTabs li");if(a){if(((tabs.length)*tabLength)-tabsWidth>chartTabsPosition){chartTabsPosition+=tabLength;jQuery("#chartsTabs").animate({left:"-="+tabLength+"px"},500)}}else{if(chartTabsPosition-tabLength<=0){jQuery("#chartsTabs").animate({left:"+="+chartTabsPosition+"px"},300);chartTabsPosition=0}else{chartTabsPosition-=tabLength;jQuery("#chartsTabs").animate({left:"+="+tabLength+"px"},300)}}}function scroolToSelectedChart(){tabsWidth=$J(document).width()-(120+spacerWidth+(isShown("chartDiscussion")?300:0));var a=1;tabs=$$("#chartsTabs li");for(var b=0;b<tabs.length;b++){if(tabs[b].className=="on"){break}else{a++}}if((a*tabLength)<tabsWidth){chartTabsPosition=0}else{chartTabsPosition=a*tabLength-tabsWidth+tabLength+30}$("chartsTabs").style.left=-chartTabsPosition+"px"}function spacerIsDisplayed(element){var show=eval(element.getAttribute("show"));if(show){hideElement("chartFeed");hideElement("rightArrow");showElement("leftArrow");hideElement("feedTs");hideElement("feedBs");tabsWidth+=400}else{showElement("chartFeed");showElement("rightArrow");hideElement("leftArrow");showElement("feedBs");showElement("feedTs");tabsWidth-=400}element.setAttribute("show",!show);scroolToSelectedChart()}function updateSeriesData(){var a=chart.getChartById("main");for(var c=0;c<a.seriesList.length;c++){var b=a.seriesList[c];if(hasText(b.name)&&b.enabled){if(b.id=="dataSetFirstQuoteSymbolSeries"){changeSymbolSelect("chartFirstSymbol",b.name);$("firstSeriesName").innerHTML=b.name}else{if(b.id=="dataSetSecondQuoteSymbolSeries"){changeSymbolSelect("chartSecondSymbol",b.name);$("secondSeriesName").innerHTML=b.name}else{if(b.id=="dataSetThirdQuoteSymbolSeries"){changeSymbolSelect("chartThirdSymbol",b.name);$("thirdSeriesName").innerHTML=b.name}}}}}}var defaultTemplate="Light Gray";function fillChartSettings(r,c,y,w,u,z,B,o,g,x,t,f,v){$("cPname").innerHTML=c;if(t=="true"){$("chartDeleted").style.display=""}else{$("chartDeleted").style.display="none"}selectDefaultTemplate();initSymbols();updateSeriesData();createIndicatorsLinks();if(g==chart_type_chart&&hasText($F("userId"))){var h="#"+c.replace(/%2c/gi,"-").replace("/","").replace(" ","")+"/"+u+"/"+x;window.location.hash=h}changeTimeScale(y);var d=$("publishChart");if(d!=null){if(w){d.innerHTML="Published";d.onclick=function(){};hideElement("privateChart")}else{showElement("privateChart");d.innerHTML=$T("tPublish");d.className="floatRight buttonOn";d.onclick=function(){publishChartConfirm(this)}}}(B!=null&&$("chartVoteCount")!=null)?$("chartVoteCount").innerHTML=B:0;(f!=null&&$("chartFollowCount")!=null)?$("chartFollowCount").innerHTML=f:0;var s=$("chartViews");if(s!=null){s.innerHTML=o}initSeriesSettings();var q=$("chartVote");if(q!=null){q.setAttribute("show",false)}hideElement("chartVotesWindow");var b=$("chartFollowing");if(b!=null){b.setAttribute("show",false)}hideElement("chartFollowingWindow");updateChartUsers(v);updateChartFacebookData(u,c);var k=$("chartFirstSymbol");(chartsArray[u].p)?k.disabled="disabled":k.disabled="";var m=false;try{m=chartsArray[u].feedObject.find("#userMessages").children().size()>0}catch(A){}if(!m){hideElement("discussLinkCont")}else{var a=$J("#linkToDiscussion");if(a!=undefined){var l="/forex-charts/"+c.replace(" ","")+"/discussion/";if(!w){l+=x+"/"}l+=u+",1";a.attr("href",l);showElement("discussLinkCont")}}}function createChartPost(a,h,d){if($("post"+a)==null){var b=new Element("div",{style:"display:none"});var g=new Element("div",{});b.innerHTML=h;g.innerHTML=h;var c=chartsArray[d].feedObject;var f=c.find("#userMessages");if(f.children().size()>0){jQuery(g).insertBefore(f.children()[0])}else{f.append(g)}$("userMessages").insertBefore(b,$("userMessages").firstChild);feedSlideDown(b,"chartDiscussion");runAjaxScripts(h);updateFeedLastTime()}}function addChartComment(a,k,g){var c=$("post"+a);if(c!=null){var d=new Element("div",{style:"display:none"});var h=new Element("div",{});d.innerHTML=k;h.innerHTML=k;var f=chartsArray[g].feedObject;var b=f.find("#"+c.id);b.append(h);c.appendChild(d);feedSlideDown(d,"chartDiscussion");updateFeedLastTime()}}function saveChartScreenshot(){try{hideElement("screenshotTd");showElement("screenshotLoading");showElement("chartScreenShotWindow");var a={width:300,height:100,top:100,resizable:false};a.close=function(d,f){jQuery.destroy("#chartScreenShotWindow")};chart.objectModel.settings.labels.push({anchor:"LeftBottom",yPadding:0,xPadding:0,format:"Chart by Myfxbook.com, GMT "+(userTime<0?userTime/3600000:"-"+userTime/3600000),background:{enabled:true,fill:{color:"#"+$AT($("chartProfileBackgroundColor"),"hex")},insideMargin:{all:3},border:{enabled:true,color:"#"+$("textColor").getAttribute("hex")}},font:{color:"#"+$("textColor").getAttribute("hex"),family:"tahoma",size:11,bold:true}});chart.applySettingsChanges();var b=["image=",encodeParameter(chart.getPNGImageBase64Encoded()),"&name=",$("chartName"+lastChartId).innerHTML]}catch(c){chart.objectModel.settings.labels=[];chart.applySettingsChanges()}fxAjax.sendRequest(fxVars.saveChartScreenshot,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),params:{},loader:false,callback:"saveChartScreenshotResponse"})}function saveChartScreenshotResponse(a){if(!a.error){var b=a.content.imageUrl;if(b!=null){$("chartScreenshotUrl").value=b;$("imageView").href=b}hideElement("screenshotLoading");showElement("screenshotTd")}chart.objectModel.settings.labels=[];chart.applySettingsChanges()}function showChartWindow(d){var c=$(d);var b=$$("[chartWindow]");for(var a=0;a<b.length;a++){if(b[a].id!=d){hideElement(b[a].id)}}if(isShown(c)){hideElement(c)}else{showElement(c)}}function updateFeedTimes(f,c){var b=$$(f);var d;for(var a=0;a<b.length;a++){d=dateToString(Number(b[a].getAttribute("time")));if(d!="false"){b[a].innerHTML=d}}b=[];if(c){b=$$(c)}for(a=0;a<b.length;a++){d=dateToString(Number(b[a].getAttribute("time")));if(d!="false"){b[a].innerHTML=d}}setTimeout("updateFeedTimes('"+f+"'"+(c?",'"+c+"'":"")+")",5000)}function updateAnnotations(a){if(!a){var c=chart.objectModel.annotations.annotationList;for(var b=0;b<c.length;b++){if(c[b]!=null){c[b].allowEdit=false}}chart.applyConfigChanges()}}function openNewChart(){var a=httpServerPath+"/forex-charts/";var b=$$("#chartsMenu li[chartItem]");a+="nc";window.location=a}function changeDateTotimestamp(object,type,userTime){for(var o in object){if(o=="firstTimeAnchor"||o=="secondTimeAnchor"||o=="thirdTimeAnchor"||o=="timeAnchor"){if(type==1){object[o]=object[o].getTime()-(userTime)}else{if(type==0){object[o]=new Date(eval(object[o])+(userTime))}else{if(type==2){object[o]=new Date(object[o].getTime()+(userTime))}}}}if((typeof object[o]=="object")){changeDateTotimestamp(object[o],type,userTime)}}return object}function chartUpdate(data){try{var type=data.type;var uid=Number($F("userId"));switch(type){case"inbox":var span=new Element("span",{});span.innerHTML=data.data;var updateInboxCount=data.updateInboxCount;removeExistsChildren(span,"inboxNotify");if($("inboxNotificationsTB")){$("inboxNotificationsTB").insertBefore(span,$("inboxNotificationsTB").firstChild);var inboxActivityCount=Number($("newInboxNotification").innerHTML);if(updateInboxCount){if(inboxActivityCount==0){$("newInboxNotification").className="countRed"}$("newInboxNotification").innerHTML=inboxActivityCount+1}updateFeedScrooler("inboxNotify",false)}newBubble(data.bubbleData);break;case"notifications":var span=new Element("span",{});var chartOid=data.chartOid;var wallPost=data.wallPost;var notificationType=data.notificationType;var notificationData=data.data;var bubbleData=data.bubbleData;if(hasText(notificationData)){if(uid!=data.from&&chartOid!=null&&lastChartId!=chartOid&&wallPost!=null){updateChartNotification(false,chartOid)}span.innerHTML=notificationData;if(notificationType!=-1){removeExistChildren(span,"notify")}if($("notificationsTB")){$("notificationsTB").insertBefore(span,$("notificationsTB").firstChild);var activityCount=Number($("newNotification").innerHTML);if(activityCount==0){$("newNotification").className="countRed"}$("newNotification").innerHTML=activityCount+1;updateFeedScrooler("notify",false)}}if(hasText(bubbleData)){newBubble(bubbleData)}var marketNotificationOid=data.marketNotificationOid;if(marketNotificationOid!=undefined){if(data.marketNotifyOff!=undefined&&data.marketNotifyOff){onOffMarketNotify(data.marketSymbolOid,"notifyOff")}removeDeletedMarketNotification(marketNotificationOid)}var calendarNotificationOid=data.calendarNotificationOid;if(calendarNotificationOid!=undefined){if(data.calendarNotificationIsSent!=undefined){onOffCalendarNotify(calendarNotificationOid,data.calendarNotificationIsSent)}}break;case"comment":var commnet=data.data;var postOid=data.post;var chartOid=Number(data.chartOid);var commentOid=Number(data.oid);var commentObject=$("comment"+commentOid);var pending=data.pending;var from=Number(data.from);var commentText=$("commentText"+postOid);if(commentText!=null){commentText.style.height="15px"}if(pending&&from==uid){break}if(commentObject==null){if(postOid!=null){var post=$("post"+postOid);if(post!=null){addChartComment(postOid,commnet,lastChartId)}else{var chartsData=[];if(chartsComments[chartOid]!=null){chartsData=chartsComments[chartOid]}chartsData.push({c:commnet,p:postOid,id:commentOid});chartsComments[chartOid]=chartsData;updateFeedLastTime()}if(uid!=from){goToChartNotification("comment"+commentOid,false,false)}else{wallPostChangeOwnerSettings()}}}break;case"post":chartOid=Number(data.chartOid);post=data.post;post=changeAvatar(post);var lastOid=Number(data.lastOid);from=Number(data.from);if(chartOid!=null&&$("post"+lastOid)==null){if(lastChartId==chartOid){createChartPost(lastOid,post,lastChartId)}else{chartsData=[];if(chartsPosts[chartOid]!=null){chartsData=chartsPosts[chartOid]}var postData={lastOid:{},post:{}};postData.lastOid=lastOid;postData.post=post;chartsData.push(postData);chartsPosts[chartOid]=chartsData;updateFeedLastTime()}if(uid!=from){goToChartNotification("post"+lastOid,true,false)}else{wallPostChangeOwnerSettings()}}else{if(uid==from){wallPostChangeOwnerSettings()}}break;case"annotation":if(uid==data.uid){data.o.allowEdit=true}chart.addAnnotation(changeDateTotimestamp(data.o,0,userTime));chartUpdateMsg("Chart Updated",true);break;case"indicator":if(uid!=data.uid){var mainChart=chart.getChartById("main");var inidcator=data.o.indicator;var chartObject=data.o.chart;if(inidcator!=null||chartObject!=null){if(chartObject==null){var idx=mainChart.technicalIndicators.indexOf(inidcator);if(idx==-1){mainChart.technicalIndicators.push(inidcator)}}else{idx=chart.getChartById(chartObject.id);if(idx==null){chart.objectModel.settings.charts.push(chartObject)}}chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true)}}break;case"annotationRemove":var id=data.o.id;if(id!=null){chart.removeAnnotation(id)}chartUpdateMsg("Chart Updated",true);break;case"indicatorRemove":var chartId=data.o.chart;var indicator=data.o.indicator;if(chartId&&chartId!="main"){var list=chart.objectModel.settings.charts;for(var i=0;i<list.length;i++){if(list[i].id==chartId){list.splice(i,1);break}}}else{mainChart=chart.getChartById("main");list=mainChart.technicalIndicators;for(var i=0;i<list.length;i++){if(indicator.id==list[i].id){list.splice(i,1)}}}chartUpdateMsg("Chart Updated",true);chart.applySettingsChanges();break;case"annotationRemoveAll":chart.removeAllAnnotations();chartUpdateMsg("Chart Updated",true);break;case"users":var users=data.users;id=data.id;var usersObject={users:users,notConnected:data.notConnected};if(id!=null){chartsArray[id].users=usersObject}if(id==lastChartId){updateChartUsers(usersObject)}break;case"votes":var vote=data.vote;var chartOid=data.chartOid;if(chartOid!=null){chartsArray[chartOid].totalVotes=vote;var chartVoteCount=$("chartVoteCount");if(vote!=null&&chartVoteCount!=null&&lastChartId==chartOid){chartVoteCount.innerHTML=vote;if(!effectActive){effectActive=true;jQuery("#chartVoteCount").effect("pulsate",{times:4},1500,function(){effectActive=false})}}}break;case"following":var following=data.following;id=data.id;if(following!=null&&id!=null){chartsArray[id].subscribers=following;var chartFollowCount=$("chartFollowCount");if(chartFollowCount!=null&&lastChartId==id){chartFollowCount.innerHTML=following;if(!effectActive){effectActive=true;jQuery("#chartFollowCount").effect("pulsate",{times:4},1500,function(){effectActive=false})}}}break;case"removePost":var oid=data.oid;chartOid=data.chartOid;post=$("post"+oid);var postText=$("postText"+oid);if(postText!=null){postText.remove()}if(post!=null){post.remove();chartsArray[lastChartId].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",false)}else{chartsData=[];if(chartsPosts[chartOid]!=null){chartsData=chartsPosts[chartOid]}var postData={oid:oid,remove:true};chartsData.push(postData);chartsPosts[chartOid]=chartsData}break;case"removeComment":var oid=data.oid;chartOid=data.chartOid;var postId=data.postId;var comment=$("comment"+oid);if(comment!=null){comment.remove();chartsArray[lastChartId].feedObject=jQuery("#feedData").clone();updateFeedScrooler("chartDiscussion",false)}else{chartsData=[];if(chartsComments[chartOid]!=null){chartsData=chartsComments[chartOid]}var postData={oid:oid,remove:true,p:postId};chartsData.push(postData);chartsComments[chartOid]=chartsData}break;case"removeChart":showElement("chartDeleted");break;case"compare":var symbol=data.o.symbol;var element=$(data.o.elementId);if(element!=null){getQuotesData(element,symbol);hideElement("chartSecondSymbol");hideElement("chartThirdSymbol");chartUpdateMsg("Chart Updated",true)}break;case"removeFollowing":updateChartSubscribersResponse(data,false);break;case"addFollowing":updateChartSubscribersResponse(data,true);break;case"indicatorEdit":var mainChart=chart.getChartById("main");var inidcator=data.o.indicator;var chartObject=data.o.chart;if(inidcator!=null||chartObject!=null){if(chartObject==null){var indicatorsList=mainChart.technicalIndicators;for(var i=0;i<indicatorsList.length;i++){if(indicatorsList[i].id==inidcator.id){}indicatorsList[i]=inidcator;break}}else{var chartsList=chart.objectModel.settings.charts;for(var j=0;j<chartsList.length;j++){if(chartsList[j].id==chartObject.id){chartsList[j]=chartObject;break}}}chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true)}break;case"textColor":$("textColor").setAttribute("hex",data.o);changeTextColor(true,false,false);chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true);break;case"backroundColor":$("chartProfileBackgroundColor").setAttribute("hex",data.o);changeChartBackroundColor(null,true,false,false);chart.applySettingsChanges();chartUpdateMsg("Chart Updated",true);break;case"gridColor":$("chartProfileGridColor").setAttribute("hex",data.o);changeChartGridColor(false);chartUpdateMsg("Chart Updated",true);break;case"scrollerColor":$("scrollerColor").setAttribute("hex",data.o);changeScrollerColor(false);chartUpdateMsg("Chart Updated",true);break;case"candlestickSettings":var element=$(data.o.id);dataSetType=data.o.dataSetType;element.setAttribute("hex",data.o.color);changeCandlestickSettings(element,false);chartUpdateMsg("Chart Updated",true);break;case"showGrid":showGrid(data.o,false);chartUpdateMsg("Chart Updated",true);break;case"seriesTypeChange":element=$$("#seriesType li[value="+data.o.id+"]")[0];dataSetType=data.o.dataSetType;if(element!=null){onSeriesTypeChange(element,false,false);chartUpdateMsg("Chart Updated",true)}break;case"ohlcSettings":dataSetType=data.o.dataSetType;element=$(data.o.id);if(element!=null){element.setAttribute("hex",data.o.color);changeOhlcSettings(element,false);chartUpdateMsg("Chart Updated",true)}break;case"seriesColorChange":dataSetType=data.o.dataSetType;$("chartProfileSeriesColor").setAttribute("hex",data.o.color);onSeriesColorChange(false);chartUpdateMsg("Chart Updated",true);break;case"loadTemplate":var template=data.o.template;if(template!=null){templates[data.o.id]=template;loadTemplate(data.o.id,"",false);chartUpdateMsg("Chart Updated",true)}break;case"chartsActivity":var div=new Element("div",{style:"display:none"});var chartsActivity=data.chartsActivity;var chartObject=data.chart;var chartTimeScale=data.timeScale;var chartSymbols=data.symbols;var symbols=getCheckBoxesValues("chartSymbol").split(",");var timeSacles=getCheckBoxesValues("chartTimeScale").split(",");if(jQuery.inArray(chartTimeScale.toString(),timeSacles)!=-1&&(jQuery.inArray(chartSymbols[0],symbols)!=-1||jQuery.inArray(chartSymbols[1],symbols)!=-1||jQuery.inArray(chartSymbols[2],symbols)!=-1)){if(chartsActivity!=null){var activityOid=data.activity;if(activityOid!=null&&$("activity"+activityOid)==null){var chartsActivitySpan=$("chartsActivity");if(eval(chartsActivitySpan.getAttribute("empty"))==true){chartsActivitySpan.innerHTML=""}chartsActivitySpan.setAttribute("empty",false);div.innerHTML=chartsActivity;chartsActivitySpan.insertBefore(div,chartsActivitySpan.firstChild);jQuery(div).slideDown(300)}}if(chartObject!=null){var chartOid=data.chartOid;if(chartOid!=null&&$("publishChart"+chartOid)==null){var publishCharts=$("publishCharts");if(eval(publishCharts.getAttribute("empty"))==true){publishCharts.innerHTML=""}var div=new Element("div",{style:"display:none"});div.innerHTML=chartObject;publishCharts.insertBefore(div,publishCharts.firstChild);jQuery(div).slideDown(600);publishCharts.setAttribute("empty",false)}}}break;case"chartLastUpdate":var time=data.o.time;id=data.o.id;if(id!=null&&time!=null){fxWebsocket.updateChartData(id,time)}break;case"updateAccount":loadAccountToChart(lastChartId,false);break}var chartUpdateElement=$("lastUpdate");if(chartUpdateElement!=null){var updateTime=new Date().getTime();chartUpdateElement.setAttribute("time",updateTime);chartUpdateElement.innerHTML=dateToString(updateTime)}}catch(e){}}function showChartMsg(f,b){try{var c=$("chartMsg");var a={resizable:false};a.close=function(g,h){jQuery.destroy(c)};c.innerHTML=f;if(b!=null){c.appendChild(b)}var f=jQuery(c).dialog({modal:true,buttons:{Ok:function(){f.dialog("close")}}})}catch(d){}}function createChartUrl(f,g,h,b,d,a){var c=["/forex-charts/",d.replace("/",""),"/",f,"/",a];if(g!=null&&h!=null){c.push("/",f,",",g,",",h)}if(b!=null){c.push(",",b)}return c.join("")}var lastChartUpdateTime=0;var notificationTime=5*1000*60;function wallPostChangeOwnerSettings(){$("userComment").style.height="16px";$("userComment").value="";var a=$("chartFollow");if(a!=null){a.checked=true}}function chartUpdateMsg(c,a){var b=$("chartUpdated");if(b!=null){b.innerHTML=c;if(a){if(!effectActive){effectActive=true;jQuery("#chartUpdated").effect("pulsate",{times:3},3000).fadeOut(function(){effectActive=false})}}else{showElement(b.id)}}}function displayRemovePostOrComment(b,c,f,g){var a=b.getAttribute("uid");var d=$(g);if(d!=null&&d.className.indexOf("owner")!=-1||($F("userId")==a)){displayElementByClass(c,f)}}function feedSlideDown(a,b){jQuery(a).slideDown(300,function(){updateFeedScrooler(b,false)})}function updateChartSubscribersResponse(h,d){if(d){var b=h.name;var g=h.user;var l=h.invitation;if(hasText(b)&&hasText(g)){var c=createChartUrl(lastChartId,null,null,null,b,l);var m=new Element("li",{});var o=new Element("br",{});var k=new Element("span",{className:"gray font10"});k.innerHTML=g;var a=new Element("a",{id:"chartMenuFollowItem"+lastChartId,href:c});a.innerHTML=b;a.appendChild(o);a.appendChild(k);m.appendChild(a);$("chartsFollowingMenu").appendChild(m);if($$("#chartsFollowingMenu li").size()>=2){hideElement("chartMenuFollowItemNoCharts")}}}else{var f=$("chartMenuFollowItem"+lastChartId);if(f!=null){f.parentNode.remove()}if($$("#chartsFollowingMenu li").size()<2){showElement("chartMenuFollowItemNoCharts")}}}function connectionLostMsg(){try{if(!showDisconnectMsg){var b=$("chartMsg");var a={resizable:false};a.close=function(f,g){jQuery.destroy(b)};b.innerHTML="Connection lost. Reconnecting... <br/><br/> <div class='center'><img src='/images/loader4.gif'/></div>";var d=jQuery(b).dialog({modal:true,buttons:{Ok:function(){d.dialog("close")}}});showDisconnectMsg=true}}catch(c){}}function getChartQuotes(a){fxAjax.sendRequest(fxVars.getChartQuotes+lastChartId+"&invite="+chartsArray[lastChartId].i+"&symbol="+a,{params:{oid:lastChartId},callback:"getChartQuotesResponse"})}function getChartQuotesResponse(response,params){if(!response.error){var config=response.content.config;var quotesData=response.content.quotesData;var timeScale=response.content.timeScale;chart.setConfig(config);var lastPoint=response.content.lastPoint;if(lastPoint!=null){chartsArray[params.oid].lastPoints=eval("("+lastPoint+")")}if(quotesData){createIndicatorsLinks();initSeriesSettings();if(timeScale!=null&&quoteTime!=timeScale){quoteTime=timeScale;changeTimeScale(quoteTime);changeCurrentTabName(false);updateChartMenu()}updateAnnotations(eval($F("chartOwner")))}else{showChartMsg("Chart is not available currently, please try again later.<br/><br/>We apologize for the inconvenience.")}}chartLoading=false}function updateChartNotification(a,c){var b=$("chartNotification"+c);if(b!=null){if(a){b.innerHTML=0;hideElement(b.id)}else{b.innerHTML=Number(b.innerHTML)+1;showElement(b.id)}}}function updateChartLink(){try{var b=chartsArray[lastChartId];var a=serverPath+"/forex-charts/"+$("chartName"+lastChartId).innerHTML.replace("/","").replace(" ","")+"/"+lastChartId+(!b.p?"/"+b.i:"")}catch(c){$("linkToChartInput").value=""}$("linkToChartInput").value=a;showElement("linkToChart")}function selectDefaultTemplate(){$("tempateSelectName").innerHTML=defaultTemplate+'<img alt="" src="../../../images/controlDown.png">';var b=$$("#templateList li");for(var a=0;a<b.length;a++){if(b[a].getAttribute("default")!=null){b[a].className="selected"}else{b[a].className=""}}}function feedChannelSubscribe(a){var d=0;var f=$$("#userMessages [time]");for(var b=0;b<f.length;b++){var c=Number(f[b].getAttribute("time"));d=(c>d)?c:d}if(d==0){d=getMetaContent("server-timestamp")}if(a){fxWebsocket.subscribe(feed_subscribe,lastChartId,d,chartsArray[lastChartId].i)}onOpenArray.push("fxWebsocket.subscribe('"+feed_subscribe+"','"+lastChartId+"','"+d+"','"+chartsArray[lastChartId].i+"')")}function updateFeedLastTime(){fxWebsocket.updateChartData(feed_subscribe+lastChartId,dt.getTime())}function pushToAnnotationList(c,a){var b;if(a){b=annotationUndoList[lastChartId]}else{b=annotationRedoList[lastChartId]}if(b==null){b=[];(a)?annotationUndoList[lastChartId]=b:annotationRedoList[lastChartId]=b}b.push(c)}function getChartVotesOrFollowing(b,a){if((Number($("chartVoteCount").innerHTML)!=0&&a)||(Number($("chartFollowCount").innerHTML)!=0&&!a)){if(a){$("chartVotes").innerHTML="";showElement("chartVotesLoader");showElement("chartVotesWindow")}else{$("chartFollowingUsers").innerHTML="";showElement("chartFollowingUsersLoader");showElement("chartFollowingWindow")}fxAjax.sendRequest(fxVars.getChartVotesOrFollowing+lastChartId+"&invite="+chartsArray[lastChartId].i+"&vote="+a,{callback:"getChartVotesOrFollowingResponse"})}}function getChartVotesOrFollowingResponse(a){if(!a.error){var c=a.content.chartVotes;var b=a.content.followingUsers;if(c!=null){hideElement("chartVotesLoader");$("chartVotes").innerHTML=c;createScroller("chartVotesScroller")}if(b!=null){hideElement("chartFollowingUsersLoader");$("chartFollowingUsers").innerHTML=b;createScroller("chartFollowingUsersScroller")}}}function updateChartUsers(h){if(h!=null){var b=h.users;var o=$("connectedUsers");var m=$("connectedUsersCount");var g=$("notConnectedCount");o.innerHTML="";var c=0;if(b!=null){c=b.length}var l=new Element("span",{});var d=false;if(b!=null&&c>0){l.innerHTML=": ";for(var f=0;f<c;f++){if(b[f]=="Staff"){d=true;continue}var k=new Element("a",{className:"underline"});k.innerHTML=b[f];k.href="/members/"+b[f];k.target="_blank";l.innerHTML=l.innerHTML+k.outerHTML;if(f!=c-1){l.innerHTML=l.innerHTML+", "}else{l.innerHTML=l.innerHTML+"."}}}else{l.innerHTML=". "}if(d){c=c-1}o.appendChild(l);if(b!=null){$("connectedUsersCount").innerHTML=c}$("notConnectedCount").innerHTML=h.notConnected;$("totalConnectedCount").innerHTML=parseInt(c)+parseInt(h.notConnected);if(!effectActive){effectActive=true;jQuery("#totalConnectedCount").effect("pulsate",{times:4},1500,function(){effectActive=false})}}}var quoteData={};var lastClose=0;function updateQuotes(o){var q=o[5];var v=o[8];var t=o[7];var g=o[6];var b=o[4];var k=0;var a=(hasText(o[9]))?Number(o[9])+(userTime):null;var f=(hasText(o[1]))?symbolOidToNameMap[o[1]]:null;var s=o[2];for(var h in chartsArray){var u=chartsArray[h].o;var m=u.getChartById("main");if(m!=null){var d=m.seriesList;for(var l=0;l<d.length;l++){var c=Number(b)+(userTime)-k*1000*60;if(d[l].name==f&&chartsArray[h].t==s){if(h==lastChartId&&chartsArray[h].loaded!=null){if(a!=null){u.appendData(chartsDataSets[l],a+",,,,;")}if(hasText(c)&&lastClose!=v){u.appendData(chartsDataSets[l],c+","+q+","+g+","+t+","+v);u.commitDataChanges()}lastClose=v}else{if(quoteData[h]==null){quoteData[h]={}}var r=quoteData[h];r[c]={p:","+q+","+g+","+t+","+v+";",d:chartsDataSets[l]};if(a!=null){r[a]={p:",,,,;",d:chartsDataSets[l]}}}}}}}}function addQuoteDataPoints(d){var b=quoteData[d];if(b!=null){for(var c in b){var a=b[c];chart.appendData(a.d,c+a.p)}chart.commitDataChanges();delete quoteData[d]}}function updateChartFacebookData(b,a){$("chartFacebook").setAttribute("content",serverPath+"/chartImage.png?oid="+b);$("chartFacebookTitle").setAttribute("content",a+" Analysis By "+$F("chartOwnerName"))}function changeAvatar(f){var c=new Element("span",{className:"underline"}).update(f);var a=$F("avatarUrl");var d=jQuery(c).find("img.avatarElement");for(var b=0;b<d.length;b++){if(d[b]!=null){d[b].setAttribute("src",a)}}return c.innerHTML}function changeSeriesFormat(){var k=chart.getChartById("main");var g=k.seriesList;var a=k.technicalIndicators;if(g!=null){for(var f=0;f<g.length;f++){var d=g[f];var h=symbolsDecimals[d.name];var b=(h!=null)?h:5;if(hasText(b)){d.legendItem.labels.focusSettings.mouseOut.format='<textformat><font size="10" color="#000000">{%SeriesName}:  </font></textformat><textformat><font color="#000000">O: {%Open.LastVisible}{numDecimals:'+b+",plusSign:false}   H: {%High.LastVisible}{numDecimals:"+b+",plusSign:false}   L: {%Low.LastVisible}{numDecimals:"+b+",plusSign:false}   C: {%Close.LastVisible}{numDecimals:"+b+",plusSign:false}</font></textformat>";d.legendItem.labels.focusSettings.mouseOver.format='<textformat><font size="10" color="#000000">{%SeriesName}:  </font></textformat><textformat><font color="#000000">O: {%Open.Current}{numDecimals:'+b+",plusSign:false}   H: {%High.Current}{numDecimals:"+b+",plusSign:false}   L: {%Low.Current}{numDecimals:"+b+",plusSign:false}   C: {%Close.Current}{numDecimals:"+b+",plusSign:false}</font></textformat>"}}}for(var c=0;c<a.length;c++){loadIndicator(a[c],"main",true)}}function setAccountToChart(a){var b=[$F("accountCombo"),"&chartId=",lastChartId];fxAjax.sendRequest(fxVars.setOpenTrades+b.join(""),{callback:"setAccountToChartResponse"})}function setAccountToChartResponse(a){if(!a.error){loadAccountToChart(lastChartId,true)}}function loadAccountToChart(b,a){fxAjax.sendRequest(fxVars.loadOpenTrades+b+"&symbol="+getFilteredSymbolName($F("chartFirstSymbol"))+"&invite="+chartsArray[b].i,{params:{update:a,id:b},callback:"loadAccountToChartResponse"})}var accountTimeout;function loadAccountToChartResponse(response,params){clearTimeout(accountTimeout);var error=true;removeAccountAnnotation(params.id);if(!response.error){if(response.content.accountOid==undefined){accountOid=0}else{accountOid=parseInt(response.content.accountOid)}chartsArray[params.id].accountLoaded=true;chartsArray[params.id].accountOid=accountOid;setSelectedAccount(accountOid);if(accountOid!=NO_ACCOUNT){chart.objectModel.eventMarkers.groups=eval("("+response.content.config+")").groups;if(response.content.openTrades!=undefined){openTradesHistoryEvents=response.content.openTrades}if(response.content.history!=undefined){historyEvents=response.content.history}var annotations=eval("("+response.content.config+")").annotations.annotationList;if(annotations!=undefined){for(var i=0;i<annotations.length;i++){chart.addAnnotation(annotations[i]);chartsArray[params.id].accountAnnotation.push(annotations[i].id)}}if(hasText(response.content.url)){$J("#linkToSystem").attr("href",response.content.url);showElement("linkToSystem")}else{hideElement("linkToSystem")}error=false}else{error=true}}if(error){chart.objectModel.eventMarkers.groups=[];chartsArray[params.id].accountOid=0;setSelectedAccount(0);hideElement("linkToSystem")}if(params.update){var object={type:"updateAccount",callback:"chartUpdate"};fxWebsocket.sendToChart(lastChartId,object)}chart.applyEventMarkersChanges();chart.applySettingsChanges();accountTimeout=setTimeout("loadAccountToChart(lastChartId,false)",60000)}function removeAccountAnnotation(c){var b=chart.getAnnotationListAsJSON();for(var a=0;a<b.length;a++){if(isContains(chartsArray[c].accountAnnotation,b[a].id)){chart.removeAnnotation(b[a].id)}}chartsArray[c].accountAnnotation=[]}function setSelectedAccount(b){if(b!=undefined&&owner){var a=$$("#accountCombo [value="+b+"]")[0];if(a!=undefined){$$("#accountCombo [value="+b+"]")[0].selected=true}}}function getFilteredSymbolName(a){switch(a){case GOLD_SYMBOL_NAME:a=GOLD;break;case SILVER_SYMBOL_NAME:a=SILVER;break}return a}var popups=["notificationCont","inboxNotificationCont","userPanel","searchbar"];function hideSearchForm(){$("searchForm").className="searchFormOff";$("search").value="";hideElement("searchForm");showElement("searchButton")}jQuery(document).keydown(function(a){if(a.keyCode==27){popups.each(function(b){if(b=="searchbar"){hideSearchForm()}else{hideElement(b)}})}});jQuery(document).ready(function(){popups.each(function(b){var a=jQuery("#"+b)[0];jQuery(document).on("click",function(c){if(jQuery(c.target).closest(a).length===0){if(b=="searchbar"){hideSearchForm()}else{jQuery(a).hide()}}})})});function hideAllMenus(){popups.each(function(b){var a=jQuery("#"+b)[0];if(b=="searchbar"){hideSearchForm()}else{jQuery(a).hide()}})}var updatingNotifications=false;var endPaging=false;var activityLoaded=false;var ACTIVITY_PRELOAD=1;var ACTIVITY_LOAD=2;var ACTIVITY_PAGING=3;function updateNotifications(d,f,c){var l=isVisible("notificationCont");var k=(f==ACTIVITY_PRELOAD);var a=(f==ACTIVITY_PAGING);var g=parseInt($("newNotification").innerHTML);var b=false;switch(f){case ACTIVITY_PRELOAD:if(!activityLoaded){activityLoaded=true;b=true}else{return}break;case ACTIVITY_LOAD:if(activityLoaded){if(!l){hideAllMenus();showElement("notificationCont")}else{if(c==null||(c!=null&&!c)){hideElement("notificationCont")}}}if(updatingNotifications){return}b=(g!=0);updateFeedScrooler("notify");break;case ACTIVITY_PAGING:showElement("notificationCont");b=true;break}if(b){updatingNotifications=true;var h="";if(a){h="&firstOid="+$("newNotification").getAttribute("oid")}if(!a||(a&&!endPaging)){fxAjax.sendRequest(fxVars.updateNotifications+"&preload="+k+h,{params:{paging:a,element:d,preload:k},loader:false,callback:"updateNotificationsResponse"});showElement("activityLoader")}else{hideElement("activityLoader");updatingNotifications=false}}}function updateNotificationsResponse(a,f){if(!a.error&&a.content){var b=a.content.notifications;var d=a.content.notificationOid;if(d!=null){$("newNotification").setAttribute("oid",d)}else{endPaging=true}if(hasText(b)){var c=new Element("span",{});c.innerHTML=b;removeExistChildren(c,"notify");$("notifyTb").appendChild(c);updateFeedScrooler("notify")}if(!f.preload){$("newNotification").innerHTML=0;$("newNotification").className="countRed grayBG"}else{if(isVisible("notificationCont")){updatingNotifications=false;updateNotifications($("notificationCont"),ACTIVITY_LOAD,true)}}}hideElement("activityLoader");updatingNotifications=false}var updatingInboxNotification=false;var endInboxPaging=false;var activityInboxLoaded=false;function updateInboxNotifications(c,g){var f=isVisible("inboxNotificationCont");var b=(g==ACTIVITY_PAGING);var a=false;switch(g){case ACTIVITY_PRELOAD:if(!activityInboxLoaded){activityInboxLoaded=true;a=true}else{return}break;case ACTIVITY_LOAD:if(activityInboxLoaded){if(f){hideElement("inboxNotificationCont")}else{hideAllMenus();showElement("inboxNotificationCont")}}if(updatingInboxNotification){return}updateFeedScrooler("inboxNotify");break;case ACTIVITY_PAGING:showElement("inboxNotificationCont");a=true;break}if(a){updatingInboxNotification=true;var d="";if(b){d="&firstOid="+$("newInboxNotification").getAttribute("oid")}if(!b||(b&&!endInboxPaging)){fxAjax.sendRequest(fxVars.updateInboxNotifications+d,{params:{paging:b,element:c},loader:false,callback:"updateInboxNotificationsResponse"});showElement("inboxActivityLoader")}else{hideElement("inboxActivityLoader");updatingInboxNotification=false}}}function updateInboxNotificationsResponse(a,d){if(!a.error&&a.content){var f=a.content.inboxNotifications;var c=a.content.inboxNotificationsOid;if(c!=null){$("newInboxNotification").setAttribute("oid",c)}else{endInboxPaging=true}if(hasText(f)){var b=new Element("span",{});b.innerHTML=f;removeExistsChildren(b,"inboxNotify");$("inboxNotifyTb").appendChild(b);updateFeedScrooler("inboxNotify")}}hideElement("inboxActivityLoader");updatingInboxNotification=false}function showBugReportDialog(b){var a={};a.width=512;if(b){a.height=347}else{a.height=446}a.resizable=false;a.modal=true;a.title=$T("tBugReport");a.close=function(c,d){$JD.destroy("#reportBugForm");hideElement("bugSent");showElement("bugFormContent");jQuery("#reportBugForm [name=bugReportFileRemove]").each(function(){this.click()})};initBugForm();$JD.create("#reportBugForm",a);$J("#bugDescription").focus()}function showResendActivationDialog(){var a={};a.width=450;a.height=103;a.resizable=false;a.modal=true;a.title=$T("tResendActivation");a.close=function(b,c){$JD.destroy("#activation");$("emailActivation").value="";hideElement("activationResponse");hideElement("activationClose");showElement("activationCont")};$JD.create("#activation",a)}function showForgotPasswordDialog(){var a={};a.width=450;a.height=103;a.resizable=false;a.modal=true;a.title=$T("tResetPassword");a.close=function(b,c){$JD.destroy("#forgotPassword");$("emailForgot").value="";hideElement("forgotResponse");showElement("forgotCont")};$JD.create("#forgotPassword",a)}function getUserVouchers(a){if(hasText(a)&&!hasText($("vouchers").innerHTML)){fxAjax.sendRequest(fxVars.getUserVouchers+a,{loader:true,callback:"getUserVouchersResponse"})}else{showHideElement("vouchers")}}function getUserVouchersResponse(a){if(!a.error){$("vouchers").innerHTML=a.content.data;showElement("vouchers")}else{inlineMsg("vouchersButton","<b>"+$T("tError")+"</b><br>"+a.message,3)}}function sortPortfolioMenu(){var c=$J(".sortableLi");var a=[];for(var b=0;b<c.length;b++){a.push(c[b].id)}fxAjax.sendRequest(fxVars.saveUserPortfolioMenuOrder+a,{params:{},callback:""})}function getCotStatement(f,c,d){var a=["?type=",c,"&data=",d];var b=$(f+"Statement").href;if($is(b)){$(f+"Statement").href=b.substring(0,b.indexOf("?")!=-1?b.indexOf("?"):b.length)+a.join("")}}function showUpdateInvestorPassPopup(){var a={};a.top=535;a.resizable=false;a.close=function(b,c){$JD.destroy("#investorPassInputPopup");$("investorPassword").value="";hideElement("investorPassChanged");showElement("investorPasswordLabel");showElement("investorPassword");showElement("saveButton");showElement("cancelButton")};$JD.create("#investorPassInputPopup",a)}function updateInvestorPass(){if(validate("accountOid",VALID_ACCOUNT)&&validate("investorPassword",VALID_ACCOUNT_PASSWORD)){var a=$F("accountOid");var b=$F("investorPassword");var c=[];c.push(a);c.push("&investorPassword="+encodeParameter(b));fxAjax.sendRequest(fxVars.updateInvestorPassword+c.join(""),{params:{},callback:"updateInvestorPassResponse"})}}function updateInvestorPassResponse(a){if(!a.error){hideElement("investorPasswordLabel");hideElement("investorPassword");hideElement("saveButton");hideElement("cancelButton");$("investorPassChanged").style.display="block";$("investorPassword").value="";setTimeout(function(){$JD.close("#investorPassInputPopup")},1000)}}var contestAnalysisChartsDivs=["winBalance","lossBalance","margin","winTrades","lossTrades","pie","winAvgPips","lossAvgPips"];var contestAnalysisChartsData=["winBalanceChartData","lossBalanceChartData","marginCalledChartData","winTradesChartData","lossTradesChartData","pieChartData","winAvgPipsChartData","lossAvgPipsChartData"];function getContestAnalysisCharts(a,b){if(a.length>0){fxAjax.sendRequest(fxVars.getContestAnalysisCharts+b,{params:{charts:a},callback:"getContestAnalysisChartsResponse"})}}function getContestAnalysisChartsResponse(a,d){if(!a.error){if(d.charts){for(var c=0;c<d.charts.length;c++){var b=jQuery.parseJSON((a.content[contestAnalysisChartsData[c]]));d.charts[c].setDataJson(b)}}}}function getCheckBoxIntValue(a){return($(a)!=null&&$(a).checked)?1:0}var loginDialogHeight=265;var registrationDialogHeight=411;var registrationCompleteDialogHeight=180;var loginDialogRegistrationWidth=320;function showLoginDialog(){var a=jQuery("#loginDialog").dialog({resizable:false,modal:true,height:loginDialogHeight,width:loginDialogRegistrationWidth,buttons:[{text:"Login",click:loginDialog},{text:"Cancel",click:function(){a.dialog("close")}}]})}function loginDialog(){if(validate("loginDialogEmail",VALID_EMAIL)&&validate("loginDialogPassword",VALID_PASSWORD)){var a=["loginEmail=",$("loginDialogEmail").value,"&loginPassword=",encodeParameter($("loginDialogPassword").value),"&remember=",$("loginDialogRemember").checked];fxAjax.sendRequest(fxVars.loginUrl+a.join(""),{contentType:"text/xml",params:{loginRedirect:getAuthRedirectUrl()},loader:true,callback:"loginDialogResponse"})}}function loginDialogResponse(d,f){var a=d.getElementsByTagName("response")[0];var b=a.getAttribute("error");var c=a.getAttribute("message");if(b=="false"){if(hasText(f.loginRedirect)){window.location=f.loginRedirect}else{window.location=serverPath+"/dashboard"}}else{$("loginDialogResponse").innerHTML=c}}var accountRegType;function registrationDialog(){if(validate("registrationDialogUserName",VALID_USER_NAME)&&validate("registrationDialogEmail",VALID_EMAIL)&&validate("registrationDialogPassword",VALID_PASSWORD)&&validate("registrationDialogConfirmPassword",VALID_PASSWORD_CONFIRM3)&&validate("registrationDialogCaptcha",VALID_CAPTHCA)&&validate("registrationDialogAgree",VALID_AGREE)){var a=["username=",$("registrationDialogUserName").value,"&email=",$("registrationDialogEmail").value,"&password=",encodeParameter($("registrationDialogPassword").value),"&captcha=",$("registrationDialogCaptcha").value];fxAjax.sendRequest(fxVars.regUrl+a.join(""),{contentType:"text/xml",params:{registrationRedirect:window.location.href},loader:true,callback:"registrationDialogResponse"})}}function registrationDialogResponse(g,h){var b=g.getElementsByTagName("response")[0];var c=b.getAttribute("error");var f=b.getAttribute("code");var d=b.getAttribute("message");if(c=="false"){$("registrationContent").innerHTML="<div class='font12 lh18 center'>"+d+"</div><br/><br/><a class=\"bold underline\" style='color:#0066ff;' href='javascript:switchRegistrationToLoginDialog()' >Login</a><span id='registrationResponse' class='red' style='padding-left:50px'></span>";var a=jQuery("#loginDialog");a.dialog("option","buttons",[{text:"Ok",click:function(){a.dialog("close")}}]);a.dialog("option","height",registrationCompleteDialogHeight);setCookie("reglr",h.registrationRedirect,YEAR,true);if(accountRegType!=undefined){setCookie("rat",accountRegType,YEAR,true)}$J("#registerLink").remove()}else{if(f==30){inlineMsg("registrationDialogUserName","<b>"+$T("tError")+"</b><br>"+d,3)}if(f==7){inlineMsg("registrationDialogCaptcha","<b>"+$T("tError")+"</b><br>"+d,3);reloadCaptcha();clearField("registrationDialogCaptcha")}if(f==13){inlineMsg("registrationResponse","<b>"+$T("tError")+"</b><br>"+d,3)}if(f==8){inlineMsg("registrationDialogEmail","<b>"+$T("tError")+"</b><br>"+d,3)}}}function switchLoginToRegistrationDialog(a){accountRegType=a;switchLoginRegistrationDialog(registrationDialogHeight,"Registration","Register",registrationDialog,"loginContent","registrationContent")}function switchRegistrationToLoginDialog(){switchLoginRegistrationDialog(loginDialogHeight,"Login","Login",loginDialog,"registrationContent","loginContent")}function switchLoginRegistrationDialog(b,h,a,f,g,d){var c=jQuery("#loginDialog");c.dialog("option","height",b);c.dialog("option","title",h);c.dialog("option","buttons",[{text:a,click:f},{text:"Cancel",click:function(){c.dialog("close")}}]);hideElement(g);showElement(d)}function hideShowElementsByName(d,a){var c=document.getElementsByName(d);for(var b=0;b<c.length;b++){a?showElement(c[b]):hideElement(c[b])}}function getAuthRedirectUrl(){var a=$J("#cTraderOauth").val();return(a!=undefined&&hasText(a))?a:window.location.href}
/* Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 *
 * Requires: 1.2.2+
 */
(function(d){var b=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks){for(var a=b.length;a;){d.event.fixHooks[b[--a]]=d.event.mouseHooks}}d.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var f=b.length;f;){this.addEventListener(b[--f],c,false)}}else{this.onmousewheel=c}},teardown:function(){if(this.removeEventListener){for(var f=b.length;f;){this.removeEventListener(b[--f],c,false)}}else{this.onmousewheel=null}}};d.fn.extend({mousewheel:function(f){return f?this.bind("mousewheel",f):this.trigger("mousewheel")},unmousewheel:function(f){return this.unbind("mousewheel",f)}});function c(m){var k=m||window.event,h=[].slice.call(arguments,1),o=0,l=true,g=0,f=0;m=d.event.fix(k);m.type="mousewheel";if(k.wheelDelta){o=k.wheelDelta/120}if(k.detail){o=-k.detail/3}f=o;if(k.axis!==undefined&&k.axis===k.HORIZONTAL_AXIS){f=0;g=-1*o}if(k.wheelDeltaY!==undefined){f=k.wheelDeltaY/120}if(k.wheelDeltaX!==undefined){g=-1*k.wheelDeltaX/120}h.unshift(m,o,g,f);return(d.event.dispatch||d.event.handle).apply(this,h)}})(jQuery);(function(d,f,g){d.fn.jScrollPane=function(a){function b(br,bb){var bk,a9=this,a1,bF,aK,bD,a6,a0,s,aO,bi,bS,bs,aW,bh,aX,aV,bO,a5,bz,a2,aM,bw,by,bJ,bC,bl,aT,bu,bm,aI,bq,bP,aZ,be,bG=true,ba=true,bQ=false,aU=false,bA=br.clone(false,false).empty(),bM=d.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";bP=br.css("paddingTop")+" "+br.css("paddingRight")+" "+br.css("paddingBottom")+" "+br.css("paddingLeft");aZ=(parseInt(br.css("paddingLeft"),10)||0)+(parseInt(br.css("paddingRight"),10)||0);function bx(l){var t,q,r,h,k,m,o=false,u=false;bk=l;if(a1===g){k=br.scrollTop();m=br.scrollLeft();br.css({overflow:"hidden",padding:0});bF=br.innerWidth()+aZ;aK=br.innerHeight();br.width(bF);a1=d('<div class="jspPane" />').css("padding",bP).append(br.children());bD=d('<div class="jspContainer" />').css({width:bF+"px",height:aK+"px"}).append(a1).appendTo(br)}else{br.css("width","");o=bk.stickToBottom&&bf();u=bk.stickToRight&&bv();h=br.innerWidth()+aZ!=bF||br.outerHeight()!=aK;if(h){bF=br.innerWidth()+aZ;aK=br.innerHeight();bD.css({width:bF+"px",height:aK+"px"})}if(!h&&be==a6&&a1.outerHeight()==a0){br.width(bF);return}be=a6;a1.css("width","");br.width(bF);bD.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}a1.css("overflow","auto");if(l.contentWidth){a6=l.contentWidth}else{a6=a1[0].scrollWidth}a0=a1[0].scrollHeight;a1.css("overflow","");s=a6/bF;aO=a0/aK;bi=aO>1;bS=s>1;if(!(bS||bi)){br.removeClass("jspScrollable");a1.css({top:0,width:bD.width()-aZ});aR();bp();a8();aJ()}else{br.addClass("jspScrollable");t=bk.maintainPosition&&(bh||bO);if(t){q=bU();r=bW()}bR();c();bn();if(t){bc(u?(a6-bF):q,false);bd(o?(a0-aK):r,false)}bg();bI();bB();if(bk.enableKeyboardNavigation){a7()}if(bk.clickOnTrack){aP()}bt();if(bk.hijackInternalLinks){aS()}}if(bk.autoReinitialise&&!bq){bq=setInterval(function(){bx(bk)},bk.autoReinitialiseDelay)}else{if(!bk.autoReinitialise&&bq){clearInterval(bq)}}k&&br.scrollTop(0)&&bd(k,false);m&&br.scrollLeft(0)&&bc(m,false);br.trigger("jsp-initialised",[bS||bi])}function bR(){if(bi){bD.append(d('<div class="jspVerticalBar" />').append(d('<div class="jspCap jspCapTop" />'),d('<div class="jspTrack" />').append(d('<div class="jspDrag" />').append(d('<div class="jspDragTop" />'),d('<div class="jspDragBottom" />'))),d('<div class="jspCap jspCapBottom" />')));a5=bD.find(">.jspVerticalBar");bz=a5.find(">.jspTrack");bs=bz.find(">.jspDrag");if(bk.showArrows){by=d('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",bT(0,-1)).bind("click.jsp",bV);bJ=d('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",bT(0,1)).bind("click.jsp",bV);if(bk.arrowScrollOnHover){by.bind("mouseover.jsp",bT(0,-1,by));bJ.bind("mouseover.jsp",bT(0,1,bJ))}bE(bz,bk.verticalArrowPositions,by,bJ)}aM=aK;bD.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){aM-=d(this).outerHeight()});bs.hover(function(){bs.addClass("jspHover")},function(){bs.removeClass("jspHover")}).bind("mousedown.jsp",function(k){d("html").bind("dragstart.jsp selectstart.jsp",bV);bs.addClass("jspActive");var h=k.pageY-bs.position().top;d("html").bind("mousemove.jsp",function(l){a4(l.pageY-h,false)}).bind("mouseup.jsp mouseleave.jsp",bo);return false});aQ()}}function aQ(){bz.height(aM+"px");bh=0;a2=bk.verticalGutter+bz.outerWidth();a1.width(bF-a2-aZ);try{if(a5.position().left===0){a1.css("margin-left",a2+"px")}}catch(h){}}function c(){if(bS){bD.append(d('<div class="jspHorizontalBar" />').append(d('<div class="jspCap jspCapLeft" />'),d('<div class="jspTrack" />').append(d('<div class="jspDrag" />').append(d('<div class="jspDragLeft" />'),d('<div class="jspDragRight" />'))),d('<div class="jspCap jspCapRight" />')));bC=bD.find(">.jspHorizontalBar");bl=bC.find(">.jspTrack");aX=bl.find(">.jspDrag");if(bk.showArrows){bm=d('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",bT(-1,0)).bind("click.jsp",bV);aI=d('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",bT(1,0)).bind("click.jsp",bV);if(bk.arrowScrollOnHover){bm.bind("mouseover.jsp",bT(-1,0,bm));aI.bind("mouseover.jsp",bT(1,0,aI))}bE(bl,bk.horizontalArrowPositions,bm,aI)}aX.hover(function(){aX.addClass("jspHover")},function(){aX.removeClass("jspHover")}).bind("mousedown.jsp",function(k){d("html").bind("dragstart.jsp selectstart.jsp",bV);aX.addClass("jspActive");var h=k.pageX-aX.position().left;d("html").bind("mousemove.jsp",function(l){a3(l.pageX-h,false)}).bind("mouseup.jsp mouseleave.jsp",bo);return false});aT=bD.innerWidth();bH()}}function bH(){bD.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){aT-=d(this).outerWidth()});bl.width(aT+"px");bO=0}function bn(){if(bS&&bi){var k=bl.outerHeight(),h=bz.outerWidth();aM-=k;d(bC).find(">.jspCap:visible,>.jspArrow").each(function(){aT+=d(this).outerWidth()});aT-=h;aK-=h;bF-=k;bl.parent().append(d('<div class="jspCorner" />').css("width",k+"px"));aQ();bH()}if(bS){a1.width((bD.outerWidth()-aZ)+"px")}a0=a1.outerHeight();aO=a0/aK;if(bS){bu=Math.ceil(1/s*aT);if(bu>bk.horizontalDragMaxWidth){bu=bk.horizontalDragMaxWidth}else{if(bu<bk.horizontalDragMinWidth){bu=bk.horizontalDragMinWidth}}aX.width(bu+"px");aV=aT-bu;bK(bO)}if(bi){bw=Math.ceil(1/aO*aM);if(bw>bk.verticalDragMaxHeight){bw=bk.verticalDragMaxHeight}else{if(bw<bk.verticalDragMinHeight){bw=bk.verticalDragMinHeight}}bs.height(bw+"px");aW=aM-bw;bL(bh)}}function bE(q,m,r,k){var h="before",o="after",l;if(m=="os"){m=/Mac/.test(navigator.platform)?"after":"split"}if(m==h){o=m}else{if(m==o){h=m;l=r;r=k;k=l}}q[h](r)[o](k)}function bT(l,h,k){return function(){bj(l,h,this,k);this.blur();return false}}function bj(o,q,h,l){h=d(h).addClass("jspActive");var m,r,t=true,k=function(){if(o!==0){a9.scrollByX(o*bk.arrowButtonSpeed)}if(q!==0){a9.scrollByY(q*bk.arrowButtonSpeed)}r=setTimeout(k,t?bk.initialDelay:bk.arrowRepeatFreq);t=false};k();m=l?"mouseout.jsp":"mouseup.jsp";l=l||d("html");l.bind(m,function(){h.removeClass("jspActive");r&&clearTimeout(r);r=null;l.unbind(m)})}function aP(){aJ();if(bi){bz.bind("mousedown.jsp",function(l){if(l.originalTarget===g||l.originalTarget==l.currentTarget){var o=d(this),h=o.offset(),m=l.pageY-h.top-bh,r,t=true,k=function(){var v=o.offset(),u=l.pageY-v.top-bw/2,x=aK*bk.scrollPagePercent,w=aW*x/(a0-aK);if(m<0){if(bh-w>u){a9.scrollByY(-x)}else{a4(u)}}else{if(m>0){if(bh+w<u){a9.scrollByY(x)}else{a4(u)}}else{q();return}}r=setTimeout(k,t?bk.initialDelay:bk.trackClickRepeatFreq);t=false},q=function(){r&&clearTimeout(r);r=null;d(document).unbind("mouseup.jsp",q)};k();d(document).bind("mouseup.jsp",q);return false}})}if(bS){bl.bind("mousedown.jsp",function(l){if(l.originalTarget===g||l.originalTarget==l.currentTarget){var o=d(this),h=o.offset(),m=l.pageX-h.left-bO,r,t=true,k=function(){var v=o.offset(),u=l.pageX-v.left-bu/2,x=bF*bk.scrollPagePercent,w=aV*x/(a6-bF);if(m<0){if(bO-w>u){a9.scrollByX(-x)}else{a3(u)}}else{if(m>0){if(bO+w<u){a9.scrollByX(x)}else{a3(u)}}else{q();return}}r=setTimeout(k,t?bk.initialDelay:bk.trackClickRepeatFreq);t=false},q=function(){r&&clearTimeout(r);r=null;d(document).unbind("mouseup.jsp",q)};k();d(document).bind("mouseup.jsp",q);return false}})}}function aJ(){if(bl){bl.unbind("mousedown.jsp")}if(bz){bz.unbind("mousedown.jsp")}}function bo(){d("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(bs){bs.removeClass("jspActive")}if(aX){aX.removeClass("jspActive")}}function a4(h,k){if(!bi){return}if(h<0){h=0}else{if(h>aW){h=aW}}if(k===g){k=bk.animateScroll}if(k){a9.animate(bs,"top",h,bL)}else{bs.css("top",h);bL(h)}}function bL(o){if(o===g){o=bs.position().top}bD.scrollTop(0);bh=o;var k=bh===0,m=bh==aW,l=o/aW,h=-l*(a0-aK);if(bG!=k||bQ!=m){bG=k;bQ=m;br.trigger("jsp-arrow-change",[bG,bQ,ba,aU])}aL(k,m);a1.css("top",h);br.trigger("jsp-scroll-y",[-h,k,m]).trigger("scroll")}function a3(k,h){if(!bS){return}if(k<0){k=0}else{if(k>aV){k=aV}}if(h===g){h=bk.animateScroll}if(h){a9.animate(aX,"left",k,bK)}else{aX.css("left",k);bK(k)}}function bK(o){if(o===g){o=aX.position().left}bD.scrollTop(0);bO=o;var k=bO===0,l=bO==aV,m=o/aV,h=-m*(a6-bF);if(ba!=k||aU!=l){ba=k;aU=l;br.trigger("jsp-arrow-change",[bG,bQ,ba,aU])}aN(k,l);a1.css("left",h);br.trigger("jsp-scroll-x",[-h,k,l]).trigger("scroll")}function aL(k,h){if(bk.showArrows){by[k?"addClass":"removeClass"]("jspDisabled");bJ[h?"addClass":"removeClass"]("jspDisabled")}}function aN(k,h){if(bk.showArrows){bm[k?"addClass":"removeClass"]("jspDisabled");aI[h?"addClass":"removeClass"]("jspDisabled")}}function bd(h,l){var k=h/(a0-aK);a4(k*aW,l)}function bc(l,h){var k=l/(a6-bF);a3(k*aV,h)}function bN(l,t,h){var w,z,y,A=0,m=0,k,u,v,q,r,o;try{w=d(l)}catch(x){return}z=w.outerHeight();y=w.outerWidth();bD.scrollTop(0);bD.scrollLeft(0);while(!w.is(".jspPane")){A+=w.position().top;m+=w.position().left;w=w.offsetParent();if(/^body|html$/i.test(w[0].nodeName)){return}}k=bW();v=k+aK;if(A<k||t){r=A-bk.verticalGutter}else{if(A+z>v){r=A-aK+z+bk.verticalGutter}}if(r){bd(r,h)}u=bU();q=u+bF;if(m<u||t){o=m-bk.horizontalGutter}else{if(m+y>q){o=m-bF+y+bk.horizontalGutter}}if(o){bc(o,h)}}function bU(){return -a1.position().left}function bW(){return -a1.position().top}function bf(){var h=a0-aK;return(h>20)&&(h-bW()<10)}function bv(){var h=a6-bF;return(h>20)&&(h-bU()<10)}function bI(){bD.unbind(bM).bind(bM,function(l,k,m,q){var o=bO,h=bh;a9.scrollBy(m*bk.mouseWheelSpeed,-q*bk.mouseWheelSpeed,false);return o==bO&&h==bh})}function aR(){bD.unbind(bM)}function bV(){return false}function bg(){a1.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(h){bN(h.target,false)})}function bp(){a1.find(":input,a").unbind("focus.jsp")}function a7(){var h,m,k=[];bS&&k.push(bC[0]);bi&&k.push(a5[0]);a1.focus(function(){br.focus()});br.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(o){if(o.target!==this&&!(k.length&&d(o.target).closest(k).length)){return}var q=bO,r=bh;switch(o.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:h=o.keyCode;l();break;case 35:bd(a0-aK);h=null;break;case 36:bd(0);h=null;break}m=o.keyCode==h&&q!=bO||r!=bh;return !m}).bind("keypress.jsp",function(o){if(o.keyCode==h){l()}return !m});if(bk.hideFocus){br.css("outline","none");if("hideFocus" in bD[0]){br.attr("hideFocus",true)}}else{br.css("outline","");if("hideFocus" in bD[0]){br.attr("hideFocus",false)}}function l(){var o=bO,q=bh;switch(h){case 40:a9.scrollByY(bk.keyboardSpeed,false);break;case 38:a9.scrollByY(-bk.keyboardSpeed,false);break;case 34:case 32:a9.scrollByY(aK*bk.scrollPagePercent,false);break;case 33:a9.scrollByY(-aK*bk.scrollPagePercent,false);break;case 39:a9.scrollByX(bk.keyboardSpeed,false);break;case 37:a9.scrollByX(-bk.keyboardSpeed,false);break}m=o!=bO||q!=bh;return m}}function a8(){br.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function bt(){if(location.hash&&location.hash.length>1){var k,m,l=escape(location.hash.substr(1));try{k=d("#"+l+', a[name="'+l+'"]')}catch(h){return}if(k.length&&a1.find(l)){if(bD.scrollTop()===0){m=setInterval(function(){if(bD.scrollTop()>0){bN(k,true);d(document).scrollTop(bD.position().top);clearInterval(m)}},50)}else{bN(k,true);d(document).scrollTop(bD.position().top)}}}}function aS(){if(d(document.body).data("jspHijack")){return}d(document.body).data("jspHijack",true);d(document.body).delegate("a[href*=#]","click",function(v){var k=this.href.substr(0,this.href.indexOf("#")),u=location.href,o,m,h,r,t,q;if(location.href.indexOf("#")!==-1){u=location.href.substr(0,location.href.indexOf("#"))}if(k!==u){return}o=escape(this.href.substr(this.href.indexOf("#")+1));m;try{m=d("#"+o+', a[name="'+o+'"]')}catch(l){return}if(!m.length){return}h=m.closest(".jspScrollable");r=h.data("jsp");r.scrollToElement(m,true);if(h[0].scrollIntoView){t=d(f).scrollTop();q=m.offset().top;if(q<t||q>t+d(f).height()){h[0].scrollIntoView()}}v.preventDefault()})}function bB(){var o,q,l,m,k,h=false;bD.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(t){var r=t.originalEvent.touches[0];o=bU();q=bW();l=r.pageX;m=r.pageY;k=false;h=true}).bind("touchmove.jsp",function(r){if(!h){return}var t=r.originalEvent.touches[0],u=bO,v=bh;a9.scrollTo(o+l-t.pageX,q+m-t.pageY);k=k||Math.abs(l-t.pageX)>5||Math.abs(m-t.pageY)>5;return u==bO&&v==bh}).bind("touchend.jsp",function(r){h=false}).bind("click.jsp-touchclick",function(r){if(k){k=false;return false}})}function aY(){var h=bW(),k=bU();br.removeClass("jspScrollable").unbind(".jsp");br.replaceWith(bA.append(a1.children()));bA.scrollTop(h);bA.scrollLeft(k);if(bq){clearInterval(bq)}}d.extend(a9,{reinitialise:function(h){h=d.extend({},bk,h);bx(h)},scrollToElement:function(k,l,h){bN(k,l,h)},scrollTo:function(k,h,l){bc(k,l);bd(h,l)},scrollToX:function(k,h){bc(k,h)},scrollToY:function(h,k){bd(h,k)},scrollToPercentX:function(k,h){bc(k*(a6-bF),h)},scrollToPercentY:function(k,h){bd(k*(a0-aK),h)},scrollBy:function(l,h,k){a9.scrollByX(l,k);a9.scrollByY(h,k)},scrollByX:function(h,l){var m=bU()+Math[h<0?"floor":"ceil"](h),k=m/(a6-bF);a3(k*aV,l)},scrollByY:function(h,l){var m=bW()+Math[h<0?"floor":"ceil"](h),k=m/(a0-aK);a4(k*aW,l)},positionDragX:function(h,k){a3(h,k)},positionDragY:function(k,h){a4(k,h)},animate:function(o,k,h,l){var m={};m[k]=h;o.animate(m,{duration:bk.animateDuration,easing:bk.animateEase,queue:false,step:l})},getContentPositionX:function(){return bU()},getContentPositionY:function(){return bW()},getContentWidth:function(){return a6},getContentHeight:function(){return a0},getPercentScrolledX:function(){return bU()/(a6-bF)},getPercentScrolledY:function(){return bW()/(a0-aK)},getIsScrollableH:function(){return bS},getIsScrollableV:function(){return bi},getContentPane:function(){return a1},scrollToBottom:function(h){a4(aW,h)},hijackInternalLinks:d.noop,destroy:function(){aY()}});bx(bb)}a=d.extend({},d.fn.jScrollPane.defaults,a);d.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){a[this]=a[this]||a.speed});return this.each(function(){var h=d(this),c=h.data("jsp");if(c){c.reinitialise(a)}else{c=new b(h,a);h.data("jsp",c)}})};d.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:g,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);var EMPTY="";function saveMultiplier(c,a){var b="saveMultiplierChanges("+c+")";getAccountRisk(a,"mainRisk",b)}function saveMultiplierChanges(c){var a=$("multiplier"+c);if(a!=null){var b=(parseFloat(a.value)).toFixed(2);fxAjax.sendRequest(fxVars.updateMultiplier+ +c+"&multiplier="+b,{params:{id:c,multiplier:b},loader:false,callback:"updateMultiplierResponse"})}}function restoreMultiplierChanges(g,f){var b=$("multiplier"+g);if(b!=null){var c=b.getAttribute("firstMultiplier");b.value=c;var a=Number($("drawdown"+g).getAttribute("drawdown"));updateRisks(c,a,"mainRisk",g);var d=$("monthly"+g).getAttribute("balance");updateMasterData(g,c,f,d,false);updateSlaveRecommendedBalance(d,false);updateTotal(false)}}function getRisk(g,a,f,d){var c=0;var b;$$("[firstmultiplier]").each(function(m){var k=m.getAttribute("elementId");var h=Number($("drawdown"+k).getAttribute("drawdown"));var l=$("multiplier"+k);var o=Number(Number(parseFloat(l.value)).toFixed(1));if(k!=d){b=o*h}else{b=g*h}if(b>c){c=b}});return c}function getOldRisk(g,a,f,d){var c=0;var b;$$("[firstmultiplier]").each(function(l){var k=l.getAttribute("elementId");var h=Number($("drawdown"+k).getAttribute("drawdown"));var o=$("multiplier"+k).getAttribute("firstMultiplier");var m=Number(Number(parseFloat(o)).toFixed(1));if(k!=d){b=m*h}else{b=g*h}if(b>c){c=b}});return c}var lastMultiplier=0;function updateMultiplier(t,h,v,r,w,l,d,x){var u=false;var k=Number($("drawdown"+t).getAttribute("drawdown"));var q="multiplier"+t;var c=$(q);var g=c.value;var o=parseFloat((parseFloat(c.value)+h).toFixed(2));if(isNaN(c.value)){u=true}var a=(r!=null)?r:$("monthly"+t).getAttribute("balance");var b=$("save"+t);var s=c.getAttribute("firstMultiplier");var m=h;var y=(k*o).toFixed(2);if(y>=100){if(y>100){Tipped.create("#"+q,$T("tYouCannotSetRiskOfMoreThan")).show();window.setTimeout(function(){Tipped.remove("#"+q)},3000)}o=(100/k).toFixed(2);y=(k*o).toFixed(2);c.value=o}if(!u&&o>=0&&y>0&&y<=100&&getRisk(o,k,w,t)<=100){lastMultiplier=o;c.style.borderColor="";var f=(/^\d+(\.\d+)*$/).exec(g);c.value=(f==null&&!l)?g:o;updateRisks(o,k,w,t);if(b!=null&&d){$("row"+t).className="promote";showElement(b.id);showElement("saveB"+t)}else{if($J("#agreeAutoTradeTerms")[0]!=undefined){jQuery("#agreeAutoTradeTerms").button("option","disabled",!$("AutoTradeConfermTermsCheckbox").checked)}}updateMasterData(t,o,v,a,false);if(w=="mainRisk"){updateSlaveRecommendedBalance(a,false);updateTotal(false)}}else{if(u||lastMultiplier!=parseFloat(c.value)&&m>=0){c.style.borderColor="red";$("row"+t).className="promoteLimit";if(b!=null&&d){hideElement("saveB"+t)}else{if($J("#agreeAutoTradeTerms")[0]!=undefined){jQuery("#agreeAutoTradeTerms").button("option","disabled",true)}}}else{if(o>0&&m<0){updateMasterData(t,o,v,a,false);c.value=o}}}}function getMarginOrRiskColor(b,c){var a="";if(c<33){a="absolute darkGreen"}else{if(c<66){a="absolute darkYellow"}else{a="absolute darkRed"}}b.style.width=c+"%";b.className=a}function updateRisks(g,a,f,d){var c=$(f);var b=getRisk(g,a,f,d);if(c!=null&&b<=100){getMarginOrRiskColor(c,b)}}function updateMasterData(a,k,f,d,h){var c=$("drawdown"+a).getAttribute("drawdown")*k;var l=$("daily"+a).getAttribute("daily")*k;var b=$("monthly"+a).getAttribute("monthly")*k;$("drawdown"+a).innerHTML=roundNumUp(c,2)+"% <br/>"+f+roundNumUp((c*d/100),2);$("daily"+a).innerHTML=roundNumUp(l,2)+"% <br/>"+f+roundNumUp((l*d/100),2);$("monthly"+a).innerHTML=roundNumUp(b,2)+"% <br/>"+f+roundNumUp((b*d/100),2);if(h){$("monthly"+a).setAttribute("balance",d)}var g=$("minBalance"+a);g.innerHTML=f+calculateMinBalance(g,k,h)}function calculateMinBalance(d,f,a){if(d!=null){var b=Number(d.getAttribute("slaveMinBalance"));var c=roundNumUp((b/f),2);if(c<1000){c=1000}return c}}function updateMultiplierResponse(f,c){var a=c.id;var h=$("multiplier"+a);$("row"+a).className="";hideElement("save"+a);if(!f.error){if(h!=null){var d=$("mainRisk");var k=Number(h.getAttribute("firstMultiplier"));var b=Number($("drawdown"+a).getAttribute("drawdown"));h.setAttribute("firstMultiplier",c.multiplier);var g=getOldRisk(c.multiplier,b,"mainRisk",a);d.setAttribute("risk",g)}}else{if(h!=null){h.value=h.getAttribute("firstMultiplier")}var l=f.message;if(l!=null){showJqueryMessage("autoTradeMsg",l)}}}function autoTradeopenDemo(c,f,h,a){var d=true;var g=["name=",encodeParameter(c),"&accountLeverage=",f,"&accountDeposit=",h];showElement("openDemoAccountLoader");hideElement("openDemoAccountData");var b=staticServerPath+"images/circle1.gif";$("openDemoAccountLoader").innerHTML="Creating your demo account.<br/><br/><div class='loader4 inlineBlock'></div><br/><br/> This may take up to 30 seconds.";jQuery("a.ui-dialog-titlebar-close").remove();a.dialog({buttons:[],closeOnEscape:false});fxAjax.sendRequest(fxVars.openDemo+g.join(""),{contentType:"text/xml",params:{},loader:false,callback:"autoTradeOpenDemoResponse"})}function autoTradeOpenDemoResponse(b){if(!b.error){setInfoMessageToDialog("Account created!")}else{var a=b.message;showOpenDemoAccountLoader(a)}}function setInfoMessageToDialog(a){$("openDemoAccountLoader").innerHTML=a;jQuery("#openDemoAccountWindow").dialog("option","buttons",{Ok:function(){document.location.reload(true)}})}function showOpenDemoAccountLoader(a){showElement("openDemoAccountLoader");$("openDemoAccountLoader").innerHTML=a;showJqueryMessage("openDemoAccountWindow","")}function showOpenLiveAccountLoader(a){showElement("openLiveAccountLoader");$("openLiveAccountLoader").innerHTML=a;showJqueryMessage("openLiveAccountWindow","")}function autoTradeCheckMtLogin(c,b,a){fxAjax.sendRequest(fxVars.checkMtLogin+c+"&lastStatus="+b+"&autoTradeDemoAccount=true",{contentType:"text/xml",params:{id:c,newAccount:a},loader:false,callback:"autoTradeOpenDemoResponse"})}var confirmMasterOid=0;function addAutoTradeConfirm(f,d,b,c){$("AutoTradeConfermTermsCheckbox").checked=false;showElement("autoTradeConfirmLoader");hideElement("autoTradeConfirmData");confirmMasterOid="master"+f;var a=jQuery("#autoTradeConfirm").dialog({resizable:false,modal:true,height:670,width:700,zIndex:1011,close:function(){if(!a.data("okButton")){$("autoTradeConfirmData").innerHTML=""}a.data("okButton",false)},buttons:[{id:"agreeAutoTradeTerms",text:"Ok",disabled:true,click:function(){a.data("okButton",true);a.dialog("close");var h=$F("slaveAccounts");var g="addOrDeleteMasterToSlave("+h+","+f+","+d+","+b.id+","+c+")";getAccountRisk(h,"confirmRisk",g)}},{id:"button-cancel",text:"Cancel",click:function(){a.dialog("close")}}]});getAutoTradeConfirmData(f,c,a)}function getAutoTradeConfirmData(f,c,b){initMasterSettings(f);var d=["masterOid=",f,"&systemPage=",c];var a=$("slaveAccounts");if(a!=null){d.push("&slaveOid=",a.value)}fxAjax.sendRequest(fxVars.getAutoTradeConfirmData+d.join(""),{params:{popup:b},loader:false,callback:"getAutoTradeConfirmDataResponse"})}function removeAutoTradeConfirm(h,k,g,c,f,b){var d="Are you sure you wish to remove "+b+"?<br/><br/><b>Important:</b> Any trades opened by this system will be no longer managed by it. In case you subscribe to the system again, it will resume managing the trades.";var a="addOrDeleteMasterToSlave("+h+","+k+","+g+","+c.id+","+f+")";showJqueryMessageWithOkAndCancel("removeAutoTrade",d,a,null,null)}function addOrDeleteMasterToSlave(f,d,u,m,a){var l=$(m);var r=new Element("img",{src:"/images/loader5.gif"});l.parentNode.appendChild(r);hideElement(l);var c=$("multipliermaster"+d);var t=(c!=null)?Number($F("multipliermaster"+d)):0;var q=$("balanceStop"+d).value;var g=$("drawdownStop"+d).value;var k=$("totalLots"+d).value;var b=$("totalOpenTrades"+d).value;var o=$("fixedLots"+d).value;var s=getTimeTableDate(d);var h=["slaveAccountOid=",f,"&masterAccountOid=",d,"&add=",u,"&multiplier=",t,"&systemPage=",a,"&balanceStop=",q,"&drawdownStop=",g,"&totalLots=",k,"&totalOpenTrades=",b,"&fixedLots=",o,"&weekTimes=",encodeParameter(s),"&ignoreTradeSymbols=",encodeParameter(getTradeSymbolsValues(d))];fxAjax.sendRequest(fxVars.addOrDeleteMasterToSlave,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:h.join(""),method:"post",params:{add:u,element:l,system:a,masterAccountOid:d,imgElement:r},loader:false,callback:"addOrDeleteMasterToSlaveResponse"})}function addOrDeleteMasterToSlaveResponse(g,f){var b=f.system;var r=g.message;if(!g.error){var k=g.content.data;var l=f.element;$("autoTradeConfirmData").innerHTML="";if(hasText(k)&&!b){$("subscribedSystems").innerHTML=k;runAjaxScripts(k)}var o=l.getAttribute("masterAccountOid");var c=masters["openTrade"+o];var m=masters["openOrder"+o];if(f.add){if(!b){l.className="largeOff responseGreen radius3 border0 bold";l.value="Trading";l.disabled=true;if(c){c.setDefault()}if(m){m.setDefault()}}else{r="Autotrade account added successfully";if(g.content.allSlavesConnectedToMaster){l.className="radius3 font11 bold noUnderline pointer bg6 border2";l.innerHTML="Trading";$J("a#masterButton"+f.masterAccountOid).attr("onclick","").unbind("click")}initMasterSettings(f.masterAccountOid)}}else{var q=$("masterButton"+o);if(q!=null){q.className="largeOff";q.value="AutoTrade";q.disabled=false}if(c){c.setClassName("atUnsubscribed");c.addInfoUnsubscribed()}if(m){m.setClassName("atUnsubscribed");m.addInfoUnsubscribed()}initMasterSettings(o)}var d=$("mainRisk");var h=Number(g.content.risk);var a=h>100?100:h;if(d!=null&&h!=null){d.style.width=a+"%";d.setAttribute("risk",h);getMarginOrRiskColor(d,a)}}showElement(f.element);f.imgElement.remove();if(r!=null){showJqueryMessage("autoTradeMsg",r)}}function changeAutoTradeTermsCheckbox(b){var a=Number($("drawdown"+confirmMasterOid).getAttribute("drawdown"));var c=$("multiplier"+confirmMasterOid);var f=parseFloat(parseFloat(c.value).toFixed(2));var d=false;if(!isNaN(c.value)&&f>0&&getRisk(f,a,"confirmRisk",confirmMasterOid)<=100){d=true}jQuery("#agreeAutoTradeTerms").button("option","disabled",!(d&&b.checked))}var ACCOUNT_LAST_DATA_EQUITY=0;var ACCOUNT_LAST_DATA_BALANCE=1;var ACCOUNT_POSITIONS=2;var ACCOUNT_ORDER_POSITION_CLOSE=11;var ACCOUNT_LAST_DATA_MARGIN=12;function SignalTradeMasterGroupingObject(){this.sumMap={};this.isDemo=eval($J("#isDemo").val());this.add=function(param){var el=$J(param);this.trade=el.attr("trade");if(this.trade==undefined){return}this.masterId=el.attr("master");this.key=this.masterId+this.trade;var obj=this.sumMap[this.key];if(obj==undefined){obj=new GroupParams(el,this.masterId,this.trade,this.key,this.isDemo)}if(!this.isDemo){obj.lots=obj.lots+Number(el.attr("lots"))}obj.profit=obj.profit+Number(el.attr("profit"));obj.count++;this.sumMap[this.key]=obj};function GroupParams(el,id,trade,key,isDemo){this.profit=0;this.lots=0;this.count=0;this.id=id;this.trade=trade;this.key=key;this.isDemo=isDemo;var profit=$J("#profit"+key);var lots=$J("#lots"+key);var positions=$J("#positions"+key);this.update=function(value){profit.html(styleFigure(value.profit,"","",true,false,2));if(!this.isDemo){if(!isNaN(value.lots)){lots.html(getLots(value.lots))}}positions.html(value.count)}}}function AutotradeTable(){var a={};this.addTr=function(d,k,c,b){var f=$J(d);var g=f.attr("master");this.idAppend=b?"openTrade":"openOrder";this.ticket=f.attr("t");var h=g+this.idAppend;if(a[h]==undefined){a[h]=[];if(!$J("#master"+g+this.idAppend).isExist()){a[h].push(new TrTradeElement(new MasterElement(g,k,c,b),k,b,c))}}a[h].push(new TrTradeElement(d,k,b,c))};this.appendAll=function(){var d=[];var c=$J("#myAccount").attr("accountOid");var b=undefined;$J.each(a,function(f,g){if(f.indexOf(c+"openTrade")>=0){b=f}else{d.push(f)}});d.sort();if(b!=undefined){d.push(b)}$J.each(d,function(f,g){var k=a[g].sort(function(m,l){return m.ticket-l.ticket});var h=undefined;$J.each(k,function(){this.appendElement();if(hasText(this.masterOid)){h=this.idAppend+this.masterOid}});if(hasText(h)){masters[h].addInfoUnsubscribed();masters[h].addInfoDisapprove()}})}}function TrTradeElement(element,tableElement,isOpenTrade,orderData){var f=this;this.idAppend=isOpenTrade?"openTrade":"openOrder";var el=$J(element);var te=$J(tableElement);this.isMaster=el.attr("isMaster")!=undefined;var className=EMPTY;this.masterOid=el.attr("master");var masterDisapproved=!hasText(availableMasters[this.masterOid]);var selectedMaster=hasText(selectedMasters[this.masterOid]);if(masterDisapproved){className="autotradeTrDisapprove"}else{if(!selectedMaster){className="atUnsubscribed"}}if(!this.isMaster){el.mouseout(function(){this.className=masters[f.idAppend+f.masterOid].getClassName()});el.mouseover(function(){this.className="normalActive"})}this.ticket=!this.isMaster?Number(orderData.t):0;function _resize(trade){if(trade){var c=$(tableElement.id+"Count");c.innerHTML=Number(c.innerHTML)+1}createScroller(tableElement.id+"Cont")}this.appendElement=function(){var master=el.attr("master");var masterElementsExist=$J("#master"+master+this.idAppend).isExist();if(!masterElementsExist){$J(tableElement).append(element);_resize(false)}else{var isOpen=eval($J("#expandButton"+master+this.idAppend).attr("isOpen"));var masterElements=$J(tableElement).find("tr[master="+master+"]");if(!masterElements.isExist()){te.find("tr[id=master"+master+this.idAppend+"]").after(el)}else{masterElements.last().after(el)}if(!isOpen){el.hide()}_resize(true)}}}var availableMasters={};var selectedMasters={};var masters={};function MasterElement(masterOid,tableElement,orderData,isOpenTrade){var f=this;var isDemo=eval($J("#isDemo").val());var trElement=$J("<tr>");this.master=true;var masterDisapproved=!hasText(availableMasters[masterOid]);var selectedMaster=hasText(selectedMasters[masterOid]);var className="";var masterInfoElement=undefined;if(masterDisapproved){className="autotradeTrDisapprove"}else{if(!selectedMaster){className="atUnsubscribed"}else{trElement.attr("class","autotradeTr")}}this.idAppend=isOpenTrade?"openTrade":"openOrder";var ip=this.idAppend;trElement.attr("trade",this.idAppend);trElement.attr("id","master"+masterOid+this.idAppend);trElement.attr("isMaster",true);var min=$J("<td>");min.attr("colSpan",1);min.attr("width","5%");this.systemLink=orderData.slk;var minButton=$J("<span isOpen='true' masterExpandButton='"+this.idAppend+"' id='expandButton"+masterOid+this.idAppend+"' class='expandButton radius2 floatLeft marginL10 lh14 pointer'>-</span>");minButton.click(function(){openCloseGroup(masterOid,f.idAppend,tableElement)});min.append(minButton);trElement.append(min);var mySlaveAccount=$J("#myAccount");var tdAvatar=$J("<td>");tdAvatar.attr("colSpan",1);tdAvatar.attr("width","10%");var defaultUser=false;var uid=orderData.u;if(uid==undefined){defaultUser=true}var imageType=!defaultUser?orderData.it:mySlaveAccount.attr("imageType");var imageId=!defaultUser?orderData.ii:mySlaveAccount.attr("imageId");if(!hasText(imageType)||!hasText(imageId)){imageId="";imageType="jpg"}var aAvatar=$J("<span class='inlineBlock' target='_blank'>");var aAvatarImg=$J("<img class='avatarFrame' width='30' height='30'>");this.img="/userimages."+imageType+"?uid="+uid+"&id="+imageId+"&w=30&h=30";aAvatarImg.attr("src",this.img);aAvatar.append(aAvatarImg);tdAvatar.append(aAvatar);trElement.append(tdAvatar);var masterAccount=$J("<td>");masterAccount.attr("colSpan",2);masterAccount.attr("width",isOpenTrade?"21%":"24%");masterAccount.attr("align","left");var linkToSystem=undefined;var slaveTicket=false;if(hasText(this.systemLink)){linkToSystem=$J("<a class='underline' target='_blank'>");linkToSystem.attr("href",this.systemLink);if(hasText(orderData.mn)){this.systemName=htmlDecode(orderData.mn)}linkToSystem.text(this.systemName)}else{slaveTicket=true;linkToSystem=$J("<label>");this.systemName="Manual Trades";linkToSystem.text(this.systemName)}masterAccount.append(linkToSystem);masterAccount.append(" (").append($J("<span id='positions"+masterOid+this.idAppend+"'>")).append(")");trElement.append(masterAccount);var lotsValue=$J("<td><li class='key'>");lotsValue.attr("id","lots"+masterOid+this.idAppend);lotsValue.attr("colSpan",1);trElement.append(lotsValue);var td=$J("<td>");if(isOpenTrade){td.attr("colSpan",7);td.attr("width","52%");trElement.append(td);var profitValue=$J("<td>");profitValue.attr("id","profit"+masterOid+this.idAppend);profitValue.attr("colSpan",1);profitValue.attr("class","bold");trElement.append(profitValue)}else{td.attr("colSpan",5);td.attr("width","54%");trElement.append(td)}var closeElement=$J("<td name='closer'><a name='aCloser' class='closer pointer'>").attr("colSpan",1);trElement.append(closeElement);closeElement.click(function(){closeMasterPositionsConfirm(masterOid,f.idAppend,isOpenTrade,f.systemName,slaveTicket)});if(masterInfoElement!=undefined){masterInfoElement.find("[name=imageSrc]").attr("src",this.img);masterInfoElement.find("[name=systemName]").html(this.systemName)}this.addInfoUnsubscribed=function(){if(className=="atUnsubscribed"){trElement.attr("class","atUnsubscribed");$J("[master="+masterOid+"][trade="+this.idAppend+"]").attr("class","atUnsubscribed");if(!$J("#unsubscribed"+masterOid).isExist()){masterInfoElement=$J("#unsubscribedSample").clone();masterInfoElement.show();masterInfoElement.attr("id","unsubscribed"+masterOid);$J("#masterUnsubscribed").append(masterInfoElement);if(masterInfoElement!=undefined){masterInfoElement.find("[name=imageSrc]").attr("src",this.img);masterInfoElement.find("[name=systemName]").html(this.systemName)}}}};this.addInfoDisapprove=function(){if(className=="autotradeTrDisapprove"){trElement.attr("class","autotradeTrDisapprove");$J("[master="+masterOid+"][trade="+this.idAppend+"]").attr("class","autotradeTrDisapprove");if(!$J("#disapproved"+masterOid).isExist()){masterInfoElement=$J("#disapprovedSample").clone();masterInfoElement.show();masterInfoElement.attr("id","disapproved"+masterOid);$J("#masterDisapproved").append(masterInfoElement);if(masterInfoElement!=undefined){masterInfoElement.find("[name=imageSrc]").attr("src",this.img);masterInfoElement.find("[name=systemName]").html(this.systemName)}}}};this.setDefault=function(){className="";trElement.attr("class","autotradeTr");$J("[master="+masterOid+"][trade="+this.idAppend+"]").attr("class","");if(masterInfoElement){masterInfoElement.remove()}};this.setClassName=function(cn){className=cn};this.getClassName=function(){return className};trElement.find("*:not([name=closer],a)").click(function(){openCloseGroup(masterOid,f.idAppend,tableElement)});masters[this.idAppend+masterOid]=this;return trElement}function openCloseGroup(masterOid,appendId,tableElement){var element=$J("#expandButton"+masterOid+appendId);var shown=eval(element.attr("isOpen"));var elements=$J("tr[master="+masterOid+"][trade="+appendId+"]");if(!shown){element.text("-");elements.show()}else{element.text("+");elements.hide()}element.attr("isOpen",!shown);createScroller(tableElement.id+"Cont")}var initAutotrade=false;function accountLastDataUpdate(data,hideLoader){var slaveAccountOid=$J("#myAccount").attr("accountOid");if(data!=null&&(data.po==null||initAutotrade||data.init!=undefined)){initAutotrade=true;var equityElement=$("autoTradeEquity");var balanceElement=$("autoTradeBalance");var floatingPlElement=$("floatingPl");var accountOid=data.a;var equity=data.e;if(equityElement!=null&&equity!=null){equityElement.innerHTML=styleFigure(equity,equityElement.getAttribute("predecessor"),"",false,false,2);equityElement.setAttribute("value",equity);if(Number(balanceElement.innerHTML)!=null){var value=Number(equity)-Number(balanceElement.getAttribute("value"));floatingPlElement.innerHTML=styleFigure(value,balanceElement.getAttribute("predecessor"),"",true,true,2)}}var balance=data.b;if(balanceElement!=null&&balance!=null){balanceElement.innerHTML=styleFigure(balance,balanceElement.getAttribute("predecessor"),"",false,false,2);balanceElement.setAttribute("value",balance);jQuery("[monthly]").each(function(){this.setAttribute("balance",balance)});updateSlaveRecommendedBalance(balance,false);if(Number(equityElement.innerHTML)!=null){value=Number(equityElement.getAttribute("value"))-Number(balance);floatingPlElement.innerHTML=styleFigure(value,balanceElement.getAttribute("predecessor"),"",true,true,2)}}var positionClosed=data.pc;if(positionClosed!=null){var ticket=data.t;var positionType=data.ty;var positionTable;var ticketId;var isOpenTrade=positionType<=1;if(isOpenTrade){positionTable=$("openTrades");ticketId="openTrade"+ticket}else{positionTable=$("openOrders");ticketId="openOrder"+ticket}var deleteRow;if(positionTable!=null){var rowCount=positionTable.rows.length;if($(ticketId)!=undefined){var el=$J("#"+ticketId);var trade=el.attr("trade");var master=el.attr("master");$(ticketId).remove();if(!$J("[master="+master+"][trade="+trade+"]").isExist()&&$J("#master"+master+trade).isExist()){$J("#master"+master+trade).remove()}var noTradesExist=!$J("[master="+master+"][trade=openOrder]").isExist()&&!$J("[master="+master+"][trade=openTrade]").isExist();if(noTradesExist&&$J("#disapproved"+master).isExist()){$J("#disapproved"+master).remove()}if(noTradesExist&&$J("#unsubscribed"+master).isExist()){$J("#unsubscribed"+master).remove()}if(noTradesExist){masters["openTrade"+master]=null;masters["openOrder"+master]=null}counter=$(positionTable.id+"Count");counter.innerHTML=Number(counter.innerHTML)-1;createScroller(positionTable.id+"Cont")}if(positionTable.rows.length==1){(isOpenTrade)?showElement("noOpenTrades"):showElement("noOpenOrders")}}}var positions=data.po;if(positions!=null){var openOrdersTable;var trElement;var autotradeTable=new AutotradeTable();for(var position in positions){var isOpenTrade=false;var orderData=positions[position];var type=Number(orderData.ty);var tradeElement=$("openTrade"+position);var comment=orderData.com;if(type<=1||(tradeElement!=null)){openOrdersTable=$("openTrades");trElement=tradeElement;isOpenTrade=true}else{openOrdersTable=$("openOrders");trElement=$("openOrder"+position)}var masterOid=orderData.mo;if(trElement==null){var lotsKey=new Element("li",{className:"key"});var openPriceKey=new Element("li",{className:"key"});(isOpenTrade)?hideElement("noOpenTrades"):hideElement("noOpenOrders");trElement=new Element("tr");if(!hasText(masterOid)){masterOid=slaveAccountOid}var idAppend=(isOpenTrade)?"openTrade":"openOrder";trElement.id=idAppend+position;$J(trElement).attr("master",masterOid);if(orderData.lo!=undefined){$J(trElement).attr("lots",orderData.lo)}$J(trElement).attr("profit",orderData.p);$J(trElement).attr("trade",idAppend);$J(trElement).attr("ticket",position);if(comment!=null){trElement.setAttribute("comment",comment)}var tdAvatar=trElement.insertCell(trElement.cells.length);tdAvatar.width="5%";var tdTicket=trElement.insertCell(trElement.cells.length);tdTicket.setAttribute("name","t");tdTicket.width=(isOpenTrade)?"9%":"10%";var tdTime=trElement.insertCell(trElement.cells.length);tdTime.setAttribute("name","ti");tdTime.width=(isOpenTrade)?"12%":"11%";var tdType=trElement.insertCell(trElement.cells.length);tdType.setAttribute("name","ty");tdType.width=(isOpenTrade)?"8%":"10%";var tdLots=trElement.insertCell(trElement.cells.length);tdLots.setAttribute("name","lo");tdLots.width=(isOpenTrade)?"7%":"10%";tdLots.appendChild(lotsKey);var tdSymbol=trElement.insertCell(trElement.cells.length);tdSymbol.setAttribute("name","s");tdSymbol.width=(isOpenTrade)?"7%":"9%";var tdOpenPrice=trElement.insertCell(trElement.cells.length);tdOpenPrice.setAttribute("name","op");tdOpenPrice.width=(isOpenTrade)?"8%":"10%";tdOpenPrice.appendChild(openPriceKey);var tdStopLoss=trElement.insertCell(trElement.cells.length);tdStopLoss.setAttribute("name","sl");tdStopLoss.width=(isOpenTrade)?"8%":"11%";var tdTakeProfit=trElement.insertCell(trElement.cells.length);tdTakeProfit.setAttribute("name","tp");tdTakeProfit.width=(isOpenTrade)?"7%":"11%";var tdClosePrice=trElement.insertCell(trElement.cells.length);tdClosePrice.setAttribute("name","cp");tdClosePrice.width=(isOpenTrade)?"7%":"10%";if(isOpenTrade){var tdCommission=trElement.insertCell(trElement.cells.length);tdCommission.setAttribute("name","co");tdCommission.width="6%";var tdSwap=trElement.insertCell(trElement.cells.length);tdSwap.setAttribute("name","sw");tdSwap.width="6%";var tdProfit=trElement.insertCell(trElement.cells.length);tdProfit.setAttribute("name","p");tdProfit.width="6%";tdProfit.className="bold lh34"}var tdClosePosition=trElement.insertCell(trElement.cells.length);tdClosePosition.width="4%";var closeId=isOpenTrade?"closeOpenTrade"+position:"closeOpenOrder"+position;var aElement=new Element("a",{className:"closer pointer",id:closeId,ticket:position,ot:isOpenTrade.toString(),name:"aCloser"});aElement.onclick=function(){closePositionConfirm(this,accountOid,this.getAttribute("ticket"),eval(this.getAttribute("ot")))};tdClosePosition.appendChild(aElement);autotradeTable.addTr(trElement,openOrdersTable,orderData,isOpenTrade)}for(var id in orderData){updateOpenOrderValue(trElement,id,orderData[id])}}autotradeTable.appendAll()}insertAndUpdateElements();var margin=data.m;if(Number(margin)>100){margin=100}if(margin!=null){var marginElement=$$("[name=marginElement]").each(function(element){getMarginOrRiskColor(element,margin)})}if(hideLoader==undefined||hideLoader){var autoTradeMainloader=jQuery("#autoTradeloader");if(autoTradeMainloader.dialog("isOpen")){autoTradeMainloader.dialog("close")}}var connectionStatus=data.connectionStatus;if(hasText(connectionStatus)){showJqueryMessage("autoTradeMsg",connectionStatus)}}}function insertAndUpdateElements(){var a=new SignalTradeMasterGroupingObject();$J("[master]").each(function(){a.add(this)});$J.each(a.sumMap,function(b,c){c.update(c)})}function updateOpenOrderValue(b,a,d){var c=$J(b).find("td[name="+a+"]");if(c!=null){c.html(filterPositionsValues(a,d))}if(a=="p"){$J(b).attr("profit",d)}else{if(a=="lo"){$J(b).attr("lots",d)}}}function filterPositionsValues(b,c){var a=c;if(b=="ty"){a=getPositionType(c)}else{if(b=="p"){a=styleFigure(c,"","",true,false,2)}else{if(b=="tp"||b=="sl"){a=(c==0)?"-":c}else{if(b=="lo"){a=getLots(c)}}}}return a}function getPositionType(a){switch(a){case 0:return"Buy";case 1:return"Sell";case 2:return"Buy Limit";case 3:return"Sell Limit";case 4:return"Buy Stop";case 5:return"Sell Stop"}}function createOpenDemoAccountConfirm(c,b){if($$("#autoTradeMenuUl li [demo=true]").length<Number($F("autoTradeAccountsLimit"))){hideElement("openDemoAccountLoader");showElement("openDemoAccountData");var a=jQuery("#openDemoAccountWindow").dialog({resizable:false,modal:true,buttons:[{id:"agreeOpenDemo",text:"Ok",click:function(){if(validate("accountName",VALID_SYSTEM_NAME)){var f=$F("accountDeposit");var d=$F("accountName");autoTradeopenDemo(d,DEFAULT_LEVERAGE,f,a)}}},{id:"button-cancel",text:"Cancel",click:function(){a.dialog("close")}}]})}else{showElement("openDemoAccountLoader");hideElement("openDemoAccountData");showOpenDemoAccountLoader("You already have a demo account. If you wish to open a new demo account, please delete the existing one.")}}function getAutoTradeConfirmDataResponse(b,f){if(!b.error){var d=b.content.data;if(hasText(d)){$("autoTradeConfirmData").innerHTML=d;runAjaxScripts(b.content.data)}showElement("autoTradeConfirmData")}else{var c=b.message;if(c!=null){f.popup.dialog("close");$("autoTradeMsg").innerHTML=c;var a=jQuery("#autoTradeMsg").dialog({resizable:false,modal:true,buttons:[{text:"Ok",click:function(){document.location.reload(true)}}]});jQuery("a.ui-dialog-titlebar-close").remove()}}hideElement("autoTradeConfirmLoader")}function autoTradeProvidersCheck(a){hideElement(a.id);showElement("accountsCheckLoader");setTimeout("showElement('accountsCheckTable'); hideElement('accountsCheckLoader');",1000)}function autoTradeAddProviderResponse(a,c){if(!a.error){var b=a.content.message}else{b=a.message}showJqueryMessage("autoTradeFaqMsg",b)}function removeSlaveAccountConfirm(b){var c="removeSlave"+b;var a="removeSlaveAccount("+b+","+c+")";showJqueryMessageWithOkAndCancel("removeSlaveAccounteMsg",null,a,null,null)}function removeSlaveAccount(c,a){var b=new Element("img",{src:"/images/loader5.gif"});a.parentNode.appendChild(b);hideElement(a);fxAjax.sendRequest(fxVars.removeSlaveAccount+c,{params:{slaveAccountOid:c,imgElement:b,removeElement:a},loader:false,callback:"removeSlaveAccountResponse"})}function removeSlaveAccountResponse(a,c){if(!a.error){removeElement("slaveAccount"+c.slaveAccountOid);removeElement("autoTradeMenu"+c.slaveAccountOid);if($("myAccountsTable").rows.length==1){showElement("myAccountsEmpty")}}else{showElement(c.removeElement);var b=a.message;if(hasText(b)){showJqueryMessage("removeSystemMsg",b)}}c.imgElement.remove()}function autoTradeConnectionStatusUpdate(b){if(b!=null){var a=b.connected;if(a!=null){if(a){hideElement("connStatusOff");showElement("connStatusOn")}else{hideElement("connStatusOn");showElement("connStatusOff")}}}}function autoTradeMainUpdate(b){if(!b.error){var c=b.accountOid;var g=b.equity;var h=b.balance;if(c!=null){var f=$("autoTradeAccountB"+c);var a=$("autoTradeAccountE"+c);if(f!=null&&h!=null){f.innerHTML=roundNumber(h,2)}if(a!=null&&g!=null){a.innerHTML=roundNumber(g,2)}}var d=jQuery("#autoTradeMainloader");if(d.dialog("isOpen")){d.dialog("close")}}}function updateMultiplierByKeyPress(b,g,f,d){var a=0;if(b.keyCode==38){a=0.1}else{if(b.keyCode==40){a=-0.1}}updateMultiplier(g,a,f,null,d,false,true,true)}function getAccountRisk(c,a,b){fxAjax.sendRequest(fxVars.getAccountRisk+c,{params:{riskElementId:a,func:b},loader:false,callback:"getAccountRiskeResponse"})}function getAccountRiskeResponse(response,params){if(!response.error){var riskElement=$(params.riskElementId);var currentRisk=parseInt(riskElement.getAttribute("risk"));var risk=parseInt(response.content.risk);if(risk!=currentRisk){var okfunc="document.location.reload(true);";showJqueryMessageWithOkAndCancel("autoTradeMsg","The data in this page is out of date. Press OK to refresh the page",okfunc,null,null)}else{eval(params.func)}}}function closePositionConfirm(c,d,h,b){var a=c.parentNode.parentNode.getAttribute("master");var f=a==d;var g=(!b)?"none":"";var l="<div>Are you sure you want to close this order? </div><br/><div style='display:"+g+"'><div class='paddT5'>";if(!f){l+="<input type='checkbox' id='copyFromMaster'/><label for='copyFromMaster'>Re-enter the trade if possible</label></div><div class='gray1'>Tick the checkbox if you want to re-enter the trade again at a better or equal price (compared to original provider entry).</div></div>"}var k="closePosition('"+c.id+"',"+d+","+h+","+b+")";showJqueryMessageWithOkAndCancel("autoTradeMsg",l,k,null,null)}function closeMasterPositionsConfirm(c,a,b,h,d){var f=(!b)?"none":"";var g=b?"trades":"orders";if(h.indexOf("Manual Trades")>=0){g=""}var l="<div>Are you sure you wish to close all  <b>"+h+"</b> "+g+"? </div><br/><div style='display:"+f+"'><div class='paddT5'>";if(!d){l+="<input type='checkbox' id='copyFromMaster'/><label for='copyFromMaster'>Re-enter the trades if possible</label></div><div class='gray1'>Tick the checkbox if you want to re-enter the trade again at a better or equal price (compared to original provider entry).</div></div>"}var k="closeAllMasterPositions('"+c+"','"+a+"',"+b+")";showJqueryMessageWithOkAndCancel("autoTradeMsg",l,k,null,null)}function closeAllMasterPositions(c,k,h){var g=$J("[master="+c+"][trade="+k+"]").find("a[name=aCloser]");var a=$J("#myAccount").attr("accountOid");var b=$J("#master"+c+k).find("a[name=aCloser]");var d=$J("#copyFromMaster").is("checked");var f=$J("<img src='/images/loader5.gif'>");b.parent().append(f);b.hide();$J.each(g,function(){var l=$J(this);closePosition(l.attr("id"),a,l.attr("ticket"),h)})}function closePosition(a,b,h,g){var c=$(a);var d=($("copyFromMaster")!=null)?$("copyFromMaster").checked:false;var f=new Element("img",{src:"/images/loader5.gif"});c.parentNode.appendChild(f);hideElement(c);fxAjax.sendRequest(fxVars.closePosition+b+"&ticket="+h+"&openTrade="+g+"&resync="+d,{params:{imgElement:f,element:c},loader:false,callback:"closePositionResponse"})}function closePositionResponse(a,c){if(!a.error){}else{c.imgElement.remove();showElement(c.element);var b=a.message;if(hasText(b)){showJqueryMessage("autoTradeMsg",b)}}}function showLoader(c){var b=$(c);if(b!=null){var a=jQuery("#"+c).dialog({resizable:false,modal:true})}jQuery("a.ui-dialog-titlebar-close").remove()}function saveAutoTradeQuestionnaire(h){$("responseMessage").innerHTML="";hideElement("responseMessage");if(validate("maxOpenTrades",VALID_INTEGER)&&validate("maxTradesPerDay",VALID_INTEGER)&&validate("maxBalanceRisked",VALID_PERCENT)){var k=false;var b=[];var o=false;$J("[name=risk]").each(function(q,r){if(r.checked){o=true;b.push(r.id+"=true")}});if(!o){showElement("riskErr");k=true}else{hideElement("riskErr")}var c=[];var g=true;$J("[name=confirm]").each(function(q,r){if(!r.checked){showElement(r.id+"Err");g=false}else{hideElement(r.id+"Err");c.push(r.id+"=true")}});if(!g){showElement("mainErr");k=true}else{hideElement("mainErr")}var d=getUrlVars();var m=[];var a=d.cTraderOauthError;var l=d.cTraderOAuthToken;if(d.length>0&&a!=undefined&&l!=undefined){m=["&cTraderOauthError=",a,"&cTraderOAuthToken=",l]}if(!k){var f=["&maxOpenTrades=",$F("maxOpenTrades"),"&maxTradesPerDay=",$F("maxTradesPerDay"),"&maxBalanceRisked=",$F("maxBalanceRisked"),"&systemDescription=",encodeParameter($("systemDescription").value)];fxAjax.sendRequest(fxVars.saveAutoTradeQuestionnaire+h+f.join("")+"&"+b.join("&")+"&"+c.join("&")+m.join(""),{contentType:"text/html",loader:true,callback:"saveAutoTradeQuestionnaireResponse"})}}}function saveAutoTradeQuestionnaireResponse(a,b){if(a.content.newProviderRequest){autoTradeAddProviderResponse(a,b)}else{$("responseMessage").innerHTML=a.message;showElement("responseMessage")}}function showHideAllTrades(el,trade,cont){var expandAllElement=$J(el);var shown=eval(expandAllElement.attr("isOpen"));var trElements=$J("[master][trade="+trade+"]");var expandElements=$J("[masterExpandButton="+trade+"]");if(!shown){expandAllElement.text("-");expandElements.text("-");trElements.show()}else{expandAllElement.text("+");expandElements.text("+");trElements.hide()}expandElements.attr("isOpen",!shown);expandAllElement.attr("isOpen",!shown);createScroller(cont)}function updateSignalTraderSettings(c,d,h,a,m,f,l,o,b,k){initSignalSettings=false;updateDefaultSettings(c,m,f,h,a,l,o,b);if(k){jQuery("#masterSettings"+c).dialog("close")}else{var g=["slaveAccountOid=",d,"&masterAccountOid=",c,"&totalLots=",h,"&totalOpenTrades=",a,"&balanceStop=",m,"&drawdownStop=",f,"&fixedLots=",l,"&weekTimes=",encodeParameter(o),"&ignoreTradeSymbols=",encodeParameter(b)];fxAjax.sendRequest(fxVars.updateSignalTraderSettings,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:g.join(""),method:"post",params:{masterAccountOid:c},loader:false,callback:"updateSignalTraderSettingsResponse"})}}function checkBalanceAndDrawdownBeforeUpdateSignalTraderSettings(c,f,m){var o=$("balanceStop"+c);var s="";var k=null;if($("autoTradeBalance")!=null){k=parseFloat($("autoTradeBalance").getAttribute("value"))}else{if(jQuery("#slaveAccounts")!=null){k=parseFloat(jQuery("#slaveAccounts").find(":selected").attr("balance"))}}var g=$("drawdownStop"+c);var q=getTimeTableDate(c);var h=$("totalLots"+c);var a=$("totalOpenTrades"+c);var l=$("fixedLots"+c);var b=getCheckBoxesValues("tradeSymbols"+c);if((!hasText(h.value)||validate(h.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))&&(!hasText(a.value)||validate(a.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(o.value)||validate(o.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(g.value)||validate(g.id,VALID_PERCENT_WITHOUT_ZERO))&&(!hasText(l.value)||validate(l.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))){if(!isNaN(k)&&(parseFloat(o.value)>(k*0.9))){s+="Balance"}if(parseFloat(g.value)<10){s+=hasText(s)?",Drawdown":"Drawdown"}if(hasText(s)){var d="updateSignalTraderSettings("+c+","+f+',"'+h.value+'","'+a.value+'","'+o.value+'","'+g.value+'","'+l.value+'","'+q+'","'+b+'",'+m+")";var r="The <b>"+s+"</b> level you've set is less than 10% from current value. Are you sure you wish to set it at that level? (Setting the limit too close may result in many missing trades).";showJqueryMessageWithOkAndCancel("autoTradeMsg",r,d,"",400)}else{updateSignalTraderSettings(c,f,h.value,a.value,o.value,g.value,l.value,q,b,m)}}}function updateSignalTraderSettingsResponse(a,b){if(!a.error){showJqueryMessage("autoTradeMsg","Settings Updated")}else{showJqueryMessage("autoTradeMsg",(hasText(a.message))?a.message:"Cant Update Settings")}jQuery("#masterSettings"+b.masterAccountOid).dialog("close")}function pauseMasterForSlave(element,masterAccountOid,slaveAccountOid){var paused=!eval(element.getAttribute("paused"));var data=["slaveAccountOid=",slaveAccountOid,"&masterAccountOid=",masterAccountOid,"&paused=",paused];fxAjax.sendRequest(fxVars.pauseMasterForSlave+data.join(""),{params:{element:element,paused:paused},loader:false,callback:"pauseMasterForSlaveResponse"})}function pauseMasterForSlaveResponse(a,b){if(!a.error){b.element.setAttribute("paused",b.paused);if(b.paused){b.element.childNodes[0].className="ATButtons play";$J(b.element).parent().parent().find("td")[0].childNodes[1].className="ATplay";showJqueryMessage("autoTradeMsg",$T("tPausingAutotradeSystem",[$J(b.element).parent().parent().find("td")[3].childNodes[1].text]))}else{b.element.childNodes[0].className="ATButtons pause";$J(b.element).parent().parent().find("td")[0].childNodes[1].className="ATpaused"}}else{showJqueryMessage("autoTradeMsg",(hasText(a.message))?a.message:"Failed To Pause System")}}function getTimeTableDate(h){var g="";var b=0;var a=$$("#timeTable"+h+" tr[class=day]");for(var f=0;f<a.length;f++){var d=a[f].childNodes;g+=f+"#";for(var c=0;c<d.length;c++){b=d[c].getAttribute("status");if(b==1){g+=c-1+","}}g+="@"}return g}function addOrDeleteSimulator(element,masterOid,simulate){var multiplierElement=$("multiplier"+masterOid);var add=(simulate!=null)?simulate:eval(element.getAttribute("simulate"));if(add){element.className="largeOff responseGray radius3 border0 bold";element.value="Simulating";if($("timeTable"+masterOid)==null){jQuery("#mainTimeTableDiv"+masterOid).timeTable("")}showElement("row"+masterOid)}else{var masterButton=$("masterButton"+masterOid);if(masterButton!=null){masterButton.className="largeOff";masterButton.value="Simulate";hideElement("row"+masterOid)}var timeTable=$("timeTable"+masterOid);if(timeTable!=null){timeTable.remove();updateDefaultSettings(masterOid,"","","","","","","")}}multiplierElement.setAttribute("show",add);updateSimulatorMultiplier(masterOid,0,"$",false);element.setAttribute("simulate",!add);var subscribedSystems=$$("#simulatorSubscribedSystemsTab [show=true]");if(subscribedSystems.length==0){showElement("simulatorSubscribedSystemsEmpty");hideElement("simulatorTotal")}else{hideElement("simulatorSubscribedSystemsEmpty");showElement("simulatorTotal")}}function updateSimulatorMultiplier(a,g,f,k){var l=false;var b=Number($("drawdown"+a).getAttribute("drawdown"));var d=$("multiplier"+a);var h=d.value;var q=parseFloat((parseFloat(d.value)+g).toFixed(2));if(isNaN(d.value)){l=true}var o=$F("accountDeposit");var c=Number((b*q).toFixed(2));if(!l&&q>=0&&c>0&&c<=100&&updateSimulatorRisk(c,a)){d.style.borderColor="";var m=(/^\d+(\.\d+)*$/).exec(h);d.value=(m==null&&!k)?h:q;updateMasterData(a,q,f,o,true);updateSlaveRecommendedBalance(o,true);updateTotal(true)}else{if(q>0&&g<=0){updateMasterData(a,q,f,o,true);d.value=q}d.style.borderColor="red"}}function updateSimulatorMultiplierByKeyPress(b,g,f,d){var a=0;if(b.keyCode==38){a=0.1}else{if(b.keyCode==40){a=-0.1}}updateSimulatorMultiplier(g,a,f,false)}function updateSimulatorData(){var c=$$("#simulatorSubscribedSystemsTab [show=true]");if(c.length>0){for(var b=0;b<c.length;b<b++){var a=c[b];a.click()}}}var lastSimulationData=[];function startSimulation(w,h,x,k){var o=[];if(getSimulatorRisk()<=100){if(h||lastSimulationData.length>0){var g=x;if(g==null){g=0;if(isShown("balance")){g=1}}var c=$$("#simulatorSubscribedSystemsTab [show=true]");if(c.length>0){if(h){if(!isValidDate(userFormatToDefaultFormat($F("startDate"),w))){$("startDate").value=$("startDate").defaultValue}if(!isValidDate(userFormatToDefaultFormat($F("endDate"),w))){$("endDate").value=$("endDate").defaultValue}var f=userFormatToDefaultFormat($F("startDate"),w);var d=userFormatToDefaultFormat($F("endDate"),w);var z=["accountLeverage=",$F("accountLeverage"),"&accountDeposit=",$F("accountDeposit"),"&start=",getDbTimeFormat(f),"&end=",getDbTimeFormat(d)];var a="";var A=[];for(var v=0;v<c.length;v++){var b=c[v];var r=b.getAttribute("elementid");var u=$("balanceStop"+r).value;var s=$("drawdownStop"+r).value;var m=$("totalLots"+r).value;var t=$("totalOpenTrades"+r).value;var q=$("fixedLots"+r).value;var y=getTimeTableDate(r);var l=b.value;a+=r+"-"+l+"-"+u+"-"+s+"-"+m+"-"+t+"-"+q+"-"+y+"-"+getTradeSymbolsValues(r)+"!";A.push($("systemLink"+r).innerHTML)}z.push("&mastersMultiplier=",encodeParameter(a));if(!k){o=[$F("accountLeverage"),"%",$F("accountDeposit"),"%",f,"%",d,"%",a]}lastSimulationData=z.slice()}else{z=lastSimulationData.slice()}z.push("&chartType=",g);fxAjax.sendRequest(fxVars.getSimulatorChart+z.join(""),{params:{chartType:g,providers:c.length,settings:o.join(""),userTimeFormat:w,systemsNames:A,simulation:h,load:k},loader:false,callback:"startSimulationResponse"})}else{showJqueryMessage("simulatorMsg","Please select at least 1 provider.")}}}else{showJqueryMessage("simulatorMsg",$T("tCannotRunSimulatorPleaseAdjuctSetting"))}}function startSimulationResponse(a,F){if(!a.error){var r=growthChartObject;var y="growth";if(F.chartType==1){r=balanceChartObject;y="balance"}var G=jQuery.parseJSON(a.content.chart);var t=a.content.trades;var h=Number(a.content.totalGain);var v=Number(a.content.totalProfit);var m=Number(a.content.totalPips);var b=Number(a.content.floatingPips);var w=Number(a.content.floatingProfit);var B=Number(a.content.openTrades);var g=a.content.drawdown;var k=a.content.marginCall;if(k){showElement("marginCall")}else{hideElement("marginCall")}$("totalTrades").innerHTML=t;$("totalGain").innerHTML=h+"%";$("totalProfit").innerHTML=styleFigure(v,"$","",false,true,2);$("totalPips").innerHTML=m;$("drawdown").innerHTML=g+"%";$J("#floatingPips").html(styleFigure(b,"","",false,true,2));$J("#openTrades").html(B);$J("#floatingProfit").html(styleFigure(w,"$","",false,true,2));r.setDataJson(G);if(F.simulation&&!F.load){Effect.ScrollTo("wrapper")}var C=F.settings;if(hasText(C)){var x=$("simulatorHistoryTable");var o=x.insertRow(x.rows.length);o.onmouseover=function(){this.className="normalActive"};o.onmouseout=function(){this.className=""};var f=o.insertCell(o.cells.length);var E=new Element("span",{className:"dotted"});E.innerHTML=F.providers;f.appendChild(E);var c=o.insertCell(o.cells.length);c.innerHTML=t;var s=o.insertCell(o.cells.length);s.innerHTML=styleFigure(h,"","%",true,false,2);s.className="bold";var d=o.insertCell(o.cells.length);d.innerHTML=styleFigure(v,"$","",true,true,2);d.className="bold";var u=o.insertCell(o.cells.length);u.innerHTML=styleFigure(m,"","",true,false,1);u.className="bold";var l=o.insertCell(o.cells.length);l.innerHTML=g+"%";var q=o.insertCell(o.cells.length);var z=new Element("a");z.onclick=function(){loadSimulatorUserSettings(C,F.userTimeFormat,false)};z.innerHTML="Load";z.className="underline pointer";q.appendChild(z);var D=o.insertCell(o.cells.length);var A=new Element("a",{className:"closer pointer"});A.onclick=function(){if(simulatorHistoryTable!=null){var I=simulatorHistoryTable.rows;var H=I.indexOf(o);I.splice(H,1)}o.remove();if(x.rows.length==1){showElement("simulatorHistoryEmpty")}};D.appendChild(A);hideElement("simulatorHistoryEmpty");new Tip(f,F.systemsNames.join("<br>"),{title:"Providers",hook:{target:"rightmiddle",tooltip:"leftmiddle"}});initSimulatorHistoryTable()}}}function saveSimulatorUserSettingsWindow(b){if($$("#simulatorSubscribedSystemsTab [show=true]").length>0){var a=jQuery("#saveSimulation").dialog({resizable:false,modal:true,width:340,buttons:[{text:"Ok",click:function(){if(validate("simulationTitle",VALID_TITLE)){saveSimulatorUserSettings(b);a.dialog("close")}}},{id:"button-cancel",text:"Cancel",click:function(){a.dialog("close")}}]})}else{showJqueryMessage("simulatorMsg","Please select at least 1 provider.")}}function saveSimulatorUserSettings(c){var h=userFormatToDefaultFormat($F("startDate"),c);var b=userFormatToDefaultFormat($F("endDate"),c);var f=[$F("accountLeverage"),"%",$F("accountDeposit"),"%",h,"%",b,"%"];var a="";$$("#simulatorSubscribedSystemsTab [show=true]").each(function(q){var k=q.getAttribute("elementid");var s=$("balanceStop"+k).value;var m=$("drawdownStop"+k).value;var o=$("totalLots"+k).value;var l=$("totalOpenTrades"+k).value;var r=$("fixedLots"+k).value;var u=getTimeTableDate(k);var t=q.value;a+=k+"-"+t+"-"+s+"-"+m+"-"+o+"-"+l+"-"+r+"-"+u+"-"+getTradeSymbolsValues(k)+"!"});f.push(a);var d=f.join("");var g=escapeHtml($F("simulationTitle"));fxAjax.sendRequest(fxVars.saveSimulatorUserSettings,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:"title="+encodeParameter(g)+"&settings="+encodeParameter(d),method:"post",params:{settings:d,title:g,userTimeFormat:c},loader:false,callback:"saveSimulatorUserSettingsResponse"})}function saveSimulatorUserSettingsResponse(g,f){var c=g.content.oid;if(!g.error&&c!=null){var d=f.settings;var m=$("simulatorUserSettingsTable");var k=m.insertRow(m.rows.length);var a=new Element("a");var l=new Element("a");k.id="deleteSimulatorSettings"+c;a.innerHTML=f.title;a.onclick=function(){loadSimulatorUserSettings(d,f.userTimeFormat,true)};a.className="underline pointer";var b=k.insertCell(k.cells.length);b.appendChild(a);var h=k.insertCell(k.cells.length);h.align="right";l.className="closer pointer";l.onclick=function(){deleteSimulatorUserSettingsConfirmation(c)};h.appendChild(l);$("simulationTitle").value="";showElement("simulatorUserSettingsTable")}else{showJqueryMessage("simulatorMsg","General error.")}}function loadSimulatorUserSettings(x,w,y){$$("#mastersTable input[type=button]").each(function(C){C.value="Simulate";C.className="largeOff"});$$("#simulatorSubscribedSystemsTab [show=true]").each(function(C){C.setAttribute("firstmultiplier",0.5);C.value=0.5;C.setAttribute("show",false);var D=C.getAttribute("elementid");hideElement("row"+D)});var A=x.split("%");var k=A[0];var r=A[1];var d=A[2];var v=A[3];var b=A[4];var B=b.split("!");$("accountLeverage").value=k;$("accountDeposit").value=r;if(hasText(d)){$("startDate").value=defaultFormatTouserFormat(d,w)}if(hasText(v)){$("endDate").value=defaultFormatTouserFormat(v,w)}for(var u=0;u<B.length;u++){var a=B[u].split("-");if(a.length==9){var h=a[0];var g=a[1];var s=a[2];var o=a[3];var l=a[4];var q=a[5];var m=a[6];var z=a[7];var f=a[8];var c=$("masterButton"+h);var t=$("multiplier"+h);t.setAttribute("firstmultiplier",g);t.value=g;t.click();addOrDeleteSimulator(c,h,true);updateDefaultSettings(h,s,o,l,q,m,z,f);updateTimeTableData(h,z);updateTradeSymbols(h,f)}}startSimulation(w,true,null,true);if(y){hideElement("simulatorUserSettingsDiv")}}function deleteSimulatorUserSettingsConfirmation(b){var a="deleteSimulatorUserSettings("+b+")";showJqueryMessageWithOkAndCancel("simulatorMsg","Are you sure you wish to delete it?",a,null,300)}function deleteSimulatorUserSettings(a){fxAjax.sendRequest(fxVars.deleteSimulatorUserSettings+"oid="+a,{params:{oid:a},loader:false,callback:"deleteSimulatorUserSettingsResponse"})}function deleteSimulatorUserSettingsResponse(b,d){var a=b.content.deleted;if(!b.error&&a){var c=$("deleteSimulatorSettings"+d.oid);if(c!=null){c.remove()}}else{showJqueryMessage("simulatorMsg","General error.")}}var initSimulatorSettings=true;function showSimulatorSignalTraderSettingsWindow(c){initSimulatorSettings=true;var b=[{text:"Ok",click:function(){updateSimulatorSignalTraderSettings(c)}},{text:"Cancel",click:function(){a.dialog("close")}}];var a=jQuery("#masterSettings"+c).dialog({resizable:false,modal:true,width:600,buttons:b,close:function(d,f){if(initSimulatorSettings){initSimulatorSignalTraderSettings(c)}}})}function updateSimulatorSignalTraderSettings(c){var k=$("balanceStop"+c);var d=$("drawdownStop"+c);var f=$("totalLots"+c);var a=$("totalOpenTrades"+c);var h=$("fixedLots"+c);var l=getTimeTableDate(c);var b=getCheckBoxesValues("tradeSymbols"+c);if((!hasText(f.value)||validate(f.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))&&(!hasText(a.value)||validate(a.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(k.value)||validate(k.id,VALID_INTEGER_POSITIVE_WITHOUT_ZERO))&&(!hasText(d.value)||validate(d.id,VALID_PERCENT_WITHOUT_ZERO))&&(!hasText(h.value)||validate(h.id,VALID_DOUBLE_POSITIVE_WITHOUT_ZERO))){initSimulatorSettings=false;var g=jQuery("#masterSettings"+c);g.dialog("close");updateDefaultSettings(c,k.value,d.value,f.value,a.value,h.value,l,b)}}function initSimulatorSignalTraderSettings(c){var q=$("masterSettings"+c);var r=q.getAttribute("balanceStop");var h=q.getAttribute("drawdownStop");var f=q.getAttribute("totalLots");var b=q.getAttribute("totalOpenTrades");var d=q.getAttribute("fixedLots");var m=q.getAttribute("weekTimes");var l=q.getAttribute("tradeSymbols");var s=$("balanceStop"+c);var g=$("drawdownStop"+c);var k=$("totalLots"+c);var a=$("totalOpenTrades"+c);var o=$("fixedLots"+c);s.value=r;g.value=h;k.value=f;a.value=b;o.value=d;updateTimeTableData(c,m);updateTradeSymbols(c,l);initSimulatorSettings=true;initSignalSettings=true}function updateDefaultSettings(d,k,b,c,a,h,l,f){var g=jQuery("#masterSettings"+d);if(g!=null){g.attr("balanceStop",k);g.attr("drawdownStop",b);g.attr("totalLots",c);g.attr("totalOpenTrades",a);g.attr("fixedLots",h);g.attr("weekTimes",l);g.attr("tradeSymbols",f);$("balanceStop"+d).value=k;$("drawdownStop"+d).value=b;$("totalLots"+d).value=c;$("totalOpenTrades"+d).value=a;$("fixedLots"+d).value=h}}function updateSimulatorRisk(c,f){try{var b=getSimulatorRisk(f);if(c>b){b=c}var d=$("mainRisk");if(b<=100){d.setAttribute("risk",b);getMarginOrRiskColor(d,b);return true}}catch(a){}return false}function showSetSimulationAsAutoTradePortfolioWindow(){var a=$$("#simulatorSubscribedSystemsTab [show=true]");if(a.length>0){if(getSimulatorRisk()<=100){showJqueryMessageWithOkAndCancel("showSetSimulationAsAutoTradePortfolioWindow","","setSimulationAsAutoTradePortfolio()","",510)}else{showJqueryMessage("simulatorMsg","Please reduce the risk to less than 100%.")}}else{showJqueryMessage("simulatorMsg","Please select at least 1 provider.")}}function setSimulationAsAutoTradePortfolio(){var a="";$$("#simulatorSubscribedSystemsTab [show=true]").each(function(g){var b=g.getAttribute("elementid");var k=$("balanceStop"+b).value;var d=$("drawdownStop"+b).value;var f=$("totalLots"+b).value;var c=$("totalOpenTrades"+b).value;var h=$("fixedLots"+b).value;var m=getTimeTableDate(b);var l=g.value;a+=b+"-"+l+"-"+k+"-"+d+"-"+f+"-"+c+"-"+h+"-"+m+"-"+getTradeSymbolsValues(b)+"!"});fxAjax.sendRequest(fxVars.setSimulationAsAutoTradePortfolio,{contentType:"application/x-www-form-urlencoded; charset=utf-8",postBody:"settings="+encodeParameter(a)+"&slaveAccountOid="+$F("userAutoTradeAccounts"),method:"post",params:{},loader:false,callback:"setSimulationAsAutoTradePortfolioResponse"})}function setSimulationAsAutoTradePortfolioResponse(a,c){if(!a.error){showJqueryMessage("simulatorMsg","Simulation Added to AutoTrade Portfolio")}else{var b=a.message;if(b!=null){showJqueryMessage("simulatorMsg",b)}}}function getSimulatorRisk(c){var b=0;var a;$$("#simulatorSubscribedSystemsTab [show=true]").each(function(h){var f=Number(h.getAttribute("elementId"));if(f!=c){var d=Number($("drawdown"+f).getAttribute("drawdown"));var g=$("multiplier"+f);var k=Number(Number(parseFloat(g.value)).toFixed(1));a=k*d;if(a>b){b=a}}});return b}function initSimulatorHistoryTable(){if(simulatorHistorySortable){var a=$J("#simulatorHistoryTable tr").not(".skipSort");simulatorHistoryTable.rows=$A(a).map(function(b){return $(b)});simulatorHistoryTable.headerRow=simulatorHistoryTable.rows.shift();simulatorHistoryTable.headers=Selector.findChildElements(simulatorHistoryTable.headerRow,["th"]);simulatorHistoryTable.sortOnColumn(simulatorHistoryTh,simulatorHistorySpan,simulatorHistorySpan.order)}}function startSimulationFromAutoTrade(){var c=[50,"%",10000,"%","","%","","%"];var a="";try{$$("#subscribedSystems [firstmultiplier ]").each(function(g){var h=g.getAttribute("masterOid");var f=getCheckBoxesValues("tradeSymbols"+h);a+=g.getAttribute("masterOid")+"-"+g.value+"-"+$("balanceStop"+h).value+"-"+$("drawdownStop"+h).value+"-"+$("totalLots"+h).value+"-"+$("totalOpenTrades"+h).value+"-"+$("fixedLots"+h).value+"-"+getTimeTableDate(h)+"-"+f+"!"});c.push(a)}catch(d){}var b="";if(hasText(a)){b="/simulator.html?settings="+encodeParameter(c.join(""))}else{b="/autotrade/simulator"}window.open(b,"_self")}function updateTradeSymbols(g,f){var a=f.split(",");var d=document.getElementsByName("tradeSymbols"+g);for(var c=0;c<d.length;c++){var b=d[c];b.checked=a.indexOf(b.value)>=0}}var initSignalSettings=true;function showMasterSettingsSubmitDialog(id,func,close,width,buttonText){initSignalSettings=true;var buttons=[];if(func!=null){buttons=[{text:(buttonText!=null)?buttonText:"Submit",click:function(){eval(func);if(close){popup.dialog("close")}}},{text:"Cancel",click:function(){popup.dialog("close")}}]}var popup=jQuery("#masterSettings"+id).dialog({resizable:false,modal:true,width:width,buttons:buttons,close:function(event,ui){if(initSignalSettings){initSimulatorSignalTraderSettings(id)}}})}function getTradeSymbolsValues(b){var a=getCheckBoxesValues("tradeSymbols"+b);return hasText(a)?a:" "}function initMasterSettings(a){updateDefaultSettings(a,"","","","","","","");updateTimeTableData(a,"");updateTradeSymbols(a,"")}function updateSlaveRecommendedBalance(c,a){try{var b=0;var g;if(a){g=jQuery("[firstmultiplier][show=true]")}else{g=jQuery("[firstmultiplier]")}g.each(function(k){var h=this.getAttribute("elementid");var l=$("minBalance"+h);b+=calculateMinBalance(l,this.value,a)});var f=parseInt((c/b)*100);slaveRecommendedBalance.refresh((f<=100)?f:100)}catch(d){}}function updateTotal(o){try{var f=0;var g=0;var m=0;var b=0;var h=0;var d=0;var q=0;var l;if(o){l=jQuery("#subscribedSystemsTable [elementid][show=true]")}else{l=jQuery("#subscribedSystemsTable [elid]")}l.each(function(){var y=o?this.getAttribute("elementid"):this.getAttribute("elid");var x=$("multiplier"+y).value;var u=$("monthly"+y).getAttribute("balance");var v=$("minBalance"+y);var r=$("drawdown"+y).getAttribute("drawdown")*x;var t=$("daily"+y).getAttribute("daily")*x;var s=$("monthly"+y).getAttribute("monthly")*x;var w=$("mouse"+y).getAttribute("elc");f+=roundNumUp((t*u/100),2);g+=roundNumUp((s*u/100),2);m+=roundNumUp((r*u/100),2);b+=roundNumUp(t,2);h+=roundNumUp(s,2);d+=roundNumUp(r,2);q+=calculateMinBalance(v,x,o)});var a=$("totalMinBalance");var c=a.getAttribute("elc");$("hypotheticalTotalDaily").innerHTML=roundNumUp(b,2)+"%<br/>"+c+roundNumUp(f,2);$("hypotheticalTotalMonthly").innerHTML=roundNumUp(h,2)+"%<br/>"+c+roundNumUp(g,2);a.innerHTML=c+roundNumUp(q,2)}catch(k){}}function simulationGetDaysBetweenFirstStartDates(){var a=0;try{jQuery("#subscribedSystemsTable tr[style=''][date]").each(function(){var c=Number(this.getAttribute("date"));if(c!=null){var d=Math.floor((new Date().getTime()-c)/day)+1;if(d>a){a=d}}})}catch(b){}return a}function getLots(b){var a;if(b>=100000000){a=(b/100000000)+"m"}else{if(b>=100000){a=(b/100000)+"k"}else{if(b>=1000){a=(b/100)}else{a=b.toFixed(2)}}}return a}(function(){var a=[].indexOf||function(f){for(var d=0,c=this.length;d<c;d++){if(d in this&&this[d]===f){return d}}return -1},b=[].slice;(function(c,d){if(typeof define==="function"&&define.amd){return define("waypoints",["jquery"],function(f){return d(f,c)})}else{return d(c.jQuery,c)}})(this,function(d,h){var u,s,v,x,m,f,g,o,l,y,k,r,w,t,c,q;u=d(h);o=a.call(h,"ontouchstart")>=0;x={horizontal:{},vertical:{}};m=1;g={};f="waypoints-context-id";k="resize.waypoints";r="scroll.waypoints";w=1;t="waypoints-waypoint-ids";c="waypoint";q="waypoints";s=(function(){function z(A){var B=this;this.$element=A;this.element=A[0];this.didResize=false;this.didScroll=false;this.id="context"+m++;this.oldScroll={x:A.scrollLeft(),y:A.scrollTop()};this.waypoints={horizontal:{},vertical:{}};A.data(f,this.id);g[this.id]=this;A.bind(r,function(){var C;if(!(B.didScroll||o)){B.didScroll=true;C=function(){B.doScroll();return B.didScroll=false};return h.setTimeout(C,d[q].settings.scrollThrottle)}});A.bind(k,function(){var C;if(!B.didResize){B.didResize=true;C=function(){d[q]("refresh");return B.didResize=false};return h.setTimeout(C,d[q].settings.resizeThrottle)}})}z.prototype.doScroll=function(){var A,B=this;A={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};if(o&&(!A.vertical.oldScroll||!A.vertical.newScroll)){d[q]("refresh")}d.each(A,function(E,D){var G,F,C;C=[];F=D.newScroll>D.oldScroll;G=F?D.forward:D.backward;d.each(B.waypoints[E],function(J,I){var K,H;if((D.oldScroll<(K=I.offset)&&K<=D.newScroll)){return C.push(I)}else{if((D.newScroll<(H=I.offset)&&H<=D.oldScroll)){return C.push(I)}}});C.sort(function(I,H){return I.offset-H.offset});if(!F){C.reverse()}return d.each(C,function(I,H){if(H.options.continuous||I===C.length-1){return H.trigger([G])}})});return this.oldScroll={x:A.horizontal.newScroll,y:A.vertical.newScroll}};z.prototype.refresh=function(){var C,A,B,D=this;B=d.isWindow(this.element);A=this.$element.offset();this.doScroll();C={horizontal:{contextOffset:B?0:A.left,contextScroll:B?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:B?0:A.top,contextScroll:B?0:this.oldScroll.y,contextDimension:B?d[q]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};return d.each(C,function(F,E){return d.each(D.waypoints[F],function(K,H){var J,I,M,L,G;J=H.options.offset;M=H.offset;I=d.isWindow(H.element)?0:H.$element.offset()[E.offsetProp];if(d.isFunction(J)){J=J.apply(H.element)}else{if(typeof J==="string"){J=parseFloat(J);if(H.options.offset.indexOf("%")>-1){J=Math.ceil(E.contextDimension*J/100)}}}H.offset=I-E.contextOffset+E.contextScroll-J;if((H.options.onlyOnScroll&&(M!=null))||!H.enabled){return}if(M!==null&&(M<(L=E.oldScroll)&&L<=H.offset)){return H.trigger([E.backward])}else{if(M!==null&&(M>(G=E.oldScroll)&&G>=H.offset)){return H.trigger([E.forward])}else{if(M===null&&E.oldScroll>=H.offset){return H.trigger([E.forward])}}}})})};z.prototype.checkEmpty=function(){if(d.isEmptyObject(this.waypoints.horizontal)&&d.isEmptyObject(this.waypoints.vertical)){this.$element.unbind([k,r].join(" "));return delete g[this.id]}};return z})();v=(function(){function z(A,C,B){var D,E;B=d.extend({},d.fn[c].defaults,B);if(B.offset==="bottom-in-view"){B.offset=function(){var F;F=d[q]("viewportHeight");if(!d.isWindow(C.element)){F=C.$element.height()}return F-d(this).outerHeight()}}this.$element=A;this.element=A[0];this.axis=B.horizontal?"horizontal":"vertical";this.callback=B.handler;this.context=C;this.enabled=B.enabled;this.id="waypoints"+w++;this.offset=null;this.options=B;C.waypoints[this.axis][this.id]=this;x[this.axis][this.id]=this;D=(E=A.data(t))!=null?E:[];D.push(this.id);A.data(t,D)}z.prototype.trigger=function(A){if(!this.enabled){return}if(this.callback!=null){this.callback.apply(this.element,A)}if(this.options.triggerOnce){return this.destroy()}};z.prototype.disable=function(){return this.enabled=false};z.prototype.enable=function(){this.context.refresh();return this.enabled=true};z.prototype.destroy=function(){delete x[this.axis][this.id];delete this.context.waypoints[this.axis][this.id];return this.context.checkEmpty()};z.getWaypointsByElement=function(A){var C,B;B=d(A).data(t);if(!B){return[]}C=d.extend({},x.horizontal,x.vertical);return d.map(B,function(D){return C[D]})};return z})();y={init:function(B,z){var A;if(z==null){z={}}if((A=z.handler)==null){z.handler=B}this.each(function(){var F,E,D,C;F=d(this);D=(C=z.context)!=null?C:d.fn[c].defaults.context;if(!d.isWindow(D)){D=F.closest(D)}D=d(D);E=g[D.data(f)];if(!E){E=new s(D)}return new v(F,E,z)});d[q]("refresh");return this},disable:function(){return y._invoke(this,"disable")},enable:function(){return y._invoke(this,"enable")},destroy:function(){return y._invoke(this,"destroy")},prev:function(A,z){return y._traverse.call(this,A,z,function(B,C,D){if(C>0){return B.push(D[C-1])}})},next:function(A,z){return y._traverse.call(this,A,z,function(B,C,D){if(C<D.length-1){return B.push(D[C+1])}})},_traverse:function(C,A,B){var z,D;if(C==null){C="vertical"}if(A==null){A=h}D=l.aggregate(A);z=[];this.each(function(){var E;E=d.inArray(this,D[C]);return B(z,E,D[C])});return this.pushStack(z)},_invoke:function(z,A){z.each(function(){var B;B=v.getWaypointsByElement(this);return d.each(B,function(D,C){C[A]();return true})});return this}};d.fn[c]=function(){var z,A;A=arguments[0],z=2<=arguments.length?b.call(arguments,1):[];if(y[A]){return y[A].apply(this,z)}else{if(d.isFunction(A)){return y.init.apply(this,arguments)}else{if(d.isPlainObject(A)){return y.init.apply(this,[null,A])}else{if(!A){return d.error("jQuery Waypoints needs a callback function or handler option.")}else{return d.error("The "+A+" method does not exist in jQuery Waypoints.")}}}}};d.fn[c].defaults={context:h,continuous:true,enabled:true,horizontal:false,offset:0,triggerOnce:false};l={refresh:function(){return d.each(g,function(A,z){return z.refresh()})},viewportHeight:function(){var z;return(z=h.innerHeight)!=null?z:u.height()},aggregate:function(C){var A,B,z;A=x;if(C){A=(z=g[d(C).data(f)])!=null?z.waypoints:void 0}if(!A){return[]}B={horizontal:[],vertical:[]};d.each(B,function(E,D){d.each(A[E],function(G,F){return D.push(F)});D.sort(function(G,F){return G.offset-F.offset});B[E]=d.map(D,function(F){return F.element});return B[E]=d.unique(B[E])});return B},above:function(z){if(z==null){z=h}return l._filter(z,"vertical",function(B,A){return A.offset<=B.oldScroll.y})},below:function(z){if(z==null){z=h}return l._filter(z,"vertical",function(B,A){return A.offset>B.oldScroll.y})},left:function(z){if(z==null){z=h}return l._filter(z,"horizontal",function(B,A){return A.offset<=B.oldScroll.x})},right:function(z){if(z==null){z=h}return l._filter(z,"horizontal",function(B,A){return A.offset>B.oldScroll.x})},enable:function(){return l._invoke("enable")},disable:function(){return l._invoke("disable")},destroy:function(){return l._invoke("destroy")},extendFn:function(z,A){return y[z]=A},_invoke:function(A){var z;z=d.extend({},x.vertical,x.horizontal);return d.each(z,function(C,B){B[A]();return true})},_filter:function(z,B,D){var A,C;A=g[d(z).data(f)];if(!A){return[]}C=[];d.each(A.waypoints[B],function(F,E){if(D(A,E)){return C.push(E)}});C.sort(function(F,E){return F.offset-E.offset});return d.map(C,function(E){return E.element})}};d[q]=function(){var z,A;A=arguments[0],z=2<=arguments.length?b.call(arguments,1):[];if(l[A]){return l[A].apply(null,z)}else{return l.aggregate.call(null,A)}};d[q].settings={resizeThrottle:100,scrollThrottle:30};return u.load(function(){return d[q]("refresh")})})}).call(this);(function(){(function(a,b){if(typeof define==="function"&&define.amd){return define(["jquery","waypoints"],b)}else{return b(a.jQuery)}})(this,function(b){var c,a;c={wrapper:'<div class="sticky-wrapper" />',stuckClass:"stuck"};a=function(f,d){f.wrap(d.wrapper);f.each(function(){var g;g=b(this);g.parent().height(g.outerHeight());return true});return f.parent()};return b.waypoints("extendFn","sticky",function(g){var f,d;g=b.extend({},b.fn.waypoint.defaults,c,g);f=a(this,g);d=g.handler;g.handler=function(l){var h,k;h=b(this).children(":first");k=l==="down"||l==="right";h.toggleClass(g.stuckClass,k);if(d!=null){return d.call(this,l)}};f.waypoint(g);return this})})}).call(this);var notificationDialogIsOpen=false;function getAccountNotification(c,a){if(notificationDialogIsOpen){$JD.close("#accountNotification");getAccountNotification(c,a)}else{if(hasText(a)&&hasText(c)){var b=["accountOid=",a,"&typeAccount=",c];fxAjax.sendRequest(fxVars.getAccountNotification+b.join(""),{loader:false,callback:"getAccountNotificationResponse"})}}}function getAccountNotificationResponse(a){if(!a.error){$("editNotification").innerHTML=a.content.edit;$("addNotification").innerHTML=a.content.data;var b={};b.width=600;b.height=300;b.top=535;b.resizable=false;b.close=function(c,d){clearAccountNotificationWindow();notificationDialogIsOpen=false;$JD.destroy("#accountNotification")};$JD.create("#accountNotification",b);notificationDialogIsOpen=true;showDisabledNotificationTip()}}function clearAccountNotificationWindow(){hideElement("accountNotification");hideElement("addNotification");showElement("addNewNotificationAccount")}function addAccountNotification(accountOid,typeAccount,oid){if(validate("notificationAddTargetInput",VALID_ABSOLUTE_NUMBER)){var target=$F("notificationAddTargetInput");var selectFieldType=$("notificationAddTypeSelect");var selectType=parseInt(selectFieldType.value);var isPercent=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"isPercent"));var onlyPositive=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"onlyPositive"));if(isPercent&&!onlyPositive&&(target<-100||target>100)){inlineMsg("notificationAddTargetInput","<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[-100,100]),3)}else{if(isPercent&&onlyPositive&&(target<0||target>100)){inlineMsg("notificationAddTargetInput","<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3)}else{if(!isPercent&&onlyPositive&&target<0){inlineMsg("notificationAddTargetInput","<strong>"+$T("tError")+"</strong><br />"+$T("tYouMustEnterValidPositiveNumber"),3)}else{showElement("addNewNotificationAccount");var relation=$F("notificationAddRelationSelect");var relationTime="";if(selectType==25){relationTime=$F("notificationAddRelationTimeSelect")}var data=["accountOid=",accountOid,"&typeAccount=",typeAccount,"&type=",selectType,"&relation=",relation,"&target=",target,"&relationTime=",relationTime];fxAjax.sendRequest(fxVars.addAccountNotification+data.join(""),{params:{oid:oid,typeAccount:typeAccount},loader:false,callback:"addAccountNotificationResponse"})}}}}}function addAccountNotificationResponse(a,b){if(!a.error){$("editNotification").innerHTML=a.content.edit;$("addNotification").innerHTML=a.content.data;hideElement("addNotification");showElement("accountNotification");showElement("addAccountNotification");onOffAccountNotify(b.typeAccount,b.oid,"notifyOn")}else{inlineMsg("notificationAddTargetInput",a.message,3)}}function editRemoveAccountNotification(notificationOid,edit,accountOid,typeAccount){var data;var error=false;if(edit){if(validate("notificationEditTargetInput"+notificationOid,VALID_ABSOLUTE_NUMBER)){var selectFieldType=$("notificationEditTypeSelect"+notificationOid);var selectType=parseInt(selectFieldType.value);var isPercent=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"isPercent"));var onlyPositive=eval($AT(selectFieldType.options[selectFieldType.selectedIndex],"onlyPositive"));var selectRelationSelectType=$("notificationEditRelationSelect"+notificationOid);var relation=eval($AT(selectRelationSelectType.options[selectRelationSelectType.selectedIndex],"value"));var target=$F("notificationEditTargetInput"+notificationOid);if(isPercent&&!onlyPositive&&(target<-100||target>100)){inlineMsg("notificationEditTargetInput"+notificationOid,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[-100,100]),3);error=true}else{if(isPercent&&onlyPositive&&(target<0||target>100)){inlineMsg("notificationEditTargetInput"+notificationOid,"<strong>"+$T("tError")+"</strong><br />"+$T("tPleaseEnterNumberBetween",[0,100]),3);error=true}else{if(!isPercent&&onlyPositive&&target<0){inlineMsg("notificationEditTargetInput"+notificationOid,"<strong>"+$T("tError")+"</strong><br />"+$T("tYouMustEnterValidPositiveNumber"),3);error=true}}}var relationTime="";if(selectType==25){relationTime=$F("notificationEditRelationTimeSelect"+notificationOid)}data=["notificationOid=",notificationOid,"&edit=","true","&relation=",relation,"&target=",target,"&relationTime=",relationTime]}else{error=true}}else{data=["notificationOid=",notificationOid,"&edit=","false"];var notificationsCount=parseInt($F("notificationsCount"));$("notificationsCount").value=notificationsCount-1}if(!error){fxAjax.sendRequest(fxVars.editRemoveAccountNotification+data.join(""),{loader:false,params:{accountOid:accountOid,typeAccount:typeAccount,notificationOid:notificationOid,edit:edit},callback:"editRemoveAccountNotificationResponse"})}}function editRemoveAccountNotificationResponse(a,b){if(!a.error){if(!b.edit){removeElement("notificationEditRow"+b.notificationOid);var c=parseInt($F("notificationsCount"));if(c!=0){onOffAccountNotify(b.typeAccount,b.accountOid,"notifyOn")}else{onOffAccountNotify(b.typeAccount,b.accountOid,"notifyOff")}}hideElement("notificationSave"+b.notificationOid);hideElement("notificationCancel"+b.notificationOid)}else{inlineMsg("notificationEditRow"+b.notificationOid,a.message,3)}}function cancelAccountNotification(a){if(!hasText(a)){hideElement("addNotification");showElement("addNewNotificationAccount");$("notificationAddRelationSelect").selectedIndex=0;$("notificationAddTypeSelect").selectedIndex=0;$("notificationAddRelationTimeSelect").selectedIndex=0;$("notificationAddTargetInput").value=""}else{hideElement("notificationSave"+a);hideElement("notificationCancel"+a);$("notificationEditRelationSelect"+a).selectedIndex=$F("originalRelationOption"+a);$("notificationEditRelationTimeSelect"+a).selectedIndex=$F("originalRelationTimeOption"+a);$("notificationEditTargetInput"+a).value=$F("originalNotificationValue"+a)}}function onOffAccountNotify(a,b,c){$(((a==0)?"myAccount":"watched")+b).className=c}var drawDownType="4";var tradesType="13";var lotsType="21";var avgTradeLengthType="25";function showRelevantOption(d,f){var a=$J(".relationOptions"+f);var c=$J("#notificationAddRelationTimeSelect"+f)[0];var b=$J("#relationTimeOptions"+f)[0];switch(d.value){case drawDownType:case tradesType:case lotsType:if(d.value!=tradesType){a[1].disabled=true}a[0].selected=true;hideElement(c);hideElement(b);break;case avgTradeLengthType:a[1].disabled=false;showElement(c);showElement(b);break;default:a[1].disabled=false;hideElement(c);hideElement(b);break}}function showDisabledNotificationTip(){$J(".disabledNotification").each(function(){new Tip(this,$T("tAccountNotificationDisabled"))})}var AdScrollObject=function(b){var t=false;var k=$J("#"+b);var f=undefined;var u=k.offset().top;var g=k.height();var s=$J("#footerAds");var q;if(s.isExist()){q=s}else{q=$J("#wrap")}var c;if(b=="rightColumn"){c=k.find("[ads=true]")}else{c=k}function a(v){if(!t&&$J(window).scrollTop()>u){m();t=true}}var o=k.waypoint(function(v){if(!t&&$J(window).scrollTop()>u){m();t=true}});function m(){c.css("position","fixed");c.css("top","0")}function r(){var w=q.offset().top;var v=$J(window).scrollTop()+g;return w<=v+10}function l(){c.css("position","");c.css("top",0);k.css("top",0);t=false;$J.waypoints("refresh")}function d(){c.css("position","");k.css("top",q.offset().top-u-g-10)}function h(v){if(v){m()}f=$J(window).scrollTop()}this.doScroll=function(){if(t){var v=r();var x=$J(window).scrollTop();var w=f>=x;if((!v||w)&&x>u){h(w)}else{if(x<u){l()}else{if(v){d()}}}}}};var adsPopup={showPopup:function(){var c=$J("#adsblock");if(c.length===1){var a=null;var b=$J(document).keypress(function(d){d.preventDefault()});$J("html").css("overflow","hidden");$J("#closeAdsblock").click(function(d){d.preventDefault();if(a!==null){window.clearTimeout(a)}c.hide();$J("#panelHolder").show();$J("html").css("overflow","auto");$J(document).unbind("keypress")});a=window.setTimeout(function(){c.hide();$J("#panelHolder").show();$J("html").css("overflow","auto");$J(document).unbind("keypress")},30000)}}};jQuery.fn.center=function(){this.css("top",Math.max(0,(($J(window).height()-$J(this).outerHeight())/2)+$J(window).scrollTop())+"px");this.css("left",Math.max(0,(($J(window).width()-$J(this).outerWidth())/2)+$J(window).scrollLeft())+"px");return this};jQuery.fn.setBodyHeight=function(){this.css("height",$J(document).height()+"px")};var pagePopupAd=false;$J(document).ready(function(){if(pagePopupAd){var b=$J("#mainPopUpContainer");b.show();var a=$J("#mainLightBoxFilter");a.show();a.setBodyHeight()}});function closeLightBox(){$J("#mainPopUpContainer").hide();$J("#mainLightBoxFilter").hide()}$J(document).keyup(function(a){if(a.keyCode==27&&isShown("mainPopUpContainer")){closeLightBox()}});function addContactConfirmWindow(b){var a=jQuery("#addContactConfirmWindow").dialog({resizable:false,modal:true,width:450,buttons:[{text:"Ok",click:function(){if(validate("contactComment",VALID_TEXT)){addContact(b);a.dialog("close")}}},{id:"button-cancel",text:"Cancel",click:function(){a.dialog("close")}}]})}function addContact(a){var b=["toUser=",a,"&text=",encodeParameter($F("contactComment"))];fxAjax.sendRequest(fxVars.addContact,{contentType:"application/x-www-form-urlencoded; charset=utf-8",method:"post",postBody:b.join(""),params:{},loader:false,callback:"addContactResponse"})}function addContactResponse(a,b){if(!a.error){jQuery("#addContact").removeAttr("onclick");showJqueryMessage("contactRequestSent","Contact request sent")}else{showErrorMessage("contactRequestSent",a)}}function approveOrDisapproveContact(c,f,a,b){var d=["oid=",c,"&approve=",f];fxAjax.sendRequest(fxVars.approveOrDisapproveContact+d.join(""),{params:{approve:f,chatPage:a,oid:c,uid:b},loader:false,callback:"approveOrDisapproveContactResponse"})}function approveOrDisapproveContactResponse(a,f){var d=f.approve?"Approved":"Disapproved";if(!a.error){if(!f.approve){if(f.chatPage){hideElement("removeContact");jQuery("#addContact").attr("onclick","addContactConfirmWindow("+f.uid+");");showElement("addContact")}var c=$("chatUserRow"+f.oid);if(c!=null){c.remove()}var b=$("chatMain"+f.oid);if(b!=null){b.remove()}updateChatWindowsCookie();updateContactsOnlineStatus()}else{if(f.chatPage){jQuery("#addContact").removeAttr("onclick")}}}else{showErrorMessage("contactRequest",a)}}function showErrorMessage(c,a){var b=a.message;if(b!=null){showJqueryMessage(c,b)}}function sendChatMsg(b,d,a){var c=$F("chatText"+b);if(hasText(c)){createChatMsg(d,b,escapeHtml(c),false,true,Math.random(),false,new Date().getTime());fxWebsocket.sendWithInvite("chat",c,b,a);chatsLastMsgTimes[b]=0}}function chatReceiveMsg(b){var a=b.oid;var d=b.chatOid;var f=b.date;var c=jQuery("#chatMain"+d+" [msgOid]:last-child")[0];if((c!=null&&Number(c.getAttribute("msgOid")<a))||c==null){var h=b.fromUid;var g=b.text;var k=Number($F("userId"))!=h;createChatMsg(h,d,g,false,true,a,k,f);hideElement("chatTyping"+d)}}function createChatMsg(q,f,l,k,a,y,r,g){var z=jQuery("#chatAvatar"+q).attr("name");var h=jQuery("#chatAvatar"+q+" div").clone(true)[0];h.removeChild(h.childElements()[1]);var o=$("chatMain"+f);var w=$("chatText"+f);var s=$("chatTitle"+f);var v=jQuery("#chat"+f+" div[class=jspPane]")[0];var u="borderB padd3 floatLeft maxWidth1 relative";if(r){u+=" bg1"}var x=new Element("div",{id:"chatMsg"+y,className:u,msgoid:y,time:g});x.onmouseover=function(){showElement("chatMsgTime"+y)};x.onmouseout=function(){hideElement("chatMsgTime"+y)};var c=new Element("span",{className:"absolute gray1 font10 whiteBG",style:"right: 5px; bottom:-6px;display: none;z-index:1",id:"chatMsgTime"+y});c.innerHTML=getTime(g);var t=new Element("span",{});var m=null;t.innerHTML=createLineBreakes(makeImgAndUrlFromText((l),"display:block;max-width:207px;height:163px"));h.className="relative inlineBlock pointer marginR5 floatLeft";h.onclick=function(){window.open("/members/"+z)};if(!isShown(o.id)){var d=jQuery("#chatsFooter div[show=true]");if(d!=null&&d.size()>=4){var b=d[d.size()-1];hideElement(b);b.setAttribute("show",false)}o.setAttribute("show",true)}showElement(o);updateChatWindowsCookie();x.appendChild(h);x.appendChild(t);x.appendChild(c);if(v==null){v=jQuery("#chat"+f)[0]}if(k){v.insertBefore(x,v.firstChild)}else{v.appendChild(x)}if(a){createChatScroller("chat",f,a,true)}if(r){if(jQuery(w).is(":focus")){updateLastChatVisibleDate(f,w.getAttribute("lastElementId"))}else{s.className="padd5 bg9 whiteColor blink"}if(!windowIsInFocus){$J.titleAlert("New message",{requireBlur:true,stopOnFocus:true,duration:0,interval:1000})}}}var chatsLastMsgTimes={};function submitChatMsg(d,g,c,h,b){var a;if(window.event){a=window.event.keyCode}else{if(g){a=g.which}else{return true}}if(a==13&&!g.shiftKey){if(g.preventDefault){g.preventDefault()}else{g.returnValue=false}sendChatMsg(c,h,b);d.value="";d.style.height="16px"}else{var f=chatsLastMsgTimes[c];if(f==null){f=0;chatsLastMsgTimes[c]=f}if(new Date().getTime()-f>Number($F("chatTypingSendDelay"))){fxWebsocket.sendChatMsg("chat","",c,b,true);chatsLastMsgTimes[c]=new Date().getTime()}}}function removeContactConfirm(c,d,a){var f="Are you sure you want to remove "+d+" from your contact list?";var b="approveOrDisapproveContact("+c+","+false+","+true+","+a+")";showJqueryMessageWithOkAndCancel("removeContactMsg",f,b,null,null)}function contactsOnline(response){var uid=response.uid;var status=response.status;var chatAvatar=$("chatAvatar"+uid);jQuery("#contactsFooter [name=userOnlineStatus"+uid+"]").each(function(){this.className=(status==0)?"offline":"online"});jQuery("#chatsFooter [name=userTitleOnlineStatus"+uid+"]").each(function(){this.className=(status==0)?"offline1":"online1"});if(!eval(chatAvatar.getAttribute("pending"))){updateContactOnlineStatus(eval(chatAvatar.getAttribute("pending")),status,chatAvatar);updateContactsOnlineStatus()}}function updateContactOnlineStatus(c,a,b){if(a==1){jQuery("#onlineContact").after(b.parentNode.parentNode.parentNode)}else{jQuery("#offineContact").after(b.parentNode.parentNode.parentNode)}b.setAttribute("status",a)}function showOrHideContactChat(k,g,f,m,h){var a=$("chatMain"+k);var d=false;if(!h){hideElement(a);d=true}else{var b=$("chatsFooter");if(!isShown(a.id)){subscribeChatChannel(k,g,f);var l=jQuery("#chatsFooter div[show=true]");if(l!=null&&l.size()>=4){var c=l[l.size()-1];hideElement(c);c.setAttribute("show",false)}b.insertBefore(a,b.firstChild);d=true}showElement(a);if(m){$("chatText"+k).focus()}createChatScroller("chat",k,true,true)}a.setAttribute("show",h);if(d){updateChatWindowsCookie()}}function updateChatWindowsCookie(){var a=[];if(isShown("contactsFooter")){a.push(0)}jQuery("#chatsFooter div[show=true]").each(function(){a.push(this.getAttribute("chatOid"))});setCookie("chatWindows",a.join("-"),hasText(a)?YEAR:0)}function subscribeChatChannel(b,g,a){if(chatChannels.indexOf("chat"+b)==-1){var f=0;var d=g+"_"+a;var c=jQuery("#chatMain"+b+" [msgOid]:last-child")[0];if(c!=null){f=c.getAttribute("time")}fxWebsocket.subscribe("chat",b,f,d);chatChannels.push("chat"+b)}}function createChatScroller(a,h,b,g){var d=a+h;var f=jQuery("#"+d);var c=f.data("jsp");if(c!=null){f.unbind("jsp-scroll-y");c.reinitialise();if(g){bindToChatScroller(f,h)}}else{if(b){f.scrollTop(f.height())}f.jScrollPane({animateScroll:true,verticalGutter:0});if(g){bindToChatScroller(f,h)}f.hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(k){stopWheel(k)})},function(){jQuery(document).unbind("mousewheel DOMMouseScroll")});c=f.data("jsp")}if(b&&c!=null){c.scrollToBottom(false)}}function bindToChatScroller(pane,id){pane.bind("jsp-scroll-y",function(event,scrollPositionY,isAtTop,isAtBottom){var allowScrool=eval(this.getAttribute("scroll"));if(scrollPositionY<=10&&!scrollerLock&&(allowScrool==null||allowScrool)){scrollerLock=true;getChatHistory(id)}})}function getChatHistory(c){var d=jQuery("#chat"+c+" div[msgOid]");if(d!=null&&d.size()>0){var a=d[0].getAttribute("msgOid");var b=["chatOid=",c,"&contactHistoryOid=",a];fxAjax.sendRequest(fxVars.getChatHistory+b.join(""),{params:{chatOid:c},loader:false,callback:"getChatHistoryResponse"})}}var scrollerLock=false;function getChatHistoryResponse(g,f){if(!g.error){var k=g.content.history;var c=jQuery("#chat"+f.chatOid);var l=c.data("jsp");if(k!=null&&k.length>0){var a=jQuery("#chat"+f.chatOid+" div[class=jspPane]")[0];if(a!=null){var m=a.firstChild;for(var h=0;h<k.length;h++){var b=k[h];var d=(Number($("chatMain"+f.chatOid).getAttribute("lastChatVisibleDate"))<b.date&&b.uid!=Number($F("userId")));createChatMsg(b.uid,b.chatOid,escapeHtml(b.text),true,false,b.oid,d,b.date)}createChatScroller("chat",f.chatOid,false,true);if(l!=null){l.scrollToElement(m,false,false)}}}else{c.attr("scroll",false)}}scrollerLock=false}var startUpdateLastChatVisibleDate=false;function updateLastChatVisibleDate(b,a){var c=jQuery("#chatMain"+b+" [msgOid]:last-child");if(c!=null&&c.size()==1){var d=c[0].getAttribute("msgoid");if(d!=null&&d!=a){if(!startUpdateLastChatVisibleDate){startUpdateLastChatVisibleDate=true;fxAjax.sendRequest(fxVars.updateLastChatVisibleDate+"chatOid="+b,{params:{chatOid:b,newElementId:d},loader:false,callback:"updateLastChatVisibleDateResponse"})}}}}function updateLastChatVisibleDateResponse(a,c){if(!a.error){var b=a.content.lastDate;$("chatText"+c.chatOid).setAttribute("lastElementId",c.newElementId);if(b!=null){$("chatMain"+c.chatOid).setAttribute("lastChatVisibleDate",b)}}startUpdateLastChatVisibleDate=false}function stopPulsate(b){var a=jQuery("#chatTitle"+b);a.stop(true,true);a.css({opacity:1})}function chatTextOnFocus(b,c){borderChange(b);updateLastChatVisibleDate(c,b.getAttribute("lastElementId"));$("chatTitle"+c).className="padd5 bg9 whiteColor";var d=jQuery("#chat"+c+" div[msgOid]");for(var a=0;a<d.length;a++){d[a].className="borderB padd3 floatLeft maxWidth1 relative"}}var urlPattern=new RegExp(/(?![^<]\\\\S+>)(?:(?:https?|ftp|file):\/\/|www\\\\.|ftp\\\\.)[-A-Z0-9+&@#/%;=%~_|$?!:,.]*[A-Z0-9+&@#/%;=%~_|$]/ig);var imgPattern=new RegExp(/https?:\/\/[\S]+.jpg|png|gif|png/ig);function makeImgAndUrlFromText(txt,style){var imgMatches=txt.match(imgPattern);var urlMatches=txt.match(urlPattern);var https=eval($J("#https").val());var urlPath=$J("#urlPath").val();if(imgMatches!=null){for(var i=0;i<imgMatches.length;i++){var imgMatch=imgMatches[i];var index=urlMatches.indexOf(imgMatch);if(urlMatches!=null&&index>=0){urlMatches.splice(index,1)}if(hasText(imgMatch)){var imageHttp=imgMatch;if(https){imageHttp=urlPath+"/safe-image.html?path="+encodeUrl(imageHttp)}txt=txt.replace(imgMatch,"<a href="+imageHttp+' target="_blank"><img style='+style+" src="+imageHttp+"></a>")}}}if(urlMatches!=null){for(var i=0;i<urlMatches.length;i++){var match=urlMatches[i];if(hasText(match)&&match.length>4){txt=txt.replace(match,"<a href="+match+' target="_blank" class="underline">'+match+"</a>")}}}return txt}function chatAddNewContact(c){var d=c.data;var b=c.chatOid;var h=c.from;var g=c.to;var f=c.online;if(hasText(d)&&b!=null){var m=jQuery("div[userid='"+g+"']");var k=jQuery("tr[userid='"+g+"']");if(m!=null){m.remove()}if(k!=null){k.remove()}var a=jQuery("#contactsTable");var o=(f)?jQuery("#onlineContact"):jQuery("#offineContact");if(o!=null){o.after('<tr id="chatUserRow'+b+'" userid="'+g+'"><td>'+d+"</td></tr>")}$("chatsFooter").appendChild($("chatMain"+b));if(isShown("contactsFooter")){createChatScroller("contactsList","",false,false)}else{$("showChatFooter").setAttribute("sc",false)}hideElement("contactsListEmpty");subscribeChatChannel(b,h,g);var l=$("chatAvatar"+g);l.setAttribute("status",f?1:0);updateContactsOnlineStatus()}}function createContactsListScroller(element){updateChatWindowsCookie();var sc=eval(element.getAttribute("sc"));if(!sc){createChatScroller("contactsList","",false,false);element.setAttribute("sc",true)}}function contactNotificatinStatusUpdate(a,b){jQuery("[name=contactsNotificatinStatus"+a+"]").each(function(){this.innerHTML=b})}function updateContactsOnlineStatus(){var b=jQuery("#contactsList [status=0]");var c=jQuery("#contactsList [status=1]");var a=jQuery("#contactsList [status=2]");if(c.length>0){showElement("onlineContact")}else{hideElement("onlineContact")}if(b.length>0){showElement("offineContact")}else{hideElement("offineContact")}if(a.length>0){showElement("pendingContact")}else{hideElement("pendingContact")}if(c.length==0&&b.length==0&&a.length==0){showElement("contactsListEmpty")}}var chatsTimers={};function chatTyping(b){var c=b.chatOid;showElement("chatTyping"+c);var a="chatTyping"+c;if(chatsTimers[c]==null){chatsTimers[c]=setVariableInterval(function(){hideElement(a);chatsTimers[c]=null;this.stop()},Number($F("chatTypingReceiveDelay")))}else{var d=chatsTimers[c];d.timeCount=0}}window.setVariableInterval=function(a,b){var c={interval:b,callback:a,stopped:false,timeCount:0,runLoop:function(){c.timeCount+=1000;if(c.stopped){return}if(c.timeCount>c.interval){var d=c.callback.call(c)}else{c.loop()}},stop:function(){this.stopped=true;window.clearTimeout(this.timeout)},start:function(){this.stopped=false;return this.loop()},loop:function(){this.timeout=window.setTimeout(this.runLoop,1000);return this}};return c.start()};function encodeUrl(a){return encodeURIComponent(a).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")}var isSearch=true;function initSearch(){var a=false;$J("#search").autocomplete({source:function(c,b){fxWebsocket.getToken().done(function(d){$J.ajax({url:fxVars.autoCompleteSearch,dataType:"json",data:{q:c.term,z:Math.random(),token:d},contentType:"application/json; charset=utf-8",success:function(f){try{b($J.map(f,function(k,h){return{id:k.id,name:k.name,label:k.label,icon:k.icon,link:k.link,value:k.value}}))}catch(g){}$J("#search").removeClass("ui-autocomplete-loading")}})})},minLength:1,select:function(b,c){a=true;window.location.href=c.item.link;return false},open:function(){$J(this).removeClass("ui-corner-all").addClass("ui-corner-top");$J(".ui-autocomplete").css("z-index",2000).css("width",170).css("top",110).css("margin-left",-2).css("background-color","#fff").css("background-image","none").addClass("boxShadow0");$J("#su0").removeClass("ui-menu-item").addClass("center bold padd5 bg6");$J("#ss0").removeClass("ui-menu-item").addClass("center bold padd5 bg6");$J("#sa0").removeClass("ui-menu-item").addClass("center bold padd5 bg6");$J("#sc0").removeClass("ui-menu-item").addClass("center bold padd5 bg6")},close:function(){$J(this).removeClass("ui-corner-top").addClass("ui-corner-all")},focus:function(b,c){$J("#search").val(c.item.name);return false}}).data("ui-autocomplete")._renderItem=function(d,h){var c=$J("<li style='float:none !important' id="+h.id+">");if(h.id!="su0"&&h.id!="ss0"&&h.id!="sa0"&&h.id!="sc0"){var b='target="_self" href="'+h.link+'"';var g=(h.icon!=null)?h.icon:"";var f=h.value!=null?"<span id='val"+h.id+"' style='margin-left:60px'>"+h.value+"</span>":"";c.append("<a class='pointer'  "+b+">"+g+" &nbsp;"+h.label+f+"</a>")}else{if(h.id=="sa0"){c.append("<a class='pointer' onclick=searchSiteFunc()>&nbsp;"+h.label+"</a>")}else{c.append(h.label)}}c.append("</li>").appendTo(d);return c};$J("#search").keypress(function(b){if(b.which==13){if(!a){searchSiteFunc()}return false}})}function autoCompleteUpdateSymbol(f){if(f.length==3){var l="sc"+f[1];var k=f[2];var d=$J("#val"+l);if(d.length){var h=parseFloat(k);var c=parseFloat($J("#val"+l).html());var g="";if(h>c){g="lightGreen radius3 padd3"}else{if(h<c){g="lightRed radius3 padd3"}}d.html(h);d.attr("class",g);var b=0}}}function createBrokerTableEl(g,f,c,a,h,l,k){var b=$J("#"+g);var q=$J("#"+f+b.val()).text();var o=g+b.val();if(b.val()!=0&&$J.inArray(q,h)==-1){var m=$J("#"+c);var r=m.find("tr:last");if(r.size()==0){m.append("<tr>")}r=m.find("tr:last");var d=(k)?"onchange='searchBrokerManage()'":"";if(r.find("td").size()<l){r.append("<td>");r.find("td:last").append('<input type="checkbox" id="'+o+'" name="'+a+'" value="'+b.val()+'" '+d+">").append('<label for="'+o+'"> '+q+"</label>")}else{m.append("<tr>");r=m.find("tr:last");r.append("<td>");r.find("td:last").append('<input type="checkbox" id="'+o+'" name="'+a+'" value="'+b.val()+'" '+d+">").append('<label for="'+o+'"> '+q+"</label>")}$J("#"+o).attr("checked","checked");if(k){searchBrokerManage()}h.push(q)}}function saveBrokerManage(){if(validate("brokerType",VALID_CHECKBOXES)&&validate("country",VALID_COUNTRY)&&validate("office",VALID_INTERNATIONAL_OFFICES)&&validate("regulation",VALID_CHECKBOXES)&&validate("operatingDate",VALID_YEAR)&&validate("address",VALID_ADDRESS)&&validate("numEmployees",VALID_INTEGER_POSITIVE_WITHOUT_ZERO)&&validate("brokerStatus",VALID_DROPDOWN)&&validate("currency",VALID_CHECKBOXES)&&validate("fundOrDepositMethod",VALID_CHECKBOXES)&&validate("email",VALID_EMAIL)&&validate("language",VALID_CHECKBOXES)&&validate("availability",VALID_CHECKBOXES)&&validate("platform",VALID_CHECKBOXES)&&(!$J("#demoExpiring").is(":checked")||validate("demoExpiringDays",VALID_NUMBER))&&validate("minDeposit",VALID_NUMBER)&&validate("maxLeverage",VALID_INTEGER_POSITIVE_WITHOUT_ZERO)&&validate("minLot",VALID_NUMBER)&&validate("maxLot",VALID_NUMBER)&&validate("commission",VALID_NUMBER)&&validate("demoUrl",VALID_URL)&&validate("liveUrl",VALID_URL)){var aa=$J("#brokerOid").val();var O=getCheckBoxesValues("brokerType");var V=$J("#country").val();var Z=getCheckBoxesValues("officeCountry");var x=getCheckBoxesValues("regulation");var ai=$J("#operatingDate").val();var H=$J("#brokerStatus").val();var L=getCheckBoxValue("status");var A=$J("#numEmployees").val();var ad=getRadioValue("clients");var X=getCheckBoxesValues("currency");var y=getCheckBoxesValues("fundOrDepositMethod");var q=getRadioValue("swapFree");var J=getRadioValue("segregated");var l=getRadioValue("marginInterest");var g=getRadioValue("managed");var m=getRadioValue("managers");var r=$J("#phone").val();var u=$J("#fax").val();var F=$J("#email").val();var Y=$J("#address").val();var C=getCheckBoxesValues("language");var t=getCheckBoxesValues("availability");var b=getCheckBoxesValues("platform");var f=$J("#timeZone").val();var M=getRadioValue("demo");var z=getCheckBoxValue("demoExpiring");var G=$J("#demoExpiringDays").val();var N=getRadioValue("mobile");var s=getRadioValue("web");var h=getRadioValue("api");var P=getRadioValue("oco");var K=getRadioValue("overPhone");var T=getRadioValue("hedge");var ab=getRadioValue("trailing");var aj=getRadioValue("oneClickTrading");var ak=getRadioValue("bonuses");var k=getRadioValue("contests");var v=getCheckBoxesValues("instruments");var B=$J("#minDeposit").val();var o=$J("#maxLeverage").val();var D=$J("#minLot").val();var S=$J("#maxLot").val();var c=$J("#commission").val();var ah=getCheckBoxesValues("ecnSpreads");var af=getRadioValue("centsDecimals");var a=getRadioValue("centsScalping");var w=$J("#generalInfo").val();var ae=$J("#demoUrl").val();var E=$J("#liveUrl").val();var U=$J("#logoUrl").val();var R;if($J("#approveBroker").val()=="yes"){R=true}else{if($J("#approveBroker").val()=="no"){R=false}}var Q=$J("#minLotComment").val();var W=$J("#maxLotComment").val();var I=$J("#minDepositComment").val();var d=$J("#maxLeverageComment").val();var ac=$J("#commissionComment").val();var ag=["brokerOid=",aa,"&brokerType=",O,"&country=",V,"&officeCountry=",Z,"&regulation=",x,"&operatingDate=",ai,"&brokerStatus=",H,"&status=",L,"&numEmployees=",A,"&clients=",ad,"&currency=",X,"&fundOrDepositMethod=",y,"&swapFree=",q,"&segregated=",J,"&marginInterest=",l,"&managed=",g,"&managers=",m,"&phone=",encodeParameter(r),"&fax=",encodeParameter(u),"&email=",F,"&language=",C,"&availability=",t,"&platforms=",b,"&address=",encodeParameter(Y),"&timeZone=",f,"&demo=",M,"&demoExpiring=",z,"&demoExpiringDays=",G,"&mobile=",N,"&web=",s,"&api=",h,"&oco=",P,"&overPhone=",K,"&hedge=",T,"&trailing=",ab,"&oneClickTrading=",aj,"&bonuses=",ak,"&contests=",k,"&instruments=",v,"&minDeposit=",B,"&maxLeverage=",o,"&minLot=",D,"&maxLot=",S,"&commission=",c,"&ecnSpreads=",ah,"&centsDecimals=",af,"&centsScalping=",a,"&generalInfo=",encodeParameter(w),"&demoUrl=",encodeParameter(ae),"&liveUrl=",encodeParameter(E),"&logoUrl=",encodeParameter(U),"&approvedBroker=",R,"&minLotComment=",encodeParameter(Q),"&maxLotComment=",encodeParameter(W),"&minDepositComment=",encodeParameter(I),"&maxLeverageComment=",encodeParameter(d),"&commissionComment=",encodeParameter(ac)];fxAjax.sendRequest(fxVars.brokerManageSave+ag.join(""),{method:"post",loader:true,callback:"brokerManageSaveResponse"})}}function brokerManageSaveResponse(a){$J("#brokerManageResponse").text(a.message);$J("#brokerManageResponse").show().delay(1500).fadeOut("slow")}function searchBrokerManage(){var B=false;var H=getCheckBoxesValues("brokerType");var L=getCheckBoxesValues("brokerCountry");var N=getCheckBoxesValues("officeCountry");var t=getCheckBoxesValues("regulation");var T=$J("#operatingDate").val();if(hasText(T)){if(!validate("operatingDate",VALID_YEAR)){B=true}}var w=$J("#numEmployees").val();if(hasText(w)){if(!validate("numEmployees",VALID_NUMBER)){B=true}}var A=getCheckBoxesValues("brokerStatus");var E=getCheckBoxIntValue("status");var P=getCheckBoxIntValue("client");var M=getCheckBoxesValues("currency");var u=getCheckBoxesValues("fundOrDepositMethod");var o=getCheckBoxIntValue("swapFree");var C=getCheckBoxIntValue("segregated");var k=getCheckBoxIntValue("marginInterest");var f=getCheckBoxIntValue("managed");var l=getCheckBoxIntValue("managers");var y=getCheckBoxesValues("language");var r=getCheckBoxesValues("availability");var b=getCheckBoxesValues("platform");var d=getCheckBoxesValues("timezone");var F=getCheckBoxIntValue("demo");var v=getCheckBoxIntValue("demoExpiring");var G=getCheckBoxIntValue("mobile");var q=getCheckBoxIntValue("web");var g=getCheckBoxIntValue("api");var I=getCheckBoxIntValue("oco");var D=getCheckBoxIntValue("overPhone");var K=getCheckBoxIntValue("hedge");var O=getCheckBoxIntValue("trailing");var U=getCheckBoxIntValue("oneClickTrading");var V=getCheckBoxIntValue("bonuses");var h=getCheckBoxIntValue("contests");var s=getCheckBoxesValues("instruments");var x=$J("#minDeposit").val();if(hasText(x)){if(!validate("minDeposit",VALID_DOUBLE_POSITIVE)){B=true}}var m=$J("#maxLeverage").val();if(hasText(m)){if(!validate("maxLeverage",VALID_DOUBLE_POSITIVE)){B=true}}var z=$J("#minLot").val();if(hasText(z)){if(!validate("minLot",VALID_DOUBLE_POSITIVE)){B=true}}var J=$J("#maxLot").val();if(hasText(J)){if(!validate("maxLot",VALID_DOUBLE_POSITIVE)){B=true}}var c=$J("#commission").val();if(hasText(c)){if(!validate("commission",VALID_DOUBLE_POSITIVE)){B=true}}var S=getCheckBoxesValues("ecnSpreads");var Q=getRadioValue("centsDecimals");var a=getCheckBoxIntValue("centsScalping");var R=["brokerType=",H,"&country=",L,"&officeCountry=",N,"&regulation=",t,"&operatingDate=",T,"&numEmployees=",w,"&brokerStatus=",A,"&status=",E,"&clients=",P,"&currency=",M,"&fundOrDepositMethod=",u,"&swapFree=",o,"&segregated=",C,"&marginInterest=",k,"&managed=",f,"&managers=",l,"&brokerLanguage=",y,"&availability=",r,"&platforms=",b,"&timeZone=",d,"&demo=",F,"&demoExpiring=",v,"&mobile=",G,"&web=",q,"&api=",g,"&oco=",I,"&overPhone=",D,"&hedge=",K,"&trailing=",O,"&oneClickTrading=",U,"&bonuses=",V,"&contests=",h,"&instruments=",s,"&minDeposit=",x,"&maxLeverage=",m,"&minLot=",z,"&maxLot=",J,"&commission=",c,"&centsScalping=",a,"&ecnSpreads=",S];if(hasText(Q)){R.push("&centsDecimals=");R.push(Q)}if(!B){dhtmlHistory.add("#?pt=51&p=1&sb=85&"+R.join(""));fxAjax.sendRequest(fxVars.brokerManageSearch+R.join(""),{loader:true,callback:"brokerManageSearchResponse"})}}function brokerManageSearchResponse(a){if(!a.error){$J("#brokersCont").html(a.content.data)}}function demoExpiringSwitch(){if($J("#demoExpiring").is(":checked")){$J("#demoExpiringDays").prop("disabled",false)}else{$J("#demoExpiringDays").val("");$J("#demoExpiringDays").prop("disabled",true)}}document.createElement("canvas").getContext||function(){function L(){}function O(b){this.type_=b,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function Q(f,d,g){!D(d)||(f.m_=d,g&&(f.lineScale_=aa(ab(d[0][0]*d[1][1]-d[0][1]*d[1][0]))))}function D(f){var d=0;for(;d<3;d++){var g=0;for(;g<2;g++){if(!isFinite(f[d][g])||isNaN(f[d][g])){return !1}}}return !0}function E(g,f,k,h){g.currentPath_.push({type:"bezierCurveTo",cp1x:f.x,cp1y:f.y,cp2x:k.x,cp2y:k.y,x:h.x,y:h.y}),g.currentX_=h.x,g.currentY_=h.y}function G(d){this.m_=M(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=Z*1,this.globalAlpha=1,this.canvas=d;var c=d.ownerDocument.createElement("div");c.style.width=d.clientWidth+"px",c.style.height=d.clientHeight+"px",c.style.overflow="hidden",c.style.position="absolute",d.appendChild(c),this.element_=c,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function H(b){switch(b){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function I(k){var h,r=1;k=String(k);if(k.substring(0,3)=="rgb"){var q=k.indexOf("(",3),o=k.indexOf(")",q+1),m=k.substring(q+1,o).split(",");h="#";var l=0;for(;l<3;l++){h+=R[Number(m[l])]}m.length==4&&k.substr(3,1)=="a"&&(r=m[3])}else{h=k}return{color:h,alpha:r}}function J(d,c){c.fillStyle=d.fillStyle,c.lineCap=d.lineCap,c.lineJoin=d.lineJoin,c.lineWidth=d.lineWidth,c.miterLimit=d.miterLimit,c.shadowBlur=d.shadowBlur,c.shadowColor=d.shadowColor,c.shadowOffsetX=d.shadowOffsetX,c.shadowOffsetY=d.shadowOffsetY,c.strokeStyle=d.strokeStyle,c.globalAlpha=d.globalAlpha,c.arcScaleX_=d.arcScaleX_,c.arcScaleY_=d.arcScaleY_,c.lineScale_=d.lineScale_}function K(k,h){var r=M(),q=0;for(;q<3;q++){var o=0;for(;o<3;o++){var m=0,l=0;for(;l<3;l++){m+=k[q][l]*h[l][o]}r[q][o]=m}}return r}function M(){return[[1,0,0],[0,1,0],[0,0,1]]}function S(d){var c=d.srcElement;c.firstChild&&(c.firstChild.style.width=c.clientWidth+"px",c.firstChild.style.height=c.clientHeight+"px")}function T(d){var c=d.srcElement;switch(d.propertyName){case"width":c.style.width=c.attributes.width.nodeValue+"px",c.getContext().clearRect();break;case"height":c.style.height=c.attributes.height.nodeValue+"px",c.getContext().clearRect()}}function V(f,d){var g=W.call(arguments,2);return function(){return f.apply(d,g.concat(W.call(arguments)))}}function X(){return this.context_||(this.context_=new G(this))}var af=Math,ae=af.round,ad=af.sin,ac=af.cos,ab=af.abs,aa=af.sqrt,Z=10,Y=Z/2,W=Array.prototype.slice,U={init:function(d){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var c=d||document;c.createElement("canvas"),c.attachEvent("onreadystatechange",V(this.init_,this,c))}},init_:function(g){g.namespaces.g_vml_||g.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),g.namespaces.g_o_||g.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML");if(!g.styleSheets.ex_canvas_){var f=g.createStyleSheet();f.owningElement.id="ex_canvas_",f.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}var k=g.getElementsByTagName("canvas"),h=0;for(;h<k.length;h++){this.initElement(k[h])}},initElement:function(d){if(!d.getContext){d.getContext=X,d.innerHTML="",d.attachEvent("onpropertychange",T),d.attachEvent("onresize",S);var c=d.attributes;c.width&&c.width.specified?d.style.width=c.width.nodeValue+"px":d.width=d.clientWidth,c.height&&c.height.specified?d.style.height=c.height.nodeValue+"px":d.height=d.clientHeight}return d}};U.init();var R=[],P=0;for(;P<16;P++){var N=0;for(;N<16;N++){R[P*16+N]=P.toString(16)+N.toString(16)}}var F=G.prototype;F.clearRect=function(){this.element_.innerHTML=""},F.beginPath=function(){this.currentPath_=[]},F.moveTo=function(f,d){var g=this.getCoords_(f,d);this.currentPath_.push({type:"moveTo",x:g.x,y:g.y}),this.currentX_=g.x,this.currentY_=g.y},F.lineTo=function(f,d){var g=this.getCoords_(f,d);this.currentPath_.push({type:"lineTo",x:g.x,y:g.y}),this.currentX_=g.x,this.currentY_=g.y},F.bezierCurveTo=function(u,t,s,r,q,o){var m=this.getCoords_(q,o),l=this.getCoords_(u,t),k=this.getCoords_(s,r);E(this,l,k,m)},F.quadraticCurveTo=function(k,h,r,q){var o=this.getCoords_(k,h),m=this.getCoords_(r,q),l={x:this.currentX_+0.6666666666666666*(o.x-this.currentX_),y:this.currentY_+0.6666666666666666*(o.y-this.currentY_)};E(this,l,{x:l.x+(m.x-this.currentX_)/3,y:l.y+(m.y-this.currentY_)/3},m)},F.arc=function(B,A,z,y,x,w){z*=Z;var v=w?"at":"wa",u=B+ac(y)*z-Y,t=A+ad(y)*z-Y,s=B+ac(x)*z-Y,h=A+ad(x)*z-Y;u==s&&!w&&(u+=0.125);var g=this.getCoords_(B,A),d=this.getCoords_(u,t),c=this.getCoords_(s,h);this.currentPath_.push({type:v,x:g.x,y:g.y,radius:z,xStart:d.x,yStart:d.y,xEnd:c.x,yEnd:c.y})},F.rect=function(g,f,k,h){this.moveTo(g,f),this.lineTo(g+k,f),this.lineTo(g+k,f+h),this.lineTo(g,f+h),this.closePath()},F.strokeRect=function(g,f,l,k){var h=this.currentPath_;this.beginPath(),this.moveTo(g,f),this.lineTo(g+l,f),this.lineTo(g+l,f+k),this.lineTo(g,f+k),this.closePath(),this.stroke(),this.currentPath_=h},F.fillRect=function(g,f,l,k){var h=this.currentPath_;this.beginPath(),this.moveTo(g,f),this.lineTo(g+l,f),this.lineTo(g+l,f+k),this.lineTo(g,f+k),this.closePath(),this.fill(),this.currentPath_=h},F.createLinearGradient=function(g,f,l,k){var h=new O("gradient");h.x0_=g,h.y0_=f,h.x1_=l,h.y1_=k;return h},F.createRadialGradient=function(k,h,r,q,o,m){var l=new O("gradientradial");l.x0_=k,l.y0_=h,l.r0_=r,l.x1_=q,l.y1_=o,l.r1_=m;return l},F.drawImage=function(aq){var ap,ao,an,am,al,ak,aj,ai,ah=aq.runtimeStyle.width,ag=aq.runtimeStyle.height;aq.runtimeStyle.width="auto",aq.runtimeStyle.height="auto";var C=aq.width,B=aq.height;aq.runtimeStyle.width=ah,aq.runtimeStyle.height=ag;if(arguments.length==3){ap=arguments[1],ao=arguments[2],al=ak=0,aj=an=C,ai=am=B}else{if(arguments.length==5){ap=arguments[1],ao=arguments[2],an=arguments[3],am=arguments[4],al=ak=0,aj=C,ai=B}else{if(arguments.length==9){al=arguments[1],ak=arguments[2],aj=arguments[3],ai=arguments[4],ap=arguments[5],ao=arguments[6],an=arguments[7],am=arguments[8]}else{throw Error("Invalid number of arguments")}}}var A=this.getCoords_(ap,ao),z=[];z.push(" <g_vml_:group",' coordsize="',Z*10,",",Z*10,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;");if(this.m_[0][0]!=1||this.m_[0][1]){var y=[];y.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",ae(A.x/Z),",","Dy=",ae(A.y/Z),"");var x=A,g=this.getCoords_(ap+an,ao),b=this.getCoords_(ap,ao+am),a=this.getCoords_(ap+an,ao+am);x.x=af.max(x.x,g.x,b.x,a.x),x.y=af.max(x.y,g.y,b.y,a.y),z.push("padding:0 ",ae(x.x/Z),"px ",ae(x.y/Z),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",y.join(""),", sizingmethod='clip');")}else{z.push("top:",ae(A.y/Z),"px;left:",ae(A.x/Z),"px;")}z.push(' ">','<g_vml_:image src="',aq.src,'"',' style="width:',Z*an,"px;"," height:",Z*am,'px;"',' cropleft="',al/C,'"',' croptop="',ak/B,'"',' cropright="',(C-al-aj)/C,'"',' cropbottom="',(B-ak-ai)/B,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",z.join(""))},F.stroke=function(aF){var aE=[],aD=I(aF?this.fillStyle:this.strokeStyle),aC=aD.color,aB=aD.alpha*this.globalAlpha;aE.push("<g_vml_:shape",' filled="',!!aF,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0 0" coordsize="',Z*10," ",Z*10,'"',' stroked="',!aF,'"',' path="');var aA={x:null,y:null},az={x:null,y:null},ay=0;for(;ay<this.currentPath_.length;ay++){var ax=this.currentPath_[ay];switch(ax.type){case"moveTo":aE.push(" m ",ae(ax.x),",",ae(ax.y));break;case"lineTo":aE.push(" l ",ae(ax.x),",",ae(ax.y));break;case"close":aE.push(" x "),ax=null;break;case"bezierCurveTo":aE.push(" c ",ae(ax.cp1x),",",ae(ax.cp1y),",",ae(ax.cp2x),",",ae(ax.cp2y),",",ae(ax.x),",",ae(ax.y));break;case"at":case"wa":aE.push(" ",ax.type," ",ae(ax.x-this.arcScaleX_*ax.radius),",",ae(ax.y-this.arcScaleY_*ax.radius)," ",ae(ax.x+this.arcScaleX_*ax.radius),",",ae(ax.y+this.arcScaleY_*ax.radius)," ",ae(ax.xStart),",",ae(ax.yStart)," ",ae(ax.xEnd),",",ae(ax.yEnd))}if(ax){if(aA.x==null||ax.x<aA.x){aA.x=ax.x}if(az.x==null||ax.x>az.x){az.x=ax.x}if(aA.y==null||ax.y<aA.y){aA.y=ax.y}if(az.y==null||ax.y>az.y){az.y=ax.y}}}aE.push(' ">');if(aF){if(typeof this.fillStyle=="object"){var aw=this.fillStyle,av=0,au={x:0,y:0},at=0,aq=1;if(aw.type_=="gradient"){var ao=aw.x1_/this.arcScaleX_,am=aw.y1_/this.arcScaleY_,ak=this.getCoords_(aw.x0_/this.arcScaleX_,aw.y0_/this.arcScaleY_),ag=this.getCoords_(ao,am);av=Math.atan2(ag.x-ak.x,ag.y-ak.y)*180/Math.PI,av<0&&(av+=360),av<0.000001&&(av=0)}else{var ak=this.getCoords_(aw.x0_,aw.y0_),u=az.x-aA.x,b=az.y-aA.y;au={x:(ak.x-aA.x)/u,y:(ak.y-aA.y)/b},u/=this.arcScaleX_*Z,b/=this.arcScaleY_*Z;var a=af.max(u,b);at=2*aw.r0_/a,aq=2*aw.r1_/a-at}var ar=aw.colors_;ar.sort(function(d,c){return d.offset-c.offset});var ap=ar.length,an=ar[0].color,al=ar[ap-1].color,aj=ar[0].alpha*this.globalAlpha,ai=ar[ap-1].alpha*this.globalAlpha,ah=[],ay=0;for(;ay<ap;ay++){var v=ar[ay];ah.push(v.offset*aq+at+" "+v.color)}aE.push('<g_vml_:fill type="',aw.type_,'"',' method="none" focus="100%"',' color="',an,'"',' color2="',al,'"',' colors="',ah.join(","),'"',' opacity="',ai,'"',' g_o_:opacity2="',aj,'"',' angle="',av,'"',' focusposition="',au.x,",",au.y,'" />')}else{aE.push('<g_vml_:fill color="',aC,'" opacity="',aB,'" />')}}else{var g=this.lineScale_*this.lineWidth;g<1&&(aB*=g),aE.push("<g_vml_:stroke",' opacity="',aB,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',H(this.lineCap),'"',' weight="',g,'px"',' color="',aC,'" />')}aE.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",aE.join(""))},F.fill=function(){this.stroke(!0)},F.closePath=function(){this.currentPath_.push({type:"close"})},F.getCoords_=function(f,d){var g=this.m_;return{x:Z*(f*g[0][0]+d*g[1][0]+g[2][0])-Y,y:Z*(f*g[0][1]+d*g[1][1]+g[2][1])-Y}},F.save=function(){var b={};J(this,b),this.aStack_.push(b),this.mStack_.push(this.m_),this.m_=K(M(),this.m_)},F.restore=function(){J(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},F.translate=function(d,c){Q(this,K([[1,0,0],[0,1,0],[d,c,1]],this.m_),!1)},F.rotate=function(d){var c=ac(d),f=ad(d);Q(this,K([[c,f,0],[-f,c,0],[0,0,1]],this.m_),!1)},F.scale=function(d,c){this.arcScaleX_*=d,this.arcScaleY_*=c,Q(this,K([[d,0,0],[0,c,0],[0,0,1]],this.m_),!0)},F.transform=function(h,g,o,m,l,k){Q(this,K([[h,g,0],[o,m,0],[l,k,1]],this.m_),!0)},F.setTransform=function(h,g,o,m,l,k){Q(this,[[h,g,0],[o,m,0],[l,k,1]],!0)},F.clip=function(){},F.arcTo=function(){},F.createPattern=function(){return new L},O.prototype.addColorStop=function(d,c){c=I(c),this.colors_.push({offset:d,color:c.color,alpha:c.alpha})},G_vmlCanvasManager=U,CanvasRenderingContext2D=G,CanvasGradient=O,CanvasPattern=L}();
/*
 * Spinners 3.0.0
 * (c) 2010-2012 Nick Stakenburg - http://www.nickstakenburg.com
 *
 * Spinners is freely distributable under the terms of an MIT-style license.
 *
 * GitHub: http://github.com/staaky/spinners
 */
var Spinners={version:"3.0.0"};(function(l){function k(b){return b*Math.PI/180}function t(b){this.element=b}function s(a,d){a&&(this.element=a,m.remove(a),m.removeDetached(),this._position=0,this._state="stopped",this.setOptions(l.extend({color:"#000",dashes:12,radius:5,height:5,width:1.8,opacity:1,padding:3,rotation:700},d||{})),this.drawPosition(0),m.add(this))}var r={scroll:function(f,d){if(!d){return f}var g=f.slice(0,d);return f.slice(d,f.length).concat(g)},isElement:function(b){return b&&1==b.nodeType},element:{isAttached:function(){return function(b){for(;b&&b.parentNode;){b=b.parentNode}return !!b&&!!b.body}}()}},q={drawRoundedRectangle:function(y,x){var w=l.extend({top:0,left:0,width:0,height:0,radius:0},x||{}),v=w.left,u=w.top,b=w.width,a=w.height,w=w.radius;y.beginPath(),y.moveTo(v+w,u),y.arc(v+b-w,u+w,w,k(-90),k(0),!1),y.arc(v+b-w,u+a-w,w,k(0),k(90),!1),y.arc(v+w,u+a-w,w,k(90),k(180),!1),y.arc(v+w,u+w,w,k(-180),k(-90),!1),y.closePath(),y.fill()}},o=function(){function f(b){var h=[];0==b.indexOf("#")&&(b=b.substring(1)),b=b.toLowerCase();if(""!=b.replace(d,"")){return null}3==b.length?(h[0]=b.charAt(0)+b.charAt(0),h[1]=b.charAt(1)+b.charAt(1),h[2]=b.charAt(2)+b.charAt(2)):(h[0]=b.substring(0,2),h[1]=b.substring(2,4),h[2]=b.substring(4));for(b=0;b<h.length;b++){h[b]=parseInt(h[b],16)}return h.red=h[0],h.green=h[1],h.blue=h[2],h}var d=RegExp("[0123456789abcdef]","g"),g=function(){function b(u,h,v){return u=u.toString(v||10),Array(h-u.length).join("0")+u}return function(a,u,h){return"#"+b(a,2,16)+b(u,2,16)+b(h,2,16)}}();return{hex2rgb:f,hex2fill:function(a,v){"undefined"==typeof v&&(v=1);var u=v,h=f(a);return h[3]=u,h.opacity=u,"rgba("+h.join()+")"},rgb2hex:g}}();l.extend(Spinners,{enabled:!1,support:{canvas:function(){var a=l("<canvas>")[0];return !!a.getContext&&!!a.getContext("2d")}()},init:function(){if(this.support.canvas||window.G_vmlCanvasManager&&window.attachEvent&&-1===navigator.userAgent.indexOf("Opera")){window.G_vmlCanvasManager&&window.G_vmlCanvasManager.init_(document),this.enabled=!0}},create:function(d,c){return t.create(d,c),this.get(d)},get:function(b){return new t(b)},play:function(b){return this.get(b).play(),this},pause:function(b){return this.get(b).pause(),this},toggle:function(b){return this.get(b).toggle(),this},stop:function(b){return this.get(b).stop(),this},remove:function(b){return this.get(b).remove(),this},removeDetached:function(){return m.removeDetached(),this},center:function(b){return this.get(b).center(),this},setOptions:function(d,c){return this.get(d).setOptions(c),this},getDimensions:function(b){return b=2*m.get(b)[0].getLayout().workspace.radius,{width:b,height:b}}});var m={spinners:[],get:function(a){if(a){var d=[];return l.each(this.spinners,function(c,b){b&&(r.isElement(a)?b.element==a:l(b.element).is(a))&&d.push(b)}),d}},add:function(b){this.spinners.push(b)},remove:function(a){l(l.map(this.spinners,function(b){if(r.isElement(a)?b.element==a:l(b.element).is(a)){return b.element}})).each(l.proxy(function(d,c){this.removeByElement(c)},this))},removeByElement:function(a){var d=this.get(a)[0];d&&(d.remove(),this.spinners=l.grep(this.spinners,function(b){return b.element!=a}))},removeDetached:function(){l.each(this.spinners,l.proxy(function(d,c){c&&c.element&&!r.element.isAttached(c.element)&&this.remove(c.element)},this))}};l.extend(t,{create:function(a,u){if(a){var h=u||{},d=[];return r.isElement(a)?d.push(new s(a,h)):l(a).each(function(f,c){d.push(new s(c,h))}),d}}}),l.extend(t.prototype,{items:function(){return m.get(this.element)},play:function(){return l.each(this.items(),function(d,c){c.play()}),this},stop:function(){return l.each(this.items(),function(d,c){c.stop()}),this},pause:function(){return l.each(this.items(),function(d,c){c.pause()}),this},toggle:function(){return l.each(this.items(),function(d,c){c.toggle()}),this},center:function(){return l.each(this.items(),function(d,c){c.center()}),this},setOptions:function(a){return l.each(this.items(),function(b,d){d.setOptions(a)}),this},remove:function(){return m.remove(this.element),this}}),l.extend(s.prototype,{setOptions:function(a){this.options=l.extend({},this.options,a||{}),this.options.radii&&(a=this.options.radii,this.options.radius=Math.min(a[0],a[1]),this.options.height=Math.max(a[0],a[1])-this.options.radius),this.options.dashWidth&&(this.options.width=this.options.dashWidth),this.options.speed&&(this.options.duration=1000*this.options.speed);var a=this._state,d=this._position;this._layout=null,this.build(),d&&d>=this.options.dashes-1&&(this._position=this.options.dashes-1);switch(a){case"playing":this.play();break;case"paused":case"stopped":this.drawPosition(this._position)}this._centered&&this.center()},remove:function(){this.canvas&&(this.pause(),l(this.canvas).remove(),this.ctx=this.canvas=null)},build:function(){this.remove();var a=this.getLayout().workspace.radius;return l(document.body).append(this.canvas=l("<canvas>").attr({width:2*a,height:2*a}).css({zoom:1})),window.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.canvas[0]),this.ctx=this.canvas[0].getContext("2d"),this.ctx.globalAlpha=this.options.opacity,l(this.element).append(this.canvas),this.ctx.translate(a,a),this},drawPosition:function(b){var u=this.getLayout().workspace,b=r.scroll(u.opacities,-1*b),h=u.radius,u=this.options.dashes,g=k(360/u);this.ctx.clearRect(-1*h,-1*h,2*h,2*h);for(h=0;h<u;h++){this.drawDash(b[h],this.options.color),this.ctx.rotate(g)}},drawDash:function(g,f){this.ctx.fillStyle=o.hex2fill(f,g);var v=this.getLayout(),u=v.workspace.radius,h=v.dash.position,v=v.dash.dimensions;q.drawRoundedRectangle(this.ctx,{top:h.top-u,left:h.left-u,width:v.width,height:v.height,radius:Math.min(v.height,v.width)/2})},_nextPosition:function(){var a=this.options.rotation/this.options.dashes;this.nextPosition(),this._playTimer=window.setTimeout(l.proxy(this._nextPosition,this),a)},nextPosition:function(){this._position==this.options.dashes-1&&(this._position=-1),this._position++,this.drawPosition(this._position)},play:function(){if("playing"!=this._state){this._state="playing";var a=this.options.rotation/this.options.dashes;return this._playTimer=window.setTimeout(l.proxy(this._nextPosition,this),a),this}},pause:function(){if("paused"!=this._state){return this._pause(),this._state="paused",this}},_pause:function(){this._playTimer&&(window.clearTimeout(this._playTimer),this._playTimer=null)},stop:function(){if("stopped"!=this._state){return this._pause(),this._position=0,this.drawPosition(0),this._state="stopped",this}},toggle:function(){return this["playing"==this._state?"pause":"play"](),this},getLayout:function(){if(this._layout){return this._layout}for(var C=this.options,B=C.dashes,A=C.width,z=C.radius,y=C.radius+C.height,x=Math.max(A,y),x=Math.ceil(Math.max(x,Math.sqrt(y*y+A/2*(A/2)))),C=x+=C.padding,w=1/B,v=[],u=0;u<B;u++){v.push((u+1)*w)}return this._layout=B={workspace:{radius:C,opacities:v},dash:{position:{top:x-y,left:x-A/2},dimensions:{width:A,height:y-z}}}},center:function(){var a=2*this.getLayout().workspace.radius;l(this.element.parentNode).css({position:"relative"}),l(this.element).css({position:"absolute",height:a+"px",width:a+"px",top:"50%",left:"50%",marginLeft:-0.5*a+"px",marginTop:-0.5*a+"px"}),this._centered=!0}}),Spinners.init(),Spinners.enabled||(t.create=function(){return[]})})(jQuery);
/*
 * Tipped - The jQuery Tooltip - v3.2.0.1
 * (c) 2010-2014 Nick Stakenburg
 *
 * http://projects.nickstakenburg.com/tipped
 *
 * License: http://projects.nickstakenburg.com/tipped/license
 */
var Tipped={version:"3.2.0.1"};Tipped.Skins={base:{afterUpdate:false,ajax:{cache:true,type:"get"},background:{color:"#f2f2f2",opacity:1},border:{size:1,color:"#000",opacity:1},closeButtonSkin:"default",containment:{selector:"viewport"},fadeIn:180,fadeOut:220,showDelay:75,hideDelay:25,radius:{size:5,position:"background"},hideAfter:false,hideOn:{element:"self",event:"mouseleave"},hideOthers:false,hook:"topleft",inline:false,offset:{x:0,y:0},onHide:false,onShow:false,shadow:{blur:2,color:"#000",offset:{x:0,y:0},opacity:0.12},showOn:"mousemove",spinner:true,stem:{height:9,width:18,offset:{x:9,y:9},spacing:2},target:"self"},reset:{ajax:false,closeButton:false,hideOn:[{element:"self",event:"mouseleave"},{element:"tooltip",event:"mouseleave"}],hook:"topmiddle",stem:true},dark:{border:{color:"#fff",size:5,opacity:0.3},background:{color:"#363636"},shadow:{opacity:0.2},fadeIn:0,fadeOut:0},light:{background:{color:"#fff"},border:{color:"#646464",opacity:0.4,size:1},shadow:{opacity:0.04}},gray:{background:{color:[{position:0,color:"#8f8f8f"},{position:1,color:"#808080"}]},border:{color:"#131313",size:1,opacity:0.6}},tiny:{background:{color:"#161616"},border:{color:"#969696",opacity:0.35,size:1},fadeIn:0,fadeOut:0,radius:4,stem:{width:11,height:6,offset:{x:6,y:6}},shadow:false,spinner:{color:"#fff"}},yellow:{background:"#ffffaa",border:{size:1,color:"#6d5208",opacity:0.4}},red:{background:{color:[{position:0,color:"#e13c37"},{position:1,color:"#e13c37"}]},border:{size:1,color:"#150201",opacity:0.6},spinner:{color:"#fff"}},green:{background:{color:[{position:0,color:"#4bb638"},{position:1,color:"#4aab3a"}]},border:{size:1,color:"#122703",opacity:0.6},spinner:{color:"#fff"}},blue:{background:{color:[{position:0,color:"#4588c8"},{position:1,color:"#3d7cb9"}]},border:{color:"#020b17",opacity:0.6},spinner:{color:"#fff"}}};(function(a){a.extend(Tipped.Skins,{black:a.extend(true,{},Tipped.Skins.dark,{radius:0}),white:a.extend(true,{},Tipped.Skins.light,{radius:0})})})(jQuery);Tipped.Skins.CloseButtons={base:{diameter:17,border:2,x:{diameter:10,size:2,opacity:1},states:{"default":{background:{color:[{position:0,color:"#1a1a1a"},{position:0.46,color:"#171717"},{position:0.53,color:"#121212"},{position:0.54,color:"#101010"},{position:1,color:"#000"}],opacity:1},x:{color:"#fafafa",opacity:1},border:{color:"#fff",opacity:1}},hover:{background:{color:"#333",opacity:1},x:{color:"#e6e6e6",opacity:1},border:{color:"#fff",opacity:1}}},shadow:{blur:1,color:"#000",offset:{x:0,y:0},opacity:0.5}},reset:{},"default":{},light:{diameter:17,border:2,x:{diameter:10,size:2,opacity:1},states:{"default":{background:{color:[{position:0,color:"#797979"},{position:0.48,color:"#717171"},{position:0.52,color:"#666"},{position:1,color:"#666"}],opacity:1},x:{color:"#fff",opacity:0.95},border:{color:"#676767",opacity:1}},hover:{background:{color:[{position:0,color:"#868686"},{position:0.48,color:"#7f7f7f"},{position:0.52,color:"#757575"},{position:1,color:"#757575"}],opacity:1},x:{color:"#fff",opacity:1},border:{color:"#767676",opacity:1}}}}};eval(function(h,b,l,d,g,f){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(l--){f[g(l)]=d[l]||g(l)}d=[function(a){return f[a]}];g=function(){return"\\w+"};l=1}while(l--){if(d[l]){h=h.replace(new RegExp("\\b"+g(l)+"\\b","g"),d[l])}}return h}('!13(12){13 ad(e,d){14 f=[e,d];1b f.17=e,f.18=d,f}13 aa(b){1P.5M&&5M[5M.6V?"6V":"8A"](b)}13 W(b){11.1h=b}13 V(e){14 d={};2h(14 f 5N e){d[f]=e[f]+"2G"}1b d}13 U(d,c){1b 1c.8B(d*d+c*c)}13 T(b){1b 2N*b/1c.38}13 S(b){1b b*1c.38/2N}13 R(b){1b 1/1c.4R(b)}13 H(a){1g(a){11.1h=a,I.1D(a);14 d=11.2m();11.1a=12.1n({},d.1a),11.2H=1,11.1r={},11.23=12(a).26("2A-23"),I.39(11),11.2i=11.1a.1z.1I,11.6W=11.1a.1o&&11.2i,11.3l={x:0,y:0},11.3v={18:0,17:0},11.1X()}}13 F(a,d){11.1h=a,11.1h&&d&&(11.1a=12.1n({3a:3,1F:{x:0,y:0},1Y:"#4S",1S:0.5,2U:1},29[2]||{}),11.2H=11.1a.2U,11.1r={},11.23=12(a).26("2A-23"),G.39(11),11.1X())}13 D(a){11.1h=a,11.1h&&(11.1a=12.1n({3a:5,1F:{x:0,y:0},1Y:"#4S",1S:0.5,2U:1},29[1]||{}),11.2H=11.1a.2U,11.23=12(a).26("2A-23"),E.39(11),11.1X())}13 Q(a,f){2h(14 e 5N f){f[e]&&f[e].3Q&&f[e].3Q===5O?(a[e]=12.1n({},a[e])||{},Q(a[e],f[e])):a[e]=f[e]}1b a}13 M(a,n){1g(11.1h=a,11.1h){14 m=12(a).26("2A-23");m&&N.1D(a),m=Y(),12(a).26("2A-23",m),11.23=m;14 l;"8C"!=12.1s(n)||ac.2s(n)?l=29[2]||{}:(l=n,n=1w),11.1a=N.6X(l);14 k=a.6Y("5P");1g(!n){14 h=a.6Y("26-2A");h?n=h:k&&(n=k)}k&&(12(a).26("5Q",k),a.8D("5P","")),11.2O=n,11.2t=11.1a.2t||+N.1a.4T,11.1r={2P:{15:1,19:1},5R:[],3m:[],2B:{4U:!1,2u:!1,1T:!1,3n:!1,1X:!1,4V:!1,5S:!1,3R:!1},5T:""};14 d=11.1a.1H;11.1H="2V"==d?"2V":"4W"!=d&&d?ac.2s(d)?d:d&&1C.6Z(d)||11.1h:11.1h,11.70(),N.39(11)}}14 4X=71.3S.8E,ac={8F:13(f,b){14 a=f;1b 13(){14 d=[12.1A(a,11)].72(4X.5U(29));1b b.5V(11,d)}},2s:13(b){1b b&&1==b.8G},4Y:13(b,f){14 e=4X.5U(29,2);1b 8H(13(){1b b.5V(b,e)},f)},4h:13(b){1b ac.4Y.5V(11,[b,1].72(4X.5U(29,1)))},5W:13(b){1b{x:b.5X,y:b.73}},1h:{4Z:13(e){14 c=0,f=0;8I{c+=e.51||0,f+=e.52||0,e=e.53}8J(e);1b ad(f,c)},54:13(a){14 h=12(a).1F(),d=ac.1h.4Z(a),c={18:12(1P).51(),17:12(1P).52()};1b h.17+=d.17-c.17,h.18+=d.18-c.18,ad(h.17,h.18)},56:13(){13 b(d){2h(14 c=d;c&&c.53;){c=c.53}1b c}1b 13(a){14 d=b(a);1b!(!d||!d.3b)}}()}},ab=13(d){13 c(a){14 e=2Q 5Y(a+"([\\\\d.]+)").8K(d);1b e?5Z(e[1]):!0}1b{3w:!(!1P.8L||-1!==d.3x("60"))&&c("8M "),60:d.3x("60")>-1&&(!!1P.61&&61.74&&5Z(61.74())||7.55),62:d.3x("75/")>-1&&c("75/"),57:d.3x("57")>-1&&-1===d.3x("8N")&&c("8O:"),76:!!d.3o(/8P.*8Q.*8R/),58:d.3x("58")>-1&&c("58/")}}(8S.8T),Z={3c:{4i:{63:"1.4.4",64:1P.4i&&4i.8U.8V}},77:13(){13 c(a){2h(14 l=a.3o(d),k=l&&l[1]&&l[1].2W(".")||[],j=0,i=0,h=k.2j;h>i;i++){j+=2X(k[i]*1c.78(10,6-2*i))}1b l&&l[3]?j-1:j}14 d=/^(\\d+(\\.?\\d+){0,3})([A-79-8W-]+[A-79-8X-9]+)?/;1b 13(b){11.3c[b].7a||(11.3c[b].7a=!0,(!11.3c[b].64||c(11.3c[b].64)<c(11.3c[b].63)&&!11.3c[b].7b)&&(11.3c[b].7b=!0,aa("1Z 8Y "+b+" >= "+11.3c[b].63)))}}()},Y=13(){14 d=0,c="8Z";1b 13(a){2h(a=a||c,d++;1C.6Z(a+d);){d++}1b a+d}}(),X=13(){14 a=[];1b{1y:13(g){2h(14 f=1w,b=0;b<a.2j;b++){a[b]&&a[b].4j==g.4j&&a[b].1s.7c()==g.1s.7c()&&12.7d(a[b].26||{})==12.7d(g.26||{})&&(f=a[b].59)}1b f},5a:13(e,b){11.1D(e.4j),a.2v(12.1n({},e,{59:b}))},1D:13(b){2h(14 d=0;d<a.2j;d++){a[d]&&a[d].4j==b&&3T a[d]}},7e:13(){a=[]}}}();12.1n(1Z,13(){1b{2I:{3p:13(){14 b=1C.2b("3p");1b!(!b.3y||!b.3y("2d"))}(),3z:13(){7f{1b!!("91"5N 1P||1P.7g&&1C 92 7g)}7h(b){1b!1}}(),4k:13(){14 a=["93","7i","94"],d=!!1P.7i;1b 12.1B(a,13(e,c){7f{1C.95(c),d=!0}7h(f){}}),d}()},3A:13(){(11.2I.3p||ab.3w)&&(Z.77("4i"),N.3B.1k&&(12(N.3B.1k).1D(),N.3B.1k=1w),12(1C).96(13(){N.7j(),N.7k()}))},5b:13(e,d,f){1b W.5b(e,d,f),11.1y(e)},1y:13(b){1b 2Q W(b)},65:13(b){1b N.65(b)},25:13(b){1b 11.1y(b).25(),11},1Q:13(b){1b 11.1y(b).1Q(),11},3d:13(b){1b 11.1y(b).3d(),11},2Y:13(b){1b 11.1y(b).2Y(),11},1D:13(b){1b 11.1y(b).1D(),11},5c:13(){1b N.5c(),11},66:13(b){1b N.66(b),11},67:13(b){1b N.67(b),11},1T:13(a){1g(ac.2s(a)){1b N.68(a)}1g("69"!=12.1s(a)){14 f=12(a),d=0;1b 12.1B(f,13(e,c){N.68(c)&&d++}),d}1b N.3U().2j},6a:13(){1b N.6a(),11}}}()),12.1n(W,{5b:13(a,h){1g(a){14 g=29[2]||{},d=[];1b N.7l(),ac.2s(a)?d.2v(2Q M(a,h,g)):12(a).1B(13(e,c){d.2v(2Q M(c,h,g))}),d}}}),12.1n(W.3S,{4l:13(){1b N.2n.5d={x:0,y:0},N.1y(11.1h)},25:13(){1b 12.1B(11.4l(),13(d,c){c.25()}),11},1Q:13(){1b 12.1B(11.4l(),13(d,c){c.1Q()}),11},3d:13(){1b 12.1B(11.4l(),13(d,c){c.3d()}),11},2Y:13(){1b 12.1B(11.4l(),13(d,c){c.2Y()}),11},1D:13(){1b N.1D(11.1h),11}});14 P={5e:13(){14 a;1b a=ab.76?{15:1P.6b,19:1P.6c}:{19:12(1P).19(),15:12(1P).15()}}},O={3C:1c.1K(1c.5f(1P.3C?5Z(1P.3C)||1:1,2)),3A:13(){13 b(d){14 c=d.3y("2d");c.97(O.3C,O.3C)}1b 1P.5g&&!1Z.2I.3p&&ab.3w?13(a){5g.98(a),b(a)}:13(a){b(a)}}(),3D:13(a,d){12(a).3q({15:d.15*11.3C,19:d.19*11.3C}).1t(V(d))},7m:13(a){14 p=12.1n({18:0,17:0,15:0,19:0,1q:0},29[1]||{}),o=p,n=o.17,m=o.18,l=o.15,k=o.19,j=o.1q;1b j?(a.2o(),a.3E(n+j,m),a.2f(n+l-j,m+j,j,S(-90),S(0),!1),a.2f(n+l-j,m+k-j,j,S(0),S(90),!1),a.2f(n+j,m+k-j,j,S(90),S(2N),!1),a.2f(n+j,m+j,j,S(-2N),S(-90),!1),a.2p(),a.3e(),3F 0):(a.7n(n,m,l,k),3F 0)},99:13(a,p){2h(14 o=12.1n({x:0,y:0,1Y:"#4S"},29[2]||{}),n=0,m=p.2j;m>n;n++){2h(14 l=0,k=p[n].2j;k>l;l++){14 j=2X(p[n].3G(l))*(1/9);a.2Z=J.30(o.1Y,j),j&&a.7n(o.x+l,o.y+n,1,1)}}},4m:13(a,h){14 g;1g("2C"==12.1s(h)){g=J.30(h)}1N{1g("2C"==12.1s(h.1Y)){g=J.30(h.1Y,"2J"==12.1s(h.1S)?h.1S:1)}1N{1g(12.7o(h.1Y)){14 f=12.1n({3V:0,3W:0,3X:0,3Y:0},29[2]||{});g=O.7p.7q(a.9a(f.3V,f.3W,f.3X,f.3Y),h.1Y,h.1S)}}}1b g}};O.7p={7q:13(a,l){2h(14 k="2J"==12.1s(29[2])?29[2]:1,j=0,i=l.2j;i>j;j++){14 h=l[j];("69"==12.1s(h.1S)||"2J"!=12.1s(h.1S))&&(h.1S=1),a.9b(h.1f,J.30(h.1Y,h.1S*k))}1b a}};14 L={7r:["3Z","4n","40","41","4o","4p","4q","4r","4s","4t","4u","42"],4v:{7s:/^(18|17|20|1V)(18|17|20|1V|2D|31)$/,1R:/^(18|20)/,3f:/(2D|31)/,7t:/^(18|20|17|1V)/},7u:13(){14 b={18:"19",17:"15",20:"19",1V:"15"};1b 13(a){1b b[a]}}(),3f:13(b){1b!!b.3H().3o(11.4v.3f)},7v:13(b){1b!11.3f(b)},2R:13(b){1b b.3H().3o(11.4v.1R)?"1R":"2k"},6d:13(e){14 d=1w,f=e.3H().3o(11.4v.7t);1b f&&f[1]&&(d=f[1]),d},2W:13(b){1b b.3H().3o(11.4v.7s)}},K={6e:13(d){14 c=d.1a.1o;1b{15:c.15,19:c.19}},4w:13(a,n){14 m=12.1n({43:"1K"},29[2]||{}),l=a.1a.1o,k=l.15,j=l.19,i=11.5h(k,j,n);1b m.43&&(i.15=1c[m.43](i.15),i.19=1c[m.43](i.19)),{15:i.15,19:i.19}},5h:13(j,i,p){14 o=T(1c.7w(0.5*(i/j))),n=2N-o,m=1c.4R(S(n-90))*p,l=j+2*m,k=l*i/j;1b{15:l,19:k}},44:13(g,e){14 j=11.4w(g,e),i=11.6e(g),h=(L.3f(g.2i),1c.1K(j.19+e));1b g.1a.1o.1F||0,g.1a.1q&&g.1a.1q.2E||0,{2K:{1d:{15:1c.1K(j.15),19:1c.1K(h)}},1l:{1d:j},1o:{1d:{15:i.15,19:i.19}}}},6f:13(b,c,d){14 f=b.1a,at={18:0,17:0},ar={18:0,17:0},aq=12.1n({},c),ap=b.1l,ao=ao||11.44(b,b.1l),an=ao.2K.1d;d&&(an.19=d,ap=0);14 g=L.2W(b.2i),al=L.2R(b.2i);1g(b.1a.1o){14 h=L.6d(b.2i);1g("18"==h?at.18=an.19-ap:"17"==h&&(at.17=an.19-ap),"1R"==al){21(g[2]){1i"2D":1i"31":ar.17=0.5*aq.15;1G;1i"1V":ar.17=aq.15}"20"==g[1]&&(ar.18=aq.19-ap+an.19)}1N{21(g[2]){1i"2D":1i"31":ar.18=0.5*aq.19;1G;1i"20":ar.18=aq.19}"1V"==g[1]&&(ar.17=aq.15-ap+an.19)}aq[L.7u(h)]+=an.19-ap}1N{1g("1R"==al){21(g[2]){1i"2D":1i"31":ar.17=0.5*aq.15;1G;1i"1V":ar.17=aq.15}"20"==g[1]&&(ar.18=aq.19)}1N{21(g[2]){1i"2D":1i"31":ar.18=0.5*aq.19;1G;1i"20":ar.18=aq.19}"1V"==g[1]&&(ar.17=aq.15)}}14 i=f.1q&&f.1q.2E||0,ai=f.1l&&f.1l.2E||0;1g(b.1a.1o){14 j=i&&"1p"==f.1q.1f?i:0,C=i&&"1l"==f.1q.1f?i:i+ai,A=ai+j+0.5*ao.1o.1d.15-0.5*ao.1l.1d.15,s=C>A?C-A:0,r=1c.1K(ai+j+0.5*ao.1o.1d.15+s);1g("1R"==al){21(g[2]){1i"17":ar.17+=r;1G;1i"1V":ar.17-=r}}1N{21(g[2]){1i"18":ar.18+=r;1G;1i"20":ar.18-=r}}}14 e;1g(f.1o&&(e=f.1o.1F)){14 a=K.6g(e,b.6W,c,ao.1l.1d,ai,i);1g(e=a.1F,a.4x,"1R"==al){21(g[2]){1i"17":ar.17+=e.x;1G;1i"1V":ar.17-=e.x}}1N{21(g[2]){1i"18":ar.18+=e.y;1G;1i"20":ar.18-=e.y}}}14 k;1g(f.1o&&(k=f.1o.9c)){1g("1R"==al){21(g[1]){1i"18":ar.18-=k;1G;1i"20":ar.18+=k}}1N{21(g[1]){1i"17":ar.17-=k;1G;1i"1V":ar.17+=k}}}1b{1d:aq,1f:{18:0,17:0},1p:{1f:at,1d:c},1o:{1d:an},2S:ar}},6g:13(t,s,r,q,p,o){14 n=L.2R(s),m=12.1n({},t),l={x:0,y:0},a=0;1b"1R"==n&&(a=r.15-q.15-2*p-2*o)<2*t.x&&(l.x=m.x,/(1V)$/.3r(s)&&(l.x*=-1),m.x=0),"2k"==n&&(a=r.19-q.19-2*p-2*o)<2*t.y&&(l.y=m.y,/(20)$/.3r(s)&&(l.y*=-1),m.y=0),{1F:m,4x:l}}},J=13(){13 r(d){14 c=d;1b c.7x=d[0],c.7y=d[1],c.7z=d[2],c}13 q(b){1b 2X(b,16)}13 p(d){14 c=2Q 71(3);1g(0==d.3x("#")&&(d=d.5i(1)),d=d.3H(),""!=d.6h(s,"")){1b 1w}3==d.2j?(c[0]=d.3G(0)+d.3G(0),c[1]=d.3G(1)+d.3G(1),c[2]=d.3G(2)+d.3G(2)):(c[0]=d.5i(0,2),c[1]=d.5i(2,4),c[2]=d.5i(4));2h(14 e=0;e<c.2j;e++){c[e]=q(c[e])}1b r(c)}13 o(e,d){14 f=p(e);1b f[3]=d,f.1S=d,f}13 n(d,e){1b"69"==12.1s(e)&&(e=1),"9d("+o(d,e).9e()+")"}13 m(b){1b"#"+(l(b)[2]>50?"4S":"9f")}13 l(b){1b a(p(b))}13 a(b){14 B,A,z,b=r(b),ah=b.7x,ag=b.7y,C=b.7z,y=ah>ag?ah:ag;C>y&&(y=C);14 x=ag>ah?ah:ag;1g(x>C&&(x=C),z=y/9g,A=0!=y?(y-x)/y:0,0==A){B=0}1N{14 w=(y-ah)/(y-x),v=(y-ag)/(y-x),u=(y-C)/(y-x);B=ah==y?u-v:ag==y?2+w-u:4+v-w,B/=6,0>B&&(B+=1)}B=1c.2c(7A*B),A=1c.2c(6i*A),z=1c.2c(6i*z);14 d=[];1b d[0]=B,d[1]=A,d[2]=z,d.9h=B,d.9i=A,d.9j=z,d}14 t="9k",s=2Q 5Y("["+t+"]","g");1b{9l:p,30:n,9m:m}}(),I={5j:{},1y:13(a){1g(!a){1b 1w}14 f=1w,e=12(a).26("2A-23");1b e&&(f=11.5j[e]),f},39:13(b){11.5j[b.23]=b},1D:13(d){14 c=11.1y(d);c&&(3T 11.5j[c.23],c.1D())}};12.1n(H.3S,13(){13 ap(){11.1r.1z={};14 c=11.2i;12.1B(L.7r,12.1A(13(a,b){14 C,A=11.1r.1z[b]={};11.2i=b;14 v=11.2x();C=v,A.2S=C.2S;14 u=C.1O.1d,p={18:C.1O.1f.18,17:C.1O.1f.17};1g(A.1O={1d:u,1f:p},A.1I={1d:C.2a.1d},11.1x){14 o=11.1x.2x(),m=o.2a.1f,l=A.1O.1f;12.1n(!0,A,{2S:o.2S,1O:{1f:{18:l.18+m.18,17:l.17+m.17}},1I:{1d:o.1I.1d}})}},11)),11.2i=c}13 ao(){11.3g(),11.1a.1x&&(G.1D(11.1h),11.1a.1E&&11.1a.1E.1x&&E.1D(11.1h)),11.32&&(11.32.1D(),11.32=1w),11.1k&&(12(11.1k).1D(),11.1k=1w)}13 an(){11.1O&&(11.1E&&(12(11.1E).1D(),11.1E=1w,11.6j=1w,11.6k=1w),12(11.1O).1D(),11.1o=1w,11.1p=1w,11.1O=1w,11.1r={})}13 am(){14 f=11.2m();11.2P=f.1r.2P;14 d=f.1a;11.1q=d.1q&&d.1q.2E||0,11.1l=d.1l&&d.1l.2E||0,11.2w=d.2w;14 g=1c.5f(11.2P.19,11.2P.15);11.1q>g/2&&(11.1q=1c.6l(g/2)),"1l"==11.1a.1q.1f&&11.1q>11.1l&&(11.1l=11.1q),11.1r={1a:{1q:11.1q,1l:11.1l,2w:11.2w}}}13 al(){11.3g(),1P.5g&&1P.5g.9n(1C);14 d=11.2m(),f=11.1a;11.1O=12("<2q>").27("9o")[0],12(d.5k).28(11.1O),11.5l(),11.7B(d),f.1E&&(11.7C(d),f.1E.1x&&(11.33?(11.33.1a=f.1E.1x,11.33.1X()):11.33=2Q D(11.1h,12.1n({2U:11.2H},f.1E.1x)))),ab.3w&&ab.3w<7&&12(d.1k).6m(11.32=12("<9p>").27("9q").3q({9r:0,4y:"9s:\'\';"})),11.5m(),f.1x&&(11.1x?(11.1x.1a=f.1x,11.1x.1X()):11.1x=2Q F(11.1h,11,12.1n({2U:11.2H},f.1x))),11.7D()}13 ak(){14 i=11.2m(),u=12(i.1k),p=12(i.1k).6n(".7E").7F()[0];1g(p){12(p).1t({15:"6o",19:"6o"});14 o=2X(u.1t("18")),m=2X(u.1t("17")),l=2X(u.1t("15"));u.1t({17:"-7G",18:"-7G",15:"9t",19:"6o"}),i.1L("1T")||12(i.1k).25();14 j=N.3B.6p(p);i.1a.3s&&"2J"==12.1s(i.1a.3s)&&j.15>i.1a.3s&&(12(p).1t({15:i.1a.3s+"2G"}),j=N.3B.6p(p)),i.1L("1T")||12(i.1k).1Q(),i.1r.2P=j,u.1t({17:m+"2G",18:o+"2G",15:l+"2G"}),11.1X()}}13 aj(g,f,i){14 h=!1;11.4z(g)&&(h=!0),11.7H(f)&&(h=!0),i&&11.7I(i)&&(h=!0),h&&11.1X()}13 ai(d){14 c=!1;1b(11.3v.17!=d.17||11.3v.18!=d.18)&&(c=!0,11.3v=d),c}13 ah(d){14 c=!1;1b(11.3l.x!=d.x||11.3l.y!=d.y)&&(c=!0,11.3l=d),c}13 ag(b){14 d=!1;1b 11.2i!=b&&(d=!0,11.2i=b),d}13 B(){1b N.1y(11.1h)[0]}13 z(){1b K.44(11,11.1l)}13 s(){14 d=11.2m().1a.1E,f=d.3I+2*d.1l;12(11.6j).1t({17:-1*f+"2G"}),12(11.6k).1t({17:0})}13 q(){14 d=11.2m().1a.1E,f=d.3I+2*d.1l;12(11.6j).1t({17:0}),12(11.6k).1t({17:f+"2G"})}13 y(f){14 h=f.1a.1E,g={15:h.3I+2*h.1l,19:h.3I+2*h.1l};12(f.1k).28(12(11.1E=1C.2b("2q")).27("6q").1t(V(g)).28(12(11.7J=1C.2b("2q")).27("9u").1t(V(g)))),11.6r(f,"6s"),11.6r(f,"6t"),1Z.2I.3z||ab.58||12(11.1E).46("4A",12.1A(11.7K,11)).46("5n",12.1A(11.7L,11))}13 x(a,b){14 c=a.1a.1E,aw=c.3I,av=c.1l||0,au=c.x.3I,at=c.x.2E,ar=(c.x.9v,c.2B[b||"6s"]),aq={15:aw+2*av,19:aw+2*av};au>=aw&&(au=aw-2);14 C;12(11.7J).28(12(11[b+"7M"]=1C.2b("2q")).27("9w").1t(12.1n(V(aq),{17:("6t"==b?aq.15:0)+"2G"}))),12(1C.3b).28(12(C=1C.2b("3p"))),O.3D(C,aq),O.3A(C);14 A=C.3y("2d");A.2U=11.2H,12(11[b+"7M"]).28(C),A.9x(aq.15/2,aq.19/2),A.2Z=O.4m(A,ar.1p,{3V:0,3W:0-aw/2,3X:0,3Y:0+aw/2}),A.2o(),A.2f(0,0,aw/2,0,2*1c.38,!0),A.2p(),A.3e(),av&&(A.2Z=O.4m(A,ar.1l,{3V:0,3W:0-aw/2-av,3X:0,3Y:0+aw/2+av}),A.2o(),A.2f(0,0,aw/2,1c.38,0,!1),A.1e((aw+av)/2,0),A.2f(0,0,aw/2+av,0,1c.38,!0),A.2f(0,0,aw/2+av,1c.38,0,!0),A.1e(aw/2,0),A.2f(0,0,aw/2,0,1c.38,!1),A.2p(),A.3e());14 v=au/2,i=at/2;1g(i>v){14 d=i;i=v,v=d}A.2Z=J.30(ar.x.1Y||ar.x,ar.x.1S||1),A.5o(S(45)),A.2o(),A.3E(0,0),A.1e(0,v);2h(14 e=0;4>e;e++){A.1e(0,v),A.1e(i,v),A.1e(i,v-(v-i)),A.1e(v,i),A.1e(v,0),A.5o(S(90))}A.2p(),A.3e()}13 w(a){14 b,aB,aA,az,ax,1W=12.1n({1o:!1,3J:1w,9y:1w,2o:!1,2p:!1,3K:1w,3L:1w,1q:0,1l:0,5p:0,3h:{x:0,y:0}},29[1]||{}),3M=1W.3K,1J=1W.3L,1u=1W.3h,1v=1W.1l,1j=1W.1q,1M=1W.3J,1m=3M.1p.1f,aD=3M.1p.1d,aw={x:1c.34(11.3l.x),y:1c.34(11.3l.y)},av={x:0,y:0},au={x:0,y:0};1g(1J){b=1J.1o.1d,aB=1J.2K.1f,aA=1J.2K.1d,az=aA.15-b.15;14 e=1W.5p,ar=1v+1j+0.5*b.15-0.5*1J.1l.1d.15;ax=1c.1K(e>ar?e-ar:0);14 h=K.6g(1u,1M,aD,1J.1l.1d,1v,1j);1u=h.1F,au=h.4x,av={x:1c.22(aD.15-2*1c.22(ax,1u.x||0)-1J.1l.1d.15-(2*1j||0),0),y:1c.22(aD.19-2*1c.22(ax,1u.y||0)-1J.1l.1d.19-(2*1j||0),0)},L.3f(1M)&&(av.x*=0.5,av.y*=0.5),aw.x=1c.5f(aw.x,av.x),aw.y=1c.5f(aw.y,av.y),L.3f(1M)&&(11.3l.x<0&&aw.x>0&&(aw.x*=-1),11.3l.y<0&&aw.y>0&&(aw.y*=-1)),11.3v&&11.3v.3N&&12.1B(11.3v.3N,13(d,f){12.1B("18 1V 20 17".2W(" "),13(g,c){f==c&&2Q 5Y("("+c+")$").3r(1M)&&(aw[/^(17|1V)$/.3r(c)?"x":"y"]=0)})})}14 C,ay;1g(1j?(C=1m.17+1v+1j,ay=1m.18+1v):(C=1m.17+1v,ay=1m.18+1v),1u&&1u.x&&/^(3Z|42)$/.3r(1M)&&(C+=1u.x),1W.2o&&a.2o(),a.3E(C,ay),1W.1o){21(1M){1i"3Z":C=1m.17+1v,1j&&(C+=1j),C+=1c.22(ax,1u.x||0),C+=aw.x,a.1e(C,ay),ay-=b.19,C+=0.5*b.15,a.1e(C,ay),ay+=b.19,C+=0.5*b.15,a.1e(C,ay);1G;1i"4n":1i"5q":C=1m.17+0.5*aD.15-0.5*b.15,C+=aw.x,a.1e(C,ay),ay-=b.19,C+=0.5*b.15,a.1e(C,ay),ay+=b.19,C+=0.5*b.15,a.1e(C,ay),C=1m.17+0.5*aD.15-0.5*aA.15,a.1e(C,ay);1G;1i"40":C=1m.17+aD.15-1v-b.15,1j&&(C-=1j),C-=1c.22(ax,1u.x||0),C-=aw.x,a.1e(C,ay),ay-=b.19,C+=0.5*b.15,a.1e(C,ay),ay+=b.19,C+=0.5*b.15,a.1e(C,ay)}}1g(1j?1j&&(a.2f(1m.17+aD.15-1v-1j,1m.18+1v+1j,1j,S(-90),S(0),!1),C=1m.17+aD.15-1v,ay=1m.18+1v+1j):(C=1m.17+aD.15-1v,ay=1m.18+1v,a.1e(C,ay)),1W.1o){21(1M){1i"41":ay=1m.18+1v,1j&&(ay+=1j),ay+=1c.22(ax,1u.y||0),ay+=aw.y,a.1e(C,ay),C+=b.19,ay+=0.5*b.15,a.1e(C,ay),C-=b.19,ay+=0.5*b.15,a.1e(C,ay);1G;1i"4o":1i"5r":ay=1m.18+0.5*aD.19-0.5*b.15,ay+=aw.y,a.1e(C,ay),C+=b.19,ay+=0.5*b.15,a.1e(C,ay),C-=b.19,ay+=0.5*b.15,a.1e(C,ay);1G;1i"4p":ay=1m.18+aD.19-1v,1j&&(ay-=1j),ay-=b.15,ay-=1c.22(ax,1u.y||0),ay-=aw.y,a.1e(C,ay),C+=b.19,ay+=0.5*b.15,a.1e(C,ay),C-=b.19,ay+=0.5*b.15,a.1e(C,ay)}}1g(1j?1j&&(a.2f(1m.17+aD.15-1v-1j,1m.18+aD.19-1v-1j,1j,S(0),S(90),!1),C=1m.17+aD.15-1v-1j,ay=1m.18+aD.19-1v):(C=1m.17+aD.15-1v,ay=1m.18+aD.19-1v,a.1e(C,ay)),1W.1o){21(1M){1i"4q":C=1m.17+aD.15-1v,1j&&(C-=1j),C-=1c.22(ax,1u.x||0),C-=aw.x,a.1e(C,ay),C-=0.5*b.15,ay+=b.19,a.1e(C,ay),C-=0.5*b.15,ay-=b.19,a.1e(C,ay);1G;1i"4r":1i"5s":C=1m.17+0.5*aD.15+0.5*b.15,C+=aw.x,a.1e(C,ay),C-=0.5*b.15,ay+=b.19,a.1e(C,ay),C-=0.5*b.15,ay-=b.19,a.1e(C,ay);1G;1i"4s":C=1m.17+1v+b.15,1j&&(C+=1j),C+=1c.22(ax,1u.x||0),C+=aw.x,a.1e(C,ay),C-=0.5*b.15,ay+=b.19,a.1e(C,ay),C-=0.5*b.15,ay-=b.19,a.1e(C,ay)}}1g(1j?1j&&(a.2f(1m.17+1v+1j,1m.18+aD.19-1v-1j,1j,S(90),S(2N),!1),C=1m.17+1v,ay=1m.18+aD.19-1v-1j):(C=1m.17+1v,ay=1m.18+aD.19-1v,a.1e(C,ay)),1W.1o){21(1M){1i"4t":ay=1m.18+aD.19-1v,1j&&(ay-=1j),ay-=1c.22(ax,1u.y||0),ay-=aw.y,a.1e(C,ay),C-=b.19,ay-=0.5*b.15,a.1e(C,ay),C+=b.19,ay-=0.5*b.15,a.1e(C,ay);1G;1i"4u":1i"5t":ay=1m.18+0.5*aD.19+0.5*b.15,ay+=aw.y,a.1e(C,ay),C-=b.19,ay-=0.5*b.15,a.1e(C,ay),C+=b.19,ay-=0.5*b.15,a.1e(C,ay);1G;1i"42":ay=1m.18+1v+b.15,1j&&(ay+=1j),ay+=1c.22(ax,1u.y||0),ay+=aw.y,a.1e(C,ay),C-=b.19,ay-=0.5*b.15,a.1e(C,ay),C+=b.19,ay-=0.5*b.15,a.1e(C,ay)}}1b 1j?1j&&(a.2f(1m.17+1v+1j,1m.18+1v+1j,1j,S(-2N),S(-90),!1),C=1m.17+1v+1j,ay=1m.18+1v,C+=1,a.1e(C,ay)):(C=1m.17+1v,ay=1m.18+1v,a.1e(C,ay)),1W.2p&&a.2p(),{x:C,y:ay,1o:aw,5u:au,3h:1u}}13 t(a){14 b,ax,aw,av,au,at,1u=12.1n({1o:!1,3J:1w,2o:!1,2p:!1,3K:1w,3L:1w,1q:0,1l:0,7N:0,3h:{x:0,y:0},5v:1w},29[1]||{}),1v=1u.3K,1j=1u.3L,1M=(1u.7N,1u.3h),1m=1u.1l,aD=1u.1q&&1u.1q.2E||0,aC=1u.7O,aB=1u.3J,aA=1v.1p.1f,az=1v.1p.1d,ar=1u.5v&&1u.5v.1o||{x:0,y:0};1g(1j){b=1j.1o.1d,ax=1j.2K.1f,aw=1j.2K.1d,av=1j.1l.1d,au=aw.15-b.15;14 c=1m+aC+0.5*b.15-0.5*av.15;at=1c.1K(aD>c?aD-c:0)}14 C=aA.17+1m+aC,A=aA.18+1m;aC&&(C+=1),12.1n({},{x:C,y:A}),1u.2o&&a.2o();14 f=12.1n({},{x:C,y:A});1g(A-=1m,a.1e(C,A),aD?aD&&(a.2f(aA.17+aD,aA.18+aD,aD,S(-90),S(-2N),!0),C=aA.17,A=aA.18+aD):(C=aA.17,A=aA.18,a.1e(C,A)),1u.1o){21(aB){1i"42":A=aA.18+1m,aC&&(A+=aC),A-=0.5*av.15,A+=0.5*b.15,A+=1c.22(at,1M.y||0),A+=ar.y,a.1e(C,A),C-=av.19,A+=0.5*av.15,a.1e(C,A),C+=av.19,A+=0.5*av.15,a.1e(C,A);1G;1i"4u":1i"5t":A=aA.18+0.5*az.19-0.5*av.15,A+=ar.y,a.1e(C,A),C-=av.19,A+=0.5*av.15,a.1e(C,A),C+=av.19,A+=0.5*av.15,a.1e(C,A);1G;1i"4t":A=aA.18+az.19-1m-av.15,aC&&(A-=aC),A+=0.5*av.15,A-=0.5*b.15,A-=1c.22(at,1M.y||0),A-=ar.y,a.1e(C,A),C-=av.19,A+=0.5*av.15,a.1e(C,A),C+=av.19,A+=0.5*av.15,a.1e(C,A)}}1g(aD?aD&&(a.2f(aA.17+aD,aA.18+az.19-aD,aD,S(-2N),S(-9z),!0),C=aA.17+aD,A=aA.18+az.19):(C=aA.17,A=aA.18+az.19,a.1e(C,A)),1u.1o){21(aB){1i"4s":C=aA.17+1m,aC&&(C+=aC),C-=0.5*av.15,C+=0.5*b.15,C+=1c.22(at,1M.x||0),C+=ar.x,a.1e(C,A),A+=av.19,C+=0.5*av.15,a.1e(C,A),A-=av.19,C+=0.5*av.15,a.1e(C,A);1G;1i"4r":1i"5s":C=aA.17+0.5*az.15-0.5*av.15,C+=ar.x,a.1e(C,A),A+=av.19,C+=0.5*av.15,a.1e(C,A),A-=av.19,C+=0.5*av.15,a.1e(C,A),C=aA.17+0.5*az.15+av.15,a.1e(C,A);1G;1i"4q":C=aA.17+az.15-1m-av.15,aC&&(C-=aC),C+=0.5*av.15,C-=0.5*b.15,C-=1c.22(at,1M.x||0),C-=ar.x,a.1e(C,A),A+=av.19,C+=0.5*av.15,a.1e(C,A),A-=av.19,C+=0.5*av.15,a.1e(C,A)}}1g(aD?aD&&(a.2f(aA.17+az.15-aD,aA.18+az.19-aD,aD,S(90),S(0),!0),C=aA.17+az.15,A=aA.18+az.15+aD):(C=aA.17+az.15,A=aA.18+az.19,a.1e(C,A)),1u.1o){21(aB){1i"4p":A=aA.18+az.19-1m,A+=0.5*av.15,A-=0.5*b.15,aC&&(A-=aC),A-=1c.22(at,1M.y||0),A-=ar.y,a.1e(C,A),C+=av.19,A-=0.5*av.15,a.1e(C,A),C-=av.19,A-=0.5*av.15,a.1e(C,A);1G;1i"4o":1i"5r":A=aA.18+0.5*az.19+0.5*av.15,A+=ar.y,a.1e(C,A),C+=av.19,A-=0.5*av.15,a.1e(C,A),C-=av.19,A-=0.5*av.15,a.1e(C,A);1G;1i"41":A=aA.18+1m,aC&&(A+=aC),A+=av.15,A-=0.5*av.15-0.5*b.15,A+=1c.22(at,1M.y||0),A+=ar.y,a.1e(C,A),C+=av.19,A-=0.5*av.15,a.1e(C,A),C-=av.19,A-=0.5*av.15,a.1e(C,A)}}1g(aD?aD&&(a.2f(aA.17+az.15-aD,aA.18+aD,aD,S(0),S(-90),!0),C=aA.17+az.15-aD,A=aA.18):(C=aA.17+az.15,A=aA.18,a.1e(C,A)),1u.1o){21(aB){1i"40":C=aA.17+az.15-1m,C+=0.5*av.15-0.5*b.15,aC&&(C-=aC),C-=1c.22(at,1M.x||0),C-=ar.x,a.1e(C,A),A-=av.19,C-=0.5*av.15,a.1e(C,A),A+=av.19,C-=0.5*av.15,a.1e(C,A);1G;1i"4n":1i"5q":C=aA.17+0.5*az.15+0.5*av.15,C+=ar.x,a.1e(C,A),A-=av.19,C-=0.5*av.15,a.1e(C,A),A+=av.19,C-=0.5*av.15,a.1e(C,A),C=aA.17+0.5*az.15-av.15,a.1e(C,A),a.1e(C,A);1G;1i"3Z":C=aA.17+1m+av.15,C-=0.5*av.15,C+=0.5*b.15,aC&&(C+=aC),C+=1c.22(at,1M.x||0),C+=ar.x,a.1e(C,A),A-=av.19,C-=0.5*av.15,a.1e(C,A),A+=av.19,C-=0.5*av.15,a.1e(C,A)}}a.1e(f.x,f.y-1m),a.1e(f.x,f.y),1u.2p&&a.2p()}13 r(a){14 b=11.2x(),av=11.1a.1o&&11.4B(),au=11.2i&&11.2i.3H(),at=11.1q,ar=11.1l,aq=11.2w,C=({15:2*ar+2*aq+11.2P.15,19:2*ar+2*aq+11.2P.19},a.1a.1o&&a.1a.1o.1F||{x:0,y:0}),A=0,v=0;at&&(A="1p"==11.1a.1q.1f?at:0,v="1l"==11.1a.1q.1f?at:A+ar),12(1C.3b).28(11.35=1C.2b("3p")),O.3D(11.35,b.1O.1d),O.3A(11.35);14 u=11.35.3y("2d");u.2U=11.2H,12(11.1O).28(11.35),u.2Z=O.4m(u,11.1a.1p,{3V:0,3W:b.1p.1f.18+ar,3X:0,3Y:b.1p.1f.18+b.1p.1d.19-ar}),u.9A=0;14 j;1g(j=11.6u(u,{2o:!0,2p:!0,1l:ar,1q:A,5p:v,3K:b,3L:av,1o:11.1a.1o,3J:au,3h:C}),u.3e(),ar){14 g=O.4m(u,11.1a.1l,{3V:0,3W:b.1p.1f.18,3X:0,3Y:b.1p.1f.18+b.1p.1d.19});u.2Z=g,j=11.6u(u,{2o:!0,2p:!1,1l:ar,1q:A,5p:v,3K:b,3L:av,1o:11.1a.1o,3J:au,3h:C}),11.7P(u,{2o:!1,2p:!0,1l:ar,7O:A,1q:{2E:v,1f:11.1a.1q.1f},3K:b,3L:av,1o:11.1a.1o,3J:au,3h:j.3h,5v:j}),u.3e()}11.3O=j}13 n(){14 a,7Q=11.2m(),6v=11.2P,3P=7Q.1a,7R=11.1q,5w=11.1l,6w=11.2w,47={15:2*5w+2*6w+6v.15,19:2*5w+2*6w+6v.19};1g(11.1a.1o){14 b=11.4B();a=b.2K.1d}14 c=K.6f(11,47),3M=c.1d,1J=c.1f,47=c.1p.1d,1u=c.1p.1f;c.1o.1d;14 d,aB,az,1j={18:0,17:0},ax={15:3M.15,19:3M.19};1g(3P.1E){14 e=7R;"1p"==3P.1q.1f&&(e+=5w);14 f=e-1c.9B(S(45))*e,aq="1V";11.2i.3H().3o(/^(40|41)$/)&&(aq="17");14 p=3P.1E.3I+2*3P.1E.1l,d={15:p,19:p};1g(1j.17=1u.17-p/2+("17"==aq?f:47.15-f),1j.18=1u.18-p/2+f,"17"==aq){1g(1j.17<0){14 g=1c.34(1j.17);ax.15+=g,1J.17+=g,1j.17=0}}1N{14 h=1j.17+p-ax.15;h>0&&(ax.15+=h)}1g(1j.18<0){14 i=1c.34(1j.18);ax.19+=i,1J.18+=i,1j.18=0}1g(11.1a.1E.1x){14 j=11.1a.1E.1x,aA=j.3a,ay=j.1F;1g(aB={15:d.15+2*aA,19:d.19+2*aA},az={18:1j.18-aA+ay.y,17:1j.17-aA+ay.x},"17"==aq){1g(az.17<0){14 g=1c.34(az.17);ax.15+=g,1J.17+=g,1j.17+=g,az.17=0}}1N{14 h=az.17+aB.15-ax.15;h>0&&(ax.15+=h)}1g(az.18<0){14 i=1c.34(az.18);ax.19+=i,1J.18+=i,1j.18+=i,az.18=0}}}14 k=c.2S;k.18+=1J.18,k.17+=1J.17;14 l={17:1c.1K(1J.17+1u.17+11.1l+11.1a.2w),18:1c.1K(1J.18+1u.18+11.1l+11.1a.2w)},ar={1I:{1d:{15:1c.1K(ax.15),19:1c.1K(ax.19)}},2a:{1d:{15:1c.1K(ax.15),19:1c.1K(ax.19)}},1O:{1d:3M,1f:{18:1c.2c(1J.18),17:1c.2c(1J.17)}},1p:{1d:{15:1c.1K(47.15),19:1c.1K(47.19)},1f:{18:1c.2c(1u.18),17:1c.2c(1u.17)}},2S:{18:1c.2c(k.18),17:1c.2c(k.17)},2O:{1f:l}};1b 11.1a.1E&&(ar.1E={1d:{15:1c.1K(d.15),19:1c.1K(d.19)},1f:{18:1c.2c(1j.18),17:1c.2c(1j.17)}},11.1a.1E.1x&&(ar.33={1d:{15:1c.1K(aB.15),19:1c.1K(aB.19)},1f:{18:1c.2c(az.18),17:1c.2c(az.17)}})),ar}13 k(){14 d=11.2x(),f=11.2m();12(f.1k).1t(V(d.1I.1d)),12(f.5k).1t(V(d.2a.1d)),11.32&&11.32.1t(V(d.1I.1d)),12(11.1O).1t(12.1n(V(d.1O.1d),V(d.1O.1f))),11.1E&&(12(11.1E).1t(V(d.1E.1f)),d.33&&12(11.33.1k).1t(V(d.33.1f))),12(f.3i).1t(V(d.2O.1f))}13 e(b){11.2H=b||0,11.1x&&(11.1x.2H=11.2H)}13 a(b){11.7S(b),11.1X()}1b{5l:am,7D:ap,1X:al,1D:ao,3g:an,2m:B,2Y:ak,5x:aj,7I:ai,7H:ah,4z:ag,7C:y,6r:x,7B:r,6u:w,7P:t,7K:s,7L:q,4B:z,2x:n,5m:k,7S:e,9C:a}}());14 G={3t:{},1y:13(a){1g(!a){1b 1w}14 f=1w,e=12(a).26("2A-23");1b e&&(f=11.3t[e]),f},39:13(b){11.3t[b.23]=b},1D:13(d){14 c=11.1y(d);c&&(3T 11.3t[c.23],c.1D())},4C:13(b){1b 1c.38/2-1c.78(b,1c.4R(b)*1c.38)}};G.4D={4w:13(g,f){14 j=I.1y(g.1h),i=j.4B().1l.1d,h=11.5h(i.15,i.19,f,{43:!1});1b{15:h.15,19:h.19}},9D:13(r,q,p){14 o=0.5*r,n=T(1c.9E(o/U(o,q))),m=2N-n-90,l=R(S(m))*p,k=2*(o+l),j=k/r*q;1b{15:k,19:j}},5h:13(j,i,p){14 o=T(1c.7w(0.5*(i/j))),n=2N-o,m=1c.4R(S(n-90))*p,l=j+2*m,k=l*i/j;1b{15:l,19:k}},44:13(r){14 q=I.1y(r.1h),p=r.1a.3a,o=L.7v(q.2i),n=(L.2R(q.2i),G.4D.4w(r,p)),m={2K:{1d:{15:1c.1K(n.15),19:1c.1K(n.19)},1f:{18:0,17:0}}};1g(p){m.36=[];2h(14 l=0;p>=l;l++){14 f=G.4D.4w(r,l,{43:!1}),a={1f:{18:m.2K.1d.19-f.19,17:o?p-l:(m.2K.1d.15-f.15)/2},1d:f};m.36.2v(a)}}1N{m.36=[12.1n({},m.2K)]}1b m},5o:13(e,d,f){K.5o(e,d.3u(),f)}},12.1n(F.3S,13(){13 t(){1b N.1y(11.1h)[0]}13 s(){1b I.1y(11.1h)}13 r(){11.3g()}13 q(){11.1k&&(12(11.1k).1D(),11.1o=1w,11.1p=1w,11.1O=1w,11.1k=1w,11.1r={})}13 p(){}13 o(){11.3g(),11.5l();14 d=11.2m(),e=11.3u();11.1k=12("<2q>").27("9F")[0],12(d.1k).6m(11.1k),e.32&&12(d.1k).6m(e.32),e.2x(),12(11.1k).1t({18:0,17:0}),11.7T(),11.5m()}13 n(){1b 11.1a.1S/(11.1a.3a+1)}13 m(){14 a=11.3u(),1M=a.2x(),1m=11.2m(),aD=11.2x(),k=11.1a.3a,aB=G.4D.44(11),aA=a.2i,az=L.6d(aA),ay={18:k,17:k};1g(1m.1a.1o){14 b=aB.36[aB.36.2j-1];"17"==az&&(ay.17+=1c.1K(b.1d.19)),"18"==az&&(ay.18+=1c.1K(b.1d.19))}14 c=a.1r.1a,av=c.1q,au=c.1l;"1p"==1m.1a.1q.1f&&av&&(av+=au);14 d=aD.1O.1d;12(11.1k).28(12(11.1O=1C.2b("2q")).27("9G").1t(V(d))).1t(V(d)),12(1C.3b).28(12(11.35=1C.2b("3p"))),O.3D(11.35,aD.1O.1d),O.3A(11.35);14 e=11.35.3y("2d");e.2U=11.2H,12(11.1O).28(11.35);2h(14 f=k+1,j=0;k>=j;j++){e.2Z=J.30(11.1a.1Y,G.4C(j*(1/f))*(11.1a.1S/f)),O.7m(e,{15:1M.1p.1d.15+2*j,19:1M.1p.1d.19+2*j,18:ay.18-j,17:ay.17-j,1q:av+j})}1g(a.1a.1o){14 g={x:ay.17,y:ay.18},ag=aB.36[0].1d,w=a.1a.1o,ar=au;ar+=0.5*w.15;14 h=a.1a.1q&&"1p"==a.1a.1q.1f?a.1a.1q.2E||0:0;h&&(ar+=h);14 i=au+h+0.5*w.15-0.5*ag.15,an=1c.1K(av>i?av-i:0),am=a.3O&&a.3O.1o||{x:0,y:0},ak=a.3O&&a.3O.5u||{x:0,y:0};1g(ar+=1c.22(an,a.1a.1o.1F&&a.1a.1o.1F[az&&/^(17|1V)$/.3r(az)?"y":"x"]||0),"18"==az||"20"==az){21(aA){1i"3Z":1i"4s":g.x+=ar+am.x-ak.x;1G;1i"4n":1i"5q":1i"4r":1i"5s":g.x+=0.5*1M.1p.1d.15+am.x;1G;1i"40":1i"4q":g.x+=1M.1p.1d.15-(ar-am.x+ak.x)}"20"==az&&(g.y+=1M.1p.1d.19);2h(14 j=0,ai=aB.36.2j;ai>j;j++){e.2Z=J.30(11.1a.1Y,G.4C(j*(1/f))*(11.1a.1S/f));14 k=aB.36[j];e.2o(),"18"==az?(e.3E(g.x,g.y-j),e.1e(g.x-0.5*k.1d.15,g.y-j),e.1e(g.x,g.y-j-k.1d.19),e.1e(g.x+0.5*k.1d.15,g.y-j)):(e.3E(g.x,g.y+j),e.1e(g.x-0.5*k.1d.15,g.y+j),e.1e(g.x,g.y+j+k.1d.19),e.1e(g.x+0.5*k.1d.15,g.y+j)),e.2p(),e.3e()}}1N{21(aA){1i"42":1i"41":g.y+=ar+am.y-ak.y;1G;1i"4u":1i"5t":1i"4o":1i"5r":g.y+=0.5*1M.1p.1d.19+am.y;1G;1i"4t":1i"4p":g.y+=1M.1p.1d.19-(ar-am.y+ak.y)}"1V"==az&&(g.x+=1M.1p.1d.15);2h(14 j=0,ai=aB.36.2j;ai>j;j++){e.2Z=J.30(11.1a.1Y,G.4C(j*(1/f))*(11.1a.1S/f));14 k=aB.36[j];e.2o(),"17"==az?(e.3E(g.x-j,g.y),e.1e(g.x-j,g.y-0.5*k.1d.15),e.1e(g.x-j-k.1d.19,g.y),e.1e(g.x-j,g.y+0.5*k.1d.15)):(e.3E(g.x+j,g.y),e.1e(g.x+j,g.y-0.5*k.1d.15),e.1e(g.x+j+k.1d.19,g.y),e.1e(g.x+j,g.y+0.5*k.1d.15)),e.2p(),e.3e()}}}}13 k(){14 a=11.3u();a.2P,a.1q;14 b=a.2x(),av=(11.2m(),11.1a.3a),au=12.1n({},b.1p.1d);au.15+=2*av,au.19+=2*av;14 e,ar;1g(a.1a.1o){14 g=G.4D.44(11);e=g.2K.1d,ar=e.19}14 h=K.6f(a,au,ar),ao=h.1d,an=h.1f,au=h.1p.1d,am=h.1p.1f,aj=b.1O.1f,ag=b.1p.1f,w={18:aj.18+ag.18-(am.18+av)+11.1a.1F.y,17:aj.17+ag.17-(am.17+av)+11.1a.1F.x},j=b.2S,f=b.2a.1d,d={18:0,17:0};1g(w.18<0){14 c=1c.34(w.18);d.18+=c,w.18=0,j.18+=c}1g(w.17<0){14 i=1c.34(w.17);d.17+=i,w.17=0,j.17+=i}14 l={19:1c.22(ao.19+w.18,f.19+d.18),15:1c.22(ao.15+w.17,f.15+d.17)},ai={17:1c.1K(d.17+b.1O.1f.17+b.1p.1f.17+a.1l+a.2w),18:1c.1K(d.18+b.1O.1f.18+b.1p.1f.18+a.1l+a.2w)},ah={1I:{1d:l},2a:{1d:f,1f:d},1k:{1d:ao,1f:w},1O:{1d:ao,1f:{18:1c.2c(an.18),17:1c.2c(an.17)}},1p:{1d:{15:1c.1K(au.15),19:1c.1K(au.19)},1f:{18:1c.2c(am.18),17:1c.2c(am.17)}},2S:j,2O:{1f:ai}};1b ah}13 a(){14 i=11.2x(),x=11.3u(),w=11.2m();1g(12(w.1k).1t(V(i.1I.1d)),12(w.5k).1t(12.1n(V(i.2a.1f),V(i.2a.1d))),x.32&&x.32.1t(V(i.1I.1d)),w.1a.1E){14 v=x.2x(),u=i.2a.1f,l=v.1E.1f;1g(12(x.1E).1t(V({18:u.18+l.18,17:u.17+l.17})),w.1a.1E.1x){14 j=v.33.1f;12(x.33.1k).1t(V({18:u.18+j.18,17:u.17+j.17}))}}12(11.1k).1t(12.1n(V(i.1k.1d),V(i.1k.1f))),12(11.1O).1t(V(i.1O.1d)),12(w.3i).1t(V(i.2O.1f))}1b{5l:p,1D:r,3g:q,1X:o,2m:t,3u:s,2x:k,7U:n,7T:m,5m:a}}());14 E={3t:{},1y:13(a){1g(!a){1b 1w}14 d=12(a).26("2A-23");1b d?11.3t[d]:1w},39:13(b){11.3t[b.23]=b},1D:13(d){14 c=11.1y(d);c&&(3T 11.3t[c.23],c.1D())}};12.1n(D.3S,13(){13 a(){1b N.1y(11.1h)[0]}13 l(){1b I.1y(11.1h)}13 k(){1b 11.1a.1S/(11.1a.3a+1)}13 j(){11.3g()}13 i(){11.1k&&(12(11.1k).1D(),11.1k=1w)}13 h(){11.3g();14 u=(11.2m(),11.3u()),t=u.2x().1E.1d,s=12.1n({},t),r=11.1a.3a;s.15+=2*r,s.19+=2*r,12(u.1E).6x(12(11.1k=1C.2b("2q")).27("9H")),12(1C.3b).28(12(11.4E=1C.2b("3p"))),O.3D(11.4E,s),O.3A(11.4E);14 q=11.4E.3y("2d");q.2U=11.2H,12(11.1k).28(11.4E);2h(14 p=s.15/2,o=s.19/2,n=t.19/2,m=r+1,b=0;r>=b;b++){q.2Z=J.30(11.1a.1Y,G.4C(b*(1/m))*(11.1a.1S/m)),q.2o(),q.2f(p,o,n+b,S(0),S(7A),!0),q.2p(),q.3e()}}1b{1X:h,1D:j,3g:i,2m:a,3u:l,7U:k}}());14 N={2y:{},1a:{48:"6y",4T:9I},7V:13(){14 a=["2z"];1Z.2I.3z&&(a.2v("7W"),11.4F&&12(1C.3b).4G("2z",11.4F),11.4F=1w),12.1B(a,13(d,e){12(1C.6z).9J(".3j .6q, .3j .7X-1I",e)}),11.4H&&(12(1P).4G("3D",11.4H),11.4H=1w),12(1C).4G("4I",N.2n.6A)},7k:13(){13 a(){11.7V();14 c=["2z"];1Z.2I.3z&&(c.2v("7W"),11.4F=13(){1b 3F 0},12(1C.3b).46("2z",11.4F)),12.1B(c,13(d,e){12(1C.6z).9K(".3j .6q, .3j .7X-1I",e,13(f){f.9L(),f.9M(),N.6B(12(f.1H).5y(".3j")[0]).1Q()})}),11.4H=12.1A(11.7Y,11),12(1P).46("3D",11.4H),12(1C).46("4I",N.2n.6A)}1b a}(),7Y:13(){11.5z&&(1P.6C(11.5z),11.5z=1w),11.5z=ac.4Y(12.1A(13(){14 a=11.3U();12.1B(a,13(d,c){c.1f()})},11),9N)},5A:13(a){14 g,h=12(a).26("2A-23");1g(!h){14 f=11.6B(12(a).5y(".3j")[0]);f&&f.1h&&(h=12(f.1h).26("2A-23"))}1b h&&(g=11.2y[h])?g:3F 0},65:13(d){14 c;1b ac.2s(d)&&(c=11.5A(d)),c&&c.1h},1y:13(a){14 f=[];1g(ac.2s(a)){14 d=11.5A(a);d&&(f=[d])}1N{12.1B(11.2y,13(c,b){b.1h&&12(b.1h).7Z(a)&&f.2v(b)})}1b f},6B:13(a){1g(!a){1b 1w}14 d=1w;1b 12.1B(11.2y,13(b,c){c.1L("1X")&&c.1k===a&&(d=c)}),d},9O:13(a){14 d=[];1b 12.1B(11.2y,13(c,b){b.1h&&12(b.1h).7Z(a)&&d.2v(b)}),d},25:13(a){1g(ac.2s(a)){14 f=a,d=11.1y(f)[0];d&&d.25()}1N{12(a).1B(12.1A(13(g,e){14 h=11.1y(e)[0];h&&h.25()},11))}},1Q:13(a){1g(ac.2s(a)){14 d=11.1y(a)[0];d&&d.1Q()}1N{12(a).1B(12.1A(13(f,e){14 g=11.1y(e)[0];g&&g.1Q()},11))}},3d:13(a){1g(ac.2s(a)){14 f=a,d=11.1y(f)[0];d&&d.3d()}1N{12(a).1B(12.1A(13(g,e){14 h=11.1y(e)[0];h&&h.3d()},11))}},5c:13(){12.1B(11.3U(),13(d,c){c.1Q()})},2Y:13(a){1g(ac.2s(a)){14 f=a,d=11.1y(f)[0];d&&d.2Y()}1N{12(a).1B(12.1A(13(g,e){14 h=11.1y(e)[0];h&&h.2Y()},11))}},3U:13(){14 a=[];1b 12.1B(11.2y,13(b,d){d.1T()&&a.2v(d)}),a},68:13(a){14 d=!1;1b ac.2s(a)&&12.1B(11.3U()||[],13(b,c){1b c.1h==a?(d=!0,!1):3F 0}),d},80:13(){14 d,a=0;1b 12.1B(11.2y,13(b,c){c.2t>a&&(a=c.2t,d=c)}),d},81:13(){11.3U().2j<=1&&12.1B(11.2y,13(a,d){d.1L("1X")&&!d.1a.2t&&12(d.1k).1t({2t:d.2t=+N.1a.4T})})},39:13(b){11.2y[b.23]=b},4J:13(a){14 f=11.5A(a);1g(f){14 e=12(f.1h).26("2A-23");3T 11.2y[e],f.1Q(),f.1D()}},1D:13(a){ac.2s(a)?11.4J(a):12(a).1B(12.1A(13(d,c){11.4J(c)},11))},7l:13(){12.1B(11.2y,12.1A(13(d,c){c.1h&&!ac.1h.56(c.1h)&&11.4J(c.1h)},11))},7j:13(){12.1B(11.2y,12.1A(13(d,c){c.1h&&11.4J(c.1h)},11)),11.2y={}},66:13(b){11.1a.48=b||"6y"},67:13(b){11.1a.4T=b||0},6a:13(){12.1B(11.2y,12.1A(13(d,c){c.1r&&c.1r.2u&&(c.1r.2u.6D(),c.1r.2u=1w),c.2g("3n",!1)},11)),X.7e()},6X:13(){13 k(c){14 b;1b b="2C"==12.1s(c)?{1h:n.2e&&n.2e.1h||a.2e.1h,2F:c}:Q(12.1n({},a.2e),c)}13 j(b){1b a=1Z.2L.82,n=Q(12.1n({},a),1Z.2L.6E),m=1Z.2L.6F.82,l=Q(12.1n({},m),1Z.2L.6F.6E),j=i,i(b)}13 i(j){j.2a=j.2a&&1Z.2L[j.2a]?j.2a:1Z.2L[N.1a.48]?N.1a.48:"6y";14 w=j.2a?12.1n({},1Z.2L[j.2a]||1Z.2L[N.1a.48]):{},ap=Q(12.1n({},n),w),ao=Q(12.1n({},ap),j);1g(ao.2l){14 x=n.2l||{},am=a.2l;"4K"==12.1s(ao.2l)&&(ao.2l={49:x.49||am.49,1s:x.1s||am.1s}),ao.2l=Q(12.1n({},am),ao.2l)}1g(ao.1p&&"2C"==12.1s(ao.1p)&&(ao.1p={1Y:ao.1p,1S:1}),ao.1l){14 z,ak=n.1l||{},aj=a.1l;z="2J"==12.1s(ao.1l)?{2E:ao.1l,1Y:ak.1Y||aj.1Y,1S:ak.1S||aj.1S}:Q(12.1n({},aj),ao.1l),ao.1l=0===z.2E?!1:z}1g(ao.1q){14 C;C="2J"==12.1s(ao.1q)?{2E:ao.1q,1f:n.1q&&n.1q.1f||a.1q.1f}:Q(12.1n({},a.1q),ao.1q),ao.1q=0===C.2E?!1:C}14 D,B=B=ao.1z&&ao.1z.1H||"2C"==12.1s(ao.1z)&&ao.1z||n.1z&&n.1z.1H||"2C"==12.1s(n.1z)&&n.1z||a.1z&&a.1z.1H||a.1z,y=ao.1z&&ao.1z.1I||n.1z&&n.1z.1I||a.1z&&a.1z.1I||N.2n.6G(B);1g(ao.1z?"2C"==12.1s(ao.1z)?D={1H:ao.1z,1I:N.2n.83(ao.1z)}:(D={1I:y,1H:B},ao.1z.1I&&(D.1I=ao.1z.1I),ao.1z.1H&&(D.1H=ao.1z.1H)):D={1I:y,1H:B},"2V"==ao.1H){14 f=L.2R(D.1H);D.1H="1R"==f?D.1H.6h(/(17|1V)/,"2D"):D.1H.6h(/(18|20)/,"2D")}ao.1z=D;14 e;1g("2V"==ao.1H?(e=12.1n({},a.1F),12.1n(e,1Z.2L.6E.1F||{}),j.2a&&12.1n(e,(1Z.2L[j.2a]||1Z.2L[N.1a.48]).1F||{}),e=N.2n.84(a.1F,a.1z,D.1H,!0),j.1F&&(e=12.1n(e,j.1F||{})),ao.4a=0):e={x:ao.1F.x,y:ao.1F.y},ao.1F=e,ao.1E&&ao.85){14 d=12.1n({},1Z.2L.6F[ao.85]),c=Q(12.1n({},l),d);1g(c.2B&&12.1B(["6s","6t"],13(o,v){14 u=c.2B[v],t=l.2B&&l.2B[v];1g(u.1p){14 s=t&&t.1p;1g("2J"==12.1s(u.1p)){u.1p={1Y:s&&s.1Y||m.2B[v].1p.1Y,1S:u.1p}}1N{1g("2C"==12.1s(u.1p)){14 q=s&&"2J"==12.1s(s.1S)&&s.1S||m.2B[v].1p.1S;u.1p={1Y:u.1p,1S:q}}1N{u.1p=Q(12.1n({},m.2B[v].1p),u.1p)}}}1g(u.1l){14 p=t&&t.1l;u.1l="2J"==12.1s(u.1l)?{1Y:p&&p.1Y||m.2B[v].1l.1Y,1S:u.1l}:Q(12.1n({},m.2B[v].1l),u.1l)}}),c.1x){14 b=l.1x&&l.1x.3Q&&l.1x.3Q==5O?l.1x:m.1x;c.1x.3Q&&c.1x.3Q==5O&&(b=Q(b,c.1x)),c.1x=b}ao.1E=c}1g(ao.1x){14 E;E="4K"==12.1s(ao.1x)?n.1x&&"4K"==12.1s(n.1x)?a.1x:n.1x?n.1x:a.1x:Q(12.1n({},a.1x),ao.1x||{}),"2J"==12.1s(E.1F)&&(E.1F={x:E.1F,y:E.1F}),ao.1x=E}1g(ao.1o){14 A={};A="4K"==12.1s(ao.1o)?Q({},a.1o):Q(Q({},a.1o),12.1n({},ao.1o)),"2J"==12.1s(A.1F)&&(A.1F={x:A.1F,y:A.1F}),ao.1o=A}1g(ao.37&&("2C"==12.1s(ao.37)?ao.37={5B:ao.37,86:!0}:"4K"==12.1s(ao.37)&&(ao.37=ao.37?{5B:"5e",86:!0}:!1)),ao.2e&&"2z-9P"==ao.2e&&(ao.87=!0,ao.2e=!1),ao.2e){1g(12.7o(ao.2e)){14 r=[];12.1B(ao.2e,13(h,g){r.2v(k(g))}),ao.2e=r}1N{ao.2e=[k(ao.2e)]}}1b ao.2T&&"2C"==12.1s(ao.2T)&&(ao.2T=[""+ao.2T]),ao.2w=0,ao.1U&&(1P.6H||(ao.1U=!1)),ao}14 a,n,m,l;1b j}()};N.2n=13(){13 B(n){14 m=L.2W(n),l=m[1],k=m[2],j=L.2R(n),b=12.1n({1R:!0,2k:!0},29[1]||{});1b"1R"==j?(b.2k&&(l=C[l]),b.1R&&(k=C[k])):(b.2k&&(k=C[k]),b.1R&&(l=C[l])),l+k}13 w(b){14 c=L.2W(b);1b B(c[1]+C[c[2]])}13 u(f,h){12(f.1k).1t({18:h.18+"2G",17:h.17+"2G"})}13 r(z,y,x,v){14 t=ag(z,y,x,v),s=x&&"2C"==88 x.1s?x.1s:"";1g(/9Q$/.3r(s),1===t.4b.4c){1b i(z,t),t}14 l=y,k=v,j={1R:!t.4b.1R,2k:!t.4b.2k},f={1R:!1,2k:!1},c=L.2R(y);1b((f.2k="1R"==c&&j.2k)||(f.1R="2k"==c&&j.1R))&&(l=B(y,f),k=B(v,f),t=ag(z,l,x,k),1===t.4b.4c)?(i(z,t),t):(t=p(t,z),i(z,t),t)}13 p(k,j){14 s=A(j),q=s.1d,o=s.1f,n=I.1y(j.1h).1r.1z[k.1z.1I].1I.1d,m=k.1f,l={18:0,17:0,3N:[]};1b o.17>m.17&&(l.17=o.17-m.17,l.3N.2v("17"),k.1f.17=o.17),o.18>m.18&&(l.18=m.18-o.18,l.3N.2v("18"),k.1f.18=o.18),o.17+q.15<m.17+n.15&&(l.17=o.17+q.15-(m.17+n.15),l.3N.2v("1V"),k.1f.17=o.17+q.15-n.15),o.18+q.19<m.18+n.19&&(l.18=o.18+q.19-(m.18+n.19),l.3N.2v("20"),k.1f.18=o.18+q.19-n.19),k.89=l,k}13 i(f,c){f.5x(c.1z.1I,c.4b.4x,c.89),u(f,c.1f)}13 g(b){1b b&&(/^2V|2z|3z$/.3r("2C"==88 b.1s&&b.1s||"")||b.5X>=0)}13 e(h,f,j){1b h>=f&&j>=h}13 d(k,j,s,q){14 o=e(k,s,q),n=e(j,s,q);1g(o&&n){1b j-k}1g(o&&!n){1b q-k}1g(!o&&n){1b j-s}14 m=e(s,k,j),l=e(q,k,j);1b m&&l?q-s:m&&!l?j-s:!m&&l?q-k:0}13 a(f,c){1b d(f.1f.17,f.1f.17+f.1d.15,c.1f.17,c.1f.17+c.1d.15)*d(f.1f.18,f.1f.18+f.1d.19,c.1f.18,c.1f.18+c.1d.19)}13 ak(h,f){14 j=h.1d.15*h.1d.19;1b j?a(h,f)/j:0}13 aj(h,f){14 l=L.2W(f),k=L.2R(f),j={17:0,18:0};1g("1R"==k){21(l[2]){1i"2D":1i"31":j.17=0.5*h.15;1G;1i"1V":j.17=h.15}"20"==l[1]&&(j.18=h.19)}1N{21(l[2]){1i"2D":1i"31":j.18=0.5*h.19;1G;1i"20":j.18=h.19}"1V"==l[1]&&(j.17=h.15)}1b j}13 ai(h){14 l=ac.1h.54(h),k=ac.1h.4Z(h),j={18:12(1P).51(),17:12(1P).52()};1b l.17+=-1*(k.17-j.17),l.18+=-1*(k.18-j.18),l}13 ag(a,b,d,e){14 f,6I,1W,n=I.1y(a.1h),1J=n.1a,1u=1J.1F,1v=g(d);1g(1v||!d){1g(1W={15:24,19:24},1v){14 h=ac.5W(d);f={18:h.y-0.5*1W.19+6,17:h.x-0.5*1W.15+6}}1N{14 i=a.1r.2F;f={18:(i?i.y:0)-0.5*1W.19+6,17:(i?i.x:0)-0.5*1W.15+6}}a.1r.2F={x:f.17,y:f.18}}1N{f=ai(d),1W={15:12(d).8a(),19:12(d).8b()}}1g(1J.1o&&"2V"!=1J.1H){14 j=L.2W(e),aC=L.2W(b),o=L.2R(e),aA=n.1r.1a,az=n.4B().1l.1d,ay=aA.1q,ax=aA.1l,aw=ay&&"1p"==1J.1q.1f?ay:0,av=ay&&"1l"==1J.1q.1f?ay:ay+ax,au=ax+aw+0.5*1J.1o.15-0.5*az.15,at=av>au?av-au:0;4L=1c.1K(ax+aw+0.5*1J.1o.15+at+1J.1o.1F["1R"==o?"x":"y"]),"1R"==o&&"17"==j[2]&&"17"==aC[2]||"1V"==j[2]&&"1V"==aC[2]?(1W.15-=2*4L,f.17+=4L):("2k"==o&&"18"==j[2]&&"18"==aC[2]||"20"==j[2]&&"20"==aC[2])&&(1W.19-=2*4L,f.18+=4L)}6I=12.1n({},f);14 k=1v?B(1J.1z.1I):1J.1z.1H,aq=aj(1W,k),ap=aj(1W,e);({18:f.18+aq.18+1u.y,17:f.17+aq.17+1u.x}),f={17:f.17+ap.17,18:f.18+ap.18};14 l=12.1n({},1u);l=D(l,k,e,"2V"==n.1a.1H),f.18+=l.y,f.17+=l.x;14 n=I.1y(a.1h),an=n.1r.1z,am=12.1n({},an[b]),al={x:0,y:0},j=L.2W(e);1g("2D"!=j[2]){14 o=o=L.2R(e),z=N.2n.6G(e,"2k"==o?{1R:!0,2k:!1}:{1R:!1,2k:!0});b==z&&(al.y=n.3O.5u.y,al.x=n.3O.5u.x)}14 x={18:f.18-am.2S.18-al.y,17:f.17-am.2S.17-al.x};am.1I.1f=x;14 v={1R:!0,2k:!0},t={x:0,y:0};1g(a.1a.37){14 s=A(a),m=a.1a.1x?G.1y(a.1h):n,c=m.2x().1I.1d;v.4c=ak({1d:c,1f:x},s),v.4c<1&&((x.17<s.1f.17||x.17+c.15>s.1f.17+s.1d.15)&&(v.1R=!1,t.x=x.17<s.1f.17?x.17-s.1f.17:x.17+c.15-(s.1f.17+s.1d.15)),(x.18<s.1f.18||x.18+c.19>s.1f.18+s.1d.19)&&(v.2k=!1,t.y=x.18<s.1f.18?x.18-s.1f.18:x.18+c.19-(s.1f.18+s.1d.19)))}1N{v.4c=1}v.4x=t;14 p=an[b].1O,3P=ak({1d:1W,1f:6I},{1d:p.1d,1f:{18:x.18+p.1f.18,17:x.17+p.1f.17}});1b{1f:x,4c:{1H:3P},4b:v,1z:{1I:b,1H:e}}}13 A(j){14 q={18:12(1P).51(),17:12(1P).52()},o=j.1a,n=o.1H;("2V"==n||"4W"==n)&&(n=j.1h);14 m=12(n).5y(o.37.5B).7F()[0];1g(!m||"5e"==o.37.5B){1b{1d:P.5e(),1f:q}}14 l=ac.1h.54(m),k=ac.1h.4Z(m);1b l.17+=-1*(k.17-q.17),l.18+=-1*(k.18-q.18),{1d:{15:12(m).6b(),19:12(m).6c()},1f:l}}14 C={17:"1V",1V:"17",18:"20",20:"18",2D:"2D",31:"31"};ab.3w&&ab.3w<9||ab.57&&ab.57<2||ab.62&&ab.62<9R;14 D=13(){14 f=[[-1,-1],[0,-1],[1,-1],[-1,0],[0,0],[1,0],[-1,1],[0,1],[1,1]],c={42:0,3Z:0,4n:1,5q:1,40:2,41:2,4o:5,5r:5,4p:8,4q:8,4r:7,5s:7,4s:6,4t:6,4u:3,5t:3};1b 13(o,n,m,l){14 k=f[c[n]],j=f[c[m]],b=[1c.6l(0.5*1c.34(k[0]-j[0]))?-1:1,1c.6l(0.5*1c.34(k[1]-j[1]))?-1:1];1b L.3f(n)||!L.3f(m)||l||("1R"==L.2R(m)?b[0]=0:b[1]=0),{x:b[0]*o.x,y:b[1]*o.y}}}();1b{1y:ag,5a:r,6G:B,83:w,8c:ai,84:D,6J:g}}(),N.2n.5d={x:0,y:0},N.2n.6A=13(b){N.2n.5d={x:b.5X,y:b.73}},N.3B=13(){13 a(){12(1C.3b).28(12(1C.2b("2q")).27("9S").28(12(1C.2b("2q")).27("3j").28(12(11.1k=1C.2b("2q")).27("8d"))))}13 j(c){1b{15:12(c).6b(),19:12(c).6c()}}13 i(c){14 g=j(c),f=c.53;1b f&&12(f).1t({15:g.15+"2G"})&&j(c).19>g.19&&g.15++,12(f).1t({15:"6i%"}),g}13 h(t,s,r){(!11.1k||11.1k&&!ac.1h.56(11.1k))&&11.1X();14 q=t.1a,p=12.1n({1U:!1},29[3]||{});!q.8e&&!ac.2s(s)||12(s).26("8f")||(q.8e&&"2C"==12.1s(s)&&(t.3k=12("#"+s)[0],s=t.3k),!t.4d&&s&&ac.1h.56(s)&&(12(t.3k).26("8g",12(t.3k).1t("8h")),t.4d=1C.2b("2q"),12(t.3k).6x(12(t.4d).1Q())));14 o=1C.2b("2q");12(11.1k).28(12(o).27("7E 9T").28(s)),ac.2s(s)&&12(s).25(),q.2a&&12(o).27("9U"+t.1a.2a);14 n=12(o).6n("8i[4y]").9V(13(){1b!(12(11).3q("19")&&12(11).3q("15"))});1g(n.2j>0&&!t.1L("3R")){t.2g("3R",!0),q.1U&&(p.1U||t.1U||(t.1U=t.6K(q.1U)),t.1L("1T")&&(t.1f(),12(t.1k).25()),t.1U.6L());14 m=0,l=1c.22(9W,9X*(n.2j||0));t.2r("3R"),t.4e("3R",12.1A(13(){n.1B(13(){11.6M=13(){}}),m>=n.2j||(11.5C(t,o),r&&r())},11),l),12.1B(n,12.1A(13(g,e){14 b=2Q 9Y;b.6M=12.1A(13(){b.6M=13(){};14 w=b.15,v=b.19,u=12(e).3q("15"),f=12(e).3q("19");u&&f||(!u&&f?(w=1c.2c(f*w/v),v=f):!f&&u&&(v=1c.2c(u*v/w),w=u),12(e).3q({15:w,19:v}),m++),m==n.2j&&(t.2r("3R"),t.1U&&(t.1U.1D(),t.1U=1w),t.1L("1T")&&12(t.1k).1Q(),11.5C(t,o),r&&r())},11),b.4y=e.4y},11))}1N{11.5C(t,o),r&&r()}}13 d(e,l){14 k=i(l),g={15:k.15-(2X(12(l).1t("2w-17"))||0)-(2X(12(l).1t("2w-1V"))||0),19:k.19-(2X(12(l).1t("2w-18"))||0)-(2X(12(l).1t("2w-20"))||0)};e.1a.3s&&"2J"==12.1s(e.1a.3s)&&g.15>e.1a.3s&&(12(l).1t({15:e.1a.3s+"2G"}),k=i(l)),e.1r.2P=k,12(e.3i).8j(l)}1b{1X:a,4f:h,5C:d,6p:i}}(),12.1n(M.3S,13(){13 1u(f,e,g){11.1r.3m[f]=ac.4Y(e,g)}13 1v(b){1b 11.1r.3m[b]}13 1j(b){11.1r.3m[b]&&(1P.6C(11.1r.3m[b]),3T 11.1r.3m[b])}13 1M(){12.1B(11.1r.3m,13(e,c){1P.6C(c)}),11.1r.3m=[]}13 1m(g,m,l,j){m=m;14 h=12.1A(l,j||11);11.1r.5R.2v({1h:g,8k:m,8l:h}),12(g).46(m,h)}13 aD(){12.1B(11.1r.5R,13(e,f){12(f.1h).4G(f.8k,f.8l)})}13 aC(e,c){11.1r.2B[e]=c}13 aB(b){1b 11.1r.2B[b]}13 aA(){11.2M(11.1h,"4A",11.5D),11.2M(11.1h,"5n",12.1A(13(b){11.6N(b)},11)),11.1a.2T&&12.1B(11.1a.2T,12.1A(13(e,g){14 f=!1;"2z"==g&&(11.1a.2e&&12.1B(11.1a.2e,13(j,h){1b"4W"==h.1h&&"2z"==h.2F?(f=!0,!1):3F 0}),11.2g("5S",f)),11.2M(11.1h,g,"2z"==g?f?11.3d:11.25:12.1A(13(){11.8m()},11))},11)),11.1a.2e?12.1B(11.1a.2e,12.1A(13(e,g){14 f;21(g.1h){1i"4W":1g(11.1L("5S")&&"2z"==g.2F){1b}f=11.1h;1G;1i"1H":f=11.1H}f&&11.2M(f,g.2F,"2z"==g.2F?11.1Q:12.1A(13(){11.6O()},11))},11)):11.1a.8n&&11.1a.2T&&!12.6P("2z",11.1a.2T)>-1&&11.2M(11.1h,"5n",12.1A(13(){11.2r("25")},11));14 c=!1;!11.1a.9Z&&11.1a.2T&&((c=12.6P("4I",11.1a.2T)>-1)||12.6P("5E",11.1a.2T)>-1)&&"2V"==11.1H&&11.2M(11.1h,c?"4I":"5E",13(b){11.1L("4V")&&11.1f(b)})}13 az(){11.2M(11.1k,1Z.2I.3z?"5E":"4A",11.5D),11.2M(11.1k,"5n",11.6N),11.2M(11.1k,1Z.2I.3z?"5E":"4A",12.1A(13(){11.5F("4M")||11.25()},11)),11.1a.2e&&12.1B(11.1a.2e,12.1A(13(e,g){14 f;21(g.1h){1i"1I":f=11.1k}f&&11.2M(f,g.2F,g.2F.3o(/^(2z|4I|4A)$/)?11.1Q:12.1A(13(){11.6O()},11))},11))}13 ay(f,e,h){14 g=I.1y(11.1h);g&&g.5x(f,e,h)}13 ax(e){14 c=I.1y(11.1h);c&&c.4z(e)}13 av(){11.4z(11.1a.1z.1I)}13 au(){12(11.1k=1C.2b("2q")).27("3j"),11.8o()}13 ar(){11.1X();14 b=I.1y(11.1h);b?b.1X():(2Q H(11.1h),11.2g("4V",!0))}13 ap(){11.1L("1X")||(12(1C.3b).28(12(11.1k).1t({17:"-5G",18:"-5G",2t:11.2t}).28(12(11.5k=1C.2b("2q")).27("a0")).28(12(11.3i=1C.2b("2q")).27("8d"))),12(11.1k).27("a1"+11.1a.2a),11.1a.87&&(12(11.1h).27("8p"),11.2M(1C.6z,"2z",12.1A(13(e){1g(11.1T()){14 f=12(e.1H).5y(".3j, .8p")[0];(!f||f&&f!=11.1k&&f!=11.1h)&&11.1Q()}},11))),1Z.2I.4k&&(11.1a.4N||11.1a.4a)&&(11.5H(11.1a.4N),12(11.1k).27("6Q")),11.8q(),11.2g("1X",!0),N.39(11))}13 al(){14 b;11.2O,11.4d&&11.3k&&((b=12(11.3k).26("8g"))&&12(11.3k).1t({8h:b}),12(11.4d).6x(11.3k).1D(),11.4d=1w)}13 aj(){ac.4h(12.1A(13(){11.8r()},11)),11.8s(),11.6R(),ac.4h(12.1A(13(){12(11.1k).6n("8i[4y]").4G("a2")},11)),I.1D(11.1h),11.1L("1X")&&11.1k&&(12(11.1k).1D(),11.1k=1w);14 f,e="5Q";(f=12(11.1h).26(e))&&12(11.1h).3q("5P",f).8t("5Q"),12(11.1h).8t("2A-23")}13 ah(e){14 f=12.1n({4O:11.1a.4O,1U:!1},29[1]||{});11.1X(),11.1L("1T")&&12(11.1k).1Q(),N.3B.4f(11,e,12.1A(13(){14 c=11.1L("1T");c||11.2g("1T",!0),11.8u(),c||11.2g("1T",!1),11.1L("1T")&&(12(11.1k).1Q(),11.1f(),11.5I(),12(11.1k).25()),11.2g("3n",!0),f.4O&&f.4O(11.3i.4P,11.1h),f.4Q&&f.4Q()},11),{1U:f.1U})}13 B(e){14 g,f={4j:11.2O,1s:11.1a.2l.1s,26:11.1a.2l.26||{},8v:11.1a.2l.8v||"8j"};1g(!(11.1L("2u")||11.1a.2l.49&&11.1L("3n"))){1g(11.1a.2l.49&&(g=X.1y(f))){1b 11.6S(g,{4Q:12.1A(13(){11.1L("1T")&&11.1a.4g&&11.1a.4g(11.3i.4P,11.1h)},11)}),3F 0}11.2g("2u",!0),11.1a.1U&&(11.1U?11.1U.6L():(11.1U=11.6K(11.1a.1U),11.2g("3n",!1)),11.1f(e)),11.1r.2u&&(11.1r.2u.6D(),11.1r.2u=1w),11.1r.2u=12.2l(12.1n({},f,{a3:12.1A(13(h,l,j){0!==j.a4&&(X.5a(f,j.59),11.6S(j.59,{4Q:12.1A(13(){11.2g("2u",!1),11.1L("1T")&&11.1a.4g&&11.1a.4g(11.3i.4P,11.1h),11.1U&&(11.1U.1D(),11.1U=1w)},11)}))},11)}))}}13 aw(e){14 f=12.1n({1U:11.1a.1U&&11.1U},29[1]||{});11.4f(e,f)}13 at(){14 e=1C.2b("2q");12(e).26("8f",!0);14 g=6H.5b(e,12.1n({},29[0]||{})),f=6H.6e(e);1b 12(e).1t(V(f)),11.4f(e,{4O:!1,4Q:13(){g.6L()}}),g}13 ao(){1g(11.1L("1X")&&!11.1a.2t){14 c=N.80();c&&c!=11&&11.2t<=c.2t&&12(11.1k).1t({2t:11.2t=c.2t+1})}}13 an(){14 b=I.1y(11.1h);b&&(b.2Y(),11.1T()&&11.1f())}13 am(e){1g(1Z.2I.4k){e=e||0;14 c=11.1k.a5;c.a6=e+"5J",c.a7=e+"5J",c.a8=e+"5J",c.a9=e+"5J"}}13 ak(c){11.2r("1Q"),11.2r("4M"),11.1L("1T")||11.5F("25")||11.4e("25",12.1A(13(){11.2r("25"),11.25(c)},11),11.1a.8n||1)}13 ai(e){1g(11.2r("1Q"),11.2r("4M"),!11.1T()){1g("13"==12.1s(11.2O)||"13"==12.1s(11.1r.5K)){"13"!=12.1s(11.1r.5K)&&(11.1r.5K=11.2O);14 f=11.1r.5K(11.1h)||!1;1g(f!=11.1r.5T&&(11.1r.5T=f,11.2g("3n",!1),11.6R()),11.2O=f,!f){1b}}11.1a.ae&&N.5c(),11.2g("1T",!0),11.1a.2l?11.8w(e):11.1L("3n")||11.4f(11.2O),11.1L("4V")&&11.1f(e),11.5I(),11.1a.5L&&ac.4h(12.1A(13(){11.5D()},11)),"13"==12.1s(11.1a.4g)&&(!11.1a.2l||11.1a.2l&&11.1a.2l.49&&11.1L("3n"))&&11.1a.4g(11.3i.4P,11.1h),1Z.2I.4k&&(11.1a.4N||11.1a.4a)&&(11.5H(11.1a.4N),12(11.1k).27("8x").8y("6Q")),12(11.1k).25()}}13 ag(){11.2r("25"),11.1L("1T")&&(11.2g("1T",!1),1Z.2I.4k&&(11.1a.4N||11.1a.4a)?(11.5H(11.1a.4a),12(11.1k).8y("8x").27("6Q"),11.4e("4M",12.1A(11.6T,11),11.1a.4a)):11.6T(),11.1r.2u&&(11.1r.2u.6D(),11.1r.2u=1w,11.2g("2u",!1)))}13 v(){11.1L("1X")&&(12(11.1k).1t({17:"-5G",18:"-5G"}),N.81(),"13"!=12.1s(11.1a.8z)||11.1U||11.1a.8z(11.3i.4P,11.1h))}13 u(){11.2r("25"),!11.5F("1Q")&&11.1L("1T")&&11.4e("1Q",12.1A(13(){11.2r("1Q"),11.2r("4M"),11.1Q()},11),11.1a.af||1)}13 k(b){11[11.1T()?"1Q":"25"](b)}13 i(){1b 11.1L("1T")}13 d(){11.2g("4U",!0),11.1L("1T")&&11.5I(),11.1a.5L&&11.2r("6U")}13 a(){11.2g("4U",!1),11.1a.5L&&11.4e("6U",12.1A(13(){11.2r("6U"),11.1L("4U")||11.1Q()},11),11.1a.5L)}14 r=13(j){1g(11.1T()){14 q;1g("2V"==11.1a.1H){14 p=N.2n.6J(j),o=N.2n.5d;1g(p){o.x||o.y?(11.1r.2F={x:o.x,y:o.y},q=1w):q=j}1N{1g(o.x||o.y){11.1r.2F={x:o.x,y:o.y}}1N{1g(!11.1r.2F){14 n=N.2n.8c(11.1h);11.1r.2F={x:n.17,y:n.18}}}q=1w}}1N{q=11.1H}1g(N.2n.5a(11,11.1a.1z.1I,q,11.1a.1z.1H),j&&N.2n.6J(j)){14 m={15:12(11.1k).8a(),19:12(11.1k).8b()},l=ac.5W(j),n=ac.1h.54(11.1k);l.x>=n.17&&l.x<=n.17+m.15&&l.y>=n.18&&l.y<=n.18+m.19&&ac.4h(12.1A(13(){11.2r("1Q")},11))}}};1b{1X:ap,70:au,8u:ar,8o:aA,8q:az,25:ai,1Q:ag,6T:v,3d:k,1T:i,8m:ak,6O:u,5H:am,2g:aC,1L:aB,5D:d,6N:a,5F:1v,4e:1u,2r:1j,8s:1M,2M:1m,8r:aD,5x:ay,4z:ax,as:av,2Y:an,4f:ah,8w:B,6S:aw,6K:at,1f:r,5I:ao,6R:al,1D:aj}}()),1Z.3A()}(4i);',62,660,"|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||this|ba|function|var|width||left|top|height|options|return|Math|dimensions|lineTo|position|if|element|case|aG|container|border|aE|extend|stem|background|radius|_cache|type|css|aI|aH|null|shadow|get|hook|proxy|each|document|remove|closeButton|offset|break|target|tooltip|aJ|ceil|getState|aF|else|bubble|window|hide|horizontal|opacity|visible|spinner|right|aL|build|color|Tipped|bottom|switch|max|uid||show|data|addClass|append|arguments|skin|createElement|round||hideOn|arc|setState|for|_hookPosition|length|vertical|ajax|getTooltip|Position|beginPath|closePath|div|clearTimer|isElement|zIndex|xhr|push|padding|getOrderLayout|tooltips|click|tipped|states|string|middle|size|event|px|_globalAlpha|support|number|box|Skins|setEvent|180|content|contentDimensions|new|getOrientation|anchor|showOn|globalAlpha|mouse|split|parseInt|refresh|fillStyle|hex2fill|center|iframeShim|closeButtonShadow|abs|bubbleCanvas|blurs|containment|PI|add|blur|body|scripts|toggle|fill|isCenter|cleanup|cornerOffset|contentElement|t_Tooltip|inlineContent|_stemCorrection|timers|updated|match|canvas|attr|test|maxWidth|shadows|getSkin|_adjustment|IE|indexOf|getContext|touch|init|UpdateQueue|devicePixelRatio|resize|moveTo|void|charAt|toLowerCase|diameter|hookPosition|layout|stemLayout|aK|sides|_corrections|aS|constructor|preloading_images|prototype|delete|getVisible|x1|y1|x2|y2|topleft|topright|righttop|lefttop|math|getLayout||bind|aO|defaultSkin|cache|fadeOut|contained|overlap|inlineMarker|setTimer|update|onShow|defer|jQuery|url|cssTransitions|items|createFillStyle|topmiddle|rightmiddle|rightbottom|bottomright|bottommiddle|bottomleft|leftbottom|leftmiddle|regex|getBorderDimensions|correction|src|setHookPosition|mouseenter|getStemLayout|transition|Stem|closeButtonCanvas|_void|unbind|_onWindowResizeHandler|mousemove|_remove|boolean|sideOffset|fadeTransition|fadeIn|afterUpdate|firstChild|callback|cos|000|startingZIndex|active|skinned|self|bb|delay|cumulativeScrollOffset||scrollTop|scrollLeft|parentNode|cumulativeOffset||isAttached|Gecko|Chrome|responseText|set|create|hideAll|mouseBuffer|viewport|min|G_vmlCanvasManager|getCenterBorderDimensions|substring|skins|skinElement|prepare|order|mouseleave|rotate|borderRadius|topcenter|rightcenter|bottomcenter|leftcenter|corner|corrections|aQ|setHookPositionAndStemCorrection|closest|_resizeTimer|_getTooltip|selector|_updateTooltip|setActive|touchmove|getTimer|10000px|setFadeDuration|raise|ms|contentFunction|hideAfter|console|in|Object|title|tipped_restore_title|events|toggles|fnCallContent|call|apply|pointer|pageX|RegExp|parseFloat|Opera|opera|WebKit|required|available|findElement|setDefaultSkin|setStartingZIndex|isVisibleByElement|undefined|clearAjaxCache|innerWidth|innerHeight|getSide|getDimensions|getBubbleLayout|nullifyCornerOffset|replace|100|defaultCloseButton|hoverCloseButton|floor|prepend|find|auto|getMeasureElementDimensions|t_Close|drawCloseButtonState|default|hover|_drawBackgroundPath|aT|aP|before|dark|documentElement|_mouseBufferHandler|getByTooltipElement|clearTimeout|abort|reset|CloseButtons|getInversedPosition|Spinners|aM|isPointerEvent|insertSpinner|play|onload|setIdle|hideDelayed|inArray|t_hidden|_restoreInlineContent|afterAjaxUpdate|_hide|idle|warn|_stemPosition|createOptions|getAttribute|getElementById|_preBuild|Array|concat|pageY|version|AppleWebKit|MobileSafari|check|pow|Za|checked|notified|toUpperCase|param|clear|try|DocumentTouch|catch|TransitionEvent|removeAll|startDelegating|removeDetached|drawRoundedRectangle|fillRect|isArray|Gradient|addColorStops|positions|toOrientation|side|toDimension|isCorner|atan|red|green|blue|360|drawBubble|drawCloseButton|createHookCache|t_ContentContainer|first|25000px|setStemCorrection|setAdjustment|closeButtonShift|closeButtonMouseover|closeButtonMouseout|CloseButton|stemOffset|backgroundRadius|_drawBorderPath|aU|aR|setGlobalAlpha|drawBackground|getBlurOpacity|stopDelegating|touchstart|close|onWindowResize|is|getHighestTooltip|resetZ|base|getTooltipPositionFromTarget|adjustOffsetBasedOnHooks|closeButtonSkin|flip|hideOnClickOutside|typeof|adjustment|outerWidth|outerHeight|getAbsoluteOffset|t_Content|inline|isSpinner|tipped_restore_inline_display|display|img|html|eventName|handler|showDelayed|showDelay|createPreBuildObservers|t_hideOnClickOutside|createPostBuildObservers|clearEvents|clearTimers|removeData|_buildSkin|dataType|ajaxUpdate|t_visible|removeClass|onHide|log|sqrt|object|setAttribute|slice|wrap|nodeType|setTimeout|do|while|exec|attachEvent|MSIE|KHTML|rv|Apple|Mobile|Safari|navigator|userAgent|fn|jquery|z_|z0|requires|_t_uid_||ontouchstart|instanceof|WebKitTransitionEvent|OTransitionEvent|createEvent|ready|scale|initElement|drawPixelArray|createLinearGradient|addColorStop|spacing|rgba|join|fff|255|hue|saturation|brightness|0123456789abcdef|hex2rgb|getSaturatedBW|init_|t_Bubble|iframe|t_iframeShim|frameBorder|javascript|15000px|t_CloseButtonShift|lineCap|t_CloseState|translate|stemCorrection|270|lineWidth|sin|setOpacity|getCenterBorderDimensions2|acos|t_Shadow|t_ShadowBubble|t_CloseButtonShadow|999999|undelegate|delegate|preventDefault|stopPropagation|200|getBySelector|outside|move|530|t_UpdateQueue|t_clearfix|t_Content_|filter|8000|750|Image|fixed|t_Skin|t_Tooltip_|load|success|status|style|MozTransitionDuration|webkitTransitionDuration|OTransitionDuration|transitionDuration|||||hideOthers|hideDelay|||||||||||||resetHookPosition|||||||||||".split("|"),0,{}));var newsChannel="newsFeed";var newsDialogOidIsOpen=0;var WALL_POST_TYPE_NEWS=3;function newsDiscuss(d,c,a,b){if(newsDialogOidIsOpen!=d||b){if(newsDialogOidIsOpen!=0){closenewsDiscuss(d)}if(d!=undefined){fxAjax.sendRequest(fxVars.newsRedirect+"id="+d+"&discuss=true",{params:{oid:d,scrollElementId:c,postOid:a},loader:false,callback:"newsDiscussResponse"})}}else{if(c!=null){goToNewsNotification(c,"newsDiscussion",a)}}}function closenewsDiscuss(a){newsDialogOidIsOpen=0;$JD.destroy("#newsDialog");fxWebsocket.unsubscribe(newsChannel,a)}function updateNewsSubscribeCheckboxElement(a,b,c){if(c){a.checked="checked";a.onchange=function(){feedUnsubscribe(0,WALL_POST_TYPE_NEWS,b)}}else{a.checked="";a.onchange=function(){feedSubscribe(0,WALL_POST_TYPE_NEWS,b)}}}function hideMainScroller(){jQuery("body").css({overflow:"hidden"})}function showMainScroller(){jQuery("body").css({overflow:"inherit"});Tipped.hideAll()}function newsDiscussResponse(a,f){if(!a.error&&(!newsDialogOidIsOpen||!$J("#newsDialog").dialog("isOpen"))){var g=a.content.subscribedToNewsFeed;var c=new Element("input",{type:"checkbox",id:"subscribeToNews",checked:g});updateNewsSubscribeCheckboxElement(c,f.oid,g);$J("#newsDialog").html(a.content.data);var b={};b.width=$J(window).width()-100;b.height=$J(window).height()-100;b.resizable=false;b.title=a.content.title+" <a target='_blank' href='"+a.content.url+"'>("+$T("tLink")+")</a>";b.modal=true;b.close=function(h,k){closenewsDiscuss(f.oid);Tipped.hideAll()};b.open=function(h,k){newsDialogOidIsOpen=f.oid;$J(this).parent().css("z-index",1100).css("position","fixed").css("top",50).css("left",50);$J(".ui-widget-overlay").css("z-index",1050).bind("click",function(){closenewsDiscuss(f.oid);showMainScroller()});if(hasText($F("userId"))){$J(this).parent().children(".ui-dialog-titlebar").append(jQuery("<span id='subscribeToNewsSpan' style='float: right;padding-right:182px'></span>").append(c).append(" <label for='subscribeToNews'>"+$T("tFeedSubscribe")+"</label>"))}};b.create=function(h,k){hideMainScroller()};b.beforeClose=function(h,k){showMainScroller()};$J("#newsIframeData").append($J("#newsIframe").attr("src",a.content.url).css("width",b.width-350).css("height",b.height-50)).css("scrolling","yes");var d=$J("#newsDiscussTable");$J("#newsDialog").append(d);$JD.create("#newsDialog",b);$J("#newsDiscussion").height(b.height-50);newsChannelSubscribe(f.oid);createNewsFeedScroller(f.oid);if(f.scrollElementId!=null){goToNewsNotification(f.scrollElementId,"newsDiscussion",f.postOid)}}}function newsChannelSubscribe(f){var c=0;var d=$$("#newsUserMessages [time]");for(var a=0;a<d.length;a++){var b=Number(d[a].getAttribute("time"));c=(b>c)?b:c}if(c==0){c=getMetaContent("server-timestamp")}if(atmosphereIsConnected){fxWebsocket.subscribe(newsChannel,f,c,null)}else{onOpenArray.push("fxWebsocket.subscribe('"+newsChannel+"','"+f+"','"+c+"','"+null+"')")}}function newsCallBack(data){try{var type=data.type;var uid=Number($F("userId"));switch(type){case"comment":var commnet=data.data;var postOid=data.post;var commentOid=Number(data.oid);var commentObject=$("newsComment"+commentOid);var pending=data.pending;var from=Number(data.from);var objectId=data.objectId;var commentText=$("newsCommentText"+postOid);if(commentText!=null){commentText.style.height="15px"}if(pending&&from==uid){break}if(commentObject==null){updateCommentsCount(objectId);if(postOid!=null){var post=$("newsPost"+postOid);if(post!=null){addNewsComment(postOid,commnet)}if(uid!=from){goToNotification("newsComment"+commentOid,false,false,"newsDiscussion")}else{if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($("subscribeToNews"),data.objectId,true)}}}}break;case"post":post=data.post;post=changeAvatar(post);var lastOid=Number(data.lastOid);from=Number(data.from);objectId=data.objectId;if($("newsPost"+lastOid)==null){updateCommentsCount(objectId);createNewsPost(lastOid,post,lastChartId);if(uid!=from){goToNotification("newsPost"+commentOid,false,false,"newsDiscussion")}else{if(eval($F("userFeedAutoSubscribe"))){updateNewsSubscribeCheckboxElement($("subscribeToNews"),data.objectId,true)}}}break;case"removePost":var oid=data.oid;post=$("newsPost"+oid);var postText=$("newsPostText"+oid);if(postText!=null){postText.remove()}if(post!=null){post.remove();updateFeedScrooler("newsDiscussion",false)}break;case"removeComment":var oid=data.oid;var postId=data.postId;var comment=$("newsComment"+oid);if(comment!=null){comment.remove();updateFeedScrooler("newsDiscussion",false)}break}}catch(e){}}function createNewsPost(a,f,c){if($("newsPost"+a)==null){var b=new Element("div",{style:"display:none"});var d=new Element("div",{});b.innerHTML=f;d.innerHTML=f;$("newsUserMessages").insertBefore(b,$("newsUserMessages").firstChild);feedSlideDown(b,"newsDiscussion");runAjaxScripts(f)}}function createNewsFeedScroller(a){jQuery("#newsDiscussion").jScrollPane({hijackInternalLinks:true,animateScroll:true,verticalGutter:0}).bind("jsp-scroll-y",function(d,c,f,b){if(b){showMoreWallPost(null,WALL_POST_TYPE_NEWS,a,"")}});jQuery("#newsDiscussion").hover(function(){jQuery(document).bind("mousewheel DOMMouseScroll",function(b){stopWheel(b)})},function(){if(!isShown("newsFeedLoader")){jQuery(document).unbind("mousewheel DOMMouseScroll")}})}function changeNewsPostChoice(b){var a=$F("userId");if(hasText(a)&&a!=0){if($("newsPostText"+b).style.display=="none"){showElement("newsPostText"+b);$("newsCommentText"+b).focus()}else{hideElement("newsPostText"+b);$("newsCommentText"+b).blur()}showElement("userCommentNews");updateFeedScrooler("newsDiscussion",false)}}function addNewsComment(a,f){var b=$("newsPost"+a);if(b!=null){var c=new Element("div",{style:"display:none"});var d=new Element("div",{});c.innerHTML=f;d.innerHTML=f;b.appendChild(c);feedSlideDown(c,"newsDiscussion")}}function goToNewsNotification(a,c,b){var g;if($(a)!=null){goToChartNotification(a,false,true,c)}else{if(showMoreBloack){if($("newsPost"+b)==null){var d=$$("#newsUserMessages [postId]");g=d[d.length-1].getAttribute("postId")}if(Number(g)>b){var f=["firstPostOid=",b];if(g!=null){f.push("&lastPostOid="+g)}showMoreBloack=false;fxAjax.sendRequest(fxVars.getWallPosts+f.join(""),{params:{lastPostOid:g,firstPostOid:b,objectId:a},loader:false,callback:"loadNewsNotificationResponse"})}else{jQuery("#newsUserMessages [lastOid]").each(function(k){var l=Number(this.getAttribute("firstOid"));var h=Number(this.getAttribute("lastOid"));if(b<h&&b>l){getWallPostsBetweenOids(l,h,this,"",a)}})}}}}function loadNewsNotificationResponse(a,f){try{if(!a.error){var g=new Element("div",{style:"height: 100%; border-left: 3px solid orange; left: 0px; top: 0px;z-index:1",className:"absolute"});var b=a.content.post;if(f.lastPostOid==null){$("newsPost"+f.firstPostOid).innerHTML=b}else{var c=new Element("span",{});c.innerHTML=b;$("newsUserMessages").appendChild(c)}if(a.content.lastTime!=null){$("newsShowMoreWallPost").setAttribute("lastTime",a.content.lastTime)}$(f.objectId).insertBefore(g,$(f.objectId).firstChild);g.fade({duration:3});updateFeedScrooler("newsDiscussion");moveScroller("newsDiscussion",f.objectId)}}catch(d){}showMoreBloack=true}jQuery(window).resize(function(){if(newsDialogOidIsOpen!=0){newsDiscuss(newsDialogOidIsOpen,null,null,true)}});function updateCommentsCount(a){var c=jQuery("#newsCommentsCount"+a);if(c!=null){var d=Number(c.attr("count"))+1;c.attr("count",d);var b=c.html();c.html(b.replace(/(\d+)/g,d))}}!function(C){function B(g,f,l){if(8==u){var k=o.width(),h=w.debounce(function(){var b=o.width();k!=b&&(k=b,l())},g);o.on(f,h)}else{o.on(f,w.debounce(l,g))}}function A(b){window.console&&window.console&&window.console.log&&window.console.log("jQuery.floatThead: "+b)}function z(){var a=C('<div style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;width:100%"></div>');C("body").append(a);var g=a.innerWidth(),f=C("div",a).innerWidth();return a.remove(),g-f}function y(f){if(f.dataTableSettings){for(var d=0;d<f.dataTableSettings.length;d++){var g=f.dataTableSettings[d].nTable;if(f[0]==g){return !0}}}return !1}function x(h,g,D){var m=D?"outerWidth":"width";if(r&&h.css("max-width")){var l=0;D&&(l+=parseInt(h.css("borderLeft"),10),l+=parseInt(h.css("borderRight"),10));for(var k=0;k<g.length;k++){l+=g.get(k).offsetWidth}return l}return h[m]()}C.floatThead=C.floatThead||{},C.floatThead.defaults={cellTag:null,headerCellSelector:"tr:visible:first>*:visible",zIndex:1001,debounceResizeMs:10,useAbsolutePositioning:!0,scrollingTop:0,scrollingBottom:0,scrollContainer:function(){return C([])},getSizingRow:function(b){return b.find("tbody tr:visible:first>*:visible")},floatTableClass:"floatThead-table",floatWrapperClass:"floatThead-wrapper",floatContainerClass:"floatThead-container",copyTableClass:!0,enableAria:!1,autoReflow:!1,debug:!1};var w=window._,v="undefined"!=typeof MutationObserver,u=function(){for(var f=3,d=document.createElement("b"),g=d.all||[];f=1+f,d.innerHTML="<!--[if gt IE "+f+"]><i><![endif]-->",g[0];){}return f>4?f:document.documentMode}(),t=/Gecko\//.test(navigator.userAgent),s=/WebKit\//.test(navigator.userAgent),r=function(){if(s){var a=C('<div style="width:0px"><table style="max-width:100%"><tr><th><div style="min-width:100px;">X</div></th></tr></table></div>');C("body").append(a);var d=0==a.find("table").width();return a.remove(),d}return !1},q=!t&&!u,o=C(window);C.fn.floatThead=function(a){if(a=a||{},!w&&(w=window._||C.floatThead._,!w)){throw new Error("jquery.floatThead-slim.js requires underscore. You should use the non-lite version since you do not have underscore.")}if(8>u){return this}q&&(document.createElement("fthtr"),document.createElement("fthtd"),document.createElement("fthfoot"));var g=null;if(w.isFunction(r)&&(r=r()),w.isString(a)){var f=a,d=this;return this.filter("table").each(function(){var h=C(this).data("floatThead-attached");if(h&&w.isFunction(h[f])){var k=h[f]();"undefined"!=typeof k&&(d=k)}}),d}var c=C.extend({},C.floatThead.defaults||{},a);if(C.each(a,function(h){h in C.floatThead.defaults||!c.debug||A("Used ["+h+"] key to init plugin, but that param is not an option for the plugin. Valid options are: "+w.keys(C.floatThead.defaults).join(", "))}),c.debug){var b=C.fn.jquery.split(".");1==parseInt(b[0],10)&&parseInt(b[1],10)<=7&&A("jQuery version "+C.fn.jquery+" detected! This plugin supports 1.8 or better, or 1.7.x with jQuery UI 1.8.24 -> http://jqueryui.com/resources/download/jquery-ui-1.8.24.zip")}return this.filter(":not(."+c.floatTableClass+")").each(function(){function a7(l){return l+".fth-"+aD+".floatTHead"}function a6(){var l=0;aB.find("tr:visible").each(function(){l+=C(this).outerHeight(!0)}),a8.outerHeight(l),aO.outerHeight(l)}function a5(){var D=x(aC,aP,!0),l=at.width()||D,F="hidden"!=at.css("overflow-y")?l-aw.vertical:l;if(aN.width(F),am){var E=100*D/F;ah.css("width",E+"%")}else{ah.outerWidth(D)}}function a4(){az=(w.isFunction(c.scrollingTop)?c.scrollingTop(aC):c.scrollingTop)||0,ay=(w.isFunction(c.scrollingBottom)?c.scrollingBottom(aC):c.scrollingBottom)||0}function a3(){var l,J;if(ac){l=ae.find("col").length}else{var I;if(I=null==c.cellTag&&c.headerCellSelector?c.headerCellSelector:"tr:first>"+c.cellTag,w.isNumber(I)){return I}J=aB.find(I),l=0,J.each(function(){l+=parseInt(C(this).attr("colspan")||1,10)})}if(l!=au){au=l;for(var H,G=[],F=[],E=[],D=0;l>D;D++){G.push(c.enableAria&&(H=J.eq(D).text())?'<th scope="col" class="floatThead-col">'+H+"</th>":'<th class="floatThead-col"/>'),F.push("<col/>"),E.push("<fthtd style='display:table-cell;height:0;width:auto;'/>")}F=F.join(""),G=G.join(""),q&&(E=E.join(""),aa.html(E),aP=aa.find("fthtd")),a8.html(G),aO=a8.find("th"),ac||ae.html(F),aG=ae.find("col"),af.html(F),h=af.find("col")}return l}function a2(){if(!ax){if(ax=!0,ar){var D=x(aC,aP),l=ak.width();D>l&&aC.css("minWidth",D)}aC.css(aQ),ah.css(aQ),ah.append(aB),aA.before(aE),a6()}}function a0(){ax&&(ax=!1,ar&&aC.width(m),aE.detach(),aC.prepend(aB),aC.css(aI),ah.css(aI),aC.css("minWidth",aS),aC.css("minWidth",x(aC,aP)))}function aZ(l){ar!=l&&(ar=l,aN.css({position:ar?"absolute":"fixed"}))}function aX(D,l,F,E){return q?F:E?c.getSizingRow(D,l,F):l}function aW(){var D,l=a3();return function(){aG=ae.find("col");var F=aX(aC,aG,aP,u);if(F.length==l&&l>0){if(!ac){for(D=0;l>D;D++){aG.eq(D).css("width","")}}a0();var E=[];for(D=0;l>D;D++){E[D]=F.get(D).offsetWidth}for(D=0;l>D;D++){h.eq(D).width(E[D]),aG.eq(D).width(E[D])}a2()}else{ah.append(aB),aC.css(aI),ah.css(aI),a6()}}}function aU(D){var l=at.css("border-"+D+"-width"),E=0;return l&&~l.indexOf("px")&&(E=parseInt(l,10)),E}function aT(){var O,N=at.scrollTop(),M=0,L=ap?aq.outerHeight(!0):0,K=ao?L:-L,J=aN.height(),I=aC.offset(),H=0;if(am){var G=at.offset();M=I.top-G.top+N,ap&&ao&&(M+=L),M-=aU("top"),H=aU("left")}else{O=I.top-az-J+ay+aw.horizontal}var F=o.scrollTop(),E=o.scrollLeft(),D=at.scrollLeft();return N=at.scrollTop(),function(P){var T=aC[0].offsetWidth<=0&&aC[0].offsetHeight<=0;if(!T&&a9){return a9=!1,setTimeout(function(){aC.trigger("reflow")},1),null}if(T&&(a9=!0,!ar)){return null}if("windowScroll"==P?(F=o.scrollTop(),E=o.scrollLeft()):"containerScroll"==P?(N=at.scrollTop(),D=at.scrollLeft()):"init"!=P&&(F=o.scrollTop(),E=o.scrollLeft(),N=at.scrollTop(),D=at.scrollLeft()),!s||!(0>F||0>E)){if(ai){aZ("windowScrollDone"==P?!0:!1)}else{if("windowScrollDone"==P){return null}}I=aC.offset(),ap&&ao&&(I.top+=L);var S,R,Q=aC.outerHeight();if(am&&ar){if(M>=N){var l=M-N;S=l>0?l:0}else{S=al?0:N}R=H}else{!am&&ar?(F>O+Q+K?S=Q-J+K:I.top>F+az?(S=0,a0()):(S=az+F-I.top+M+(ao?L:0),a2()),R=0):am&&!ar?(M>N||N-M>Q?(S=I.top-F,a0()):(S=I.top+N-F-M,a2()),R=I.left+D-E):am||ar||(F>O+Q+K?S=Q+az-F+O+K:I.top>F+az?(S=I.top-F,a2()):S=az,R=I.left-E)}return{top:S,left:R}}}}function aR(){var D=null,l=null,E=null;return function(I,H,G){null==I||D==I.top&&l==I.left||(aN.css({top:I.top,left:I.left}),D=I.top,l=I.left),H&&a5(),G&&a6();var F=at.scrollLeft();ar&&E==F||(aN.scrollLeft(F),E=F)}}function aF(){if(at.length){if(at.data().perfectScrollbar){aw={horizontal:0,vertical:0}}else{var D=at.width(),l=at.height(),H=aC.height(),G=x(aC,aP),F=G>D?av:0,E=H>l?av:0;aw.horizontal=G>D-E?av:0,aw.vertical=H>l-F?av:0}}}var aD=w.uniqueId(),aC=C(this);if(aC.data("floatThead-attached")){return !0}if(!aC.is("table")){throw new Error('jQuery.floatThead must be run on a table element. ex: $("table").floatThead();')}v=c.autoReflow&&v;var aB=aC.find("thead:first"),aA=aC.find("tbody:first");if(0==aB.length){throw new Error("jQuery.floatThead must be run on a table that contains a <thead> element")}var az,ay,ax=!1,aw={vertical:0,horizontal:0},av=z(),au=0,at=c.scrollContainer(aC)||C([]),ar=c.useAbsolutePositioning;null==ar&&(ar=c.scrollContainer(aC).length),ar||(ax=!0);var aq=aC.find("caption"),ap=1==aq.length;if(ap){var ao="top"===(aq.css("caption-side")||aq.attr("align")||"top")}var an=C('<fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"/>'),am=at.length>0,al=!1,ak=C([]),ai=9>=u&&!am&&ar,ah=C("<table/>"),af=C("<colgroup/>"),ae=aC.find("colgroup:first"),ac=!0;0==ae.length&&(ae=C("<colgroup/>"),ac=!1);var aa=C('<fthrow style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"/>'),aN=C('<div style="overflow: hidden;" aria-hidden="true" class="floatThead-floatContainer"></div>'),a9=!1,aE=C("<thead/>"),a8=C('<tr class="size-row"/>'),aO=C([]),aG=C([]),h=C([]),aP=C([]);aE.append(a8),aC.prepend(ae),q&&(an.append(aa),aC.append(an)),ah.append(af),aN.append(ah),c.copyTableClass&&ah.attr("class",aC.attr("class")),ah.attr({cellpadding:aC.attr("cellpadding"),cellspacing:aC.attr("cellspacing"),border:aC.attr("border")});var aH=aC.css("display");if(ah.css({borderCollapse:aC.css("borderCollapse"),border:aC.css("border"),display:aH}),"none"==aH&&(a9=!0),ah.addClass(c.floatTableClass).css("margin",0),ar){var k=function(D,l){var G=D.css("position"),F="relative"==G||"absolute"==G;if(!F||l){var E={paddingLeft:D.css("paddingLeft"),paddingRight:D.css("paddingRight")};aN.css(E),D=D.wrap("<div class='"+c.floatWrapperClass+"' style='position: relative; clear:both;'></div>").parent(),al=!0}return D};am?(ak=k(at,!0),ak.append(aN)):(ak=k(aC),aC.after(aN))}else{aC.after(aN)}aN.css({position:ar?"absolute":"fixed",marginTop:0,top:ar?0:"auto",zIndex:c.zIndex}),aN.addClass(c.floatContainerClass),a4();var aQ={"table-layout":"fixed"},aI={"table-layout":aC.css("tableLayout")||"auto"},m=aC[0].style.width||"",aS=aC.css("minWidth")||"";aF();var aJ,ad=function(){(aJ=aW())()};ad();var aV=aT(),aK=aR();aK(aV("init"),!0);var ag=w.debounce(function(){aK(aV("windowScrollDone"),!1)},300),aY=function(){aK(aV("windowScroll"),!1),ag()},aL=function(){aK(aV("containerScroll"),!1)},aj=function(){a4(),aF(),ad(),aV=aT(),(aK=aR())(aV("resize"),!0,!0)},a1=w.debounce(function(){aF(),a4(),ad(),aV=aT(),aK(aV("reflow"),!0)},1);if(am?ar?at.on(a7("scroll"),aL):(at.on(a7("scroll"),aL),o.on(a7("scroll"),aY)):o.on(a7("scroll"),aY),o.on(a7("load"),a1),B(c.debounceResizeMs,a7("resize"),aj),aC.on("reflow",a1),y(aC)&&aC.on("filter",a1).on("sort",a1).on("page",a1),v){var aM=at.length?at[0]:aC[0];g=new MutationObserver(function(D){for(var l=function(F){return F&&F[0]&&"THEAD"==F[0].nodeName},E=0;E<D.length;E++){if(!l(D[E].addedNodes)&&!l(D[E].removedNodes)){a1();break}}}),g.observe(aM,{childList:!0,subtree:!0})}aC.data("floatThead-attached",{destroy:function(){var l=".fth-"+aD;a0(),aC.css(aI),ae.remove(),q&&an.remove(),aE.parent().length&&aE.replaceWith(aB),v&&(g.disconnect(),g=null),aC.off("reflow"),at.off(l),al&&(at.length?at.unwrap():aC.unwrap()),aC.css("minWidth",aS),aN.remove(),aC.data("floatThead-attached",!1),o.off(l)},reflow:function(){a1()},setHeaderHeight:function(){a6()},getFloatContainer:function(){return aN},getRowGroups:function(){return ax?aN.find("thead").add(aC.find("tbody,tfoot")):aC.find("thead,tbody,tfoot")}})}),this}}(jQuery),function(b){b.floatThead=b.floatThead||{},b.floatThead._=window._||function(){var a={},h=Object.prototype.hasOwnProperty,g=["Arguments","Function","String","Number","Date","RegExp"];a.has=function(d,c){return h.call(d,c)},a.keys=function(k){if(k!==Object(k)){throw new TypeError("Invalid object")}var m=[];for(var l in k){a.has(k,l)&&m.push(l)}return m};var f=0;return a.uniqueId=function(d){var c=++f+"";return d?d+c:c},b.each(g,function(){var c=this;a["is"+c]=function(d){return Object.prototype.toString.call(d)=="[object "+c+"]"}}),a.debounce=function(l,k,t){var s,r,q,o,m;return function(){q=this,r=arguments,o=new Date;var d=function(){var u=new Date-o;k>u?s=setTimeout(d,k-u):(s=null,t||(m=l.apply(q,r)))},c=t&&!s;return s||(s=setTimeout(d,k)),c&&(m=l.apply(q,r)),m}},a}()}(jQuery);